/*! RESOURCE: /scripts/lib/prototype.min.js */
var Prototype={Version:"1.7.3",Browser:function(){var ua=navigator.userAgent;var isOpera=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!isOpera,Opera:isOpera,WebKit:ua.indexOf("AppleWebKit/")>-1,Gecko:ua.indexOf("Gecko")>-1&&ua.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(ua)}}(),BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:function(){var constructor=window.Element||window.HTMLElement;return!!(constructor&&constructor.prototype)}(),SpecificElementExtensions:function(){if(typeof window.HTMLDivElement!=="undefined")return true;var div=document.createElement("div"),form=document.createElement("form"),isSupported=false;if(div["__proto__"]&&div["__proto__"]!==form["__proto__"]){isSupported=true}div=form=null;return isSupported}()},ScriptFragment:"<script[^>]*>([\\S\\s]*?)</script\\s*>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(x){return x}};if(Prototype.Browser.MobileSafari)Prototype.BrowserFeatures.SpecificElementExtensions=false;var Class=function(){var IS_DONTENUM_BUGGY=function(){for(var p in{toString:1}){if(p==="toString")return false}return true}();function subclass(){}function create(){var parent=null,properties=$A(arguments);if(Object.isFunction(properties[0]))parent=properties.shift();function klass(){this.initialize.apply(this,arguments)}Object.extend(klass,Class.Methods);klass.superclass=parent;klass.subclasses=[];if(parent){subclass.prototype=parent.prototype;klass.prototype=new subclass;parent.subclasses.push(klass)}for(var i=0,length=properties.length;i<length;i++)klass.addMethods(properties[i]);if(!klass.prototype.initialize)klass.prototype.initialize=Prototype.emptyFunction;klass.prototype.constructor=klass;return klass}function addMethods(source){var ancestor=this.superclass&&this.superclass.prototype,properties=Object.keys(source);if(IS_DONTENUM_BUGGY){if(source.toString!=Object.prototype.toString)properties.push("toString");if(source.valueOf!=Object.prototype.valueOf)properties.push("valueOf")}for(var i=0,length=properties.length;i<length;i++){var property=properties[i],value=source[property];if(ancestor&&Object.isFunction(value)&&value.argumentNames()[0]=="$super"){var method=value;value=function(m){return function(){return ancestor[m].apply(this,arguments)}}(property).wrap(method);value.valueOf=function(method){return function(){return method.valueOf.call(method)}}(method);value.toString=function(method){return function(){return method.toString.call(method)}}(method)}this.prototype[property]=value}return this}return{create:create,Methods:{addMethods:addMethods}}}();(function(){var _toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,NULL_TYPE="Null",UNDEFINED_TYPE="Undefined",BOOLEAN_TYPE="Boolean",NUMBER_TYPE="Number",STRING_TYPE="String",OBJECT_TYPE="Object",FUNCTION_CLASS="[object Function]",BOOLEAN_CLASS="[object Boolean]",NUMBER_CLASS="[object Number]",STRING_CLASS="[object String]",ARRAY_CLASS="[object Array]",DATE_CLASS="[object Date]",NATIVE_JSON_STRINGIFY_SUPPORT=window.JSON&&typeof JSON.stringify==="function"&&JSON.stringify(0)==="0"&&typeof JSON.stringify(Prototype.K)==="undefined";var DONT_ENUMS=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var IS_DONTENUM_BUGGY=function(){for(var p in{toString:1}){if(p==="toString")return false}return true}();function Type(o){switch(o){case null:return NULL_TYPE;case void 0:return UNDEFINED_TYPE}var type=typeof o;switch(type){case"boolean":return BOOLEAN_TYPE;case"number":return NUMBER_TYPE;case"string":return STRING_TYPE}return OBJECT_TYPE}function extend(destination,source){for(var property in source)destination[property]=source[property];return destination}function inspect(object){try{if(isUndefined(object))return"undefined";if(object===null)return"null";return object.inspect?object.inspect():String(object)}catch(e){if(e instanceof RangeError)return"...";throw e}}function toJSON(value){return Str("",{"":value},[])}function Str(key,holder,stack){var value=holder[key];if(Type(value)===OBJECT_TYPE&&typeof value.toJSON==="function"){value=value.toJSON(key)}var _class=_toString.call(value);switch(_class){case NUMBER_CLASS:case BOOLEAN_CLASS:case STRING_CLASS:value=value.valueOf()}switch(value){case null:return"null";case true:return"true";case false:return"false"}var type=typeof value;switch(type){case"string":return value.inspect(true);case"number":return isFinite(value)?String(value):"null";case"object":for(var i=0,length=stack.length;i<length;i++){if(stack[i]===value){throw new TypeError("Cyclic reference to '"+value+"' in object")}}stack.push(value);var partial=[];if(_class===ARRAY_CLASS){for(var i=0,length=value.length;i<length;i++){var str=Str(i,value,stack);partial.push(typeof str==="undefined"?"null":str)}partial="["+partial.join(",")+"]"}else{var keys=Object.keys(value);for(var i=0,length=keys.length;i<length;i++){var key=keys[i],str=Str(key,value,stack);if(typeof str!=="undefined"){partial.push(key.inspect(true)+":"+str)}}partial="{"+partial.join(",")+"}"}stack.pop();return partial}}function stringify(object){return JSON.stringify(object)}function toQueryString(object){return $H(object).toQueryString()}function toHTML(object){return object&&object.toHTML?object.toHTML():String.interpret(object)}function keys(object){if(Type(object)!==OBJECT_TYPE){throw new TypeError}var results=[];for(var property in object){if(_hasOwnProperty.call(object,property))results.push(property)}if(IS_DONTENUM_BUGGY){for(var i=0;property=DONT_ENUMS[i];i++){if(_hasOwnProperty.call(object,property))results.push(property)}}return results}function values(object){var results=[];for(var property in object)results.push(object[property]);return results}function clone(object){return extend({},object)}function isElement(object){return!!(object&&object.nodeType==1)}function isArray(object){return _toString.call(object)===ARRAY_CLASS}var hasNativeIsArray=typeof Array.isArray=="function"&&Array.isArray([])&&!Array.isArray({});if(hasNativeIsArray){isArray=Array.isArray}function isHash(object){return object instanceof Hash}function isFunction(object){return _toString.call(object)===FUNCTION_CLASS}function isString(object){return _toString.call(object)===STRING_CLASS}function isNumber(object){return _toString.call(object)===NUMBER_CLASS}function isDate(object){return _toString.call(object)===DATE_CLASS}function isUndefined(object){return typeof object==="undefined"}extend(Object,{extend:extend,inspect:inspect,toJSON:NATIVE_JSON_STRINGIFY_SUPPORT?stringify:toJSON,toQueryString:toQueryString,toHTML:toHTML,keys:Object.keys||keys,values:values,clone:clone,isElement:isElement,isArray:isArray,isHash:isHash,isFunction:isFunction,isString:isString,isNumber:isNumber,isDate:isDate,isUndefined:isUndefined})})();Object.extend(Function.prototype,function(){var slice=Array.prototype.slice;function update(array,args){var arrayLength=array.length,length=args.length;while(length--)array[arrayLength+length]=args[length];return array}function merge(array,args){array=slice.call(array,0);return update(array,args)}function argumentNames(){var names=this.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return names.length==1&&!names[0]?[]:names}function bind(context){if(arguments.length<2&&Object.isUndefined(arguments[0]))return this;if(!Object.isFunction(this))throw new TypeError("The object is not callable.");var nop=function(){};var __method=this,args=slice.call(arguments,1);var bound=function(){var a=merge(args,arguments);var c=this instanceof bound?this:context;return __method.apply(c,a)};nop.prototype=this.prototype;bound.prototype=new nop;return bound}function bindAsEventListener(context){var __method=this,args=slice.call(arguments,1);return function(event){var a=update([event||window.event],args);return __method.apply(context,a)}}function curry(){if(!arguments.length)return this;var __method=this,args=slice.call(arguments,0);return function(){var a=merge(args,arguments);return __method.apply(this,a)}}function delay(timeout){var __method=this,args=slice.call(arguments,1);timeout=timeout*1e3;return window.setTimeout(function(){return __method.apply(__method,args)},timeout)}function defer(){var args=update([.01],arguments);return this.delay.apply(this,args)}function wrap(wrapper){var __method=this;return function(){var a=update([__method.bind(this)],arguments);return wrapper.apply(this,a)}}function methodize(){if(this._methodized)return this._methodized;var __method=this;return this._methodized=function(){var a=update([this],arguments);return __method.apply(null,a)}}var extensions={argumentNames:argumentNames,bindAsEventListener:bindAsEventListener,curry:curry,delay:delay,defer:defer,wrap:wrap,methodize:methodize};if(!Function.prototype.bind)extensions.bind=bind;return extensions}());(function(proto){function toISOString(){return this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+"Z"}function toJSON(){return this.toISOString()}if(!proto.toISOString)proto.toISOString=toISOString;if(!proto.toJSON)proto.toJSON=toJSON})(Date.prototype);RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(str){return String(str).replace(/([.*+?^=!:()|[\]\/\\])/g,"\\$1")};var PeriodicalExecuter=Class.create({initialize:function(callback,frequency){this.callback=callback;this.frequency=frequency;this.currentlyExecuting=false;this.registerCallback()},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1e3)},execute:function(){this.callback(this)},stop:function(){if(!this.timer)return;clearInterval(this.timer);this.timer=null},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();this.currentlyExecuting=false}catch(e){this.currentlyExecuting=false;throw e}}}});Object.extend(String,{interpret:function(value){return value==null?"":String(value)},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});Object.extend(String.prototype,function(){var NATIVE_JSON_PARSE_SUPPORT=window.JSON&&typeof JSON.parse==="function"&&JSON.parse('{"test": true}').test;function prepareReplacement(replacement){if(Object.isFunction(replacement))return replacement;var template=new Template(replacement);return function(match){return template.evaluate(match)}}function isNonEmptyRegExp(regexp){return regexp.source&&regexp.source!=="(?:)"}function gsub(pattern,replacement){var result="",source=this,match;replacement=prepareReplacement(replacement);if(Object.isString(pattern))pattern=RegExp.escape(pattern);if(!(pattern.length||isNonEmptyRegExp(pattern))){replacement=replacement("");return replacement+source.split("").join(replacement)+replacement}while(source.length>0){match=source.match(pattern);if(match&&match[0].length>0){result+=source.slice(0,match.index);result+=String.interpret(replacement(match));source=source.slice(match.index+match[0].length)}else{result+=source,source=""}}return result}function sub(pattern,replacement,count){replacement=prepareReplacement(replacement);count=Object.isUndefined(count)?1:count;return this.gsub(pattern,function(match){if(--count<0)return match[0];return replacement(match)})}function scan(pattern,iterator){this.gsub(pattern,iterator);return String(this)}function truncate(length,truncation){length=length||30;truncation=Object.isUndefined(truncation)?"...":truncation;return this.length>length?this.slice(0,length-truncation.length)+truncation:String(this)}function strip(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function stripTags(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>'"])+)?\s*("[^">]*|'[^'>])?(\/)?>|<\/\w+>/gi,"")}function stripScripts(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"")}function extractScripts(){var matchAll=new RegExp(Prototype.ScriptFragment,"img"),matchOne=new RegExp(Prototype.ScriptFragment,"im");return(this.match(matchAll)||[]).map(function(scriptTag){return(scriptTag.match(matchOne)||["",""])[1]})}function evalScripts(){return this.extractScripts().map(function(script){return eval(script)})}function escapeHTML(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function unescapeHTML(){return this.stripTags().replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}function toQueryParams(separator){var match=this.strip().match(/([^?#]*)(#.*)?$/);if(!match)return{};return match[1].split(separator||"&").inject({},function(hash,pair){if((pair=pair.split("="))[0]){var key=decodeURIComponent(pair.shift()),value=pair.length>1?pair.join("="):pair[0];if(value!=undefined){value=value.gsub("+"," ");value=decodeURIComponent(value)}if(key in hash){if(!Object.isArray(hash[key]))hash[key]=[hash[key]];hash[key].push(value)}else hash[key]=value}return hash})}function toArray(){return this.split("")}function succ(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1)}function times(count){return count<1?"":new Array(count+1).join(this)}function camelize(){return this.replace(/-+(.)?/g,function(match,chr){return chr?chr.toUpperCase():""})}function capitalize(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function underscore(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function dasherize(){return this.replace(/_/g,"-")}function inspect(useDoubleQuotes){var escapedString=this.replace(/[\x00-\x1f\\]/g,function(character){if(character in String.specialChar){return String.specialChar[character]}return"\\u00"+character.charCodeAt().toPaddedString(2,16)});if(useDoubleQuotes)return'"'+escapedString.replace(/"/g,'\\"')+'"';return"'"+escapedString.replace(/'/g,"\\'")+"'"}function unfilterJSON(filter){return this.replace(filter||Prototype.JSONFilter,"$1")}function isJSON(){var str=this;if(str.blank())return false;str=str.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@");str=str.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");str=str.replace(/(?:^|:|,)(?:\s*\[)+/g,"");return/^[\],:{}\s]*$/.test(str)}function evalJSON(sanitize){var json=this.unfilterJSON(),cx=/[\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff\u0000]/g;if(cx.test(json)){json=json.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}try{if(!sanitize||json.isJSON())return eval("("+json+")")}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect())}function parseJSON(){var json=this.unfilterJSON();return JSON.parse(json)}function include(pattern){return this.indexOf(pattern)>-1}function startsWith(pattern,position){position=Object.isNumber(position)?position:0;return this.lastIndexOf(pattern,position)===position}function endsWith(pattern,position){pattern=String(pattern);position=Object.isNumber(position)?position:this.length;if(position<0)position=0;if(position>this.length)position=this.length;var d=position-pattern.length;return d>=0&&this.indexOf(pattern,d)===d}function empty(){return this==""}function blank(){return/^\s*$/.test(this)}function interpolate(object,pattern){return new Template(this,pattern).evaluate(object)}return{gsub:gsub,sub:sub,scan:scan,truncate:truncate,strip:String.prototype.trim||strip,stripTags:stripTags,stripScripts:stripScripts,extractScripts:extractScripts,evalScripts:evalScripts,escapeHTML:escapeHTML,unescapeHTML:unescapeHTML,toQueryParams:toQueryParams,parseQuery:toQueryParams,toArray:toArray,succ:succ,times:times,camelize:camelize,capitalize:capitalize,underscore:underscore,dasherize:dasherize,inspect:inspect,unfilterJSON:unfilterJSON,isJSON:isJSON,evalJSON:NATIVE_JSON_PARSE_SUPPORT?parseJSON:evalJSON,include:include,startsWith:String.prototype.startsWith||startsWith,endsWith:String.prototype.endsWith||endsWith,empty:empty,blank:blank,interpolate:interpolate}}());var Template=Class.create({initialize:function(template,pattern){this.template=template.toString();this.pattern=pattern||Template.Pattern},evaluate:function(object){if(object&&Object.isFunction(object.toTemplateReplacements))object=object.toTemplateReplacements();return this.template.gsub(this.pattern,function(match){if(object==null)return match[1]+"";var before=match[1]||"";if(before=="\\")return match[2];var ctx=object,expr=match[3],pattern=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;match=pattern.exec(expr);if(match==null)return before;while(match!=null){var comp=match[1].startsWith("[")?match[2].replace(/\\\\]/g,"]"):match[1];ctx=ctx[comp];if(null==ctx||""==match[3])break;expr=expr.substring("["==match[3]?match[1].length:match[0].length);match=pattern.exec(expr)}return before+String.interpret(ctx)})}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable=function(){function each(iterator,context){try{this._each(iterator,context)}catch(e){if(e!=$break)throw e}return this}function eachSlice(number,iterator,context){var index=-number,slices=[],array=this.toArray();if(number<1)return array;while((index+=number)<array.length)slices.push(array.slice(index,index+number));return slices.collect(iterator,context)}function all(iterator,context){iterator=iterator||Prototype.K;var result=true;this.each(function(value,index){result=result&&!!iterator.call(context,value,index,this);if(!result)throw $break},this);return result}function any(iterator,context){iterator=iterator||Prototype.K;var result=false;this.each(function(value,index){if(result=!!iterator.call(context,value,index,this))throw $break},this);return result}function collect(iterator,context){iterator=iterator||Prototype.K;var results=[];this.each(function(value,index){results.push(iterator.call(context,value,index,this))},this);return results}function detect(iterator,context){var result;this.each(function(value,index){if(iterator.call(context,value,index,this)){result=value;throw $break}},this);return result}function findAll(iterator,context){var results=[];this.each(function(value,index){if(iterator.call(context,value,index,this))results.push(value)},this);return results}function grep(filter,iterator,context){iterator=iterator||Prototype.K;var results=[];if(Object.isString(filter))filter=new RegExp(RegExp.escape(filter));this.each(function(value,index){if(filter.match(value))results.push(iterator.call(context,value,index,this))},this);return results}function include(object){if(Object.isFunction(this.indexOf)&&this.indexOf(object)!=-1)return true;var found=false;this.each(function(value){if(value==object){found=true;throw $break}});return found}function inGroupsOf(number,fillWith){fillWith=Object.isUndefined(fillWith)?null:fillWith;return this.eachSlice(number,function(slice){while(slice.length<number)slice.push(fillWith);return slice})}function inject(memo,iterator,context){this.each(function(value,index){memo=iterator.call(context,memo,value,index,this)},this);return memo}function invoke(method){var args=$A(arguments).slice(1);return this.map(function(value){return value[method].apply(value,args)})}function max(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index,this);if(result==null||value>=result)result=value},this);return result}function min(iterator,context){iterator=iterator||Prototype.K;var result;this.each(function(value,index){value=iterator.call(context,value,index,this);if(result==null||value<result)result=value},this);return result}function partition(iterator,context){iterator=iterator||Prototype.K;var trues=[],falses=[];this.each(function(value,index){(iterator.call(context,value,index,this)?trues:falses).push(value)},this);return[trues,falses]}function pluck(property){var results=[];this.each(function(value){results.push(value[property])});return results}function reject(iterator,context){var results=[];this.each(function(value,index){if(!iterator.call(context,value,index,this))results.push(value)},this);return results}function sortBy(iterator,context){return this.map(function(value,index){return{value:value,criteria:iterator.call(context,value,index,this)}},this).sort(function(left,right){var a=left.criteria,b=right.criteria;return a<b?-1:a>b?1:0}).pluck("value")}function toArray(){return this.map()}function zip(){var iterator=Prototype.K,args=$A(arguments);if(Object.isFunction(args.last()))iterator=args.pop();var collections=[this].concat(args).map($A);return this.map(function(value,index){return iterator(collections.pluck(index))})}function size(){return this.toArray().length}function inspect(){return"#<Enumerable:"+this.toArray().inspect()+">"}return{each:each,eachSlice:eachSlice,all:all,every:all,any:any,some:any,collect:collect,map:collect,detect:detect,findAll:findAll,select:findAll,filter:findAll,grep:grep,include:include,member:include,inGroupsOf:inGroupsOf,inject:inject,invoke:invoke,max:max,min:min,partition:partition,pluck:pluck,reject:reject,sortBy:sortBy,toArray:toArray,entries:toArray,zip:zip,size:size,inspect:inspect,find:detect}}();function $A(iterable){if(!iterable)return[];if("toArray"in Object(iterable))return iterable.toArray();var length=iterable.length||0,results=new Array(length);while(length--)results[length]=iterable[length];return results}function $w(string){if(!Object.isString(string))return[];string=string.strip();return string?string.split(/\s+/):[]}Array.from=$A;(function(){var arrayProto=Array.prototype,slice=arrayProto.slice,_each=arrayProto.forEach;function each(iterator,context){for(var i=0,length=this.length>>>0;i<length;i++){if(i in this)iterator.call(context,this[i],i,this)}}if(!_each)_each=each;function clear(){this.length=0;return this}function first(){return this[0]}function last(){return this[this.length-1]}function compact(){return this.select(function(value){return value!=null})}function flatten(){return this.inject([],function(array,value){if(Object.isArray(value))return array.concat(value.flatten());array.push(value);return array})}function without(){var values=slice.call(arguments,0);return this.select(function(value){return!values.include(value)})}function reverse(inline){return(inline===false?this.toArray():this)._reverse()}function uniq(sorted){return this.inject([],function(array,value,index){if(0==index||(sorted?array.last()!=value:!array.include(value)))array.push(value);return array})}function intersect(array){return this.uniq().findAll(function(item){return array.indexOf(item)!==-1})}function clone(){return slice.call(this,0)}function size(){return this.length}function inspect(){return"["+this.map(Object.inspect).join(", ")+"]"}function indexOf(item,i){if(this==null)throw new TypeError;var array=Object(this),length=array.length>>>0;if(length===0)return-1;i=Number(i);if(isNaN(i)){i=0}else if(i!==0&&isFinite(i)){i=(i>0?1:-1)*Math.floor(Math.abs(i))}if(i>length)return-1;var k=i>=0?i:Math.max(length-Math.abs(i),0);for(;k<length;k++)if(k in array&&array[k]===item)return k;return-1}function lastIndexOf(item,i){if(this==null)throw new TypeError;var array=Object(this),length=array.length>>>0;if(length===0)return-1;if(!Object.isUndefined(i)){i=Number(i);if(isNaN(i)){i=0}else if(i!==0&&isFinite(i)){i=(i>0?1:-1)*Math.floor(Math.abs(i))}}else{i=length}var k=i>=0?Math.min(i,length-1):length-Math.abs(i);for(;k>=0;k--)if(k in array&&array[k]===item)return k;return-1}function concat(_){var array=[],items=slice.call(arguments,0),item,n=0;items.unshift(this);for(var i=0,length=items.length;i<length;i++){item=items[i];if(Object.isArray(item)&&!("callee"in item)){for(var j=0,arrayLength=item.length;j<arrayLength;j++){if(j in item)array[n]=item[j];n++}}else{array[n++]=item}}array.length=n;return array}function wrapNative(method){return function(){if(arguments.length===0){return method.call(this,Prototype.K)}else if(arguments[0]===undefined){var args=slice.call(arguments,1);args.unshift(Prototype.K);return method.apply(this,args)}else{return method.apply(this,arguments)}}}function map(iterator){if(this==null)throw new TypeError;iterator=iterator||Prototype.K;var object=Object(this);var results=[],context=arguments[1],n=0;for(var i=0,length=object.length>>>0;i<length;i++){if(i in object){results[n]=iterator.call(context,object[i],i,object)}n++}results.length=n;return results}if(arrayProto.map){map=wrapNative(Array.prototype.map)}function filter(iterator){if(this==null||!Object.isFunction(iterator))throw new TypeError;var object=Object(this);var results=[],context=arguments[1],value;for(var i=0,length=object.length>>>0;i<length;i++){if(i in object){value=object[i];if(iterator.call(context,value,i,object)){results.push(value)}}}return results}if(arrayProto.filter){filter=Array.prototype.filter}function some(iterator){if(this==null)throw new TypeError;iterator=iterator||Prototype.K;var context=arguments[1];var object=Object(this);for(var i=0,length=object.length>>>0;i<length;i++){if(i in object&&iterator.call(context,object[i],i,object)){return true}}return false}if(arrayProto.some){some=wrapNative(Array.prototype.some)}function every(iterator){if(this==null)throw new TypeError;iterator=iterator||Prototype.K;var context=arguments[1];var object=Object(this);for(var i=0,length=object.length>>>0;i<length;i++){if(i in object&&!iterator.call(context,object[i],i,object)){return false}}return true}if(arrayProto.every){every=wrapNative(Array.prototype.every)}Object.extend(arrayProto,Enumerable);if(arrayProto.entries===Enumerable.entries){delete arrayProto.entries}if(!arrayProto._reverse)arrayProto._reverse=arrayProto.reverse;Object.extend(arrayProto,{_each:_each,map:map,collect:map,select:filter,filter:filter,findAll:filter,some:some,any:some,every:every,all:every,clear:clear,first:first,last:last,compact:compact,flatten:flatten,without:without,reverse:reverse,uniq:uniq,intersect:intersect,clone:clone,toArray:clone,size:size,inspect:inspect});var CONCAT_ARGUMENTS_BUGGY=function(){return[].concat(arguments)[0][0]!==1}(1,2);if(CONCAT_ARGUMENTS_BUGGY)arrayProto.concat=concat;if(!arrayProto.indexOf)arrayProto.indexOf=indexOf;if(!arrayProto.lastIndexOf)arrayProto.lastIndexOf=lastIndexOf})();function $H(object){return new Hash(object)}var Hash=Class.create(Enumerable,function(){function initialize(object){this._object=Object.isHash(object)?object.toObject():Object.clone(object)}function _each(iterator,context){var i=0;for(var key in this._object){var value=this._object[key],pair=[key,value];pair.key=key;pair.value=value;iterator.call(context,pair,i);i++}}function set(key,value){return this._object[key]=value}function get(key){if(this._object[key]!==Object.prototype[key])return this._object[key]}function unset(key){var value=this._object[key];delete this._object[key];return value}function toObject(){return Object.clone(this._object)}function keys(){return this.pluck("key")}function values(){return this.pluck("value")}function index(value){var match=this.detect(function(pair){return pair.value===value});return match&&match.key}function merge(object){return this.clone().update(object)}function update(object){return new Hash(object).inject(this,function(result,pair){result.set(pair.key,pair.value);return result})}function toQueryPair(key,value){if(Object.isUndefined(value))return key;value=String.interpret(value);value=value.gsub(/(\r)?\n/,"\r\n");value=encodeURIComponent(value);value=value.gsub(/%20/,"+");return key+"="+value}function toQueryString(){return this.inject([],function(results,pair){var key=encodeURIComponent(pair.key),values=pair.value;if(values&&typeof values=="object"){if(Object.isArray(values)){var queryValues=[];for(var i=0,len=values.length,value;i<len;i++){value=values[i];queryValues.push(toQueryPair(key,value))}return results.concat(queryValues)}}else results.push(toQueryPair(key,values));return results}).join("&")}function inspect(){return"#<Hash:{"+this.map(function(pair){return pair.map(Object.inspect).join(": ")}).join(", ")+"}>"}function clone(){return new Hash(this)}return{initialize:initialize,_each:_each,set:set,get:get,unset:unset,toObject:toObject,toTemplateReplacements:toObject,keys:keys,values:values,index:index,merge:merge,update:update,toQueryString:toQueryString,inspect:inspect,toJSON:toObject,clone:clone}}());Hash.from=$H;Object.extend(Number.prototype,function(){function toColorPart(){return this.toPaddedString(2,16)}function succ(){return this+1}function times(iterator,context){$R(0,this,true).each(iterator,context);return this}function toPaddedString(length,radix){var string=this.toString(radix||10);return"0".times(length-string.length)+string}function abs(){return Math.abs(this)}function round(){return Math.round(this)}function ceil(){return Math.ceil(this)}function floor(){return Math.floor(this)}return{toColorPart:toColorPart,succ:succ,times:times,toPaddedString:toPaddedString,abs:abs,round:round,ceil:ceil,floor:floor}}());function $R(start,end,exclusive){return new ObjectRange(start,end,exclusive)}var ObjectRange=Class.create(Enumerable,function(){function initialize(start,end,exclusive){this.start=start;this.end=end;this.exclusive=exclusive}function _each(iterator,context){var value=this.start,i;for(i=0;this.include(value);i++){iterator.call(context,value,i);value=value.succ()}}function include(value){if(value<this.start)return false;if(this.exclusive)return value<this.end;return value<=this.end}return{initialize:initialize,_each:_each,include:include}}());var Abstract={};var Try={these:function(){var returnValue;for(var i=0,length=arguments.length;i<length;i++){var lambda=arguments[i];try{returnValue=lambda();break}catch(e){}}return returnValue}};var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||false},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(iterator,context){this.responders._each(iterator,context)},register:function(responder){if(!this.include(responder))this.responders.push(responder)},unregister:function(responder){this.responders=this.responders.without(responder)},dispatch:function(callback,request,transport,json){this.each(function(responder){if(Object.isFunction(responder[callback])){try{responder[callback].apply(responder,[request,transport,json])}catch(e){}}})}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++},onComplete:function(){Ajax.activeRequestCount--}});Ajax.Base=Class.create({initialize:function(options){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,options||{});this.options.method=this.options.method.toLowerCase();if(Object.isHash(this.options.parameters))this.options.parameters=this.options.parameters.toObject()}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,url,options){$super(options);this.transport=Ajax.getTransport();this.request(url)},request:function(url){this.url=url;this.method=this.options.method;var params=Object.isString(this.options.parameters)?this.options.parameters:Object.toQueryString(this.options.parameters);if(!["get","post"].include(this.method)){params+=(params?"&":"")+"_method="+this.method;this.method="post"}if(params&&this.method==="get"){this.url+=(this.url.include("?")?"&":"?")+params}this.parameters=params.toQueryParams();try{var response=new Ajax.Response(this);if(this.options.onCreate)this.options.onCreate(response);Ajax.Responders.dispatch("onCreate",this,response);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous)this.respondToReadyState.bind(this).defer(1);this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?this.options.postBody||params:null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType)this.onStateChange()}catch(e){this.dispatchException(e)}},onStateChange:function(){var readyState=this.transport.readyState;if(readyState>1&&!(readyState==4&&this._complete))this.respondToReadyState(this.transport.readyState)},setRequestHeaders:function(){var headers={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,Accept:"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){headers["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005)headers["Connection"]="close"}if(typeof this.options.requestHeaders=="object"){var extras=this.options.requestHeaders;if(Object.isFunction(extras.push))for(var i=0,length=extras.length;i<length;i+=2)headers[extras[i]]=extras[i+1];else $H(extras).each(function(pair){headers[pair.key]=pair.value})}for(var name in headers)if(headers[name]!=null)this.transport.setRequestHeader(name,headers[name])},success:function(){var status=this.getStatus();return!status||status>=200&&status<300||status==304},getStatus:function(){try{if(this.transport.status===1223)return 204;return this.transport.status||0}catch(e){return 0}},respondToReadyState:function(readyState){var state=Ajax.Request.Events[readyState],response=new Ajax.Response(this);if(state=="Complete"){try{this._complete=true;(this.options["on"+response.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(response,response.headerJSON)}catch(e){this.dispatchException(e)}var contentType=response.getHeader("Content-type");if(this.options.evalJS=="force"||this.options.evalJS&&this.isSameOrigin()&&contentType&&contentType.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))this.evalResponse()}try{(this.options["on"+state]||Prototype.emptyFunction)(response,response.headerJSON);Ajax.Responders.dispatch("on"+state,this,response,response.headerJSON)}catch(e){this.dispatchException(e)}if(state=="Complete"){this.transport.onreadystatechange=Prototype.emptyFunction}},isSameOrigin:function(){var m=this.url.match(/^\s*https?:\/\/[^\/]*/);return!m||m[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""})},getHeader:function(name){try{return this.transport.getResponseHeader(name)||null}catch(e){return null}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON())}catch(e){this.dispatchException(e)}},dispatchException:function(exception){(this.options.onException||Prototype.emptyFunction)(this,exception);Ajax.Responders.dispatch("onException",this,exception)}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];Ajax.Response=Class.create({initialize:function(request){this.request=request;var transport=this.transport=request.transport,readyState=this.readyState=transport.readyState;if(readyState>2&&!Prototype.Browser.IE||readyState==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(transport.responseText);this.headerJSON=this._getHeaderJSON()}if(readyState==4){var xml=transport.responseXML;this.responseXML=Object.isUndefined(xml)?null:xml;this.responseJSON=this._getResponseJSON()}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(e){return""}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders()}catch(e){return null}},getResponseHeader:function(name){return this.transport.getResponseHeader(name)},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders()},_getHeaderJSON:function(){var json=this.getHeader("X-JSON");if(!json)return null;try{json=decodeURIComponent(escape(json))}catch(e){}try{return json.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin())}catch(e){this.request.dispatchException(e)}},_getResponseJSON:function(){var options=this.request.options;if(!options.evalJSON||options.evalJSON!="force"&&!(this.getHeader("Content-type")||"").include("application/json")||this.responseText.blank())return null;try{return this.responseText.evalJSON(options.sanitizeJSON||!this.request.isSameOrigin())}catch(e){this.request.dispatchException(e)}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,container,url,options){this.container={success:container.success||container,failure:container.failure||(container.success?null:container)};options=Object.clone(options);var onComplete=options.onComplete;options.onComplete=function(response,json){this.updateContent(response.responseText);if(Object.isFunction(onComplete))onComplete(response,json)}.bind(this);$super(url,options)},updateContent:function(responseText){var receiver=this.container[this.success()?"success":"failure"],options=this.options;if(!options.evalScripts)responseText=responseText.stripScripts();if(receiver=$(receiver)){if(options.insertion){if(Object.isString(options.insertion)){var insertion={};insertion[options.insertion]=responseText;receiver.insert(insertion)}else options.insertion(receiver,responseText)}else receiver.update(responseText)}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,container,url,options){$super(options);this.onComplete=this.options.onComplete;this.frequency=this.options.frequency||2;this.decay=this.options.decay||1;this.updater={};this.container=container;this.url=url;this.start()},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent()},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments)},updateComplete:function(response){if(this.options.decay){this.decay=response.responseText==this.lastText?this.decay*this.options.decay:1;this.lastText=response.responseText}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency)},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options)}});(function(GLOBAL){var UNDEFINED;var SLICE=Array.prototype.slice;var DIV=document.createElement("div");function $(element){if(arguments.length>1){for(var i=0,elements=[],length=arguments.length;i<length;i++)elements.push($(arguments[i]));return elements}if(Object.isString(element))element=document.getElementById(element);return Element.extend(element)}GLOBAL.$=$;if(!GLOBAL.Node)GLOBAL.Node={};if(!GLOBAL.Node.ELEMENT_NODE){Object.extend(GLOBAL.Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12})}var ELEMENT_CACHE={};function shouldUseCreationCache(tagName,attributes){if(tagName==="select")return false;if("type"in attributes)return false;return true}var HAS_EXTENDED_CREATE_ELEMENT_SYNTAX=function(){try{var el=document.createElement('<input name="x">');return el.tagName.toLowerCase()==="input"&&el.name==="x"}catch(err){return false}}();var oldElement=GLOBAL.Element;function Element(tagName,attributes){attributes=attributes||{};tagName=tagName.toLowerCase();if(HAS_EXTENDED_CREATE_ELEMENT_SYNTAX&&attributes.name){tagName="<"+tagName+' name="'+attributes.name+'">';delete attributes.name;return Element.writeAttribute(document.createElement(tagName),attributes)}if(!ELEMENT_CACHE[tagName])ELEMENT_CACHE[tagName]=Element.extend(document.createElement(tagName));var node=shouldUseCreationCache(tagName,attributes)?ELEMENT_CACHE[tagName].cloneNode(false):document.createElement(tagName);return Element.writeAttribute(node,attributes)}GLOBAL.Element=Element;Object.extend(GLOBAL.Element,oldElement||{});if(oldElement)GLOBAL.Element.prototype=oldElement.prototype;Element.Methods={ByTag:{},Simulated:{}};var methods={};var INSPECT_ATTRIBUTES={id:"id",className:"class"};function inspect(element){element=$(element);var result="<"+element.tagName.toLowerCase();var attribute,value;for(var property in INSPECT_ATTRIBUTES){attribute=INSPECT_ATTRIBUTES[property];value=(element[property]||"").toString();if(value)result+=" "+attribute+"="+value.inspect(true)}return result+">"}methods.inspect=inspect;function visible(element){return $(element).getStyle("display")!=="none"}function toggle(element,bool){element=$(element);if(typeof bool!=="boolean")bool=!Element.visible(element);Element[bool?"show":"hide"](element);return element}function hide(element){element=$(element);element.style.display="none";return element}function show(element){element=$(element);element.style.display="";return element}Object.extend(methods,{visible:visible,toggle:toggle,hide:hide,show:show});function remove(element){try{Element.prototype.remove.call(element);}catch(e){element=$(element);element.parentNode.removeChild(element);}return element;}var SELECT_ELEMENT_INNERHTML_BUGGY=function(){var el=document.createElement("select"),isBuggy=true;el.innerHTML='<option value="test">test</option>';if(el.options&&el.options[0]){isBuggy=el.options[0].nodeName.toUpperCase()!=="OPTION"}el=null;return isBuggy}();var TABLE_ELEMENT_INNERHTML_BUGGY=function(){try{var el=document.createElement("table");if(el&&el.tBodies){el.innerHTML="<tbody><tr><td>test</td></tr></tbody>";var isBuggy=typeof el.tBodies[0]=="undefined";el=null;return isBuggy}}catch(e){return true}}();var LINK_ELEMENT_INNERHTML_BUGGY=function(){try{var el=document.createElement("div");el.innerHTML="<link />";var isBuggy=el.childNodes.length===0;el=null;return isBuggy}catch(e){return true}}();var ANY_INNERHTML_BUGGY=SELECT_ELEMENT_INNERHTML_BUGGY||TABLE_ELEMENT_INNERHTML_BUGGY||LINK_ELEMENT_INNERHTML_BUGGY;var SCRIPT_ELEMENT_REJECTS_TEXTNODE_APPENDING=function(){var s=document.createElement("script"),isBuggy=false;try{s.appendChild(document.createTextNode(""));isBuggy=!s.firstChild||s.firstChild&&s.firstChild.nodeType!==3}catch(e){isBuggy=true}s=null;return isBuggy}();function update(element,content){element=$(element);var descendants=element.getElementsByTagName("*"),i=descendants.length;while(i--)purgeElement(descendants[i]);if(content&&content.toElement)content=content.toElement();if(Object.isElement(content))return element.update().insert(content);content=Object.toHTML(content);var tagName=element.tagName.toUpperCase();if(tagName==="SCRIPT"&&SCRIPT_ELEMENT_REJECTS_TEXTNODE_APPENDING){element.text=content;return element}if(ANY_INNERHTML_BUGGY){if(tagName in INSERTION_TRANSLATIONS.tags){while(element.firstChild)element.removeChild(element.firstChild);var nodes=getContentFromAnonymousElement(tagName,content.stripScripts());for(var i=0,node;node=nodes[i];i++)element.appendChild(node)}else if(LINK_ELEMENT_INNERHTML_BUGGY&&Object.isString(content)&&content.indexOf("<link")>-1){while(element.firstChild)element.removeChild(element.firstChild);var nodes=getContentFromAnonymousElement(tagName,content.stripScripts(),true);for(var i=0,node;node=nodes[i];i++)element.appendChild(node)}else{element.innerHTML=content.stripScripts()}}else{element.innerHTML=content.stripScripts()}content.evalScripts.bind(content).defer();return element}function replace(element,content){element=$(element);if(content&&content.toElement){content=content.toElement()}else if(!Object.isElement(content)){content=Object.toHTML(content);var range=element.ownerDocument.createRange();range.selectNode(element);content.evalScripts.bind(content).defer();content=range.createContextualFragment(content.stripScripts())}element.parentNode.replaceChild(content,element);return element}var INSERTION_TRANSLATIONS={before:function(element,node){element.parentNode.insertBefore(node,element)},top:function(element,node){element.insertBefore(node,element.firstChild)},bottom:function(element,node){element.appendChild(node)},after:function(element,node){element.parentNode.insertBefore(node,element.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};var tags=INSERTION_TRANSLATIONS.tags;Object.extend(tags,{THEAD:tags.TBODY,TFOOT:tags.TBODY,TH:tags.TD});function replace_IE(element,content){element=$(element);if(content&&content.toElement)content=content.toElement();if(Object.isElement(content)){element.parentNode.replaceChild(content,element);return element}content=Object.toHTML(content);var parent=element.parentNode,tagName=parent.tagName.toUpperCase();if(tagName in INSERTION_TRANSLATIONS.tags){var nextSibling=Element.next(element);var fragments=getContentFromAnonymousElement(tagName,content.stripScripts());parent.removeChild(element);var iterator;if(nextSibling)iterator=function(node){parent.insertBefore(node,nextSibling)};else iterator=function(node){parent.appendChild(node)};fragments.each(iterator)}else{element.outerHTML=content.stripScripts()}content.evalScripts.bind(content).defer();return element}if("outerHTML"in document.documentElement)replace=replace_IE;function isContent(content){if(Object.isUndefined(content)||content===null)return false;if(Object.isString(content)||Object.isNumber(content))return true;if(Object.isElement(content))return true;if(content.toElement||content.toHTML)return true;return false}function insertContentAt(element,content,position){position=position.toLowerCase();var method=INSERTION_TRANSLATIONS[position];if(content&&content.toElement)content=content.toElement();if(Object.isElement(content)){method(element,content);return element}content=Object.toHTML(content);var tagName=(position==="before"||position==="after"?element.parentNode:element).tagName.toUpperCase();var childNodes=getContentFromAnonymousElement(tagName,content.stripScripts());if(position==="top"||position==="after")childNodes.reverse();for(var i=0,node;node=childNodes[i];i++)method(element,node);content.evalScripts.bind(content).defer()}function insert(element,insertions){element=$(element);if(isContent(insertions))insertions={bottom:insertions};for(var position in insertions)insertContentAt(element,insertions[position],position);return element}function wrap(element,wrapper,attributes){element=$(element);if(Object.isElement(wrapper)){$(wrapper).writeAttribute(attributes||{})}else if(Object.isString(wrapper)){wrapper=new Element(wrapper,attributes)}else{wrapper=new Element("div",wrapper)}if(element.parentNode)element.parentNode.replaceChild(wrapper,element);wrapper.appendChild(element);return wrapper}function cleanWhitespace(element){element=$(element);var node=element.firstChild;while(node){var nextNode=node.nextSibling;if(node.nodeType===Node.TEXT_NODE&&!/\S/.test(node.nodeValue))element.removeChild(node);node=nextNode}return element}function empty(element){return $(element).innerHTML.blank()}function getContentFromAnonymousElement(tagName,html,force){var t=INSERTION_TRANSLATIONS.tags[tagName],div=DIV;var workaround=!!t;if(!workaround&&force){workaround=true;t=["","",0]}if(workaround){div.innerHTML="&#160;"+t[0]+html+t[1];div.removeChild(div.firstChild);for(var i=t[2];i--;)div=div.firstChild}else{div.innerHTML=html}return $A(div.childNodes)}function clone(element,deep){if(!(element=$(element)))return;var clone=element.cloneNode(deep);if(!HAS_UNIQUE_ID_PROPERTY){clone._prototypeUID=UNDEFINED;if(deep){var descendants=Element.select(clone,"*"),i=descendants.length;while(i--)descendants[i]._prototypeUID=UNDEFINED}}return Element.extend(clone)}function purgeElement(element){var uid=getUniqueElementID(element);if(uid){Element.stopObserving(element);if(!HAS_UNIQUE_ID_PROPERTY)element._prototypeUID=UNDEFINED;delete Element.Storage[uid]}}function purgeCollection(elements){var i=elements.length;while(i--)purgeElement(elements[i])}function purgeCollection_IE(elements){var i=elements.length,element,uid;while(i--){element=elements[i];uid=getUniqueElementID(element);delete Element.Storage[uid];delete Event.cache[uid]}}if(HAS_UNIQUE_ID_PROPERTY){purgeCollection=purgeCollection_IE}function purge(element){if(!(element=$(element)))return;purgeElement(element);var descendants=element.getElementsByTagName("*"),i=descendants.length;while(i--)purgeElement(descendants[i]);return null}Object.extend(methods,{remove:remove,update:update,replace:replace,insert:insert,wrap:wrap,cleanWhitespace:cleanWhitespace,empty:empty,clone:clone,purge:purge});function recursivelyCollect(element,property,maximumLength){element=$(element);maximumLength=maximumLength||-1;var elements=[];while(element=element[property]){if(element.nodeType===Node.ELEMENT_NODE)elements.push(Element.extend(element));if(elements.length===maximumLength)break}return elements}function ancestors(element){return recursivelyCollect(element,"parentNode")}function descendants(element){return Element.select(element,"*")}function firstDescendant(element){element=$(element).firstChild;while(element&&element.nodeType!==Node.ELEMENT_NODE)element=element.nextSibling;return $(element)}function immediateDescendants(element){var results=[],child=$(element).firstChild;while(child){if(child.nodeType===Node.ELEMENT_NODE)results.push(Element.extend(child));child=child.nextSibling}return results}function previousSiblings(element){return recursivelyCollect(element,"previousSibling")}function nextSiblings(element){return recursivelyCollect(element,"nextSibling")}function siblings(element){element=$(element);var previous=previousSiblings(element),next=nextSiblings(element);return previous.reverse().concat(next)}function match(element,selector){element=$(element);if(Object.isString(selector))return Prototype.Selector.match(element,selector);return selector.match(element)}function _recursivelyFind(element,property,expression,index){element=$(element),expression=expression||0,index=index||0;if(Object.isNumber(expression)){index=expression,expression=null}while(element=element[property]){if(element.nodeType!==1)continue;if(expression&&!Prototype.Selector.match(element,expression))continue;if(--index>=0)continue;return Element.extend(element)}}function up(element,expression,index){element=$(element);if(arguments.length===1)return $(element.parentNode);return _recursivelyFind(element,"parentNode",expression,index)}function down(element,expression,index){if(arguments.length===1)return firstDescendant(element);element=$(element),expression=expression||0,index=index||0;if(Object.isNumber(expression))index=expression,expression="*";var node=Prototype.Selector.select(expression,element)[index];return Element.extend(node)}function previous(element,expression,index){return _recursivelyFind(element,"previousSibling",expression,index)}function next(element,expression,index){return _recursivelyFind(element,"nextSibling",expression,index)}function select(element){element=$(element);var expressions=SLICE.call(arguments,1).join(", ");return Prototype.Selector.select(expressions,element)}function adjacent(element){element=$(element);var expressions=SLICE.call(arguments,1).join(", ");var siblings=Element.siblings(element),results=[];for(var i=0,sibling;sibling=siblings[i];i++){if(Prototype.Selector.match(sibling,expressions))results.push(sibling)}return results}function descendantOf_DOM(element,ancestor){element=$(element),ancestor=$(ancestor);if(!element||!ancestor)return false;while(element=element.parentNode)if(element===ancestor)return true;return false}function descendantOf_contains(element,ancestor){element=$(element),ancestor=$(ancestor);if(!element||!ancestor)return false;if(!ancestor.contains)return descendantOf_DOM(element,ancestor);return ancestor.contains(element)&&ancestor!==element}function descendantOf_compareDocumentPosition(element,ancestor){element=$(element),ancestor=$(ancestor);if(!element||!ancestor)return false;return(element.compareDocumentPosition(ancestor)&8)===8}var descendantOf;if(DIV.compareDocumentPosition){descendantOf=descendantOf_compareDocumentPosition}else if(DIV.contains){descendantOf=descendantOf_contains}else{descendantOf=descendantOf_DOM}Object.extend(methods,{recursivelyCollect:recursivelyCollect,ancestors:ancestors,descendants:descendants,firstDescendant:firstDescendant,immediateDescendants:immediateDescendants,previousSiblings:previousSiblings,nextSiblings:nextSiblings,siblings:siblings,match:match,up:up,down:down,previous:previous,next:next,select:select,adjacent:adjacent,descendantOf:descendantOf,getElementsBySelector:select,childElements:immediateDescendants});var idCounter=1;function identify(element){element=$(element);var id=Element.readAttribute(element,"id");if(id)return id;do{id="anonymous_element_"+idCounter++}while($(id));Element.writeAttribute(element,"id",id);return id}function readAttribute(element,name){return $(element).getAttribute(name)}function readAttribute_IE(element,name){element=$(element);var table=ATTRIBUTE_TRANSLATIONS.read;if(table.values[name])return table.values[name](element,name);if(table.names[name])name=table.names[name];if(name.include(":")){if(!element.attributes||!element.attributes[name])return null;return element.attributes[name].value}return element.getAttribute(name)}function readAttribute_Opera(element,name){if(name==="title")return element.title;return element.getAttribute(name)}var PROBLEMATIC_ATTRIBUTE_READING=function(){DIV.setAttribute("onclick",[]);var value=DIV.getAttribute("onclick");var isFunction=Object.isArray(value);DIV.removeAttribute("onclick");return isFunction}();if(PROBLEMATIC_ATTRIBUTE_READING){readAttribute=readAttribute_IE}else if(Prototype.Browser.Opera){readAttribute=readAttribute_Opera}function writeAttribute(element,name,value){element=$(element);var attributes={},table=ATTRIBUTE_TRANSLATIONS.write;if(typeof name==="object"){attributes=name}else{attributes[name]=Object.isUndefined(value)?true:value}for(var attr in attributes){name=table.names[attr]||attr;value=attributes[attr];if(table.values[attr]){value=table.values[attr](element,value);if(Object.isUndefined(value))continue}if(value===false||value===null)element.removeAttribute(name);else if(value===true)element.setAttribute(name,name);else element.setAttribute(name,value)}return element}var PROBLEMATIC_HAS_ATTRIBUTE_WITH_CHECKBOXES=function(){if(!HAS_EXTENDED_CREATE_ELEMENT_SYNTAX){return false}var checkbox=document.createElement('<input type="checkbox">');checkbox.checked=true;var node=checkbox.getAttributeNode("checked");return!node||!node.specified}();function hasAttribute(element,attribute){attribute=ATTRIBUTE_TRANSLATIONS.has[attribute]||attribute;var node=$(element).getAttributeNode(attribute);return!!(node&&node.specified)}function hasAttribute_IE(element,attribute){if(attribute==="checked"){return element.checked}return hasAttribute(element,attribute)}GLOBAL.Element.Methods.Simulated.hasAttribute=PROBLEMATIC_HAS_ATTRIBUTE_WITH_CHECKBOXES?hasAttribute_IE:hasAttribute;function classNames(element){return new Element.ClassNames(element)}var regExpCache={};function getRegExpForClassName(className){if(regExpCache[className])return regExpCache[className];var re=new RegExp("(^|\\s+)"+className+"(\\s+|$)");regExpCache[className]=re;return re}function hasClassName(element,className){if(!(element=$(element)))return;var elementClassName=element.className;if(elementClassName.length===0)return false;if(elementClassName===className)return true;return getRegExpForClassName(className).test(elementClassName)}function addClassName(element,className){if(!(element=$(element)))return;if(!hasClassName(element,className))element.className+=(element.className?" ":"")+className;return element}function removeClassName(element,className){if(!(element=$(element)))return;element.className=element.className.replace(getRegExpForClassName(className)," ").strip();return element}function toggleClassName(element,className,bool){if(!(element=$(element)))return;if(Object.isUndefined(bool))bool=!hasClassName(element,className);var method=Element[bool?"addClassName":"removeClassName"];return method(element,className)}var ATTRIBUTE_TRANSLATIONS={};var classProp="className",forProp="for";DIV.setAttribute(classProp,"x");if(DIV.className!=="x"){DIV.setAttribute("class","x");if(DIV.className==="x")classProp="class"}var LABEL=document.createElement("label");LABEL.setAttribute(forProp,"x");if(LABEL.htmlFor!=="x"){LABEL.setAttribute("htmlFor","x");if(LABEL.htmlFor==="x")forProp="htmlFor"}LABEL=null;function _getAttr(element,attribute){return element.getAttribute(attribute)}function _getAttr2(element,attribute){return element.getAttribute(attribute,2)}function _getAttrNode(element,attribute){var node=element.getAttributeNode(attribute);return node?node.value:""}function _getFlag(element,attribute){return $(element).hasAttribute(attribute)?attribute:null}DIV.onclick=Prototype.emptyFunction;var onclickValue=DIV.getAttribute("onclick");var _getEv;if(String(onclickValue).indexOf("{")>-1){_getEv=function(element,attribute){var value=element.getAttribute(attribute);if(!value)return null;value=value.toString();value=value.split("{")[1];value=value.split("}")[0];return value.strip()}}else if(onclickValue===""){_getEv=function(element,attribute){var value=element.getAttribute(attribute);if(!value)return null;return value.strip()}}ATTRIBUTE_TRANSLATIONS.read={names:{class:classProp,className:classProp,for:forProp,htmlFor:forProp},values:{style:function(element){return element.style.cssText.toLowerCase()},title:function(element){return element.title}}};ATTRIBUTE_TRANSLATIONS.write={names:{className:"class",htmlFor:"for",cellpadding:"cellPadding",cellspacing:"cellSpacing"},values:{checked:function(element,value){value=!!value;element.checked=value;return value?"checked":null},style:function(element,value){element.style.cssText=value?value:""}}};ATTRIBUTE_TRANSLATIONS.has={names:{}};Object.extend(ATTRIBUTE_TRANSLATIONS.write.names,ATTRIBUTE_TRANSLATIONS.read.names);var CAMEL_CASED_ATTRIBUTE_NAMES=$w("colSpan rowSpan vAlign dateTime "+"accessKey tabIndex encType maxLength readOnly longDesc frameBorder");for(var i=0,attr;attr=CAMEL_CASED_ATTRIBUTE_NAMES[i];i++){ATTRIBUTE_TRANSLATIONS.write.names[attr.toLowerCase()]=attr;ATTRIBUTE_TRANSLATIONS.has.names[attr.toLowerCase()]=attr}Object.extend(ATTRIBUTE_TRANSLATIONS.read.values,{href:_getAttr2,src:_getAttr2,type:_getAttr,action:_getAttrNode,disabled:_getFlag,checked:_getFlag,readonly:_getFlag,multiple:_getFlag,onload:_getEv,onunload:_getEv,onclick:_getEv,ondblclick:_getEv,onmousedown:_getEv,onmouseup:_getEv,onmouseover:_getEv,onmousemove:_getEv,onmouseout:_getEv,onfocus:_getEv,onblur:_getEv,onkeypress:_getEv,onkeydown:_getEv,onkeyup:_getEv,onsubmit:_getEv,onreset:_getEv,onselect:_getEv,onchange:_getEv});Object.extend(methods,{identify:identify,readAttribute:readAttribute,writeAttribute:writeAttribute,classNames:classNames,hasClassName:hasClassName,addClassName:addClassName,removeClassName:removeClassName,toggleClassName:toggleClassName});function normalizeStyleName(style){if(style==="float"||style==="styleFloat")return"cssFloat";return style.camelize()}function normalizeStyleName_IE(style){if(style==="float"||style==="cssFloat")return"styleFloat";return style.camelize()}function setStyle(element,styles){element=$(element);var elementStyle=element.style,match;if(Object.isString(styles)){elementStyle.cssText+=";"+styles;if(styles.include("opacity")){var opacity=styles.match(/opacity:\s*(\d?\.?\d*)/)[1];Element.setOpacity(element,opacity)}return element}for(var property in styles){if(property==="opacity"){Element.setOpacity(element,styles[property])}else{var value=styles[property];if(property==="float"||property==="cssFloat"){property=Object.isUndefined(elementStyle.styleFloat)?"cssFloat":"styleFloat"}elementStyle[property]=value}}return element}function getStyle(element,style){element=$(element);style=normalizeStyleName(style);var value=element.style[style];if(!value||value==="auto"){var css=document.defaultView.getComputedStyle(element,null);value=css?css[style]:null}if(style==="opacity")return value?parseFloat(value):1;return value==="auto"?null:value}function getStyle_Opera(element,style){switch(style){case"height":case"width":if(!Element.visible(element))return null;var dim=parseInt(getStyle(element,style),10);if(dim!==element["offset"+style.capitalize()])return dim+"px";return Element.measure(element,style);default:return getStyle(element,style)}}function getStyle_IE(element,style){element=$(element);style=normalizeStyleName_IE(style);var value=element.style[style];if(!value&&element.currentStyle){value=element.currentStyle[style]}if(style==="opacity"){if(!STANDARD_CSS_OPACITY_SUPPORTED)return getOpacity_IE(element);else return value?parseFloat(value):1}if(value==="auto"){if((style==="width"||style==="height")&&Element.visible(element))return Element.measure(element,style)+"px";return null}return value}function stripAlphaFromFilter_IE(filter){return(filter||"").replace(/alpha\([^\)]*\)/gi,"")}function hasLayout_IE(element){if(!element.currentStyle||!element.currentStyle.hasLayout)element.style.zoom=1;return element}var STANDARD_CSS_OPACITY_SUPPORTED=function(){DIV.style.cssText="opacity:.55";return/^0.55/.test(DIV.style.opacity)}();function setOpacity(element,value){element=$(element);if(value==1||value==="")value="";else if(value<1e-5)value=0;element.style.opacity=value;return element}function setOpacity_IE(element,value){if(STANDARD_CSS_OPACITY_SUPPORTED)return setOpacity(element,value);element=hasLayout_IE($(element));var filter=Element.getStyle(element,"filter"),style=element.style;if(value==1||value===""){filter=stripAlphaFromFilter_IE(filter);if(filter)style.filter=filter;else style.removeAttribute("filter");return element}if(value<1e-5)value=0;style.filter=stripAlphaFromFilter_IE(filter)+" alpha(opacity="+value*100+")";return element}function getOpacity(element){return Element.getStyle(element,"opacity")}function getOpacity_IE(element){if(STANDARD_CSS_OPACITY_SUPPORTED)return getOpacity(element);var filter=Element.getStyle(element,"filter");if(filter.length===0)return 1;var match=(filter||"").match(/alpha\(opacity=(.*)\)/i);if(match&&match[1])return parseFloat(match[1])/100;return 1}Object.extend(methods,{setStyle:setStyle,getStyle:getStyle,setOpacity:setOpacity,getOpacity:getOpacity});if("styleFloat"in DIV.style){methods.getStyle=getStyle_IE;methods.setOpacity=setOpacity_IE;methods.getOpacity=getOpacity_IE}var UID=0;GLOBAL.Element.Storage={UID:1};function getUniqueElementID(element){if(element===window)return 0;if(typeof element._prototypeUID==="undefined")element._prototypeUID=Element.Storage.UID++;return element._prototypeUID}function getUniqueElementID_IE(element){if(element===window)return 0;if(element==document)return 1;return element.uniqueID}var HAS_UNIQUE_ID_PROPERTY="uniqueID"in DIV;if(HAS_UNIQUE_ID_PROPERTY)getUniqueElementID=getUniqueElementID_IE;function getStorage(element){if(!(element=$(element)))return;var uid=getUniqueElementID(element);if(!Element.Storage[uid])Element.Storage[uid]=$H();return Element.Storage[uid]}function store(element,key,value){if(!(element=$(element)))return;var storage=getStorage(element);if(arguments.length===2){storage.update(key)}else{storage.set(key,value)}return element}function retrieve(element,key,defaultValue){if(!(element=$(element)))return;var storage=getStorage(element),value=storage.get(key);if(Object.isUndefined(value)){storage.set(key,defaultValue);value=defaultValue}return value}Object.extend(methods,{getStorage:getStorage,store:store,retrieve:retrieve});var Methods={},ByTag=Element.Methods.ByTag,F=Prototype.BrowserFeatures;if(!F.ElementExtensions&&"__proto__"in DIV){GLOBAL.HTMLElement={};GLOBAL.HTMLElement.prototype=DIV["__proto__"];F.ElementExtensions=true}function checkElementPrototypeDeficiency(tagName){if(typeof window.Element==="undefined")return false;if(!HAS_EXTENDED_CREATE_ELEMENT_SYNTAX)return false;var proto=window.Element.prototype;if(proto){var id="_"+(Math.random()+"").slice(2),el=document.createElement(tagName);proto[id]="x";var isBuggy=el[id]!=="x";delete proto[id];el=null;return isBuggy}return false}var HTMLOBJECTELEMENT_PROTOTYPE_BUGGY=checkElementPrototypeDeficiency("object");function extendElementWith(element,methods){for(var property in methods){var value=methods[property];if(Object.isFunction(value)&&!(property in element))element[property]=value.methodize()}}var EXTENDED={};function elementIsExtended(element){var uid=getUniqueElementID(element);return uid in EXTENDED}function extend(element){if(!element||elementIsExtended(element))return element;if(element.nodeType!==Node.ELEMENT_NODE||element==window)return element;var methods=Object.clone(Methods),tagName=element.tagName.toUpperCase();if(ByTag[tagName])Object.extend(methods,ByTag[tagName]);extendElementWith(element,methods);EXTENDED[getUniqueElementID(element)]=true;return element}function extend_IE8(element){if(!element||elementIsExtended(element))return element;var t=element.tagName;if(t&&/^(?:object|applet|embed)$/i.test(t)){extendElementWith(element,Element.Methods);extendElementWith(element,Element.Methods.Simulated);extendElementWith(element,Element.Methods.ByTag[t.toUpperCase()])}return element}if(F.SpecificElementExtensions){extend=HTMLOBJECTELEMENT_PROTOTYPE_BUGGY?extend_IE8:Prototype.K}function addMethodsToTagName(tagName,methods){tagName=tagName.toUpperCase();if(!ByTag[tagName])ByTag[tagName]={};Object.extend(ByTag[tagName],methods)}function mergeMethods(destination,methods,onlyIfAbsent){if(Object.isUndefined(onlyIfAbsent))onlyIfAbsent=false;for(var property in methods){var value=methods[property];if(!Object.isFunction(value))continue;if(!onlyIfAbsent||!(property in destination))destination[property]=value.methodize()}}function findDOMClass(tagName){var klass;var trans={OPTGROUP:"OptGroup",TEXTAREA:"TextArea",P:"Paragraph",FIELDSET:"FieldSet",UL:"UList",OL:"OList",DL:"DList",DIR:"Directory",H1:"Heading",H2:"Heading",H3:"Heading",H4:"Heading",H5:"Heading",H6:"Heading",Q:"Quote",INS:"Mod",DEL:"Mod",A:"Anchor",IMG:"Image",CAPTION:"TableCaption",COL:"TableCol",COLGROUP:"TableCol",THEAD:"TableSection",TFOOT:"TableSection",TBODY:"TableSection",TR:"TableRow",TH:"TableCell",TD:"TableCell",FRAMESET:"FrameSet",IFRAME:"IFrame"};if(trans[tagName])klass="HTML"+trans[tagName]+"Element";if(window[klass])return window[klass];klass="HTML"+tagName+"Element";if(window[klass])return window[klass];klass="HTML"+tagName.capitalize()+"Element";if(window[klass])return window[klass];var element=document.createElement(tagName),proto=element["__proto__"]||element.constructor.prototype;element=null;return proto}function addMethods(methods){if(arguments.length===0)addFormMethods();if(arguments.length===2){var tagName=methods;methods=arguments[1]}if(!tagName){Object.extend(Element.Methods,methods||{})}else{if(Object.isArray(tagName)){for(var i=0,tag;tag=tagName[i];i++)addMethodsToTagName(tag,methods)}else{addMethodsToTagName(tagName,methods)}}var ELEMENT_PROTOTYPE=window.HTMLElement?HTMLElement.prototype:Element.prototype;if(F.ElementExtensions){mergeMethods(ELEMENT_PROTOTYPE,Element.Methods);mergeMethods(ELEMENT_PROTOTYPE,Element.Methods.Simulated,true)}if(F.SpecificElementExtensions){for(var tag in Element.Methods.ByTag){var klass=findDOMClass(tag);if(Object.isUndefined(klass))continue;mergeMethods(klass.prototype,ByTag[tag])}}Object.extend(Element,Element.Methods);Object.extend(Element,Element.Methods.Simulated);delete Element.ByTag;delete Element.Simulated;Element.extend.refresh();ELEMENT_CACHE={}}Object.extend(GLOBAL.Element,{extend:extend,addMethods:addMethods});if(extend===Prototype.K){GLOBAL.Element.extend.refresh=Prototype.emptyFunction}else{GLOBAL.Element.extend.refresh=function(){if(Prototype.BrowserFeatures.ElementExtensions)return;Object.extend(Methods,Element.Methods);Object.extend(Methods,Element.Methods.Simulated);EXTENDED={}}}function addFormMethods(){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods),INPUT:Object.clone(Form.Element.Methods),SELECT:Object.clone(Form.Element.Methods),TEXTAREA:Object.clone(Form.Element.Methods),BUTTON:Object.clone(Form.Element.Methods)})}Element.addMethods(methods);function destroyCache_IE(){DIV=null;ELEMENT_CACHE=null}if(window.attachEvent)window.attachEvent("onunload",destroyCache_IE)})(this);(function(){function toDecimal(pctString){var match=pctString.match(/^(\d+)%?$/i);if(!match)return null;return Number(match[1])/100}function getRawStyle(element,style){element=$(element);var value=element.style[style];if(!value||value==="auto"){var css=document.defaultView.getComputedStyle(element,null);value=css?css[style]:null}if(style==="opacity")return value?parseFloat(value):1;return value==="auto"?null:value}function getRawStyle_IE(element,style){var value=element.style[style];if(!value&&element.currentStyle){value=element.currentStyle[style]}return value}function getContentWidth(element,context){var boxWidth=element.offsetWidth;var bl=getPixelValue(element,"borderLeftWidth",context)||0;var br=getPixelValue(element,"borderRightWidth",context)||0;var pl=getPixelValue(element,"paddingLeft",context)||0;var pr=getPixelValue(element,"paddingRight",context)||0;return boxWidth-bl-br-pl-pr}if(!Object.isUndefined(document.documentElement.currentStyle)&&!Prototype.Browser.Opera){getRawStyle=getRawStyle_IE}function getPixelValue(value,property,context){var element=null;if(Object.isElement(value)){element=value;value=getRawStyle(element,property)}if(value===null||Object.isUndefined(value)){return null}if(/^(?:-)?\d+(\.\d+)?(px)?$/i.test(value)){return window.parseFloat(value)}var isPercentage=value.include("%"),isViewport=context===document.viewport;if(/\d/.test(value)&&element&&element.runtimeStyle&&!(isPercentage&&isViewport)){var style=element.style.left,rStyle=element.runtimeStyle.left;element.runtimeStyle.left=element.currentStyle.left;element.style.left=value||0;value=element.style.pixelLeft;element.style.left=style;element.runtimeStyle.left=rStyle;return value}if(element&&isPercentage){context=context||element.parentNode;var decimal=toDecimal(value),whole=null;var isHorizontal=property.include("left")||property.include("right")||property.include("width");var isVertical=property.include("top")||property.include("bottom")||property.include("height");if(context===document.viewport){if(isHorizontal){whole=document.viewport.getWidth()}else if(isVertical){whole=document.viewport.getHeight()}}else{if(isHorizontal){whole=$(context).measure("width")}else if(isVertical){whole=$(context).measure("height")}}return whole===null?0:whole*decimal}return 0}function toCSSPixels(number){if(Object.isString(number)&&number.endsWith("px"))return number;return number+"px"}function isDisplayed(element){while(element&&element.parentNode){var display=element.getStyle("display");if(display==="none"){return false}element=$(element.parentNode)}return true}var hasLayout=Prototype.K;if("currentStyle"in document.documentElement){hasLayout=function(element){if(!element.currentStyle.hasLayout){element.style.zoom=1}return element}}function cssNameFor(key){if(key.include("border"))key=key+"-width";return key.camelize()}Element.Layout=Class.create(Hash,{initialize:function($super,element,preCompute){$super();this.element=$(element);Element.Layout.PROPERTIES.each(function(property){this._set(property,null)},this);if(preCompute){this._preComputing=true;this._begin();Element.Layout.PROPERTIES.each(this._compute,this);this._end();this._preComputing=false}},_set:function(property,value){return Hash.prototype.set.call(this,property,value)},set:function(property,value){throw"Properties of Element.Layout are read-only."},get:function($super,property){var value=$super(property);return value===null?this._compute(property):value},_begin:function(){if(this._isPrepared())return;var element=this.element;if(isDisplayed(element)){this._setPrepared(true);return}var originalStyles={position:element.style.position||"",width:element.style.width||"",visibility:element.style.visibility||"",display:element.style.display||""};element.store("prototype_original_styles",originalStyles);var position=getRawStyle(element,"position"),width=element.offsetWidth;if(width===0||width===null){element.style.display="block";width=element.offsetWidth}var context=position==="fixed"?document.viewport:element.parentNode;var tempStyles={visibility:"hidden",display:"block"};if(position!=="fixed")tempStyles.position="absolute";element.setStyle(tempStyles);var positionedWidth=element.offsetWidth,newWidth;if(width&&positionedWidth===width){newWidth=getContentWidth(element,context)}else if(position==="absolute"||position==="fixed"){newWidth=getContentWidth(element,context)}else{var parent=element.parentNode,pLayout=$(parent).getLayout();newWidth=pLayout.get("width")-this.get("margin-left")-this.get("border-left")-this.get("padding-left")-this.get("padding-right")-this.get("border-right")-this.get("margin-right")}element.setStyle({width:newWidth+"px"});this._setPrepared(true)},_end:function(){var element=this.element;var originalStyles=element.retrieve("prototype_original_styles");element.store("prototype_original_styles",null);element.setStyle(originalStyles);this._setPrepared(false)},_compute:function(property){var COMPUTATIONS=Element.Layout.COMPUTATIONS;if(!(property in COMPUTATIONS)){throw"Property not found."}return this._set(property,COMPUTATIONS[property].call(this,this.element))},_isPrepared:function(){return this.element.retrieve("prototype_element_layout_prepared",false)},_setPrepared:function(bool){return this.element.store("prototype_element_layout_prepared",bool)},toObject:function(){var args=$A(arguments);var keys=args.length===0?Element.Layout.PROPERTIES:args.join(" ").split(" ");var obj={};keys.each(function(key){if(!Element.Layout.PROPERTIES.include(key))return;var value=this.get(key);if(value!=null)obj[key]=value},this);return obj},toHash:function(){var obj=this.toObject.apply(this,arguments);return new Hash(obj)},toCSS:function(){var args=$A(arguments);var keys=args.length===0?Element.Layout.PROPERTIES:args.join(" ").split(" ");var css={};keys.each(function(key){if(!Element.Layout.PROPERTIES.include(key))return;if(Element.Layout.COMPOSITE_PROPERTIES.include(key))return;var value=this.get(key);if(value!=null)css[cssNameFor(key)]=value+"px"},this);return css},inspect:function(){return"#<Element.Layout>"}});Object.extend(Element.Layout,{PROPERTIES:$w("height width top left right bottom border-left border-right border-top border-bottom padding-left padding-right padding-top padding-bottom margin-top margin-bottom margin-left margin-right padding-box-width padding-box-height border-box-width border-box-height margin-box-width margin-box-height"),COMPOSITE_PROPERTIES:$w("padding-box-width padding-box-height margin-box-width margin-box-height border-box-width border-box-height"),COMPUTATIONS:{height:function(element){if(!this._preComputing)this._begin();var bHeight=this.get("border-box-height");if(bHeight<=0){if(!this._preComputing)this._end();return 0}var bTop=this.get("border-top"),bBottom=this.get("border-bottom");var pTop=this.get("padding-top"),pBottom=this.get("padding-bottom");if(!this._preComputing)this._end();return bHeight-bTop-bBottom-pTop-pBottom},width:function(element){if(!this._preComputing)this._begin();var bWidth=this.get("border-box-width");if(bWidth<=0){if(!this._preComputing)this._end();return 0}var bLeft=this.get("border-left"),bRight=this.get("border-right");var pLeft=this.get("padding-left"),pRight=this.get("padding-right");if(!this._preComputing)this._end();return bWidth-bLeft-bRight-pLeft-pRight},"padding-box-height":function(element){var height=this.get("height"),pTop=this.get("padding-top"),pBottom=this.get("padding-bottom");return height+pTop+pBottom},"padding-box-width":function(element){var width=this.get("width"),pLeft=this.get("padding-left"),pRight=this.get("padding-right");return width+pLeft+pRight},"border-box-height":function(element){if(!this._preComputing)this._begin();var height=element.offsetHeight;if(!this._preComputing)this._end();return height},"border-box-width":function(element){if(!this._preComputing)this._begin();var width=element.offsetWidth;if(!this._preComputing)this._end();return width},"margin-box-height":function(element){var bHeight=this.get("border-box-height"),mTop=this.get("margin-top"),mBottom=this.get("margin-bottom");if(bHeight<=0)return 0;return bHeight+mTop+mBottom},"margin-box-width":function(element){var bWidth=this.get("border-box-width"),mLeft=this.get("margin-left"),mRight=this.get("margin-right");if(bWidth<=0)return 0;return bWidth+mLeft+mRight},top:function(element){var offset=element.positionedOffset();return offset.top},bottom:function(element){var offset=element.positionedOffset(),parent=element.getOffsetParent(),pHeight=parent.measure("height");var mHeight=this.get("border-box-height");return pHeight-mHeight-offset.top},left:function(element){var offset=element.positionedOffset();return offset.left},right:function(element){var offset=element.positionedOffset(),parent=element.getOffsetParent(),pWidth=parent.measure("width");var mWidth=this.get("border-box-width");return pWidth-mWidth-offset.left},"padding-top":function(element){return getPixelValue(element,"paddingTop")},"padding-bottom":function(element){return getPixelValue(element,"paddingBottom")},"padding-left":function(element){return getPixelValue(element,"paddingLeft")},"padding-right":function(element){return getPixelValue(element,"paddingRight")},"border-top":function(element){return getPixelValue(element,"borderTopWidth")},"border-bottom":function(element){return getPixelValue(element,"borderBottomWidth")},"border-left":function(element){return getPixelValue(element,"borderLeftWidth")},"border-right":function(element){return getPixelValue(element,"borderRightWidth")},"margin-top":function(element){return getPixelValue(element,"marginTop")},"margin-bottom":function(element){return getPixelValue(element,"marginBottom")},"margin-left":function(element){return getPixelValue(element,"marginLeft")},"margin-right":function(element){return getPixelValue(element,"marginRight")}}});if("getBoundingClientRect"in document.documentElement){Object.extend(Element.Layout.COMPUTATIONS,{right:function(element){var parent=hasLayout(element.getOffsetParent());var rect=element.getBoundingClientRect(),pRect=parent.getBoundingClientRect();return(pRect.right-rect.right).round()},bottom:function(element){var parent=hasLayout(element.getOffsetParent());var rect=element.getBoundingClientRect(),pRect=parent.getBoundingClientRect();return(pRect.bottom-rect.bottom).round()}})}Element.Offset=Class.create({initialize:function(left,top){this.left=left.round();this.top=top.round();this[0]=this.left;this[1]=this.top},relativeTo:function(offset){return new Element.Offset(this.left-offset.left,this.top-offset.top)},inspect:function(){return"#<Element.Offset left: #{left} top: #{top}>".interpolate(this)},toString:function(){return"[#{left}, #{top}]".interpolate(this)},toArray:function(){return[this.left,this.top]}});function getLayout(element,preCompute){return new Element.Layout(element,preCompute)}function measure(element,property){return $(element).getLayout().get(property)}function getHeight(element){return Element.getDimensions(element).height}function getWidth(element){return Element.getDimensions(element).width}function getDimensions(element){element=$(element);var display=Element.getStyle(element,"display");if(display&&display!=="none"){return{width:element.offsetWidth,height:element.offsetHeight}}var style=element.style;var originalStyles={visibility:style.visibility,position:style.position,display:style.display};var newStyles={visibility:"hidden",display:"block"};if(originalStyles.position!=="fixed")newStyles.position="absolute";Element.setStyle(element,newStyles);var dimensions={width:element.offsetWidth,height:element.offsetHeight};Element.setStyle(element,originalStyles);return dimensions}function getOffsetParent(element){element=$(element);function selfOrBody(element){return isHtml(element)?$(document.body):$(element)}if(isDocument(element)||isDetached(element)||isBody(element)||isHtml(element))return $(document.body);var isInline=Element.getStyle(element,"display")==="inline";if(!isInline&&element.offsetParent)return selfOrBody(element.offsetParent);while((element=element.parentNode)&&element!==document.body){if(Element.getStyle(element,"position")!=="static"){return selfOrBody(element)}}return $(document.body)}function cumulativeOffset(element){element=$(element);var valueT=0,valueL=0;if(element.parentNode){do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent}while(element)}return new Element.Offset(valueL,valueT)}function positionedOffset(element){element=$(element);var layout=element.getLayout();var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;element=element.offsetParent;if(element){if(isBody(element))break;var p=Element.getStyle(element,"position");if(p!=="static")break}}while(element);valueL-=layout.get("margin-left");valueT-=layout.get("margin-top");return new Element.Offset(valueL,valueT)}function cumulativeScrollOffset(element){var valueT=0,valueL=0;do{if(element===document.body){var bodyScrollNode=document.documentElement||document.body.parentNode||document.body;valueT+=!Object.isUndefined(window.pageYOffset)?window.pageYOffset:bodyScrollNode.scrollTop||0;valueL+=!Object.isUndefined(window.pageXOffset)?window.pageXOffset:bodyScrollNode.scrollLeft||0;break}else{valueT+=element.scrollTop||0;valueL+=element.scrollLeft||0;element=element.parentNode}}while(element);return new Element.Offset(valueL,valueT)}function viewportOffset(forElement){var valueT=0,valueL=0,docBody=document.body;forElement=$(forElement);var element=forElement;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==docBody&&Element.getStyle(element,"position")=="absolute")break}while(element=element.offsetParent);element=forElement;do{if(element!=docBody){valueT-=element.scrollTop||0;valueL-=element.scrollLeft||0}}while(element=element.parentNode);return new Element.Offset(valueL,valueT)}function absolutize(element){element=$(element);if(Element.getStyle(element,"position")==="absolute"){return element}var offsetParent=getOffsetParent(element);var eOffset=element.viewportOffset(),pOffset=offsetParent.viewportOffset();var offset=eOffset.relativeTo(pOffset);var layout=element.getLayout();element.store("prototype_absolutize_original_styles",{position:element.getStyle("position"),left:element.getStyle("left"),top:element.getStyle("top"),width:element.getStyle("width"),height:element.getStyle("height")});element.setStyle({position:"absolute",top:offset.top+"px",left:offset.left+"px",width:layout.get("width")+"px",height:layout.get("height")+"px"});return element}function relativize(element){element=$(element);if(Element.getStyle(element,"position")==="relative"){return element}var originalStyles=element.retrieve("prototype_absolutize_original_styles");if(originalStyles)element.setStyle(originalStyles);return element}function scrollTo(element){element=$(element);var pos=Element.cumulativeOffset(element);window.scrollTo(pos.left,pos.top);return element}function makePositioned(element){element=$(element);var position=Element.getStyle(element,"position"),styles={};if(position==="static"||!position){styles.position="relative";if(Prototype.Browser.Opera){styles.top=0;styles.left=0}Element.setStyle(element,styles);Element.store(element,"prototype_made_positioned",true)}return element}function undoPositioned(element){element=$(element);var storage=Element.getStorage(element),madePositioned=storage.get("prototype_made_positioned");if(madePositioned){storage.unset("prototype_made_positioned");Element.setStyle(element,{position:"",top:"",bottom:"",left:"",right:""})}return element}function makeClipping(element){element=$(element);var storage=Element.getStorage(element),madeClipping=storage.get("prototype_made_clipping");if(Object.isUndefined(madeClipping)){var overflow=Element.getStyle(element,"overflow");storage.set("prototype_made_clipping",overflow);if(overflow!=="hidden")element.style.overflow="hidden"}return element}function undoClipping(element){element=$(element);var storage=Element.getStorage(element),overflow=storage.get("prototype_made_clipping");if(!Object.isUndefined(overflow)){storage.unset("prototype_made_clipping");element.style.overflow=overflow||""}return element}function clonePosition(element,source,options){options=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},options||{});var docEl=document.documentElement;source=$(source);element=$(element);var p,delta,layout,styles={};if(options.setLeft||options.setTop){p=Element.viewportOffset(source);delta=[0,0];if(Element.getStyle(element,"position")==="absolute"){var parent=Element.getOffsetParent(element);if(parent!==document.body)delta=Element.viewportOffset(parent)}}function pageScrollXY(){var x=0,y=0;if(Object.isNumber(window.pageXOffset)){x=window.pageXOffset;y=window.pageYOffset}else if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){x=document.body.scrollLeft;y=document.body.scrollTop}else if(docEl&&(docEl.scrollLeft||docEl.scrollTop)){x=docEl.scrollLeft;y=docEl.scrollTop}return{x:x,y:y}}var pageXY=pageScrollXY();if(options.setWidth||options.setHeight){layout=Element.getLayout(source)}if(options.setLeft)styles.left=p[0]+pageXY.x-delta[0]+options.offsetLeft+"px";if(options.setTop)styles.top=p[1]+pageXY.y-delta[1]+options.offsetTop+"px";var currentLayout=element.getLayout();if(options.setWidth){styles.width=layout.get("width")+"px"}if(options.setHeight){styles.height=layout.get("height")+"px"}return Element.setStyle(element,styles)}if(Prototype.Browser.IE){getOffsetParent=getOffsetParent.wrap(function(proceed,element){element=$(element);if(isDocument(element)||isDetached(element)||isBody(element)||isHtml(element))return $(document.body);var position=element.getStyle("position");if(position!=="static")return proceed(element);element.setStyle({position:"relative"});var value=proceed(element);element.setStyle({position:position});return value});positionedOffset=positionedOffset.wrap(function(proceed,element){element=$(element);if(!element.parentNode)return new Element.Offset(0,0);var position=element.getStyle("position");if(position!=="static")return proceed(element);var offsetParent=element.getOffsetParent();if(offsetParent&&offsetParent.getStyle("position")==="fixed")hasLayout(offsetParent);element.setStyle({position:"relative"});var value=proceed(element);element.setStyle({position:position});return value})}else if(Prototype.Browser.Webkit){cumulativeOffset=function(element){element=$(element);var valueT=0,valueL=0;do{valueT+=element.offsetTop||0;valueL+=element.offsetLeft||0;if(element.offsetParent==document.body){if(Element.getStyle(element,"position")=="absolute")break}element=element.offsetParent}while(element);return new Element.Offset(valueL,valueT)}}Element.addMethods({getLayout:getLayout,measure:measure,getWidth:getWidth,getHeight:getHeight,getDimensions:getDimensions,getOffsetParent:getOffsetParent,cumulativeOffset:cumulativeOffset,positionedOffset:positionedOffset,cumulativeScrollOffset:cumulativeScrollOffset,viewportOffset:viewportOffset,absolutize:absolutize,relativize:relativize,scrollTo:scrollTo,makePositioned:makePositioned,undoPositioned:undoPositioned,makeClipping:makeClipping,undoClipping:undoClipping,clonePosition:clonePosition});function isBody(element){return element.nodeName.toUpperCase()==="BODY"}function isHtml(element){return element.nodeName.toUpperCase()==="HTML"}function isDocument(element){return element.nodeType===Node.DOCUMENT_NODE}function isDetached(element){return element!==document.body&&!Element.descendantOf(element,document.body)}if("getBoundingClientRect"in document.documentElement){Element.addMethods({viewportOffset:function(element){element=$(element);if(isDetached(element))return new Element.Offset(0,0);var rect=element.getBoundingClientRect(),docEl=document.documentElement;return new Element.Offset(rect.left-docEl.clientLeft,rect.top-docEl.clientTop)}})}})();(function(){var IS_OLD_OPERA=Prototype.Browser.Opera&&window.parseFloat(window.opera.version())<9.5;var ROOT=null;function getRootElement(){if(ROOT)return ROOT;ROOT=IS_OLD_OPERA?document.body:document.documentElement;return ROOT}function getDimensions(){return{width:this.getWidth(),height:this.getHeight()}}function getWidth(){return getRootElement().clientWidth}function getHeight(){return getRootElement().clientHeight}function getScrollOffsets(){var x=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;var y=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;return new Element.Offset(x,y)}document.viewport={getDimensions:getDimensions,getWidth:getWidth,getHeight:getHeight,getScrollOffsets:getScrollOffsets}})();window.$$=function(){var expression=$A(arguments).join(", ");return Prototype.Selector.select(expression,document)};Prototype.Selector=function(){function select(){throw new Error('Method "Prototype.Selector.select" must be defined.')}function match(){throw new Error('Method "Prototype.Selector.match" must be defined.')}function find(elements,expression,index){index=index||0;var match=Prototype.Selector.match,length=elements.length,matchIndex=0,i;for(i=0;i<length;i++){if(match(elements[i],expression)&&index==matchIndex++){return Element.extend(elements[i])}}}function extendElements(elements){for(var i=0,length=elements.length;i<length;i++){Element.extend(elements[i])}return elements}var K=Prototype.K;return{select:select,match:match,find:find,extendElements:Element.extend===K?K:extendElements,extendElement:Element.extend}}();Prototype._original_property=window.Sizzle;(function(){function fakeDefine(fn){Prototype._actual_sizzle=fn()}fakeDefine.amd=true;if(typeof define!=="undefined"&&define.amd){Prototype._original_define=define;Prototype._actual_sizzle=null;window.define=fakeDefine}})();(function(window){var i,support,Expr,getText,isXML,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true}return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i}}return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while(target[j++]=els[i++]){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[]}if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector)){if(m=match[1]){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if(old=context.getAttribute("id")){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]}return cache[key+" "]=value}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return false}finally{if(div.parentNode){div.parentNode.removeChild(div)}div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while(cur=cur.nextSibling){if(cur===b){return-1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[j=matchIndexes[i]]){seed[j]=!(matches[j]=seed[j])}}})})}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",function(){setDocument()},false)}else if(parent.attachEvent){parent.attachEvent("onunload",function(){setDocument()})}}support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++]){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(doc.querySelectorAll)){assert(function(div){div.innerHTML="<select t=''><option selected=''></option></select>";if(div.querySelectorAll("[t^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=")}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if(support.matchesSelector=rnative.test(matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while(b=b.parentNode){if(b===a){return true}}}return false};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&b.compareDocumentPosition(a)===compare){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1}return sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0}return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0}else if(aup===bup){return siblingCheck(a,b)}cur=a;while(cur=cur.parentNode){ap.unshift(cur)}cur=b;while(cur=cur.parentNode){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++]){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while(node=elem[i++]){ret+=getText(node)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd")}else if(match[3]){Sizzle.error(match[0])}return match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];if(matchExpr["CHILD"].test(match[0])){return null}if(match[3]&&match[4]!==undefined){match[2]=match[4]}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while(node=node[dir]){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop()){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if(elem=unmatched[i]){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return false}}return true},parent:function(elem){return!Expr.pseudos["empty"](elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in{submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters;function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return newCache[2]=oldCache[2]}else{outerCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml)){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if(elem=unmatched[i]){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if(elem=temp[i]){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if(elem=matcherOut[i]){temp.push(matcherIn[i]=elem)}}postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];for(;i<len;i++){if(matcher=Expr.relative[tokens[i].type]){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||.1,len=elems.length;if(outermost){outermostContext=context!==document&&context}for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while(matcher=elementMatchers[j++]){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique}}if(bySet){if(elem=!matcher&&elem){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++]){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector)}i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}else if(compiled){context=context.parentNode}selector=selector.slice(tokens.shift().value.length)}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type]){break}if(find=Expr.find[type]){if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}})}if(typeof define==="function"&&define.amd){define(function(){return Sizzle})}else if(typeof module!=="undefined"&&module.exports){module.exports=Sizzle}else{window.Sizzle=Sizzle}})(window);(function(){if(typeof Sizzle!=="undefined"){return}if(typeof define!=="undefined"&&define.amd){window.Sizzle=Prototype._actual_sizzle;window.define=Prototype._original_define;delete Prototype._actual_sizzle;delete Prototype._original_define}else if(typeof module!=="undefined"&&module.exports){window.Sizzle=module.exports;module.exports={}}})();(function(engine){var extendElements=Prototype.Selector.extendElements;function select(selector,scope){return extendElements(engine(selector,scope||document))}function match(element,selector){return engine.matches(selector,[element]).length==1}Prototype.Selector.engine=engine;Prototype.Selector.select=select;Prototype.Selector.match=match})(Sizzle);window.Sizzle=Prototype._original_property;delete Prototype._original_property;var Form={reset:function(form){form=$(form);form.reset();return form},serializeElements:function(elements,options){if(typeof options!="object")options={hash:!!options};else if(Object.isUndefined(options.hash))options.hash=true;var key,value,submitted=false,submit=options.submit,accumulator,initial;if(options.hash){initial={};accumulator=function(result,key,value){if(key in result){if(!Object.isArray(result[key]))result[key]=[result[key]];result[key]=result[key].concat(value)}else result[key]=value;return result}}else{initial="";accumulator=function(result,key,values){if(!Object.isArray(values)){values=[values]}if(!values.length){return result}var encodedKey=encodeURIComponent(key).gsub(/%20/,"+");return result+(result?"&":"")+values.map(function(value){value=value.gsub(/(\r)?\n/,"\r\n");value=encodeURIComponent(value);value=value.gsub(/%20/,"+");return encodedKey+"="+value}).join("&")}}return elements.inject(initial,function(result,element){if(!element.disabled&&element.name){key=element.name;value=$(element).getValue();if(value!=null&&element.type!="file"&&(element.type!="submit"||!submitted&&submit!==false&&(!submit||key==submit)&&(submitted=true))){result=accumulator(result,key,value)}}return result})}};Form.Methods={serialize:function(form,options){return Form.serializeElements(Form.getElements(form),options)},getElements:function(form){var elements=$(form).getElementsByTagName("*");var element,results=[],serializers=Form.Element.Serializers;for(var i=0;element=elements[i];i++){if(serializers[element.tagName.toLowerCase()])results.push(Element.extend(element))}return results},getInputs:function(form,typeName,name){form=$(form);var inputs=form.getElementsByTagName("input");if(!typeName&&!name)return $A(inputs).map(Element.extend);for(var i=0,matchingInputs=[],length=inputs.length;i<length;i++){var input=inputs[i];if(typeName&&input.type!=typeName||name&&input.name!=name)continue;matchingInputs.push(Element.extend(input))}return matchingInputs},disable:function(form){form=$(form);Form.getElements(form).invoke("disable");return form},enable:function(form){form=$(form);Form.getElements(form).invoke("enable");return form},findFirstElement:function(form){var elements=$(form).getElements().findAll(function(element){return"hidden"!=element.type&&!element.disabled});var firstByIndex=elements.findAll(function(element){return element.hasAttribute("tabIndex")&&element.tabIndex>=0}).sortBy(function(element){return element.tabIndex}).first();return firstByIndex?firstByIndex:elements.find(function(element){return/^(?:input|select|textarea)$/i.test(element.tagName)})},focusFirstElement:function(form){form=$(form);var element=form.findFirstElement();if(element)element.activate();return form},request:function(form,options){form=$(form),options=Object.clone(options||{});var params=options.parameters,action=form.readAttribute("action")||"";if(action.blank())action=window.location.href;options.parameters=form.serialize(true);if(params){if(Object.isString(params))params=params.toQueryParams();Object.extend(options.parameters,params)}if(form.hasAttribute("method")&&!options.method)options.method=form.method;return new Ajax.Request(action,options)}};Form.Element={focus:function(element){$(element).focus();return element},select:function(element){$(element).select();return element}};Form.Element.Methods={serialize:function(element){element=$(element);if(!element.disabled&&element.name){var value=element.getValue();if(value!=undefined){var pair={};pair[element.name]=value;return Object.toQueryString(pair)}}return""},getValue:function(element){element=$(element);var method=element.tagName.toLowerCase();return Form.Element.Serializers[method](element)},setValue:function(element,value){element=$(element);var method=element.tagName.toLowerCase();Form.Element.Serializers[method](element,value);return element},clear:function(element){$(element).value="";return element},present:function(element){return $(element).value!=""},activate:function(element){element=$(element);try{element.focus();if(element.select&&(element.tagName.toLowerCase()!="input"||!/^(?:button|reset|submit)$/i.test(element.type)))element.select()}catch(e){}return element},disable:function(element){element=$(element);element.disabled=true;return element},enable:function(element){element=$(element);element.disabled=false;return element}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers=function(){function input(element,value){switch(element.type.toLowerCase()){case"checkbox":case"radio":return inputSelector(element,value);default:return valueSelector(element,value)}}function inputSelector(element,value){if(Object.isUndefined(value))return element.checked?element.value:null;else element.checked=!!value}function valueSelector(element,value){if(Object.isUndefined(value))return element.value;else element.value=value}function select(element,value){if(Object.isUndefined(value))return(element.type==="select-one"?selectOne:selectMany)(element);var opt,currentValue,single=!Object.isArray(value);for(var i=0,length=element.length;i<length;i++){opt=element.options[i];currentValue=this.optionValue(opt);if(single){if(currentValue==value){opt.selected=true;return}}else opt.selected=value.include(currentValue)}}function selectOne(element){var index=element.selectedIndex;return index>=0?optionValue(element.options[index]):null}function selectMany(element){var values,length=element.length;if(!length)return null;for(var i=0,values=[];i<length;i++){var opt=element.options[i];if(opt.selected)values.push(optionValue(opt))}return values}function optionValue(opt){return Element.hasAttribute(opt,"value")?opt.value:opt.text}return{input:input,inputSelector:inputSelector,textarea:valueSelector,select:select,selectOne:selectOne,selectMany:selectMany,optionValue:optionValue,button:valueSelector}}();Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,element,frequency,callback){$super(callback,frequency);this.element=$(element);this.lastValue=this.getValue()},execute:function(){var value=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(value)?this.lastValue!=value:String(this.lastValue)!=String(value)){this.callback(this.element,value);this.lastValue=value}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element)}});Abstract.EventObserver=Class.create({initialize:function(element,callback){this.element=$(element);this.callback=callback;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form")this.registerFormCallbacks();else this.registerCallback(this.element)},onElementEvent:function(){var value=this.getValue();if(this.lastValue!=value){this.callback(this.element,value);this.lastValue=value}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this)},registerCallback:function(element){if(element.type){switch(element.type.toLowerCase()){case"checkbox":case"radio":Event.observe(element,"click",this.onElementEvent.bind(this));break;default:Event.observe(element,"change",this.onElementEvent.bind(this));break}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element)}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element)}});(function(GLOBAL){var DIV=document.createElement("div");var docEl=document.documentElement;var MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED="onmouseenter"in docEl&&"onmouseleave"in docEl;var Event={KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45};var isIELegacyEvent=function(event){return false};if(window.attachEvent){if(window.addEventListener){isIELegacyEvent=function(event){return!(event instanceof window.Event)}}else{isIELegacyEvent=function(event){return true}}}var _isButton;function _isButtonForDOMEvents(event,code){return event.which?event.which===code+1:event.button===code}var legacyButtonMap={0:1,1:4,2:2};function _isButtonForLegacyEvents(event,code){return event.button===legacyButtonMap[code]}function _isButtonForWebKit(event,code){switch(code){case 0:return event.which==1&&!event.metaKey;case 1:return event.which==2||event.which==1&&event.metaKey;case 2:return event.which==3;default:return false}}if(window.attachEvent){if(!window.addEventListener){_isButton=_isButtonForLegacyEvents}else{_isButton=function(event,code){return isIELegacyEvent(event)?_isButtonForLegacyEvents(event,code):_isButtonForDOMEvents(event,code)}}}else if(Prototype.Browser.WebKit){_isButton=_isButtonForWebKit}else{_isButton=_isButtonForDOMEvents}function isLeftClick(event){return _isButton(event,0)}function isMiddleClick(event){return _isButton(event,1)}function isRightClick(event){return _isButton(event,2)}function element(event){return Element.extend(_element(event))}function _element(event){event=Event.extend(event);var node=event.target,type=event.type,currentTarget=event.currentTarget;if(currentTarget&&currentTarget.tagName){if(type==="load"||type==="error"||type==="click"&&currentTarget.tagName.toLowerCase()==="input"&&currentTarget.type==="radio")node=currentTarget}return node.nodeType==Node.TEXT_NODE?node.parentNode:node}function findElement(event,expression){var element=_element(event),selector=Prototype.Selector;if(!expression)return Element.extend(element);while(element){if(Object.isElement(element)&&selector.match(element,expression))return Element.extend(element);element=element.parentNode}}function pointer(event){return{x:pointerX(event),y:pointerY(event)}}function pointerX(event){var docElement=document.documentElement,body=document.body||{scrollLeft:0};return event.pageX||event.clientX+(docElement.scrollLeft||body.scrollLeft)-(docElement.clientLeft||0)}function pointerY(event){var docElement=document.documentElement,body=document.body||{scrollTop:0};return event.pageY||event.clientY+(docElement.scrollTop||body.scrollTop)-(docElement.clientTop||0)}function stop(event){Event.extend(event);event.preventDefault();event.stopPropagation();event.stopped=true}Event.Methods={isLeftClick:isLeftClick,isMiddleClick:isMiddleClick,isRightClick:isRightClick,element:element,findElement:findElement,pointer:pointer,pointerX:pointerX,pointerY:pointerY,stop:stop};var methods=Object.keys(Event.Methods).inject({},function(m,name){m[name]=Event.Methods[name].methodize();return m});if(window.attachEvent){function _relatedTarget(event){var element;switch(event.type){case"mouseover":case"mouseenter":element=event.fromElement;break;case"mouseout":case"mouseleave":element=event.toElement;break;default:return null}return Element.extend(element)}var additionalMethods={stopPropagation:function(){this.cancelBubble=true},preventDefault:function(){this.returnValue=false},inspect:function(){return"[object Event]"}};Event.extend=function(event,element){if(!event)return false;if(!isIELegacyEvent(event))return event;if(event._extendedByPrototype)return event;event._extendedByPrototype=Prototype.emptyFunction;var pointer=Event.pointer(event);Object.extend(event,{target:event.srcElement||element,relatedTarget:_relatedTarget(event),pageX:pointer.x,pageY:pointer.y});Object.extend(event,methods);Object.extend(event,additionalMethods);return event}}else{Event.extend=Prototype.K}if(window.addEventListener){Event.prototype=window.Event.prototype||document.createEvent("HTMLEvents").__proto__;Object.extend(Event.prototype,methods)}var EVENT_TRANSLATIONS={mouseenter:"mouseover",mouseleave:"mouseout"};function getDOMEventName(eventName){return EVENT_TRANSLATIONS[eventName]||eventName}if(MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED)getDOMEventName=Prototype.K;function getUniqueElementID(element){if(element===window)return 0;if(typeof element._prototypeUID==="undefined")element._prototypeUID=Element.Storage.UID++;return element._prototypeUID}function getUniqueElementID_IE(element){if(element===window)return 0;if(element==document)return 1;return element.uniqueID}if("uniqueID"in DIV)getUniqueElementID=getUniqueElementID_IE;function isCustomEvent(eventName){return eventName.include(":")}Event._isCustomEvent=isCustomEvent;function getOrCreateRegistryFor(element,uid){var CACHE=GLOBAL.Event.cache;if(Object.isUndefined(uid))uid=getUniqueElementID(element);if(!CACHE[uid])CACHE[uid]={element:element};return CACHE[uid]}function destroyRegistryForElement(element,uid){if(Object.isUndefined(uid))uid=getUniqueElementID(element);delete GLOBAL.Event.cache[uid]}function register(element,eventName,handler){var registry=getOrCreateRegistryFor(element);if(!registry[eventName])registry[eventName]=[];var entries=registry[eventName];var i=entries.length;while(i--)if(entries[i].handler===handler)return null;var uid=getUniqueElementID(element);var responder=GLOBAL.Event._createResponder(uid,eventName,handler);var entry={responder:responder,handler:handler};entries.push(entry);return entry}function unregister(element,eventName,handler){var registry=getOrCreateRegistryFor(element);var entries=registry[eventName]||[];var i=entries.length,entry;while(i--){if(entries[i].handler===handler){entry=entries[i];break}}if(entry){var index=entries.indexOf(entry);entries.splice(index,1)}if(entries.length===0){delete registry[eventName];if(Object.keys(registry).length===1&&"element"in registry)destroyRegistryForElement(element)}return entry}function observe(element,eventName,handler){element=$(element);var entry=register(element,eventName,handler);if(entry===null)return element;var responder=entry.responder;if(isCustomEvent(eventName))observeCustomEvent(element,eventName,responder);else observeStandardEvent(element,eventName,responder);return element}function observeStandardEvent(element,eventName,responder){var actualEventName=getDOMEventName(eventName);if(element.addEventListener){element.addEventListener(actualEventName,responder,false)}else{element.attachEvent("on"+actualEventName,responder)}}function observeCustomEvent(element,eventName,responder){if(element.addEventListener){element.addEventListener("dataavailable",responder,false)}else{element.attachEvent("ondataavailable",responder);element.attachEvent("onlosecapture",responder)}}function stopObserving(element,eventName,handler){element=$(element);var handlerGiven=!Object.isUndefined(handler),eventNameGiven=!Object.isUndefined(eventName);if(!eventNameGiven&&!handlerGiven){stopObservingElement(element);return element}if(!handlerGiven){stopObservingEventName(element,eventName);return element}var entry=unregister(element,eventName,handler);if(!entry)return element;removeEvent(element,eventName,entry.responder);return element}function stopObservingStandardEvent(element,eventName,responder){var actualEventName=getDOMEventName(eventName);if(element.removeEventListener){element.removeEventListener(actualEventName,responder,false)}else{element.detachEvent("on"+actualEventName,responder)}}function stopObservingCustomEvent(element,eventName,responder){if(element.removeEventListener){element.removeEventListener("dataavailable",responder,false)}else{element.detachEvent("ondataavailable",responder);element.detachEvent("onlosecapture",responder)}}function stopObservingElement(element){var uid=getUniqueElementID(element),registry=GLOBAL.Event.cache[uid];if(!registry)return;destroyRegistryForElement(element,uid);var entries,i;for(var eventName in registry){if(eventName==="element")continue;entries=registry[eventName];i=entries.length;while(i--)removeEvent(element,eventName,entries[i].responder)}}function stopObservingEventName(element,eventName){var registry=getOrCreateRegistryFor(element);var entries=registry[eventName];if(entries){delete registry[eventName]}entries=entries||[];var i=entries.length;while(i--)removeEvent(element,eventName,entries[i].responder);for(var name in registry){if(name==="element")continue;return}destroyRegistryForElement(element)}function removeEvent(element,eventName,handler){if(isCustomEvent(eventName))stopObservingCustomEvent(element,eventName,handler);else stopObservingStandardEvent(element,eventName,handler)}function getFireTarget(element){if(element!==document)return element;if(document.createEvent&&!element.dispatchEvent)return document.documentElement;return element}function fire(element,eventName,memo,bubble){element=getFireTarget($(element));if(Object.isUndefined(bubble))bubble=true;memo=memo||{};var event=fireEvent(element,eventName,memo,bubble);return Event.extend(event)}function fireEvent_DOM(element,eventName,memo,bubble){var event=document.createEvent("HTMLEvents");event.initEvent("dataavailable",bubble,true);event.eventName=eventName;event.memo=memo;element.dispatchEvent(event);return event}function fireEvent_IE(element,eventName,memo,bubble){var event=document.createEventObject();event.eventType=bubble?"ondataavailable":"onlosecapture";event.eventName=eventName;event.memo=memo;element.fireEvent(event.eventType,event);return event}var fireEvent=document.createEvent?fireEvent_DOM:fireEvent_IE;Event.Handler=Class.create({initialize:function(element,eventName,selector,callback){this.element=$(element);this.eventName=eventName;this.selector=selector;this.callback=callback;this.handler=this.handleEvent.bind(this)},start:function(){Event.observe(this.element,this.eventName,this.handler);return this},stop:function(){Event.stopObserving(this.element,this.eventName,this.handler);return this},handleEvent:function(event){var element=Event.findElement(event,this.selector);if(element)this.callback.call(this.element,event,element)}});function on(element,eventName,selector,callback){element=$(element);if(Object.isFunction(selector)&&Object.isUndefined(callback)){callback=selector,selector=null}return new Event.Handler(element,eventName,selector,callback).start()}Object.extend(Event,Event.Methods);Object.extend(Event,{fire:fire,observe:observe,stopObserving:stopObserving,on:on});Element.addMethods({fire:fire,observe:observe,stopObserving:stopObserving,on:on});Object.extend(document,{fire:fire.methodize(),observe:observe.methodize(),stopObserving:stopObserving.methodize(),on:on.methodize(),loaded:false});if(GLOBAL.Event)Object.extend(window.Event,Event);else GLOBAL.Event=Event;GLOBAL.Event.cache={};function destroyCache_IE(){GLOBAL.Event.cache=null}if(window.attachEvent)window.attachEvent("onunload",destroyCache_IE);DIV=null;docEl=null})(this);(function(GLOBAL){var docEl=document.documentElement;var MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED="onmouseenter"in docEl&&"onmouseleave"in docEl;function isSimulatedMouseEnterLeaveEvent(eventName){return!MOUSEENTER_MOUSELEAVE_EVENTS_SUPPORTED&&(eventName==="mouseenter"||eventName==="mouseleave")}function createResponder(uid,eventName,handler){if(Event._isCustomEvent(eventName))return createResponderForCustomEvent(uid,eventName,handler);if(isSimulatedMouseEnterLeaveEvent(eventName))return createMouseEnterLeaveResponder(uid,eventName,handler);return function(event){if(!Event.cache)return;var element=Event.cache[uid].element;Event.extend(event,element);handler.call(element,event)}}function createResponderForCustomEvent(uid,eventName,handler){return function(event){var cache=Event.cache[uid];var element=cache&&cache.element;if(Object.isUndefined(event.eventName))return false;if(event.eventName!==eventName)return false;Event.extend(event,element);handler.call(element,event)}}function createMouseEnterLeaveResponder(uid,eventName,handler){return function(event){var element=Event.cache[uid].element;Event.extend(event,element);var parent=event.relatedTarget;while(parent&&parent!==element){try{parent=parent.parentNode}catch(e){parent=element}}if(parent===element)return;handler.call(element,event)}}GLOBAL.Event._createResponder=createResponder;docEl=null})(this);(function(GLOBAL){var TIMER;function fireContentLoadedEvent(){if(document.loaded)return;if(TIMER)window.clearTimeout(TIMER);document.loaded=true;document.fire("dom:loaded")}function checkReadyState(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",checkReadyState);fireContentLoadedEvent()}}function pollDoScroll(){try{document.documentElement.doScroll("left")}catch(e){TIMER=pollDoScroll.defer();return}fireContentLoadedEvent()}if(document.readyState==="complete"){fireContentLoadedEvent();return}if(document.addEventListener){document.addEventListener("DOMContentLoaded",fireContentLoadedEvent,false)}else{document.attachEvent("onreadystatechange",checkReadyState);if(window==top)TIMER=pollDoScroll.defer()}Event.observe(window,"load",fireContentLoadedEvent)})(this);Element.addMethods();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.addMethods({childOf:Element.Methods.descendantOf});var Insertion={Before:function(element,content){return Element.insert(element,{before:content})},Top:function(element,content){return Element.insert(element,{top:content})},Bottom:function(element,content){return Element.insert(element,{bottom:content})},After:function(element,content){return Element.insert(element,{after:content})}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},within:function(element,x,y){if(this.includeScrollOffsets)return this.withinIncludingScrolloffsets(element,x,y);this.xcomp=x;this.ycomp=y;this.offset=Element.cumulativeOffset(element);return y>=this.offset[1]&&y<this.offset[1]+element.offsetHeight&&x>=this.offset[0]&&x<this.offset[0]+element.offsetWidth},withinIncludingScrolloffsets:function(element,x,y){var offsetcache=Element.cumulativeScrollOffset(element);this.xcomp=x+offsetcache[0]-this.deltaX;this.ycomp=y+offsetcache[1]-this.deltaY;this.offset=Element.cumulativeOffset(element);return this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+element.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+element.offsetWidth},overlap:function(mode,element){if(!mode)return 0;if(mode=="vertical")return(this.offset[1]+element.offsetHeight-this.ycomp)/element.offsetHeight;if(mode=="horizontal")return(this.offset[0]+element.offsetWidth-this.xcomp)/element.offsetWidth},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(element){Position.prepare();return Element.absolutize(element)},relativize:function(element){Position.prepare();return Element.relativize(element)},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(source,target,options){options=options||{};return Element.clonePosition(target,source,options)}};if(!document.getElementsByClassName)document.getElementsByClassName=function(instanceMethods){function iter(name){return name.blank()?null:"[contains(concat(' ', @class, ' '), ' "+name+" ')]"}instanceMethods.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(element,className){className=className.toString().strip();var cond=/\s/.test(className)?$w(className).map(iter).join(""):iter(className);return cond?document._getElementsByXPath(".//*"+cond,element):[]}:function(element,className){className=className.toString().strip();var elements=[],classNames=/\s/.test(className)?$w(className):null;if(!classNames&&!className)return elements;var nodes=$(element).getElementsByTagName("*");className=" "+className+" ";for(var i=0,child,cn;child=nodes[i];i++){if(child.className&&(cn=" "+child.className+" ")&&(cn.include(className)||classNames&&classNames.all(function(name){return!name.toString().blank()&&cn.include(" "+name+" ")})))elements.push(Element.extend(child))}return elements};return function(className,parentElement){return $(parentElement||document.body).getElementsByClassName(className)}}(Element.Methods);Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(element){this.element=$(element)},_each:function(iterator,context){this.element.className.split(/\s+/).select(function(name){return name.length>0})._each(iterator,context)},set:function(className){this.element.className=className},add:function(classNameToAdd){if(this.include(classNameToAdd))return;this.set($A(this).concat(classNameToAdd).join(" "))},remove:function(classNameToRemove){if(!this.include(classNameToRemove))return;this.set($A(this).without(classNameToRemove).join(" "))},toString:function(){return $A(this).join(" ")}};Object.extend(Element.ClassNames.prototype,Enumerable);(function(){window.Selector=Class.create({initialize:function(expression){this.expression=expression.strip()},findElements:function(rootElement){return Prototype.Selector.select(this.expression,rootElement)},match:function(element){return Prototype.Selector.match(element,this.expression)},toString:function(){return this.expression},inspect:function(){return"#<Selector: "+this.expression+">"}});Object.extend(Selector,{matchElements:function(elements,expression){var match=Prototype.Selector.match,results=[];for(var i=0,length=elements.length;i<length;i++){var element=elements[i];if(match(element,expression)){results.push(Element.extend(element))}}return results},findElement:function(elements,expression,index){index=index||0;var matchIndex=0,element;for(var i=0,length=elements.length;i<length;i++){element=elements[i];if(Prototype.Selector.match(element,expression)&&index===matchIndex++){return Element.extend(element)}}},findChildElements:function(element,expressions){var selector=expressions.toArray().join(", ");return Prototype.Selector.select(selector,element||document)}})})();
/*! RESOURCE: /scripts/lib/glide_updates/prototype.js */
Object.extendsObject = function() {
	return Class.create.apply(null, arguments).prototype;
}
Prototype.ScriptFragmentDetailed = '<script(?:[^>]*type=\"([^>]*?)\")?(?:[^>]*src=\"([^>]*?)\")?[^>]*>([\\S\\s]*?)<\/script>';
var g_evalScriptCache = {};
Object.extend(String.prototype, (function() {
	function extractScriptsDetailed() {
		var matchAll = new RegExp(Prototype.ScriptFragmentDetailed, 'img');
		var matchOne = new RegExp(Prototype.ScriptFragmentDetailed, 'im');
		return (this.match(matchAll) || []).map(function(scriptTag) {
			var m = scriptTag.match(matchOne) || [ '', '', '', '' ];
if (m[1] == 'application/xml')
				return;
			
if (m[1] == 'text/html')
				return;
if(m[1] == 'text/ng-template')
				return;
			return {
				script: m[3],
				src: m[2]
			};
		});
	}
	function evalScripts(evalGlobal, onCompleteCallback) {
		(function _executer(scripts) {
			if (!scripts || scripts.length == 0) {
				if (typeof onCompleteCallback == "function")
					onCompleteCallback();
				return;
			}
			var script = scripts.shift();
			if (!script)
				return _executer(scripts);
			if (script.src) {
				if (!g_evalScriptCache[script.src]) {
					g_evalScriptCache[script.src] = {
						state : 'loading',
						scripts : scripts
					};
					ajaxRequest(script.src,	null, true,	function(r) {
						g_evalScriptCache[script.src].state = 'loaded';
						var toEvalScripts = g_evalScriptCache[script.src].scripts;
						if (r && r.responseText)
							evalScript(r.responseText, evalGlobal);
						return _executer(toEvalScripts);
					});
				}
				else if (g_evalScriptCache[script.src].state == 'loading') {
					g_evalScriptCache[script.src].scripts = g_evalScriptCache[script.src].scripts.concat(scripts);
					return;
				} else if (g_evalScriptCache[script.src].state == 'loaded')
					return _executer(scripts);
			} else {
				if (script.script)
					evalScript(script.script, evalGlobal);
				return _executer(scripts);
			}
		})(this.extractScriptsDetailed());
	}
	return {
		evalScripts: evalScripts,
		extractScriptsDetailed: extractScriptsDetailed
	};
})());
function evalScript(s, evalGlobal) {
	if (s.length == 0)
		return;
	if (!evalGlobal)
		return eval(s);
	if (window.execScript)
		return window.execScript(s);
	return window.eval ? window.eval(s) : eval(s);
}
if (document.getElementsByClassName && typeof Element.Methods.getElementsByClassName === "function")
	document.getElementsByClassName = function(instanceMethods) {
		function iter(name) {
			return name.blank() ? null : "[contains(concat(' ', @class, ' '), ' " + name + " ')]";
		}
		instanceMethods.getElementsByClassName = Prototype.BrowserFeatures.XPath ? function(element, className) {
			className = className.toString().strip();
var cond = /\s/.test(className) ? $w(className).map(iter).join('') : iter(className);
return cond ? document._getElementsByXPath('.//*' + cond, element) : [];
		} : function(element, className) {
			className = className.toString().strip();
var elements = [], classNames = (/\s/.test(className) ? $w(className) : null);
			if (!classNames && !className)
				return elements;
			if (Object.isString(element))
				element = document.getElementById(element);
			Element.extend(element);
			
			var nodes = element.getElementsByTagName('*');
			className = ' ' + className + ' ';
			for (var i = 0, child, cn; child = nodes[i]; i++) {
				if (child.className && (cn = ' ' + child.className + ' ')
						&& (cn.include(className) || (classNames && classNames.all(function(name) {
							return !name.toString().blank() && cn.include(' ' + name + ' ');
						}))))
					elements.push(Element.extend(child));
			}
			return elements;
		};
		return function(className, parentElement) {
			return $(parentElement || document.body).getElementsByClassName(className);
		};
	}(Element.Methods);
Object.equals = function(o1, o2) {
	var i1 = 0, i2 = 0;
    for (var p in o1) {
        if (!o1 || !o2 || typeof o1[p] !== typeof o2[p] || ((o1[p] === null) !== (o2[p] === null)))
        	return false;
        
        switch (typeof o1[p]) {
            case 'undefined':
                if (typeof o2[p] != 'undefined')
                	return false;
                break;
            case 'object':
                if (o1[p] !== null && o2[p] !== null && (o1[p].constructor.toString() !== o2[p].constructor.toString() || !Object.equals(o1[p], o2[p])))
                	return false;
                break;
            case 'function':
                if (p != 'equals' && o1[p].toString() != o2[p].toString())
                	return false;
                break;
            default:
                if (o1[p] !== o2[p])
                	return false;
        }
        i1++;
    }
    
    for (var p in o2) i2++;
    if (i1 != i2)
    	return false;
    
    return true;
}
document.viewport['getDimensions'] = function() {
	var el = window.document.compatMode === 'CSS1Compat' && (!Prototype.Browser.Opera ||
		window.parseFloat(window.opera.version()) < 9.5) ? window.document.documentElement : window.document.body;
	return { width: el.clientWidth, height: el.clientHeight };
};
;
/*! RESOURCE: /scripts/lib/glide_updates/prototype.template.js */
var Template = Class.create({
	initialize: function (template) {
		this.template = template.toString();
this.pattern = /(^|.|\r|\n)(#\{((JS|HTML):)?(.*?)\})/;
	},
	evaluate: function (object) {
		if (object && Object.isFunction(object.toTemplateReplacements))
			object = object.toTemplateReplacements();
		return this.template.gsub(this.pattern, function (match) {
			if (object === null)
				return (match[1] + '');
			var before = match[1] || '';
			if (before ==='\\')
				return match[2];
			var ctx = object, expr = match[5], escape = match[4],
pattern = /^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;
			match = pattern.exec(expr);
			if (match === null)
				return before;
			while (match != null) {
var comp = match[1].startsWith('[') ? match[2].replace(/\\\\]/g, ']') : match[1];
				ctx = ctx[comp];
				if (null === ctx || '' === match[3])
					break;
				expr = expr.substring('[' === match[3] ? match[1].length : match[0].length);
				match = pattern.exec(expr);
			}
			ctx = ctx || '';
			switch (escape || '') {
				case 'HTML':
ctx = ctx.replace(/'/g, '&#39;').replace(/"/g, '&#34;').replace(/&(?![#|l|g])/g, '&amp;').replace(/\</g, '&lt;').replace(/\>/g, '&gt;');
					break;
				case 'JS':
ctx = ctx.replace(/'/g, '&#39;').replace(/"/g, '&#34;');
					break;
			}
			return before + String.interpret(ctx);
		});
	}
});
var XMLTemplate = Class.create(Template, {
	initialize: function ($super, id) {
		var s = $(id);
$super(s && s.innerHTML ? s.innerHTML.replace(/%7B/g, '{').replace(/%7D/g, '}') : '');
	},
	toString: function () {
		'XMLTemplate';
	}
});
;
/*! RESOURCE: /scripts/lib/glide_updates/prototype.plugin.js */
var Plugin = (function() {
function create(name) {
		var args = $A(arguments);
		args.shift();
		
	    var klass = function(argumentArray) {
this.initialize.apply(this, argumentArray);
	    };
	    
    	Object.extend(klass, Class.Methods);
    	Object.extend(klass.prototype, args[0] || {});
    
        if (!klass.prototype.initialize)
            klass.prototype.initialize = Prototype.emptyFunction;
	    	
    	klass.prototype.constructor = klass;
		var methods = {};
		methods[name] = function(elem) {
			new klass(arguments); 
return elem;
		}.bind(this);
		Element.addMethods(methods);
	};
	
	return {
		create: create
	};
})();
;
/*! RESOURCE: /scripts/lib/labjs/LAB.min.js */
/*! LAB.js (LABjs :: Loading And Blocking JavaScript)
    v2.0.3 (c) Kyle Simpson
    MIT License
*/
(function(o){var K=o.$LAB,y="UseLocalXHR",z="AlwaysPreserveOrder",u="AllowDuplicates",A="CacheBust",B="BasePath",C=/^[^?#]*\//.exec(location.href)[0],D=/^\w+\:\/\/\/?[^\/]+/.exec(C)[0],i=document.head||document.getElementsByTagName("head"),L=(o.opera&&Object.prototype.toString.call(o.opera)=="[object Opera]")||("MozAppearance"in document.documentElement.style),q=document.createElement("script"),E=typeof q.preload=="boolean",r=E||(q.readyState&&q.readyState=="uninitialized"),F=!r&&q.async===true,M=!r&&!F&&!L;function G(a){return Object.prototype.toString.call(a)=="[object Function]"}function H(a){return Object.prototype.toString.call(a)=="[object Array]"}function N(a,c){var b=/^\w+\:\/\//;if(/^\/\/\/?/.test(a)){a=location.protocol+a}else if(!b.test(a)&&a.charAt(0)!="/"){a=(c||"")+a}return b.test(a)?a:((a.charAt(0)=="/"?D:C)+a)}function s(a,c){for(var b in a){if(a.hasOwnProperty(b)){c[b]=a[b]}}return c}function O(a){var c=false;for(var b=0;b<a.scripts.length;b++){if(a.scripts[b].ready&&a.scripts[b].exec_trigger){c=true;a.scripts[b].exec_trigger();a.scripts[b].exec_trigger=null}}return c}function t(a,c,b,d){a.onload=a.onreadystatechange=function(){if((a.readyState&&a.readyState!="complete"&&a.readyState!="loaded")||c[b])return;a.onload=a.onreadystatechange=null;d()}}function I(a){a.ready=a.finished=true;for(var c=0;c<a.finished_listeners.length;c++){a.finished_listeners[c]()}a.ready_listeners=[];a.finished_listeners=[]}function P(d,f,e,g,h){setTimeout(function(){var a,c=f.real_src,b;if("item"in i){if(!i[0]){setTimeout(arguments.callee,25);return}i=i[0]}a=document.createElement("script");if(f.type)a.type=f.type;if(f.charset)a.charset=f.charset;if(h){if(r){e.elem=a;if(E){a.preload=true;a.onpreload=g}else{a.onreadystatechange=function(){if(a.readyState=="loaded")g()}}a.src=c}else if(h&&c.indexOf(D)==0&&d[y]){b=new XMLHttpRequest();b.onreadystatechange=function(){if(b.readyState==4){b.onreadystatechange=function(){};e.text=b.responseText+"\n//@ sourceURL="+c;g()}};b.open("GET",c);b.send()}else{a.type="text/cache-script";t(a,e,"ready",function(){i.removeChild(a);g()});a.src=c;i.insertBefore(a,i.firstChild)}}else if(F){a.async=false;t(a,e,"finished",g);a.src=c;i.insertBefore(a,i.firstChild)}else{t(a,e,"finished",g);a.src=c;i.insertBefore(a,i.firstChild)}},0)}function J(){var l={},Q=r||M,n=[],p={},m;l[y]=true;l[z]=false;l[u]=false;l[A]=false;l[B]="";function R(a,c,b){var d;function f(){if(d!=null){d=null;I(b)}}if(p[c.src].finished)return;if(!a[u])p[c.src].finished=true;d=b.elem||document.createElement("script");if(c.type)d.type=c.type;if(c.charset)d.charset=c.charset;t(d,b,"finished",f);if(b.elem){b.elem=null}else if(b.text){d.onload=d.onreadystatechange=null;d.text=b.text}else{d.src=c.real_src}i.insertBefore(d,i.firstChild);if(b.text){f()}}function S(c,b,d,f){var e,g,h=function(){b.ready_cb(b,function(){R(c,b,e)})},j=function(){b.finished_cb(b,d)};b.src=N(b.src,c[B]);b.real_src=b.src+(c[A]?((/\?.*$/.test(b.src)?"&_":"?_")+~~(Math.random()*1E9)+"="):"");if(!p[b.src])p[b.src]={items:[],finished:false};g=p[b.src].items;if(c[u]||g.length==0){e=g[g.length]={ready:false,finished:false,ready_listeners:[h],finished_listeners:[j]};P(c,b,e,((f)?function(){e.ready=true;for(var a=0;a<e.ready_listeners.length;a++){e.ready_listeners[a]()}e.ready_listeners=[]}:function(){I(e)}),f)}else{e=g[0];if(e.finished){j()}else{e.finished_listeners.push(j)}}}function v(){var e,g=s(l,{}),h=[],j=0,w=false,k;function T(a,c){a.ready=true;a.exec_trigger=c;x()}function U(a,c){a.ready=a.finished=true;a.exec_trigger=null;for(var b=0;b<c.scripts.length;b++){if(!c.scripts[b].finished)return}c.finished=true;x()}function x(){while(j<h.length){if(G(h[j])){try{h[j++]()}catch(err){}continue}else if(!h[j].finished){if(O(h[j]))continue;break}j++}if(j==h.length){w=false;k=false}}function V(){if(!k||!k.scripts){h.push(k={scripts:[],finished:true})}}e={script:function(){for(var f=0;f<arguments.length;f++){(function(a,c){var b;if(!H(a)){c=[a]}for(var d=0;d<c.length;d++){V();a=c[d];if(G(a))a=a();if(!a)continue;if(H(a)){b=[].slice.call(a);b.unshift(d,1);[].splice.apply(c,b);d--;continue}if(typeof a=="string")a={src:a};a=s(a,{ready:false,ready_cb:T,finished:false,finished_cb:U});k.finished=false;k.scripts.push(a);S(g,a,k,(Q&&w));w=true;if(g[z])e.wait()}})(arguments[f],arguments[f])}return e},wait:function(){if(arguments.length>0){for(var a=0;a<arguments.length;a++){h.push(arguments[a])}k=h[h.length-1]}else k=false;x();return e}};return{script:e.script,wait:e.wait,setOptions:function(a){s(a,g);return e}}}m={setGlobalDefaults:function(a){s(a,l);return m},setOptions:function(){return v().setOptions.apply(null,arguments)},script:function(){return v().script.apply(null,arguments)},wait:function(){return v().wait.apply(null,arguments)},queueScript:function(){n[n.length]={type:"script",args:[].slice.call(arguments)};return m},queueWait:function(){n[n.length]={type:"wait",args:[].slice.call(arguments)};return m},runQueue:function(){var a=m,c=n.length,b=c,d;for(;--b>=0;){d=n.shift();a=a[d.type].apply(null,d.args)}return a},noConflict:function(){o.$LAB=K;return m},sandbox:function(){return J()}};return m}o.$LAB=J();(function(a,c,b){if(document.readyState==null&&document[a]){document.readyState="loading";document[a](c,b=function(){document.removeEventListener(c,b,false);document.readyState="complete"},false)}})("addEventListener","DOMContentLoaded")})(this);
/*! RESOURCE: /scripts/ScriptLoader.js */
var ScriptLoader = {
	getScripts: function(scripts, callback) {
		if (!(scripts instanceof Array))
			scripts = [ scripts ];
		for (var i = 0; i < scripts.length; i++)
			$LAB.queueScript(scripts[i]);
		$LAB.queueWait(callback);
		$LAB.runQueue();
	}
};
;
/*! RESOURCE: /scripts/consts/GlideEvent.js */
var GlideEvent = {
WINDOW_CLICKED:					'glide:window_clicked',
WINDOW_BLURRED:					'glide:window_blurred',
WINDOW_FOCUSED:					'glide:window_focused',
		
IMAGE_PICKED:					'glide:image_picked',
		
	NAV_MANAGER_LOADED:				'glide:nav_manager_loaded',
NAV_FORM_DIRTY_CANCEL_STAY:		'glide:nav_form_dirty_cancel_stay',
NAV_SYNC_LIST_WITH_FORM:		'glide:nav_sync_list_with_form',
NAV_LOAD_FORM_FROM_LIST:		'glide:nav_load_form_from_list',
	NAV_SAVE_PREFERENCES:			'glide:nav_save_preferences',
	NAV_UPDATE_EDGE_BUTTON_STATES:	'glide:nav_update_edge_button_states',
		
NAV_OPEN_URL:					'glide:nav_open_url',
	
NAV_ADD_BOOKMARK:				'glide:nav_add_bookmark',
NAV_REMOVE_BOOKMARK:			'glide:nav_remove_bookmark',
NAV_UPDATE_BOOKMARK:			'glide:nav_update_bookmark',
	NAV_DRAGGING_BOOKMARK_START:	'glide:nav_dragging_bookmark_start',
	NAV_DRAGGING_BOOKMARK_STOP:		'glide:nav_dragging_bookmark_stop',
	NAV_HIDE_ALL_TOOLTIPS:			'glide:nav_hide_all_tooltips',
NAV_QUEUE_BOOKMARK_OPEN_FLYOUT:	'glide:nav_queue_bookmark_open_flyout',
NAV_OPEN_BOOKMARK:              'glide:nav_open_bookmark',
NAV_BOOKMARK_ADDED:				'glide:nav_bookmark_added',
NAV_BOOKMARK_REMOVED:			'glide:nav_bookmark_removed',
	
	NAV_EAST_PANE_RESIZED:			'glide:nav_east_pane_resized',
	
NAV_ADD_FLYOUT:					'glide:nav_add_flyout',
NAV_REMOVE_FLYOUT:				'glide:nav_remove_flyout',
NAV_TOGGLE_FLYOUT:				'glide:nav_toggle_flyout',
NAV_HIDE_FLYOUTS:				'glide:nav_hide_flyouts',
		
NAV_PANE_CLICKED:				'glide:nav_window_clicked'
};
;
/*! RESOURCE: /scripts/functions/textutil.js */
function htmlEscape(s) {
return s.replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/</g,"&#60;").replace(/>/g,"&#62;");
}
function convertDoubleQuoteToUTF8(s) {
return s.replace(/"/g,"%22");
}
function htmlEscapeQuote(s) {
return s.replace(/'/g,"&#39;");
}
function htmlEscapeDoubleQuote(s) {
return s.replace(/"/g,"&quot;");
}
function loadXML(r) {
  var xml = r.responseXML;
  if (typeof xml != 'undefined')
    return xml;
  var dom = null;
  if (window.DOMParser) {
    try { 
dom = (new DOMParser()).parseFromString(r, 'text/xml');
    } 
    catch (e) { dom = null; }
  } else if (window.ActiveXObject) {
    try {
      dom = new ActiveXObject('Microsoft.XMLDOM');
      dom.async = false;
      if (!dom.loadXML(r))
        jslog('ERROR: ' + dom.parseError.reason + dom.parseError.srcText);
    } catch (e) { dom = null; }
  } else 
    jslog('ERROR: Cannot parse xml string - "' + r + '".');
      
   return dom;
}
window.sanitizeHtml = function sanitizeHtml(text) {
	if (!text)
		return text;
	if (typeof DOMPurify !== 'undefined')
		return DOMPurify.sanitize(text);
	else
		console.warn("Missing includes of Dompurify plugin");
		
	var uriAttrs = 'background,cite,href,longdesc,src,xlink:href';
	var htmlAttrs = 'abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,' +
			'color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,' +
			'ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,' +
			'scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,' +
			'valign,value,vspace,width';
	var svgAttrs = 'accent-height,accumulate,additive,alphabetic,arabic-form,ascent,' +
			'baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,' +
			'cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,' +
			'font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,' +
			'height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,' +
			'marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,' +
			'max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,' +
			'path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,' +
			'requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,' +
			'stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,' +
			'stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,' +
			'stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,' +
			'underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,' +
			'width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,' +
			'xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan';
	var validAttrs = ['', uriAttrs, svgAttrs.toLowerCase(), htmlAttrs, ''].join(',');
	function sanitizeNodes(nodes) {
		for (var i=0; i<nodes.length; i++) {
			sanitizeElement(nodes[i]);
		}
	}
	function sanitizeElement(elem) {
		if (!elem || elem.nodeType !== Node.ELEMENT_NODE)
			return;
		var invalidAttrs = [];
		for (var i=0; i<elem.attributes.length; i++) {
			var attr = elem.attributes[i].nodeName;
			if (validAttrs.indexOf(',' + attr.toLowerCase() + ',') < 0)
				invalidAttrs.push(attr);
		}
		for (i = 0; i < invalidAttrs.length; i++) {
			elem.removeAttribute(invalidAttrs[i]);
		}
		for (i = 0; i < elem.childNodes.length; i++) {
			sanitizeElement(elem.childNodes[i]);
		}
	}
text = text.replace(/(<script\b[^>]*>[\s\S]*?<\/script>)/gmi, "");
var xmlDoc = new DOMParser().parseFromString(text, "text/html");
	var nodes = xmlDoc.documentElement.childNodes;
	for (var i = 0; i < nodes.length; i++) {
		sanitizeElement(nodes[i]);
	}
	return xmlDoc.getElementsByTagName('body')[0].innerHTML;
}
;
/*! RESOURCE: /scripts/doctype/functions_bootstrap14.js */
var userAgentLowerCase = navigator.userAgent.toLowerCase();
var isMSIE = userAgentLowerCase.indexOf("msie") >= 0;
var ie5 = false;
var isMSIE6 = false
var isMSIE7 = false;
var isMSIE8 = false;
var isMSIE9 = userAgentLowerCase.indexOf("msie 9") >= 0;
var isMSIE10 = userAgentLowerCase.indexOf("msie 10") >= 0;
var isMSIE11 = userAgentLowerCase.indexOf("rv:11.0") > 0;
var isEdge = userAgentLowerCase.indexOf("edge") >= 0;
var isChrome = userAgentLowerCase.indexOf("chrome") >= 0;
var isFirefox = userAgentLowerCase.indexOf("firefox") >= 0;
var isSafari = !isChrome && (userAgentLowerCase.indexOf("safari") >= 0);
var isSafari5 = false;
if (isSafari) {
	try {
var reSafariVersion = new RegExp("version/([\\d\\.]{3,5}) safari/");
		var results = reSafariVersion.exec( userAgentLowerCase );
		if ( results.length > 0 ) {
		    var reMajor = new RegExp("([\\d]).");
		    var results = reMajor.exec(results[1]);
		    if ( results.length > 0 ) {
		        var mv = parseInt( results[1] );
		        isSafari5 = mv < 6;
		    }
		}
	} catch(e) { }
}
var isMacintosh = userAgentLowerCase.indexOf("macintosh") >= 0;
var isWebKit = navigator.userAgent.indexOf("WebKit") >= 0;
var isTouchDevice = navigator.userAgent.indexOf('iPhone') > -1 || navigator.userAgent.indexOf('iPad') > -1;
var GJSV = 1.0;
(function(){
	var defined = {};
	var waiting = {};
	function listen(id, then) {
		if(typeof id !== 'string')
			listenMany(id, then);
		if(defined[id]) {
			return then( defined[id] );
		}
		if(!waiting[id]) {
			waiting[id] = [];
		}
		waiting[id].push(then);
	}
	function emit(id, data) {
		defined[id] = data;
		var listeners = waiting[id];
		if(!listeners) {
			return;
		}
		for(var i = 0, l = listeners.length; i < l; i++) {
			listeners[i](data);
		}
		waiting[id] = [];
	}
	function listenMany(dependencies, then) {
		if(typeof dependencies.length === 'undefined') {
return;
		}
		var unDef = { isUndefined:true };
		var resolved = [];
		function resolve(dep, i) {
			resolved[i] = dep;
			for(var i = 0, l = resolved.length; i<l; i++) {
				if(resolved[i] === unDef)
					return;
			}
			then.apply(undefined, resolved);
		};
		dependencies.forEach(function(depId, idx) {
			resolved[idx] = unDef;
			listen(depId, function(dep) {
				resolve(dep, idx);
			});
		});
	}
	window.CachedEvent = {
		after: listen,
		emit: emit
	};
})();
var g_afterPageLoadedFunctions = [];
window.g_render_functions = window.g_render_functions || [];
window.g_load_functions = window.g_load_functions || [];
window.g_late_load_functions = window.g_late_load_functions || [];
function runBeforeRender() {
	_runInlineScripts();
	jslog("runBeforeRender");
	for (var i = 0; i != g_render_functions.length; i++) {
		var f = g_render_functions[i];
		f.call();
	}
}
function _runInlineScripts() {
var inlineScripts = $j('script[type="application/javascript-deferred"]');
	jslog("running inline scripts, count: " + inlineScripts.length);
	inlineScripts.each(function(index, item) {
		var script = $j(item).text();
		try {
			$j.globalEval(script);
		} catch (e) {
			jslog("error in script " + script);
		}
	});
}
window.g_hasRunAfterAllLoaded = false;
function runAfterAllLoaded() {
	if (g_hasRunAfterAllLoaded) {
		jslog("Redundant call to runAfterAllLoaded");
		return;
	}
	g_hasRunAfterAllLoaded = true;
	var sw = new StopWatch();
	jslog("runAfterAllLoaded, functions: " + g_load_functions.length);
	for (var i = 0; i != g_load_functions.length; i++) {
		var f = g_load_functions[i];
		var t = new Date().getTime();
		f.call();
		t = new Date().getTime() - t;
if (t > 5000)
			jslog("Time: " + t + " for: [" + i + "] " + f);
	}
	jslog("late load functions: " + g_late_load_functions.length);
	for (var i = 0; i != g_late_load_functions.length; i++) {
		var f = g_late_load_functions[i];
		f.call();
	}
	window.self.loaded = true;
	sw.jslog("runAfterAllLoaded finished");
}
function addLoadEvent(func) {
	if (window.self.loaded) {
		setTimeout(func, 0);
		return;
	}
	g_load_functions.push(func);
}
function addLateLoadEvent(func) {
	if (window.self.loaded) {
		setTimeout(func, 0);
		return;
	}
	g_late_load_functions.push(func);
}
function pageLoaded() {
	CustomEvent.observe("body_clicked", contextMenuHide);
	setMandatoryExplained.defer();
}
function addRenderEvent(func) {
	if (isRenderEventRegistered(func))
		return;
	addRenderEventToArray(func);
}
function addRenderEventToArray(func) {
	if (window.self.loaded) {
		setTimeout(func, 0);
		return;
	}
	g_render_functions.push(func);
}
function isRenderEventRegistered(func) {
	var s = func.toString();
	for(var i = 0; i < g_render_functions.length; i++)
		if (g_render_functions[i].toString() == s)
			return true;
	return false;
}
function addRenderEventLogged(func, name, funcname) {
	addRenderEventToArray(function() {
		CustomEvent.fire('glide_optics_inspect_put_cs_context', funcname, 'load');
		var sw = new StopWatch();
		var __rtmr = new Date();
		try {
			func();
		} catch(e) {
			jslog('***************************************************');
			jslog('A script has encountered an error in render events');
			jslog(e);
			jslog('Script ends. Continuing happily');
			jslog('***************************************************');
		}
		CustomEvent.fire('page_timing', { name: 'CSOL', child: { description: name.substr(7), sys_id: g_event_handler_ids[funcname], source_table: 'sys_script_client' }, startTime: __rtmr, win: window });
		sw.jslog(name);
		CustomEvent.fire('glide_optics_inspect_pop_cs_context', funcname, 'load');
	});
}
function addTopRenderEvent(func) {
	if (window.self.loaded) {
		setTimeout(func, 0);
		return;
	}
	g_render_functions.unshift(func);
}
function addAfterPageLoadedEvent(func) {
	if (window.self.loaded) {
		setTimeout(func, 0);
		return;
	}
	g_afterPageLoadedFunctions.push(func);
}
function runAfterPageLoadedEvents() {
	jslog("after page loaded starting");
	var sw = new StopWatch();
	for (var i = 0; i != g_afterPageLoadedFunctions.length; i++) {
		var f = g_afterPageLoadedFunctions[i];
		f.call();
	}
	sw.jslog("after page loaded complete, functions called: " + g_afterPageLoadedFunctions.length);
	g_afterPageLoadedFunctions = [];
}
addLateLoadEvent(function() {
	setTimeout(runAfterPageLoadedEvents, 30);
});
function addUnloadEvent(func) {
	Event.observe(window, 'unload', func, false);
}
function addTinymceLoadEvent(id, func) {
	CachedEvent.after('tinyeditor_init.'+id, func);
}
function fireTinymceLoadEvent(id, ed) {
	CachedEvent.emit('tinyeditor_init.'+id, ed);
}
function gel(id) {
	if (typeof id != 'string')
		return id;
	return document.getElementById(id);
}
function cel(name, parent) {
  var e = document.createElement(name);
  if (arguments.length > 1)
    parent.appendChild(e);
  return e;
}
function rel(id) {
	var e = gel(id);
	if (e)
		e.parentNode.removeChild(e);
}
function addChild(element) {
	getFormContentParent().appendChild(element);
}
function inner(id, data) {
	var el = gel(id);
	if (el != null)
		el.innerHTML = data;
}
function clearNodes(t) {
  if (!t)
  	return;
  while (t.hasChildNodes())
		t.removeChild(t.childNodes[0]);
}
function getTopWindow() {
	var topWindow = window.self;
	try {
		while (topWindow.GJSV && topWindow != topWindow.parent && topWindow.parent.GJSV) {
			topWindow = topWindow.parent;
		}
	} catch (e) {}
	return topWindow;
}
function inFrame() {
	return getTopWindow() != window.self;
}
function getMainWindow() {
	var topWindow = getTopWindow();
	return topWindow['gsft_main'];
}
function getMainFormWindow() {
	var topWindow = getTopWindow();
	return topWindow['gsft_main_form'];
}
function getNavWindow() {
	var topWindow = getTopWindow();
	return topWindow['gsft_nav'];
}
function isPolarisWrapper() {
	return top.NOW && top.NOW.isPolarisWrapper === "true"
}
function isPolaris() {
	return window.NOW && window.NOW.isPolarisEnabled === "true" && isPolarisWrapper();
}
function reloadWindow(win, preventStackClearance) {
	var href = win.location.href;
	var len = href.length;
	if (href.endsWith('#') && len > 2) {
		if (win.frames['iframe_live_feed']) {
			href = href.substring(0, len-2);
		} else {
			href = href.substring(0, len-1);
		}
	}
	href = addDomainParameters(href);
	if (preventStackClearance) {
		var url = new GlideURL(href);
		url.setEncode(false);
		url.deleteParam('sysparm_clear_stack');
		href = url.getURL();
	}
	
	if (typeof g_form !== 'undefined' && window.isPolaris()) {
		CustomEvent.fireTop("gsft.formSubmit", {params: {target: win.location.pathname + new URL(href).search}, route: 'classic', iframeElId: (window.frameElement && window.frameElement.id) || null, subFrame: (window.location !== window.parent.location) ? win : null});
		return;
	}
	win.location.href = href;
}
function addDomainParameters(href) {
	var url = new GlideURL(href);
	if (url.getParam('sysparm_domain') == 'picker') {
		url.deleteParam('sysparm_domain');
	} else {
		var domainElement = gel('sysparm_domain');
		if (domainElement) {
			if (domainElement.value != 'picker') {
				url.addParam('sysparm_domain', domainElement.value);
				var domainScope = gel('sysparm_domain_scope');
				if (domainScope) {
					url.addParam('sysparm_domain_scope', domainScope.value);
				}
			}
		}
	}
	url.addParam('sysparm_nostack', 'true');
	url.setEncode(false);
	return url.getURL();
}
function addOnSubmitEvent(form, func, funcname) {
  if (!form)
	  return;
  var oldonsubmit = form.onsubmit;
  if (typeof form.onsubmit != 'function')
      form.onsubmit = func;
  else {
	form.onsubmit = function() {
		var formFuncCalled = false;
		try {
			if (oldonsubmit() == false)
				return false;
			CustomEvent.fire('glide_optics_inspect_put_cs_context', funcname, 'submit');
			formFuncCalled = true;
			var returnvalue = func();
			formFuncCalled = false;
			CustomEvent.fire('glide_optics_inspect_pop_cs_context', funcname, 'submit');
			if (returnvalue == false)
				return false;
			return true;
		}
		catch (ex) {
			if (formFuncCalled)
				CustomEvent.fire('glide_optics_inspect_pop_cs_context', funcname, 'load');
			formFuncError("onSubmit", func, ex);
			return false;
		}
	}
  }
  form = null;
}
function formFuncError(type, func, ex) {
	var funcStr = func.toString();
funcStr = funcStr.replace(/onSubmit[a-fA-F0-9]{32}\(/, "onSubmit(");
	var msg;
	if (g_user.hasRole("client_script_admin"))
msg = type + " script error: " + ex.toString() + ":<br/>" + funcStr.replace(/\n/g, "<br/>").replace(/\s/g, "&nbsp;");
	else
		msg = "Submit canceled due to a script error - please contact your System Administrator";
	g_form.addErrorMessage(msg);
	CustomEvent.fire('glideform:script_error', type + " script error: " + ex.toString() + "\n" + funcStr);
}
function hide(element) {
	var e = typeof element === "string" ? gel(element) : element;
	if (!e)
		return;
	e.style.display = 'none';
	_frameChanged();
}
function show(element) {
	var e = typeof element === "string" ? gel(element) : element;
	if (!e)
		return;
	if (e.tagName == "TR")
		e.style.display = 'table-row';
	else
		e.style.display = 'block';
	_frameChanged();
}
function hideObject(o, visibilityOnly) {
	if (!o)
		return;
	o.style.visibility = "hidden";
	if (!visibilityOnly)
		o.style.display = "none";
	_frameChanged();
}
function showObject(o, visibilityOnly) {
	if (!o)
		return;
	o.style.visibility = "visible";
	if (!visibilityOnly)
		o.style.display = "block";
	_frameChanged();
}
function showObjectInline(o) {
	if (!o)
		return;
	o.style.visibility="visible";
	o.style.display = "inline";
	_frameChanged();
}
function showObjectInlineBlock(o) {
	if (!o)
		return;
	o.style.visibility="visible";
	o.style.display = "inline-block";
	_frameChanged();
}
function showObjectFlex(o) {
	if (!o)
		return;
	o.style.visibility = "visible";
	o.style.display = "flex";
	_frameChanged();
}
function focusFirstElement(form) {
	try {
		var e = findFirstEditableElement(form);
		if (e) {
  			Field.activate(e);
  			triggerEvent(e, 'focus', true);
		}
	} catch (ex) {}
}
function findFirstEditableElement(form) {
	var tags = ['input', 'select', 'textarea'];
	var elements = form.getElementsByTagName('*');
	for (var i = 0, n = elements.length; i < n; i++) {
		var element = elements[i];
		if (element.type == 'hidden')
			continue;
		var tagName = element.tagName.toLowerCase();
		if (!tags.include(tagName))
			continue;
		element = $(element);
		var formGroup = element.up('.form-group');
		if (!element.disabled &&
				(window.g_accessibility ? true : !element.getAttribute('readonly')) &&
				element.style.visibility != 'hidden' &&
				element.style.display != 'none' &&
element.offsetParent != null &&
				formGroup &&
				formGroup.style.display != 'none')
			return element;
	}
	return null;
}
function triggerEvent(element, eventType, canBubble, memo) {
	canBubble = (typeof(canBubble) == undefined) ? true : canBubble;
	if (element && element.disabled && eventType == "change" && element.onchange) {
		element.onchange.call(element);
		return;
	}
	if (element.fireEvent) {
		element.fireEvent('on' + eventType);
	}  else {
		var evt = document.createEvent('HTMLEvents');
		evt.initEvent(eventType, canBubble, true);
		evt.memo = memo;
		element.dispatchEvent(evt, true);
	}
}
var g_form_dirty_message;
function onWindowClose() {
	if (typeof g_form === 'undefined')
		return;
	if (!g_form.submitted && g_form.modified) {
		g_submitted = false;
		setTimeout(function() {
			CustomEvent.fireTop('glide:nav_form_dirty_cancel_stay', window);
		}, 750);
		return g_form_dirty_message;
	}
	g_form.submitted = false;
}
function jslog(msg, src, dateTime) {
	try {
		if (!src) {
			var path = window.self.location.pathname;
src = path.substring(path.lastIndexOf('/') + 1);
		}
		if (window.self.opener && window != window.self.opener) {
			if (window.self.opener.jslog) {
			   window.self.opener.jslog(msg, src, dateTime);
			}
		} else if (parent && parent.jslog && jslog != parent.jslog) {
			parent.jslog(msg, src, dateTime);
		} else if (parent.parent && parent.parent.jslog && jslog != parent.parent.jslog) {
			parent.parent.jslog(msg, src, dateTime);
		} else {
			if (window.console && window.console.log)
				console.log(msg);
		}
	} catch (e) {}
}
function getXMLIsland(name) {
	var xml = gel(name);
	if (xml == null)
	   return null;
xml = "<xml>" + xml.innerHTML + "</xml>";
	xml = loadXML(xml);
	return xml;
}
function lock(me, ref, edit_id, nonedit_id, current_value_id, update_id, keep_focus) {
	if (me)
		me.style.display = "none";
	var unlock = gel(ref + '_unlock');
	unlock.style.display = "";
	var edit_span = gel(edit_id);
	edit_span.style.display = "none";
	var nonedit_span = gel(nonedit_id);
	nonedit_span.style.display = "inline-block";
	var current_value = gel(current_value_id);
	var the_value = "";
	if (current_value.options) {
		for(var i=0; i<current_value.options.length ;i++) {
			if (i > 0)
				the_value += g_glide_list_separator;
			the_value += current_value.options[i].text;
			}
		}
	else
		the_value = current_value.value;
	var update_element = gel(update_id);
update_element.innerHTML = htmlEscape(the_value);
	var update_element_sr = gel(update_id+'_sr');
if(update_element_sr)
		update_element_sr.innerHTML = htmlEscape(the_value); 
	if (keep_focus)
		unlock.focus();
}
function unlock(me, ref, edit_id, nonedit_id) {
	if (me)
		me.style.display = "none";
	var unlock = gel(ref + '_lock');
	if (unlock)
		unlock.style.display = "";
	var edit_span = gel(edit_id);
	edit_span.style.display = "";
	var nonedit_span = gel(nonedit_id);
	nonedit_span.style.display = "none";
	var list_foc = window.g_accessibility ? gel("select_0" + ref) : gel("sys_display." + ref);
	if (list_foc) {
		try {
			list_foc.focus();
		} catch (e) {
		}
	}
}
function setMandatoryExplained(enforce) {
	var showexp = gel('mandatory_explained');
	if (!showexp)
	  return;
	if (enforce || foundAMandatoryField())
		showexp.style.display = "inline";
	else
		showexp.style.display = "none";
}
function foundAMandatoryField() {
	var spanTags = document.getElementsByTagName('span');
	if (!spanTags)
	  return false;
	for (var c = 0, n = spanTags.length;c != n; ++c) {
		var spanTag = spanTags[c];
		var id = spanTag.id;
		if (!id)
		  continue;
		if (id.indexOf('status.') == 0) {
			var mandatory = spanTag.getAttribute("mandatory") + "";
			if (mandatory == 'true')
				return true;
		}
	}
	return false;
}
var _frameChangedTimer = null;
function _frameChanged() {
	if (_frameChangedTimer)
		clearTimeout(_frameChangedTimer);
	_frameChangedTimer = setTimeout(function(){
		_frameChangedTimer = null;
		CustomEvent.fire('frame.resized');
		CustomEvent.fire('refresh.event');
	}, 300);
}
var _returnedValue = null;
var _returnedValueTimeout = null;
function getFormContentParent() {
	if (_returnedValue) {
		clearTimeout(_returnedValueTimeout);
		_returnedValueTimeout = setTimeout(function() {
			_returnedValue = null;
		}, 2000);
		return _returnedValue;
	}
	var glideOverlay = $(document.body).select("div.glide_overlay");
	var exposeMask = $('glide_expose_mask');
var bsModal = document.querySelector('.modal.in');
	var validFormElementCount = document.querySelectorAll('.modal.in input:not([type="hidden"])').length;
	if (glideOverlay.length > 0 && exposeMask && exposeMask.visible())
		_returnedValue = glideOverlay[0];
	
	if (bsModal && validFormElementCount > 0)
		return bsModal;
	if (typeof g_section_contents == 'undefined' || !g_section_contents)
		g_section_contents = $(document.body).select(".section_header_content_no_scroll");
	if (g_section_contents.length > 0)
		_returnedValue = g_section_contents[0];
	else
		_returnedValue = document.body;
	return _returnedValue;
}
function addClassName(element, name) {
	if (!element)
		return;
	$(element).addClassName(name);
}
function removeClassName(element, name) {
	if (!element)
		return;
	$(element).removeClassName(name);
}
function hasClassName(element, name) {
	if (!element)
		return;
	if (!element.hasClassName)
		return;
	return $(element).hasClassName(name);
}
function getIFrameDocument(iframe) {
	  return iframe.contentWindow ? iframe.contentWindow.document : (iframe.contentDocument || null);
}
function writeTitle(element, title) {
	element.title = title;
	if (element.alt)
		element.alt = title;
	if (element.getAttribute('disabled') == 'disabled')
		element.style.pointerEvents = 'auto';
}
function writeDynamicTitle(element, title) {
	element.setAttribute("data-dynamic-title", title);
}
function contextMenuHide(e) {
	if (typeof contextHide === 'undefined')
		return;
	if (!isMSIE && e) {
		if (isTouchDevice && !isTouchRightClick(e)) {
			if (e.type == 'touchend' && $(e.target).up('.context_menu'))
				return;
			contextHide();
		} else if (isLeftClick(e)) {
			contextHide();
		}
	} else
		contextHide();
}
function trim(s) {
return s.replace(/^\s+|\s+$/g,'');
}
function htmlEscape(s) {
return s.replace(/&/g, "&amp;").replace(/'/g, "&#39;").replace(/"/g,
"&quot;").replace(/</g, "&#60;").replace(/>/g, "&#62;");
}
function htmlEscapeQuote(s) {
return s.replace(/'/g, "&#39;");
}
function htmlEscapeDoubleQuote(s) {
return s.replace(/"/g, "&quot;");
}
function loadXML(r) {
	var xml = r.responseXML;
	if (typeof xml != 'undefined')
		return xml;
	var dom = null;
	try {
dom = new DOMParser().parseFromString(r, 'text/xml');
	} catch (e) {}
	return dom;
}
if (!window.GwtDateTimePicker) {
	window.GwtDateTimePicker = function(name, format, showTime) {
ScriptLoader.getScripts('scripts/classes/GwtDateTimePicker.js',function() {
			new GwtDateTimePicker(name, format, showTime);
		});
	}
}
;
/*! RESOURCE: /scripts/functions/xmlhttp.js */
var isMicrosoftXMLHTTP = false;
var XML_HTTP = "xmlhttp.do";
function AJAXEvaluateSynchronously(expression) {
	var ajax = new GlideAjax("AJAXEvaluator");
	ajax.addParam("sysparm_expression", expression);
	ajax.getXMLWait();
	return ajax.getAnswer();
}
function AJAXEvaluate(expression, callbackAndArgs) {
	var ajax = new GlideAjax("AJAXEvaluator");
	ajax.addParam("sysparm_expression", expression);
	ajax.getXML(AJAXEvaluateResponse, "", callbackAndArgs);
}
function AJAXEvaluateResponse(response, callbackAndArgs) {
  var xml = response.responseXML;
  var answer = xml.documentElement.getAttribute("answer");
  
  if (callbackAndArgs != null) { 
	  var callback = callbackAndArgs;
	  var args = new Array();
	
	  if (typeof callbackAndArgs != "function" && callbackAndArgs.length > 1) {
		callback = callbackAndArgs.splice(0, 1)[0];
		args = callbackAndArgs;
	  }
     callback.call(answer, answer, response, args);
  }
}
function AJAXFunction(func, args, callback, callbackArgs) {
	for(var i = 0; i < args.length; i++) {
		if (typeof args[i] == "function")
			continue;
args[i] = args[i].replace(/"/g, "\\\"");
	}
	var expression = func + '("' + args.join('","') + '");';
	var newArgs = new Array();
	newArgs.push(callback);
	newArgs = newArgs.concat(callbackArgs);
	AJAXEvaluate(expression, newArgs);
}
function serverRequest(url, loadedFunction, args) {
	ajaxRequest(url, null, true, loadedFunction, args);
}
function serverRequestWait(url, postString) {
	var req = ajaxRequest(url, postString, false);
    if (req.status == 200)
    	return req;
}
function serverRequestPost(url, postString, loadedFunction, args) {
	ajaxRequest(url, postString, true, loadedFunction, args);
}
function serverRequestPostJSON(url, postString, loadedFunction, args) {
	ajaxRequest(url, postString, true, loadedFunction, args, true);
}
function ajaxRequest(url, postString, async, responseFunction, responseFunctionArgs, isJSONType) {
	var req = getRequest();
	showLoading();  	
	
	if (req) {
		if (async && (responseFunction != null))
			req.onreadystatechange = function() { processReqChange(req, responseFunction, responseFunctionArgs); };
			
		req.open((postString ? "POST" : "GET"), url, async);
		
		if (typeof g_ck != 'undefined' && g_ck != "")
        	req.setRequestHeader('X-UserToken', g_ck);
		if (window.transaction_source)
			req.setRequestHeader("X-Transaction-Source", window.transaction_source);
    	
		if (postString) {
req.setRequestHeader('Content-Type', isJSONType ? 'application/json' : 'application/x-www-form-urlencoded; charset=UTF-8');
			if (isJSONType) {
			    req.responseType = "json";
			}
			req.send(postString);
		} else {
			if (isMicrosoftXMLHTTP)
				req.send();
			else
				req.send(null);
		}
	}
	
	if (!async)
		hideLoading();
	return req;
}
function getRequest() {
    var req = null;
    
    if (window.XMLHttpRequest) {
        req = new XMLHttpRequest();
    } else if (window.ActiveXObject) {
        isMicrosoftXMLHTTP = true;
        req = new ActiveXObject("Microsoft.XMLHTTP");
    }
    
	return req;
}
function processReqChange(r, docLoadedFunction, docLoadedFunctionArgs) {
    if (r.readyState == 4) {
        hideLoading();
        if (r.status == 200) {
        	lastActivity = new Date();
			docLoadedFunction(r, docLoadedFunctionArgs);
         } else {
try {
	         	window.status = "There was a problem retrieving the XML data: " + r.statusText;
			} catch (e) { }
         }
    }
}
function showLoading() {
	try {
		CustomEvent.fireAll("ajax.loading.start");
	} catch(e) {}
}
function hideLoading() {
	try {
		CustomEvent.fireAll("ajax.loading.end");
	} catch(e) {}
}
;
/*! RESOURCE: /scripts/classes/event/GwtObservable.js */
var GwtObservable = Class.create({
	initialize: function() {
		this.events = {};
	},
	on: function(name, func) {
		if (!func || typeof func != 'function')
			return;
		
this.events = this.events || {};
		if (!this.events[name])
			this.events[name] = [];
			
		this.events[name].push(func);
	},
	
	forward: function(name, element, func) {
		GwtObservable.prototype.on.call(this, name, func); 
		Event.observe(element, name, function(e) {
			this.fireEvent(e.type, this, e);
		}.bind(this));
	},
	
	un: function(name, func) {
		if (!this.events[name])
			return;
		var i = this.events[name].indexOf(func);
		if(i !== -1)
			this.events[name].splice(i, 1);
	},
	
	unAll: function(name) {
		if (this.events[name])
			delete this.events[name];
	},
	
	isFiring: function() {
		return this._isFiring;
	},
	fireEvent: function() {
		if (this.suppressEvents === true)
			return true;
		
this.events = this.events || {};
		var args = $A(arguments);
		var name = args.shift();
		var eventList = this.events[name];
		
		if (!eventList)
			return true;
		var event = eventList.slice();
		
		this._isFiring = true;
for (var i = 0, l = event.length; i < l; i++) {
			var ev = event[i];
			if (ev == null)
				continue;
				
			if (ev.apply(this, args) === false) {
				this._isFiring = false;
				return false;
			}
		}
		
		this._isFiring = false;
		return true;
	},
	toString: function() { return 'GwtObservable'; }
});
;
/*! RESOURCE: /scripts/doctype/CustomEventManager.js */
var NOW = NOW || {};
var CustomEventManager = (function (existingCustomEvent) {
	"use strict";
	var events = (existingCustomEvent && existingCustomEvent.events) || {};
	var isFiringFlag = false;
	var trace = false;
	var suppressEvents = false;
	var NOW_MSG = 'NOW.PostMessage';
	var g_concourse_onmessage_enforce_same_origin = 'true'.toLowerCase() === 'true';
	var g_concourse_onmessage_enforce_same_origin_whitelist = '';
	function observe(eventName, fn){
		if (trace)
			jslog("$CustomEventManager observing: " + eventName);
		on(eventName, fn);
	}
	function on(name, func) {
		if (!func || typeof func !== 'function')
			return;
		if (typeof name === 'undefined')
			return;
		if (!events[name])
			events[name] = [];
		events[name].push(func);
	}
	function un(name, func) {
		if (!events[name])
			return;
		var idx = -1;
		for (var i = 0; i < events[name].length; i++) {
			if (events[name][i] === func) {
				idx = i;
				break;
			}
		}
		if (idx >= 0)
			events[name].splice(idx, 1)
	}
	function unAll(name) {
		if (events[name])
			delete events[name];
	}
	function fire(eventName, args){
		if (trace)
			jslog("$CustomEventManager firing: " + eventName + " args: " + arguments.length);
		return fireEvent.apply(null, arguments);
	}
	function fireUp(eventName, args){
		var win = window;
		while (win){
			try {
				if (win.CustomEvent.fireEvent.apply(null, arguments) === false)
					return;
				win = win.parent === win ? null : win.parent;
			}catch(e){
				return;
			}
		}
	}
	function fireEvent() {
		if (suppressEvents)
			return true;
		var args = Array.prototype.slice.apply(arguments);
		var name = args.shift();
		var eventList = events[name];
		if (!eventList)
			return true;
		var event = eventList.slice();
		isFiringFlag = true;
for (var i = 0, l = event.length; i < l; i++) {
			var ev = event[i];
			if (!ev)
				continue;
			if (ev.apply(null, args) === false) {
				isFiringFlag = false;
				return false;
			}
		}
		isFiringFlag = false;
		return true;
	}
	function isFiring() {
		return isFiringFlag;
	}
	function forward(name, element, func) {
		on(name, func);
		element.addEventListener(name, function(e) {
			fireEvent(e.type, this, e);
		}.bind(api));
	}
	function isOriginInWhiteList(origin, whitelistStr) {
		if (!whitelistStr) {
			return false;
		}
var delimiterRegex = /[\n, ]/;
		var whitelist = whitelistStr.split(delimiterRegex)
			.filter(function(whiteListedOrigin) {
				return whiteListedOrigin;
			})
			.map(function(whiteListedOrigin) {
				return whiteListedOrigin.toLowerCase();
			});
		if (~whitelist.indexOf(origin.toLowerCase())) {
			return true;
		}
		return false;
	}
	function shouldProcessMessage(sourceOrigin) {
		if (!g_concourse_onmessage_enforce_same_origin || sourceOrigin === window.location.origin) {
			return true;
		}
		return isOriginInWhiteList(sourceOrigin, g_concourse_onmessage_enforce_same_origin_whitelist);
	}
    function registerPostMessageEvent() {
        if (NOW.registeredPostMessageEvent) {
            return;
        }
        if (!window.postMessage) {
            return;
        }
        window.addEventListener('message', function (event) {
            if (!shouldProcessMessage(event.origin)) {
                console.warn('Incoming message ignored due to origin mismatch.');
                return;
            }
            var nowMessageJSON = event.data;
            var nowMessage;
            try {
                nowMessage = JSON.parse(nowMessageJSON.toString());
            } catch (e) {
                return;
            }
            if (!nowMessage.type == NOW_MSG) {
                return;
            }
            fire(nowMessage.eventName, nowMessage.args);
        }, false);
        NOW.registeredPostMessageEvent = true;
    }
	function doPostMessage(win, event, msg, targetOrigin) {
		var nowMessage = {type: NOW_MSG, eventName: event, args: msg};
		var nowMessageJSON;
		if (!win || !win.postMessage) {
			return
		}
		nowMessageJSON = JSON.stringify(nowMessage);
		win.postMessage(nowMessageJSON, targetOrigin);
	}
	function fireTop(eventName, args){
		if (trace)
			jslog("$CustomEventManager firing: " + eventName + " args: " + arguments.length);
		fireEvent.apply(null, arguments);
		var t = getTopWindow();
		if (t !== null && window !== t)
			t.CustomEvent.fire(eventName, args);
	}
	function fireAll(eventName, args) {
		if (trace)
			jslog("$CustomEventManager firing: " + eventName + " args: " + arguments.length);
		var topWindow = getTopWindow();
		if (topWindow !== window.self)
			CustomEvent.fireEvent(eventName, args);
		notifyAllFrom(topWindow);
		function notifyAllFrom(rootFrame) {
			var childFrame;
			rootFrame.CustomEvent.fireEvent(eventName, args);
			for (var i = 0; i < rootFrame.frames.length; i++) {
				try {
					childFrame = rootFrame.frames[i];
					if (!childFrame)
						continue;
					if (childFrame.CustomEvent && typeof childFrame.CustomEvent.fireEvent === "function") {
						notifyAllFrom(childFrame);
					}
				} catch(e) {
				}
			}
		}
	}
	function fireToWindow(targetWindow, eventName, args, usePostMessage, targetOrigin) {
		if (trace)
			jslog("$CustomEventManager firing: " + eventName + " args: " + args.length);
		if (usePostMessage) {
			doPostMessage(targetWindow, eventName, args, targetOrigin);
		} else {
			targetWindow.CustomEvent.fireEvent(eventName, args);
		}
	}
	function getTopWindow() {
		var topWindow = window.self;
		try {
			while (topWindow.CustomEvent.fireEvent && topWindow !== topWindow.parent && topWindow.parent.CustomEvent.fireEvent) {
				topWindow = topWindow.parent;
			}
		} catch (e) {}
		return topWindow;
	}
	function isTopWindow() {
		return getTopWindow() == window.self;
	}
	function jslog(msg, src, dateTime) {
		try {
			if (!src) {
				var path = window.self.location.pathname;
src = path.substring(path.lastIndexOf('/') + 1);
			}
			if (window.self.opener && window != window.self.opener) {
				if (window.self.opener.jslog) {
					window.self.opener.jslog(msg, src, dateTime);
				}
			} else if (parent && parent.jslog && jslog != parent.jslog) {
				parent.jslog(msg, src, dateTime);
			} else {
				if (window.console && window.console.log)
					console.log(msg);
			}
		} catch (e) {
		}
	}
	var api =  {
		set trace(value) {
			trace = !!value;
		},
		get trace() {
			return trace;
		},
		set suppressEvents(value) {
			suppressEvents = !!value;
		},
		get suppressEvents() {
			return suppressEvents;
		},
		get events() {
			return events;
		},
		set events(value) {
			events = value;
		},
		on: on,
		un: un,
		unAll: unAll,
		forward: forward,
		isFiring: isFiring,
		fireEvent: fireEvent,
		observe: observe,
		fire: fire,
		fireTop: fireTop,
		fireAll: fireAll,
		fireToWindow: fireToWindow,
		isTopWindow: isTopWindow,
		fireUp: fireUp,
		toString: function() { return 'CustomEventManager'; }
	};
	registerPostMessageEvent();
	return api;
})(NOW.CustomEvent);
NOW.CustomEvent = CustomEventManager;
if (typeof CustomEvent !== "undefined") {
	CustomEvent.observe = NOW.CustomEvent.observe.bind(NOW.CustomEvent);
	CustomEvent.fire = NOW.CustomEvent.fire.bind(NOW.CustomEvent);
	CustomEvent.fireUp = NOW.CustomEvent.fireUp.bind(NOW.CustomEvent);
	CustomEvent.fireTop = NOW.CustomEvent.fireTop.bind(NOW.CustomEvent);
	CustomEvent.fireAll = NOW.CustomEvent.fireAll.bind(NOW.CustomEvent);
	CustomEvent.fireToWindow = NOW.CustomEvent.fireToWindow.bind(NOW.CustomEvent);
	CustomEvent.on = NOW.CustomEvent.on.bind(NOW.CustomEvent);
	CustomEvent.un = NOW.CustomEvent.un.bind(NOW.CustomEvent);
	CustomEvent.unAll = NOW.CustomEvent.unAll.bind(NOW.CustomEvent);
	CustomEvent.forward = NOW.CustomEvent.forward.bind(NOW.CustomEvent);
	CustomEvent.isFiring = NOW.CustomEvent.isFiring.bind(NOW.CustomEvent);
	CustomEvent.fireEvent = NOW.CustomEvent.fireEvent.bind(NOW.CustomEvent);
	CustomEvent.events = NOW.CustomEvent.events;
	CustomEvent.isTopWindow = NOW.CustomEvent.isTopWindow.bind(NOW.CustomEvent);
} else {
	window.CustomEvent = NOW.CustomEvent;
}
;
/*! RESOURCE: /scripts/lib/jquery/jquery_clean.js */
(function() {
	if (!window.jQuery)
		return;
	if (!window.$j_glide)
		window.$j = jQuery.noConflict();
	if (window.$j_glide && jQuery != window.$j_glide) {
		if (window.$j_glide)
		jQuery.noConflict(true);
		window.$j = window.$j_glide;
	}
})();
;
/*! RESOURCE: /scripts/lib/jquery/jquery-2.2.3.min.js */
/*! jQuery v2.2.3-snc2 | (c) jQuery Foundation | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=a.document,e=c.slice,f=c.concat,g=c.push,h=c.indexOf,i={},j=i.toString,k=i.hasOwnProperty,l={},m="2.2.3-snc2",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return e.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:e.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a){return n.each(this,a)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(e.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(c>=0&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:g,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],"__proto__"!==b&&g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=a&&a.toString();return!n.isArray(a)&&b-parseFloat(b)+1>=0},isPlainObject:function(a){var b;if("object"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;if(a.constructor&&!k.call(a,"constructor")&&!k.call(a.constructor.prototype||{},"isPrototypeOf"))return!1;for(b in a);return void 0===b||k.call(a,b)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?i[j.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;(a=n.trim(a))&&(1===a.indexOf("use strict")?(b=d.createElement("script"),b.text=a,d.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var c,d=0;if(s(a)){for(c=a.length;d<c;d++)if(!1===b.call(a[d],d,a[d]))break}else for(d in a)if(!1===b.call(a[d],d,a[d]))break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):g.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:h.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;f<g;f++)(d=!b(a[f],f))!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,e,g=0,h=[];if(s(a))for(d=a.length;g<d;g++)null!=(e=b(a[g],g,c))&&h.push(e);else for(g in a)null!=(e=b(a[g],g,c))&&h.push(e);return f.apply([],h)},guid:1,proxy:function(a,b){var c,d,f;if("string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a))return d=e.call(arguments,2),f=function(){return a.apply(b||this,d.concat(e.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f},now:Date.now,support:l}),"function"==typeof Symbol&&(n.fn[Symbol.iterator]=c[Symbol.iterator]),n.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){i["[object "+b+"]"]=b.toLowerCase()});function s(a){var b=!!a&&"length"in a&&a.length,c=n.type(a);return"function"!==c&&!n.isWindow(a)&&("array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a)}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=fa(),z=fa(),A=fa(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+M+"))|)"+L+"*\\]",O=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+N+")*)|.*)\\)|)",P=new RegExp(L+"+","g"),Q=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),R=new RegExp("^"+L+"*,"+L+"*"),S=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),T=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),U=new RegExp(O),V=new RegExp("^"+M+"$"),W={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M+"|[*])"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,$=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_=/[+~]/,aa=/'|\\/g,ba=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),ca=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:d<0?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},da=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(xa){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ea(a,b,d,e){var f,h,j,k,l,o,r,s,w=b&&b.ownerDocument,x=b?b.nodeType:9;if(d=d||[],"string"!=typeof a||!a||1!==x&&9!==x&&11!==x)return d;if(!e&&((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,p)){if(11!==x&&(o=$.exec(a)))if(f=o[1]){if(9===x){if(!(j=b.getElementById(f)))return d;if(j.id===f)return d.push(j),d}else if(w&&(j=w.getElementById(f))&&t(b,j)&&j.id===f)return d.push(j),d}else{if(o[2])return H.apply(d,b.getElementsByTagName(a)),d;if((f=o[3])&&c.getElementsByClassName&&b.getElementsByClassName)return H.apply(d,b.getElementsByClassName(f)),d}if(c.qsa&&!A[a+" "]&&(!q||!q.test(a))){if(1!==x)w=b,s=a;else if("object"!==b.nodeName.toLowerCase()){(k=b.getAttribute("id"))?k=k.replace(aa,"\\$&"):b.setAttribute("id",k=u),r=g(a),h=r.length,l=V.test(k)?"#"+k:"[id='"+k+"']";while(h--)r[h]=l+" "+pa(r[h]);s=r.join(","),w=_.test(a)&&na(b.parentNode)||b}if(s)try{return H.apply(d,w.querySelectorAll(s)),d}catch(y){}finally{k===u&&b.removeAttribute("id")}}}return i(a.replace(Q,"$1"),b,d,e)}function fa(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ga(a){return a[u]=!0,a}function ha(a){var b=n.createElement("div");try{return!!a(b)}catch(xa){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ia(a,b){var c=a.split("|"),e=c.length;while(e--)d.attrHandle[c[e]]=b}function ja(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ka(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function la(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function ma(a){return ga(function(b){return b=+b,ga(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function na(a){return a&&void 0!==a.getElementsByTagName&&a}c=ea.support={},f=ea.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},m=ea.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=n.documentElement,p=!f(n),(e=n.defaultView)&&e.top!==e&&(e.addEventListener?e.addEventListener("unload",da,!1):e.attachEvent&&e.attachEvent("onunload",da)),c.attributes=ha(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ha(function(a){return a.appendChild(n.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Z.test(n.getElementsByClassName),c.getById=ha(function(a){return o.appendChild(a).id=u,!n.getElementsByName||!n.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if(void 0!==b.getElementById&&p){var c=b.getElementById(a);return c?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ba,ca);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ba,ca);return function(a){var c=void 0!==a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return void 0!==b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){if(void 0!==b.getElementsByClassName&&p)return b.getElementsByClassName(a)},r=[],q=[],(c.qsa=Z.test(n.querySelectorAll))&&(ha(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ha(function(a){var b=n.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=Z.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ha(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",O)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=Z.test(o.compareDocumentPosition),t=b||Z.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d||(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===n||a.ownerDocument===v&&t(v,a)?-1:b===n||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,g=[a],h=[b];if(!e||!f)return a===n?-1:b===n?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return ja(a,b);c=a;while(c=c.parentNode)g.unshift(c);c=b;while(c=c.parentNode)h.unshift(c);while(g[d]===h[d])d++;return d?ja(g[d],h[d]):g[d]===v?-1:h[d]===v?1:0},n):n},ea.matches=function(a,b){return ea(a,null,null,b)},ea.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(T,"='$1']"),c.matchesSelector&&p&&!A[b+" "]&&(!r||!r.test(b))&&(!q||!q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(xa){}return ea(b,n,null,[a]).length>0},ea.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ea.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ea.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ea.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ea.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ea.selectors={cacheLength:50,createPseudo:ga,match:W,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ba,ca),a[3]=(a[3]||a[4]||a[5]||"").replace(ba,ca),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ea.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ea.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return W.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&U.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ba,ca).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||void 0!==a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ea.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(P," ")+" ").indexOf(c)>-1:"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){while(p){m=b;while(m=m[p])if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){m=q,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n&&j[2],m=n&&q.childNodes[n];while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if(1===m.nodeType&&++t&&m===b){k[a]=[w,n,t];break}}else if(s&&(m=b,l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===w&&j[1],t=n),!1===t)while(m=++n&&m&&m[p]||(t=n=0)||o.pop())if((h?m.nodeName.toLowerCase()===r:1===m.nodeType)&&++t&&(s&&(l=m[u]||(m[u]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[w,t]),m===b))break;return(t-=e)===d||t%d==0&&t/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ea.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ga(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ga(function(a){var b=[],c=[],d=h(a.replace(Q,"$1"));return d[u]?ga(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ga(function(a){return function(b){return ea(a,b).length>0}}),contains:ga(function(a){return a=a.replace(ba,ca),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ga(function(a){return V.test(a||"")||ea.error("unsupported lang: "+a),a=a.replace(ba,ca).toLowerCase(),function(b){var c;do{if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Y.test(a.nodeName)},input:function(a){return X.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:ma(function(){return[0]}),last:ma(function(a,b){return[b-1]}),eq:ma(function(a,b,c){return[c<0?c+b:c]}),even:ma(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:ma(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:ma(function(a,b,c){for(var d=c<0?c+b:c;--d>=0;)a.push(d);return a}),gt:ma(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ka(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=la(b);function oa(){}oa.prototype=d.filters=d.pseudos,d.setFilters=new oa,g=ea.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){c&&!(e=R.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=S.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(Q," ")}),h=h.slice(c.length));for(g in d.filter)!(e=W[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ea.error(a):z(a,i).slice(0)};function pa(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function qa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(j=b[u]||(b[u]={}),i=j[b.uniqueID]||(j[b.uniqueID]={}),(h=i[d])&&h[0]===w&&h[1]===f)return k[2]=h[2];if(i[d]=k,k[2]=a(b,c,g))return!0}}}function ra(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function sa(a,b,c){for(var d=0,e=b.length;d<e;d++)ea(a,b[d],c);return c}function ta(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function ua(a,b,c,d,e,f){return d&&!d[u]&&(d=ua(d)),e&&!e[u]&&(e=ua(e,f)),ga(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||sa(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:ta(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=ta(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=ta(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function va(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=qa(function(a){return a===b},h,!0),l=qa(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];i<f;i++)if(c=d.relative[a[i].type])m=[qa(ra(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;e<f;e++)if(d.relative[a[e].type])break;return ua(i>1&&ra(m),i>1&&pa(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(Q,"$1"),c,i<e&&va(a.slice(i,e)),e<f&&va(a=a.slice(e)),e<f&&pa(a))}m.push(c)}return ra(m)}function wa(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,o,q,r=0,s="0",t=f&&[],u=[],v=j,x=f||e&&d.find.TAG("*",k),y=w+=null==v?1:Math.random()||.1,z=x.length;for(k&&(j=g===n||g||k);s!==z&&null!=(l=x[s]);s++){if(e&&l){o=0,g||l.ownerDocument===n||(m(l),h=!p);while(q=a[o++])if(q(l,g||n,h)){i.push(l);break}k&&(w=y)}c&&((l=!q&&l)&&r--,f&&t.push(l))}if(r+=s,c&&s!==r){o=0;while(q=b[o++])q(t,u,g,h);if(f){if(r>0)while(s--)t[s]||u[s]||(u[s]=F.call(i));u=ta(u)}H.apply(i,u),k&&!f&&u.length>0&&r+b.length>1&&ea.uniqueSort(i)}return k&&(w=y,j=v),t};return c?ga(f):f}return h=ea.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=va(b[c]),f[u]?d.push(f):e.push(f);f=A(a,wa(e,d)),f.selector=a}return f},i=ea.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(!(b=(d.find.ID(k.matches[0].replace(ba,ca),b)||[])[0]))return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=W.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(ba,ca),_.test(j[0].type)&&na(b.parentNode)||b))){if(j.splice(i,1),!(a=f.length&&pa(j)))return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,!b||_.test(a)&&na(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ha(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ha(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ia("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ha(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ia("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue}),ha(function(a){return null==a.getAttribute("disabled")})||ia(K,function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ea}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.uniqueSort=n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},v=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},w=n.expr.match.needsContext,x=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,y=/^.[^:#\[\.,]*$/;function z(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(y.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return h.call(b,a)>-1!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;b<c;b++)if(n.contains(e[b],this))return!0}));for(b=0;b<c;b++)n.find(a,e[b],d);return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(z(this,a||[],!1))},not:function(a){return this.pushStack(z(this,a||[],!0))},is:function(a){return!!z(this,"string"==typeof a&&w.test(a)?n(a):a||[],!1).length}});var A,B=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(n.fn.init=function(a,b,c){var e,f;if(!a)return this;if(c=c||A,"string"==typeof a){if(!(e="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:B.exec(a))||!e[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(e[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(e[1],b&&b.nodeType?b.ownerDocument||b:d,!0)),x.test(e[1])&&n.isPlainObject(b))for(e in b)n.isFunction(this[e])?this[e](b[e]):this.attr(e,b[e]);return this}return f=d.getElementById(e[2]),f&&f.parentNode&&(this.length=1,this[0]=f),this.context=d,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?void 0!==c.ready?c.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))}).prototype=n.fn,A=n(d);var C=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=w.test(a)||"string"!=typeof a?n(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?h.call(n(a),this[0]):h.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.uniqueSort(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function E(a,b){while((a=a[b])&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return u(a,"parentNode")},parentsUntil:function(a,b,c){return u(a,"parentNode",c)},next:function(a){return E(a,"nextSibling")},prev:function(a){return E(a,"previousSibling")},nextAll:function(a){return u(a,"nextSibling")},prevAll:function(a){return u(a,"previousSibling")},nextUntil:function(a,b,c){return u(a,"nextSibling",c)},prevUntil:function(a,b,c){return u(a,"previousSibling",c)},siblings:function(a){return v((a.parentNode||{}).firstChild,a)},children:function(a){return v(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(D[a]||n.uniqueSort(e),C.test(a)&&e.reverse()),this.pushStack(e)}});var F=/\S+/g;function G(a){var b={};return n.each(a.match(F)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?G(a):n.extend({},a);var b,c,d,e,f=[],g=[],h=-1,i=function(){for(e=a.once,d=b=!0;g.length;h=-1){c=g.shift();while(++h<f.length)!1===f[h].apply(c[0],c[1])&&a.stopOnFalse&&(h=f.length,c=!1)}a.memory||(c=!1),b=!1,e&&(f=c?[]:"")},j={add:function(){return f&&(c&&!b&&(h=f.length-1,g.push(c)),function b(c){n.each(c,function(c,d){n.isFunction(d)?a.unique&&j.has(d)||f.push(d):d&&d.length&&"string"!==n.type(d)&&b(d)})}(arguments),c&&!b&&i()),this},remove:function(){return n.each(arguments,function(a,b){var c;while((c=n.inArray(b,f,c))>-1)f.splice(c,1),c<=h&&h--}),this},has:function(a){return a?n.inArray(a,f)>-1:f.length>0},empty:function(){return f&&(f=[]),this},disable:function(){return e=g=[],f=c="",this},disabled:function(){return!f},lock:function(){return e=g=[],c||(f=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],g.push(c),b||i()),this},fire:function(){return j.fireWith(this,arguments),this},fired:function(){return!!d}};return j},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=e.call(arguments),d=c.length,f=1!==d||a&&n.isFunction(a.promise)?d:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(d){b[a]=this,c[a]=arguments.length>1?e.call(arguments):d,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(d>1)for(i=new Array(d),j=new Array(d),k=new Array(d);b<d;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().progress(h(b,j,i)).done(h(b,k,c)).fail(g.reject):--f;return f||g.resolveWith(k,c),g.promise()}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(!0===a?--n.readyWait:n.isReady)||(n.isReady=!0,!0!==a&&--n.readyWait>0||(H.resolveWith(d,[n]),n.fn.triggerHandler&&(n(d).triggerHandler("ready"),n(d).off("ready"))))}});function I(){d.removeEventListener("DOMContentLoaded",I),a.removeEventListener("load",I),n.ready()}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===d.readyState||"loading"!==d.readyState&&!d.documentElement.doScroll?a.setTimeout(n.ready):(d.addEventListener("DOMContentLoaded",I),a.addEventListener("load",I))),H.promise(b)},n.ready.promise();var J=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)J(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},K=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function L(){this.expando=n.expando+L.uid++}L.uid=1,L.prototype={register:function(a,b){var c=b||{};return a.nodeType?a[this.expando]=c:Object.defineProperty(a,this.expando,{value:c,writable:!0,configurable:!0}),a[this.expando]},cache:function(a){if(!K(a))return{};var b=a[this.expando];return b||(b={},K(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[b]=c;else for(d in b)e[d]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=a[this.expando];if(void 0!==f){if(void 0===b)this.register(a);else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in f?d=[b,e]:(d=e,d=d in f?[d]:d.match(F)||[])),c=d.length;while(c--)delete f[d[c]]}(void 0===b||n.isEmptyObject(f))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!n.isEmptyObject(b)}};var M=new L,N=new L,O=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,P=/[A-Z]/g;function Q(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(P,"-$&").toLowerCase(),"string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:O.test(c)?n.parseJSON(c):c)}catch(e){}
N.set(a,b,c)}else c=void 0;return c}n.extend({hasData:function(a){return N.hasData(a)||M.hasData(a)},data:function(a,b,c){return N.access(a,b,c)},removeData:function(a,b){N.remove(a,b)},_data:function(a,b,c){return M.access(a,b,c)},_removeData:function(a,b){M.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=N.get(f),1===f.nodeType&&!M.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),Q(f,d,e[d])));M.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){N.set(this,a)}):J(this,function(b){var c,d;if(f&&void 0===b){if(void 0!==(c=N.get(f,a)||N.get(f,a.replace(P,"-$&").toLowerCase())))return c;if(d=n.camelCase(a),void 0!==(c=N.get(f,d)))return c;if(void 0!==(c=Q(f,d,void 0)))return c}else d=n.camelCase(a),this.each(function(){var c=N.get(this,d);N.set(this,d,b),a.indexOf("-")>-1&&void 0!==c&&N.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){N.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=M.get(a,b),c&&(!d||n.isArray(c)?d=M.access(a,b,n.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return M.get(a,c)||M.access(a,c,{empty:n.Callbacks("once memory").add(function(){M.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)(c=M.get(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var R=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,S=new RegExp("^(?:([+-])=|)("+R+")([a-z%]*)$","i"),T=["Top","Right","Bottom","Left"],U=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)};function V(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return n.css(a,b,"")},i=h(),j=c&&c[3]||(n.cssNumber[b]?"":"px"),k=(n.cssNumber[b]||"px"!==j&&+i)&&S.exec(n.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do{f=f||".5",k/=f,n.style(a,b,k+j)}while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}var W=/^(?:checkbox|radio)$/i,X=/<([\w:-]+)/,Y=/^$|\/(?:java|ecma)script/i,Z={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Z.optgroup=Z.option,Z.tbody=Z.tfoot=Z.colgroup=Z.caption=Z.thead,Z.th=Z.td;function $(a,b){var c=void 0!==a.getElementsByTagName?a.getElementsByTagName(b||"*"):void 0!==a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function _(a,b){for(var c=0,d=a.length;c<d;c++)M.set(a[c],"globalEval",!b||M.get(b[c],"globalEval"))}var aa=/<|&#?\w+;/;function ba(a,b,c,d,e){for(var f,g,h,i,j,k,l=b.createDocumentFragment(),m=[],o=0,p=a.length;o<p;o++)if((f=a[o])||0===f)if("object"===n.type(f))n.merge(m,f.nodeType?[f]:f);else if(aa.test(f)){g=g||l.appendChild(b.createElement("div")),h=(X.exec(f)||["",""])[1].toLowerCase(),i=Z[h]||Z._default,g.innerHTML=i[1]+n.htmlPrefilter(f)+i[2],k=i[0];while(k--)g=g.lastChild;n.merge(m,g.childNodes),g=l.firstChild,g.textContent=""}else m.push(b.createTextNode(f));l.textContent="",o=0;while(f=m[o++])if(d&&n.inArray(f,d)>-1)e&&e.push(f);else if(j=n.contains(f.ownerDocument,f),g=$(l.appendChild(f),"script"),j&&_(g),c){k=0;while(f=g[k++])Y.test(f.type||"")&&c.push(f)}return l}!function(){var a=d.createDocumentFragment(),b=a.appendChild(d.createElement("div")),c=d.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var ca=/^key/,da=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ea=/^([^.]*)(?:\.(.+)|)/;function fa(){return!0}function ga(){return!1}function ha(){try{return d.activeElement}catch(a){}}function ia(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)ia(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),!1===e)e=ga;else if(!e)return a;return 1===f&&(g=e,e=function(a){return n().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=n.guid++)),a.each(function(){n.event.add(this,b,e,d,c)})}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=M.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return void 0!==n&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(F)||[""],j=b.length;while(j--)h=ea.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&!1!==l.setup.call(a,d,p,g)||a.addEventListener&&a.addEventListener(o,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=M.hasData(a)&&M.get(a);if(r&&(i=r.events)){b=(b||"").match(F)||[""],j=b.length;while(j--)if(h=ea.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,p,r.handle)||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&M.remove(a,"handle events")}},dispatch:function(a){a=n.event.fix(a);var b,c,d,f,g,h=[],i=e.call(arguments),j=(M.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||!1!==k.preDispatch.call(this,a)){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped())a.rnamespace&&!a.rnamespace.test(g.namespace)||(a.handleObj=g,a.data=g.data,void 0!==(d=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i))&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&("click"!==a.type||isNaN(a.button)||a.button<1))for(;i!==this;i=i.parentNode||this)if(1===i.nodeType&&(!0!==i.disabled||"click"!==a.type)){for(d=[],c=0;c<h;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>-1:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,e,f,g=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||d,e=c.documentElement,f=c.body,a.pageX=b.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),a.which||void 0===g||(a.which=1&g?1:2&g?3:4&g?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,e,f=a.type,g=a,h=this.fixHooks[f];h||(this.fixHooks[f]=h=da.test(f)?this.mouseHooks:ca.test(f)?this.keyHooks:{}),e=h.props?this.props.concat(h.props):this.props,a=new n.Event(g),b=e.length;while(b--)c=e[b],a[c]=g[c];return a.target||(a.target=d),3===a.target.nodeType&&(a.target=a.target.parentNode),h.filter?h.filter(a,g):a},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ha()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===ha()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&n.nodeName(this,"input"))return this.click(),!1},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},n.Event=function(a,b){if(!(this instanceof n.Event))return new n.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?fa:ga):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),this[n.expando]=!0},n.Event.prototype={constructor:n.Event,isDefaultPrevented:ga,isPropagationStopped:ga,isImmediatePropagationStopped:ga,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=fa,a&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=fa,a&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=fa,a&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||n.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),n.fn.extend({on:function(a,b,c,d){return ia(this,a,b,c,d)},one:function(a,b,c,d){return ia(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=ga),this.each(function(){n.event.remove(this,a,c,b)})}});var ja=/<script|<style|<link/i,ka=/checked\s*(?:[^=]|=\s*.checked.)/i,la=/^true\/(.*)/,ma=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function na(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function oa(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function pa(a){var b=la.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function qa(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(M.hasData(a)&&(f=M.access(a),g=M.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;c<d;c++)n.event.add(b,e,j[e][c])}N.hasData(a)&&(h=N.access(a),i=n.extend({},h),N.set(b,i))}}function ra(a,b){var c=b.nodeName.toLowerCase();"input"===c&&W.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function sa(a,b,c,d){b=f.apply([],b);var e,g,h,i,j,k,m=0,o=a.length,p=o-1,q=b[0],r=n.isFunction(q);if(r||o>1&&"string"==typeof q&&!l.checkClone&&ka.test(q))return a.each(function(e){var f=a.eq(e);r&&(b[0]=q.call(this,e,f.html())),sa(f,b,c,d)});if(o&&(e=ba(b,a[0].ownerDocument,!1,a,d),g=e.firstChild,1===e.childNodes.length&&(e=g),g||d)){for(h=n.map($(e,"script"),oa),i=h.length;m<o;m++)j=e,m!==p&&(j=n.clone(j,!0,!0),i&&n.merge(h,$(j,"script"))),c.call(a[m],j,m);if(i)for(k=h[h.length-1].ownerDocument,n.map(h,pa),m=0;m<i;m++)j=h[m],Y.test(j.type||"")&&!M.access(j,"globalEval")&&n.contains(k,j)&&(j.src?n._evalUrl&&n._evalUrl(j.src):n.globalEval(j.textContent.replace(ma,"")))}return a}function ta(a,b,c){for(var d,e=b?n.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||n.cleanData($(d)),d.parentNode&&(c&&n.contains(d.ownerDocument,d)&&_($(d,"script")),d.parentNode.removeChild(d));return a}n.extend({htmlPrefilter:function(a){return a},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=$(h),f=$(a),d=0,e=f.length;d<e;d++)ra(f[d],g[d]);if(b)if(c)for(f=f||$(a),g=g||$(h),d=0,e=f.length;d<e;d++)qa(f[d],g[d]);else qa(a,h);return g=$(h,"script"),g.length>0&&_(g,!i&&$(a,"script")),h},cleanData:function(a){for(var b,c,d,e=n.event.special,f=0;void 0!==(c=a[f]);f++)if(K(c)){if(b=c[M.expando]){if(b.events)for(d in b.events)e[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);c[M.expando]=void 0}c[N.expando]&&(c[N.expando]=void 0)}}}),n.fn.extend({domManip:sa,detach:function(a){return ta(this,a,!0)},remove:function(a){return ta(this,a)},text:function(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return sa(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){na(this,a).appendChild(a)}})},prepend:function(){return sa(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=na(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return sa(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return sa(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData($(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!ja.test(a)&&!Z[(X.exec(a)||["",""])[1].toLowerCase()]){a=n.htmlPrefilter(a);try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData($(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return sa(this,arguments,function(b){var c=this.parentNode;n.inArray(this,a)<0&&(n.cleanData($(this)),c&&c.replaceChild(b,this))},a)}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),f=e.length-1,h=0;h<=f;h++)c=h===f?this:this.clone(!0),n(e[h])[b](c),g.apply(d,c.get());return this.pushStack(d)}});var ua,va={HTML:"block",BODY:"block"};function wa(a,b){var c=n(b.createElement(a)).appendTo(b.body),d=n.css(c[0],"display");return c.detach(),d}function xa(a){var b=d,c=va[a];return c||(c=wa(a,b),"none"!==c&&c||(ua=(ua||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=ua[0].contentDocument,b.write(),b.close(),c=wa(a,b),ua.detach()),va[a]=c),c}var ya=/^margin/,za=new RegExp("^("+R+")(?!px)[a-z%]+$","i"),Aa=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)},Ba=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e},Ca=d.documentElement;!function(){var b,c,e,f,g=d.createElement("div"),h=d.createElement("div");function i(){h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",h.innerHTML="",Ca.appendChild(g);var d=a.getComputedStyle(h);b="1%"!==d.top,f="2px"===d.marginLeft,c="4px"===d.width,h.style.marginRight="50%",e="4px"===d.marginRight,Ca.removeChild(g)}h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===h.style.backgroundClip,g.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",g.appendChild(h),n.extend(l,{pixelPosition:function(){return i(),b},boxSizingReliable:function(){return null==c&&i(),c},pixelMarginRight:function(){return null==c&&i(),e},reliableMarginLeft:function(){return null==c&&i(),f},reliableMarginRight:function(){var b,c=h.appendChild(d.createElement("div"));return c.style.cssText=h.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",h.style.width="1px",Ca.appendChild(g),b=!parseFloat(a.getComputedStyle(c).marginRight),Ca.removeChild(g),h.removeChild(c),b}}))}();function Da(a,b,c){var d,e,f,g,h=a.style;return c=c||Aa(a),g=c?c.getPropertyValue(b)||c[b]:void 0,""!==g&&void 0!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),c&&!l.pixelMarginRight()&&za.test(g)&&ya.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f),void 0!==g?g+"":g}function Ea(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}var Fa=/^(none|table(?!-c[ea]).+)/,Ga={position:"absolute",visibility:"hidden",display:"block"},Ha={letterSpacing:"0",fontWeight:"400"},Ia=["Webkit","O","Moz","ms"],Ja=d.createElement("div").style;function Ka(a){if(a in Ja)return a;var b=a[0].toUpperCase()+a.slice(1),c=Ia.length;while(c--)if((a=Ia[c]+b)in Ja)return a}function La(a,b,c){var d=S.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function Ma(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=n.css(a,c+T[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+T[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+T[f]+"Width",!0,e))):(g+=n.css(a,"padding"+T[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+T[f]+"Width",!0,e)));return g}function Na(b,c,e){var f=!0,g="width"===c?b.offsetWidth:b.offsetHeight,h=Aa(b),i="border-box"===n.css(b,"boxSizing",!1,h);if(d.msFullscreenElement&&a.top!==a&&b.getClientRects().length&&(g=Math.round(100*b.getBoundingClientRect()[c])),g<=0||null==g){if(g=Da(b,c,h),(g<0||null==g)&&(g=b.style[c]),za.test(g))return g;f=i&&(l.boxSizingReliable()||g===b.style[c]),g=parseFloat(g)||0}return g+Ma(b,c,e||(i?"border":"content"),f,h)+"px"}function Oa(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)d=a[g],d.style&&(f[g]=M.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&U(d)&&(f[g]=M.access(d,"olddisplay",xa(d.nodeName)))):(e=U(d),"none"===c&&e||M.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;g<h;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Da(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;if(b=n.cssProps[h]||(n.cssProps[h]=Ka(h)||h),g=n.cssHooks[b]||n.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];f=typeof c,"string"===f&&(e=S.exec(c))&&e[1]&&(c=V(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(n.cssNumber[h]?"":"px")),l.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c))}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Ka(h)||h),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=Da(a,b,d)),"normal"===e&&b in Ha&&(e=Ha[b]),""===c||c?(f=parseFloat(e),!0===c||isFinite(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){if(c)return Fa.test(n.css(a,"display"))&&0===a.offsetWidth?Ba(a,Ga,function(){return Na(a,b,d)}):Na(a,b,d)},set:function(a,c,d){var e,f=d&&Aa(a),g=d&&Ma(a,b,d,"border-box"===n.css(a,"boxSizing",!1,f),f);return g&&(e=S.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=n.css(a,b)),La(a,c,g)}}}),n.cssHooks.marginLeft=Ea(l.reliableMarginLeft,function(a,b){if(b)return(parseFloat(Da(a,"marginLeft"))||a.getBoundingClientRect().left-Ba(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px"}),n.cssHooks.marginRight=Ea(l.reliableMarginRight,function(a,b){if(b)return Ba(a,{display:"inline-block"},Da,[a,"marginRight"])}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+T[d]+b]=f[d]||f[d-2]||f[0];return e}},ya.test(a)||(n.cssHooks[a+b].set=La)}),n.fn.extend({css:function(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Aa(a),e=b.length;g<e;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Oa(this,!0)},hide:function(){return Oa(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){U(this)?n(this).show():n(this).hide()})}});function Pa(a,b,c,d,e){return new Pa.prototype.init(a,b,c,d,e)}n.Tween=Pa,Pa.prototype={constructor:Pa,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||n.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Pa.propHooks[this.prop];return a&&a.get?a.get(this):Pa.propHooks._default.get(this)},run:function(a){var b,c=Pa.propHooks[this.prop];return this.options.duration?this.pos=b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Pa.propHooks._default.set(this),this}},Pa.prototype.init.prototype=Pa.prototype,Pa.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[n.cssProps[a.prop]]&&!n.cssHooks[a.prop]?a.elem[a.prop]=a.now:n.style(a.elem,a.prop,a.now+a.unit)}}},Pa.propHooks.scrollTop=Pa.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},n.fx=Pa.prototype.init,n.fx.step={};var Qa,Ra,Sa=/^(?:toggle|show|hide)$/,Ta=/queueHooks$/;function Ua(){return a.setTimeout(function(){Qa=void 0}),Qa=n.now()}function Va(a,b){var c,d=0,e={height:a};for(b=b?1:0;d<4;d+=2-b)c=T[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Wa(a,b,c){for(var d,e=(Za.tweeners[b]||[]).concat(Za.tweeners["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function Xa(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&U(a),q=M.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),"inline"===(k="none"===j?M.get(a,"olddisplay")||xa(a.nodeName):j)&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Sa.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?xa(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=M.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;M.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Wa(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function Ya(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=n.cssHooks[d])&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Za(a,b,c){var d,e,f=0,g=Za.prefilters.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Qa||Ua(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{},easing:n.easing._default},c),originalProperties:b,originalOptions:c,startTime:Qa||Ua(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(Ya(k,j.opts.specialEasing);f<g;f++)if(d=Za.prefilters[f].call(j,a,k,j.opts))return n.isFunction(d.stop)&&(n._queueHooks(j.elem,j.opts.queue).stop=n.proxy(d.stop,d)),d;return n.map(k,Wa,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(Za,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return V(c.elem,a,S.exec(b),c),c}]},tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.match(F);for(var c,d=0,e=a.length;d<e;d++)c=a[d],Za.tweeners[c]=Za.tweeners[c]||[],Za.tweeners[c].unshift(b)},prefilters:[Xa],prefilter:function(a,b){b?Za.prefilters.unshift(a):Za.prefilters.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(U).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=Za(this,n.extend({},a),f);(e||M.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=M.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Ta.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||n.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=M.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Va(b,!0),a,d,e)}}),n.each({slideDown:Va("show"),slideUp:Va("hide"),slideToggle:Va("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(Qa=n.now();b<c.length;b++)(a=c[b])()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),Qa=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Ra||(Ra=a.setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){a.clearInterval(Ra),Ra=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(b,c){return b=n.fx?n.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=d.createElement("input"),b=d.createElement("select"),c=b.appendChild(d.createElement("option"));a.type="checkbox",l.checkOn=""!==a.value,l.optSelected=c.selected,b.disabled=!0,l.optDisabled=!c.disabled,a=d.createElement("input"),a.value="t",a.type="radio",l.radioValue="t"===a.value}();var $a,_a=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return J(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return void 0===a.getAttribute?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),e=n.attrHooks[b]||(n.expr.match.bool.test(b)?$a:void 0)),void 0!==c?null===c?void n.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=n.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(F);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)}}),$a={set:function(a,b,c){return!1===b?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=_a[b]||n.find.attr;_a[b]=function(a,b,d){var e,f;return d||(f=_a[b],_a[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,_a[b]=f),e}});var ab=/^(?:input|select|textarea|button)$/i,bb=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return J(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&n.isXMLDoc(a)||(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,"tabindex")
;return b?parseInt(b,10):ab.test(a.nodeName)||bb.test(a.nodeName)&&a.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null},set:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var cb=/[\t\r\n\f]/g;function db(a){return a.getAttribute&&a.getAttribute("class")||""}n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,db(this)))});if("string"==typeof a&&a){b=a.match(F)||[];while(c=this[i++])if(e=db(c),d=1===c.nodeType&&(" "+e+" ").replace(cb," ")){g=0;while(f=b[g++])d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=n.trim(d),e!==h&&c.setAttribute("class",h)}}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,db(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a){b=a.match(F)||[];while(c=this[i++])if(e=db(c),d=1===c.nodeType&&(" "+e+" ").replace(cb," ")){g=0;while(f=b[g++])while(d.indexOf(" "+f+" ")>-1)d=d.replace(" "+f+" "," ");h=n.trim(d),e!==h&&c.setAttribute("class",h)}}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):n.isFunction(a)?this.each(function(c){n(this).toggleClass(a.call(this,c,db(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c){d=0,e=n(this),f=a.match(F)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else void 0!==a&&"boolean"!==c||(b=db(this),b&&M.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||!1===a?"":M.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;b=" "+a+" ";while(c=this[d++])if(1===c.nodeType&&(" "+db(c)+" ").replace(cb," ").indexOf(b)>-1)return!0;return!1}});var eb=/\r/g,fb=/[\x20\t\r\n\f]+/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),(b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return(b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(eb,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a)).replace(fb," ")}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(c=d[i],(c.selected||i===e)&&(l.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=n.inArray(n.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){if(n.isArray(b))return a.checked=n.inArray(n(a).val(),b)>-1}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var gb=/^(?:focusinfocus|focusoutblur)$/;n.extend(n.event,{trigger:function(b,c,e,f){var g,h,i,j,l,m,o,p=[e||d],q=k.call(b,"type")?b.type:b,r=k.call(b,"namespace")?b.namespace.split("."):[];if(h=i=e=e||d,3!==e.nodeType&&8!==e.nodeType&&!gb.test(q+n.event.triggered)&&(q.indexOf(".")>-1&&(r=q.split("."),q=r.shift(),r.sort()),l=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=f?2:3,b.namespace=r.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=e),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},f||!o.trigger||!1!==o.trigger.apply(e,c))){if(!f&&!o.noBubble&&!n.isWindow(e)){for(j=o.delegateType||q,gb.test(j+q)||(h=h.parentNode);h;h=h.parentNode)p.push(h),i=h;i===(e.ownerDocument||d)&&p.push(i.defaultView||i.parentWindow||a)}g=0;while((h=p[g++])&&!b.isPropagationStopped())b.type=g>1?j:o.bindType||q,m=(M.get(h,"events")||{})[b.type]&&M.get(h,"handle"),m&&m.apply(h,c),(m=l&&h[l])&&m.apply&&K(h)&&(b.result=m.apply(h,c),!1===b.result&&b.preventDefault());return b.type=q,f||b.isDefaultPrevented()||o._default&&!1!==o._default.apply(p.pop(),c)||!K(e)||l&&n.isFunction(e[q])&&!n.isWindow(e)&&(i=e[l],i&&(e[l]=null),n.event.triggered=q,e[q](),n.event.triggered=void 0,i&&(e[l]=i)),b.result}},simulate:function(a,b,c){var d=n.extend(new n.Event,c,{type:a,isSimulated:!0});n.event.trigger(d,null,b),d.isDefaultPrevented()&&c.preventDefault()}}),n.fn.extend({trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return n.event.trigger(a,b,c,!0)}}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),l.focusin="onfocusin"in a,l.focusin||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a))};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=M.access(d,b);e||d.addEventListener(a,c,!0),M.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=M.access(d,b)-1;e?M.access(d,b,e):(d.removeEventListener(a,c,!0),M.remove(d,b))}}});var hb=a.location,ib=n.now(),jb=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(d){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+b),c};var kb=/#.*$/,lb=/([?&])_=[^&]*/,mb=/^(.*?):[ \t]*([^\r\n]*)$/gm,nb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ob=/^(?:GET|HEAD)$/,pb=/^\/\//,qb={},rb={},sb="*/".concat("*"),tb=d.createElement("a");tb.href=hb.href;function ub(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(F)||[];if(n.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function vb(a,b,c,d){var e={},f=a===rb;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function wb(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function xb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}if(f)return f!==i[0]&&i.unshift(f),c[f]}function yb(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(a.crossDomain&&"script"===f)continue;if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:hb.href,type:"GET",isLocal:nb.test(hb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?wb(wb(a,n.ajaxSettings),b):wb(n.ajaxSettings,a)},ajaxPrefilter:ub(qb),ajaxTransport:ub(rb),ajax:function(b,c){"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m=n.ajaxSetup({},c),o=m.context||m,p=m.context&&(o.nodeType||o.jquery)?n(o):n.event,q=n.Deferred(),r=n.Callbacks("once memory"),s=m.statusCode||{},t={},u={},v=0,w="canceled",x={readyState:0,getResponseHeader:function(a){var b;if(2===v){if(!h){h={};while(b=mb.exec(g))h[b[1].toLowerCase()]=b[2]}b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===v?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return v||(a=u[c]=u[c]||a,t[a]=b),this},overrideMimeType:function(a){return v||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(v<2)for(b in a)s[b]=[s[b],a[b]];else x.always(a[x.status]);return this},abort:function(a){var b=a||w;return e&&e.abort(b),y(0,b),this}};if(q.promise(x).complete=r.add,x.success=x.done,x.error=x.fail,m.url=((b||m.url||hb.href)+"").replace(kb,"").replace(pb,hb.protocol+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=n.trim(m.dataType||"*").toLowerCase().match(F)||[""],null==m.crossDomain){j=d.createElement("a");try{j.href=m.url,j.href=j.href,m.crossDomain=tb.protocol+"//"+tb.host!=j.protocol+"//"+j.host}catch(z){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=n.param(m.data,m.traditional)),vb(qb,m,c,x),2===v)return x;k=n.event&&m.global,k&&0==n.active++&&n.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!ob.test(m.type),f=m.url,m.hasContent||(m.data&&(f=m.url+=(jb.test(f)?"&":"?")+m.data,delete m.data),!1===m.cache&&(m.url=lb.test(f)?f.replace(lb,"$1_="+ib++):f+(jb.test(f)?"&":"?")+"_="+ib++)),m.ifModified&&(n.lastModified[f]&&x.setRequestHeader("If-Modified-Since",n.lastModified[f]),n.etag[f]&&x.setRequestHeader("If-None-Match",n.etag[f])),(m.data&&m.hasContent&&!1!==m.contentType||c.contentType)&&x.setRequestHeader("Content-Type",m.contentType),x.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+sb+"; q=0.01":""):m.accepts["*"]);for(l in m.headers)x.setRequestHeader(l,m.headers[l]);if(m.beforeSend&&(!1===m.beforeSend.call(o,x,m)||2===v))return x.abort();w="abort";for(l in{success:1,error:1,complete:1})x[l](m[l]);if(e=vb(rb,m,c,x)){if(x.readyState=1,k&&p.trigger("ajaxSend",[x,m]),2===v)return x;m.async&&m.timeout>0&&(i=a.setTimeout(function(){x.abort("timeout")},m.timeout));try{v=1,e.send(t,y)}catch(z){if(!(v<2))throw z;y(-1,z)}}else y(-1,"No Transport");function y(b,c,d,h){var j,l,t,u,w,y=c;2!==v&&(v=2,i&&a.clearTimeout(i),e=void 0,g=h||"",x.readyState=b>0?4:0,j=b>=200&&b<300||304===b,d&&(u=xb(m,x,d)),u=yb(m,u,x,j),j?(m.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(n.lastModified[f]=w),(w=x.getResponseHeader("etag"))&&(n.etag[f]=w)),204===b||"HEAD"===m.type?y="nocontent":304===b?y="notmodified":(y=u.state,l=u.data,t=u.error,j=!t)):(t=y,!b&&y||(y="error",b<0&&(b=0))),x.status=b,x.statusText=(c||y)+"",j?q.resolveWith(o,[l,y,x]):q.rejectWith(o,[x,y,t]),x.statusCode(s),s=void 0,k&&p.trigger(j?"ajaxSuccess":"ajaxError",[x,m,j?l:t]),r.fireWith(o,[x,y]),k&&(p.trigger("ajaxComplete",[x,m]),--n.active||n.event.trigger("ajaxStop")))}return x},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax(n.extend({url:a,type:b,dataType:e,data:c,success:d},n.isPlainObject(a)&&a))}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return n.isFunction(a)?this.each(function(b){n(this).wrapInner(a.call(this,b))}):this.each(function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return!n.expr.filters.visible(a)},n.expr.filters.visible=function(a){return a.offsetWidth>0||a.offsetHeight>0||a.getClientRects().length>0};var zb=/%20/g,Ab=/\[\]$/,Bb=/\r?\n/g,Cb=/^(?:submit|button|image|reset|file)$/i,Db=/^(?:input|select|textarea|keygen)/i;function Eb(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Ab.test(a)?d(a,e):Eb(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Eb(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Eb(c,a[c],b,e);return d.join("&").replace(zb,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Db.test(this.nodeName)&&!Cb.test(a)&&(this.checked||!W.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Bb,"\r\n")}}):{name:b.name,value:c.replace(Bb,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(b){}};var Fb={0:200,1223:204},Gb=n.ajaxSettings.xhr();l.cors=!!Gb&&"withCredentials"in Gb,l.ajax=Gb=!!Gb,n.ajaxTransport(function(b){var c,d;if(l.cors||Gb&&!b.crossDomain)return{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Fb[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(i){if(c)throw i}},abort:function(){c&&c()}}}),n.ajaxPrefilter(function(a){a.crossDomain&&(a.contents.script=!1)}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(e,f){b=n("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&f("error"===a.type?404:200,a.type)}),d.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Hb=[],Ib=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Hb.pop()||n.expando+"_"+ib++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(Ib.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ib.test(b.data)&&"data");if(h||"jsonp"===b.dataTypes[0])return e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Ib,"$1"+e):!1!==b.jsonp&&(b.url+=(jb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?n(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Hb.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||d;var e=x.exec(a),f=!c&&[];return e?[b.createElement(e[1])]:(e=ba([a],b,f),f&&f.length&&n(f).remove(),n.merge([],e.childNodes))};var Jb=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Jb)return Jb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(this,f||[a.responseText,b,a])})}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};function Kb(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,n.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(e=d.getBoundingClientRect(),c=Kb(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent;while(a&&"static"===n.css(a,"position"))a=a.offsetParent;return a||Ca})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;n.fn[a]=function(d){return J(this,function(a,d,e){var f=Kb(a);if(void 0===e)return f?f[b]:a[d];f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e},a,d,arguments.length)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=Ea(l.pixelPosition,function(a,c){if(c)return c=Da(a,b),za.test(c)?n(a).position()[b]+"px":c})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},size:function(){return this.length}}),n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Lb=a.jQuery,Mb=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Mb),b&&a.jQuery===n&&(a.jQuery=Lb),n},b||(a.jQuery=a.$=n),n});
/*! RESOURCE: /scripts/lib/jquery/jquery_no_conflict.js */
(function() {
	if (window.$j_glide) {
		jQuery.noConflict(true);
		window.jQuery = $j_glide;
	}
	window.$j = window.$j_glide = jQuery.noConflict();
})();
;
;
/*! RESOURCE: /scripts/lib/jquery2_includes.js */
/*! RESOURCE: /scripts/lib/jquery/jquery_csrf.js */
(function($) {
	setToken();
	CustomEvent.observe('ck_updated', setToken);
	function setToken() {
		$.ajaxPrefilter(function(options) {
			if (!options.crossDomain) {
				if (!options.headers)
					options.headers = {};
				var token = window.g_ck || 'token_intentionally_left_blank';
				options.headers['X-UserToken'] = token;
			}
		});
	}
})(jQuery);
;
/*! RESOURCE: /scripts/jquery-ui-1.9.2.custom.js */
(function( $, undefined ) {
var uuid = 0,
runiqueId = /^ui-id-\d+$/;
$.ui = $.ui || {};
if ( $.ui.version ) {
	return;
}
$.extend( $.ui, {
	version: "1.9.2-snc",
	keyCode: {
		BACKSPACE: 8,
		COMMA: 188,
		DELETE: 46,
		DOWN: 40,
		END: 35,
		ENTER: 13,
		ESCAPE: 27,
		HOME: 36,
		LEFT: 37,
		NUMPAD_ADD: 107,
		NUMPAD_DECIMAL: 110,
		NUMPAD_DIVIDE: 111,
		NUMPAD_ENTER: 108,
		NUMPAD_MULTIPLY: 106,
		NUMPAD_SUBTRACT: 109,
		PAGE_DOWN: 34,
		PAGE_UP: 33,
		PERIOD: 190,
		RIGHT: 39,
		SPACE: 32,
		TAB: 9,
		UP: 38
	}
});
$.fn.extend({
	_focus: $.fn.focus,
	focus: function( delay, fn ) {
		return typeof delay === "number" ?
			this.each(function() {
				var elem = this;
				setTimeout(function() {
					$( elem ).focus();
					if ( fn ) {
						fn.call( elem );
					}
				}, delay );
			}) :
			this._focus.apply( this, arguments );
	},
	scrollParent: function() {
		var scrollParent;
if (($.ui.ie && (/(static|relative)/).test(this.css('position'))) || (/absolute/).test(this.css('position'))) {
			scrollParent = this.parents().filter(function() {
return (/(relative|absolute|fixed)/).test($.css(this,'position')) && (/(auto|scroll)/).test($.css(this,'overflow')+$.css(this,'overflow-y')+$.css(this,'overflow-x'));
			}).eq(0);
		} else {
			scrollParent = this.parents().filter(function() {
return (/(auto|scroll)/).test($.css(this,'overflow')+$.css(this,'overflow-y')+$.css(this,'overflow-x'));
			}).eq(0);
		}
return (/fixed/).test(this.css('position')) || !scrollParent.length ? $(document) : scrollParent;
	},
	zIndex: function( zIndex ) {
		if ( zIndex !== undefined ) {
			return this.css( "zIndex", zIndex );
		}
		if ( this.length ) {
			var elem = $( this[ 0 ] ), position, value;
			while ( elem.length && elem[ 0 ] !== document ) {
				position = elem.css( "position" );
				if ( position === "absolute" || position === "relative" || position === "fixed" ) {
					value = parseInt( elem.css( "zIndex" ), 10 );
					if ( !isNaN( value ) && value !== 0 ) {
						return value;
					}
				}
				elem = elem.parent();
			}
		}
		return 0;
	},
	uniqueId: function() {
		return this.each(function() {
			if ( !this.id ) {
				this.id = "ui-id-" + (++uuid);
			}
		});
	},
	removeUniqueId: function() {
		return this.each(function() {
			if ( runiqueId.test( this.id ) ) {
				$( this ).removeAttr( "id" );
			}
		});
	}
});
function focusable( element, isTabIndexNotNaN ) {
	var map, mapName, img,
		nodeName = element.nodeName.toLowerCase();
	if ( "area" === nodeName ) {
		map = element.parentNode;
		mapName = map.name;
		if ( !element.href || !mapName || map.nodeName.toLowerCase() !== "map" ) {
			return false;
		}
		img = $( "img[usemap=#" + mapName + "]" )[0];
		return !!img && visible( img );
	}
return ( /input|select|textarea|button|object/.test( nodeName ) ?
		!element.disabled :
		"a" === nodeName ?
			element.href || isTabIndexNotNaN :
			isTabIndexNotNaN) &&
		visible( element );
}
function visible( element ) {
	return $.expr.filters.visible( element ) &&
		!$( element ).parents().andSelf().filter(function() {
			return $.css( this, "visibility" ) === "hidden";
		}).length;
}
$.extend( $.expr[ ":" ], {
	data: $.expr.createPseudo ?
		$.expr.createPseudo(function( dataName ) {
			return function( elem ) {
				return !!$.data( elem, dataName );
			};
		}) :
		function( elem, i, match ) {
			return !!$.data( elem, match[ 3 ] );
		},
	focusable: function( element ) {
		return focusable( element, !isNaN( $.attr( element, "tabindex" ) ) );
	},
	tabbable: function( element ) {
		var tabIndex = $.attr( element, "tabindex" ),
			isTabIndexNaN = isNaN( tabIndex );
		return ( isTabIndexNaN || tabIndex >= 0 ) && focusable( element, !isTabIndexNaN );
	}
});
$(function() {
	var body = document.body,
		div = body.appendChild( div = document.createElement( "div" ) );
	$.extend( div.style, {
		minHeight: "100px",
		height: "auto",
		padding: 0,
		borderWidth: 0
	});
	$.support.minHeight = true;
	$.support.selectstart = "onselectstart" in div;
	body.removeChild( div ).style.display = "none";
});
if ( !$( "<a>" ).outerWidth( 1 ).jquery ) {
	$.each( [ "Width", "Height" ], function( i, name ) {
		var side = name === "Width" ? [ "Left", "Right" ] : [ "Top", "Bottom" ],
			type = name.toLowerCase(),
			orig = {
				innerWidth: $.fn.innerWidth,
				innerHeight: $.fn.innerHeight,
				outerWidth: $.fn.outerWidth,
				outerHeight: $.fn.outerHeight
			};
		function reduce( elem, size, border, margin ) {
			$.each( side, function() {
				size -= parseFloat( $.css( elem, "padding" + this ) ) || 0;
				if ( border ) {
					size -= parseFloat( $.css( elem, "border" + this + "Width" ) ) || 0;
				}
				if ( margin ) {
					size -= parseFloat( $.css( elem, "margin" + this ) ) || 0;
				}
			});
			return size;
		}
		$.fn[ "inner" + name ] = function( size ) {
			if ( size === undefined ) {
				return orig[ "inner" + name ].call( this );
			}
			return this.each(function() {
				$( this ).css( type, reduce( this, size ) + "px" );
			});
		};
		$.fn[ "outer" + name] = function( size, margin ) {
			if ( typeof size !== "number" ) {
				return orig[ "outer" + name ].call( this, size );
			}
			return this.each(function() {
				$( this).css( type, reduce( this, size, true, margin ) + "px" );
			});
		};
	});
}
if ( $( "<a>" ).data( "a-b", "a" ).removeData( "a-b" ).data( "a-b" ) ) {
	$.fn.removeData = (function( removeData ) {
		return function( key ) {
			if ( arguments.length ) {
				return removeData.call( this, $.camelCase( key ) );
			} else {
				return removeData.call( this );
			}
		};
	})( $.fn.removeData );
}
(function() {
var uaMatch = /msie ([\w.]+)/.exec( navigator.userAgent.toLowerCase() ) || [];
	$.ui.ie = uaMatch.length ? true : false;
	$.ui.ie6 = parseFloat( uaMatch[ 1 ], 10 ) === 6;
})();
$.fn.extend({
	disableSelection: function() {
		return this.bind( ( $.support.selectstart ? "selectstart" : "mousedown" ) +
			".ui-disableSelection", function( event ) {
				event.preventDefault();
			});
	},
	enableSelection: function() {
		return this.unbind( ".ui-disableSelection" );
	}
});
$.extend( $.ui, {
	plugin: {
		add: function( module, option, set ) {
			var i,
				proto = $.ui[ module ].prototype;
			for ( i in set ) {
				proto.plugins[ i ] = proto.plugins[ i ] || [];
				proto.plugins[ i ].push( [ option, set[ i ] ] );
			}
		},
		call: function( instance, name, args ) {
			var i,
				set = instance.plugins[ name ];
			if ( !set || !instance.element[ 0 ].parentNode || instance.element[ 0 ].parentNode.nodeType === 11 ) {
				return;
			}
			for ( i = 0; i < set.length; i++ ) {
				if ( instance.options[ set[ i ][ 0 ] ] ) {
					set[ i ][ 1 ].apply( instance.element, args );
				}
			}
		}
	},
	contains: $.contains,
	hasScroll: function( el, a ) {
		if ( $( el ).css( "overflow" ) === "hidden") {
			return false;
		}
		var scroll = ( a && a === "left" ) ? "scrollLeft" : "scrollTop",
			has = false;
		if ( el[ scroll ] > 0 ) {
			return true;
		}
		el[ scroll ] = 1;
		has = ( el[ scroll ] > 0 );
		el[ scroll ] = 0;
		return has;
	},
	isOverAxis: function( x, reference, size ) {
		return ( x > reference ) && ( x < ( reference + size ) );
	},
	isOver: function( y, x, top, left, height, width ) {
		return $.ui.isOverAxis( y, top, height ) && $.ui.isOverAxis( x, left, width );
	}
});
})( jQuery );
(function( $, undefined ) {
var uuid = 0,
	slice = Array.prototype.slice,
	_cleanData = $.cleanData;
$.cleanData = function( elems ) {
	for ( var i = 0, elem; (elem = elems[i]) != null; i++ ) {
		try {
			$( elem ).triggerHandler( "remove" );
		} catch( e ) {}
	}
	_cleanData( elems );
};
$.widget = function( name, base, prototype ) {
	var fullName, existingConstructor, constructor, basePrototype,
		namespace = name.split( "." )[ 0 ];
	name = name.split( "." )[ 1 ];
	fullName = namespace + "-" + name;
	if ( !prototype ) {
		prototype = base;
		base = $.Widget;
	}
	$.expr[ ":" ][ fullName.toLowerCase() ] = function( elem ) {
		return !!$.data( elem, fullName );
	};
	$[ namespace ] = $[ namespace ] || {};
	existingConstructor = $[ namespace ][ name ];
	constructor = $[ namespace ][ name ] = function( options, element ) {
		if ( !this._createWidget ) {
			return new constructor( options, element );
		}
		if ( arguments.length ) {
			this._createWidget( options, element );
		}
	};
	$.extend( constructor, existingConstructor, {
		version: prototype.version,
		_proto: $.extend( {}, prototype ),
		_childConstructors: []
	});
	basePrototype = new base();
	basePrototype.options = $.widget.extend( {}, basePrototype.options );
	$.each( prototype, function( prop, value ) {
		if ( $.isFunction( value ) ) {
			prototype[ prop ] = (function() {
				var _super = function() {
						return base.prototype[ prop ].apply( this, arguments );
					},
					_superApply = function( args ) {
						return base.prototype[ prop ].apply( this, args );
					};
				return function() {
					var __super = this._super,
						__superApply = this._superApply,
						returnValue;
					this._super = _super;
					this._superApply = _superApply;
					returnValue = value.apply( this, arguments );
					this._super = __super;
					this._superApply = __superApply;
					return returnValue;
				};
			})();
		}
	});
	constructor.prototype = $.widget.extend( basePrototype, {
		widgetEventPrefix: existingConstructor ? basePrototype.widgetEventPrefix : name
	}, prototype, {
		constructor: constructor,
		namespace: namespace,
		widgetName: name,
		widgetBaseClass: fullName,
		widgetFullName: fullName
	});
	if ( existingConstructor ) {
		$.each( existingConstructor._childConstructors, function( i, child ) {
			var childPrototype = child.prototype;
			$.widget( childPrototype.namespace + "." + childPrototype.widgetName, constructor, child._proto );
		});
		delete existingConstructor._childConstructors;
	} else {
		base._childConstructors.push( constructor );
	}
	$.widget.bridge( name, constructor );
};
$.widget.extend = function( target ) {
	var input = slice.call( arguments, 1 ),
		inputIndex = 0,
		inputLength = input.length,
		key,
		value;
	for ( ; inputIndex < inputLength; inputIndex++ ) {
		for ( key in input[ inputIndex ] ) {
			value = input[ inputIndex ][ key ];
			if ( input[ inputIndex ].hasOwnProperty( key ) && value !== undefined ) {
				if ( $.isPlainObject( value ) ) {
					target[ key ] = $.isPlainObject( target[ key ] ) ?
						$.widget.extend( {}, target[ key ], value ) :
						$.widget.extend( {}, value );
				} else {
					target[ key ] = value;
				}
			}
		}
	}
	return target;
};
$.widget.bridge = function( name, object ) {
	var fullName = object.prototype.widgetFullName || name;
	$.fn[ name ] = function( options ) {
		var isMethodCall = typeof options === "string",
			args = slice.call( arguments, 1 ),
			returnValue = this;
		options = !isMethodCall && args.length ?
			$.widget.extend.apply( null, [ options ].concat(args) ) :
			options;
		if ( isMethodCall ) {
			this.each(function() {
				var methodValue,
					instance = $.data( this, fullName );
				if ( !instance ) {
					return $.error( "cannot call methods on " + name + " prior to initialization; " +
						"attempted to call method '" + options + "'" );
				}
				if ( !$.isFunction( instance[options] ) || options.charAt( 0 ) === "_" ) {
					return $.error( "no such method '" + options + "' for " + name + " widget instance" );
				}
				methodValue = instance[ options ].apply( instance, args );
				if ( methodValue !== instance && methodValue !== undefined ) {
					returnValue = methodValue && methodValue.jquery ?
						returnValue.pushStack( methodValue.get() ) :
						methodValue;
					return false;
				}
			});
		} else {
			this.each(function() {
				var instance = $.data( this, fullName );
				if ( instance ) {
					instance.option( options || {} )._init();
				} else {
					$.data( this, fullName, new object( options, this ) );
				}
			});
		}
		return returnValue;
	};
};
$.Widget = function(  ) {};
$.Widget._childConstructors = [];
$.Widget.prototype = {
	widgetName: "widget",
	widgetEventPrefix: "",
	defaultElement: "<div>",
	options: {
		disabled: false,
		create: null
	},
	_createWidget: function( options, element ) {
		element = $( element || this.defaultElement || this )[ 0 ];
		this.element = $( element );
		this.uuid = uuid++;
		this.eventNamespace = "." + this.widgetName + this.uuid;
		this.options = $.widget.extend( {},
			this.options,
			this._getCreateOptions(),
			options );
		this.bindings = $();
		this.hoverable = $();
		this.focusable = $();
		if ( element !== this ) {
			$.data( element, this.widgetName, this );
			$.data( element, this.widgetFullName, this );
			this._on( true, this.element, {
				remove: function( event ) {
					if ( event.target === element ) {
						this.destroy();
					}
				}
			});
			this.document = $( element.style ?
				element.ownerDocument :
				element.document || element );
			this.window = $( this.document[0].defaultView || this.document[0].parentWindow );
		}
		this._create();
		this._trigger( "create", null, this._getCreateEventData() );
		this._init();
	},
	_getCreateOptions: $.noop,
	_getCreateEventData: $.noop,
	_create: $.noop,
	_init: $.noop,
	destroy: function() {
		this._destroy();
		this.element
			.unbind( this.eventNamespace )
			.removeData( this.widgetName )
			.removeData( this.widgetFullName )
			.removeData( $.camelCase( this.widgetFullName ) );
		this.widget()
			.unbind( this.eventNamespace )
			.removeAttr( "aria-disabled" )
			.removeClass(
				this.widgetFullName + "-disabled " +
				"ui-state-disabled" );
		this.bindings.unbind( this.eventNamespace );
		this.hoverable.removeClass( "ui-state-hover" );
		this.focusable.removeClass( "ui-state-focus" );
	},
	_destroy: $.noop,
	widget: function() {
		return this.element;
	},
	option: function( key, value ) {
		var options = key,
			parts,
			curOption,
			i;
		if ( arguments.length === 0 ) {
			return $.widget.extend( {}, this.options );
		}
		if ( typeof key === "string" ) {
			options = {};
			parts = key.split( "." );
			key = parts.shift();
			if ( parts.length ) {
				curOption = options[ key ] = $.widget.extend( {}, this.options[ key ] );
				for ( i = 0; i < parts.length - 1; i++ ) {
					curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};
					curOption = curOption[ parts[ i ] ];
				}
				key = parts.pop();
				if ( value === undefined ) {
					return curOption[ key ] === undefined ? null : curOption[ key ];
				}
				curOption[ key ] = value;
			} else {
				if ( value === undefined ) {
					return this.options[ key ] === undefined ? null : this.options[ key ];
				}
				options[ key ] = value;
			}
		}
		this._setOptions( options );
		return this;
	},
	_setOptions: function( options ) {
		var key;
		for ( key in options ) {
			this._setOption( key, options[ key ] );
		}
		return this;
	},
	_setOption: function( key, value ) {
		this.options[ key ] = value;
		if ( key === "disabled" ) {
			this.widget()
				.toggleClass( this.widgetFullName + "-disabled ui-state-disabled", !!value )
				.attr( "aria-disabled", value );
			this.hoverable.removeClass( "ui-state-hover" );
			this.focusable.removeClass( "ui-state-focus" );
		}
		return this;
	},
	enable: function() {
		return this._setOption( "disabled", false );
	},
	disable: function() {
		return this._setOption( "disabled", true );
	},
	_on: function( suppressDisabledCheck, element, handlers ) {
		var delegateElement,
			instance = this;
		if ( typeof suppressDisabledCheck !== "boolean" ) {
			handlers = element;
			element = suppressDisabledCheck;
			suppressDisabledCheck = false;
		}
		if ( !handlers ) {
			handlers = element;
			element = this.element;
			delegateElement = this.widget();
		} else {
			element = delegateElement = $( element );
			this.bindings = this.bindings.add( element );
		}
		$.each( handlers, function( event, handler ) {
			function handlerProxy() {
				if ( !suppressDisabledCheck &&
						( instance.options.disabled === true ||
							$( this ).hasClass( "ui-state-disabled" ) ) ) {
					return;
				}
				return ( typeof handler === "string" ? instance[ handler ] : handler )
					.apply( instance, arguments );
			}
			if ( typeof handler !== "string" ) {
				handlerProxy.guid = handler.guid =
					handler.guid || handlerProxy.guid || $.guid++;
			}
var match = event.match( /^(\w+)\s*(.*)$/ ),
				eventName = match[1] + instance.eventNamespace,
				selector = match[2];
			if ( selector ) {
				delegateElement.delegate( selector, eventName, handlerProxy );
			} else {
				element.bind( eventName, handlerProxy );
			}
		});
	},
	_off: function( element, eventName ) {
		eventName = (eventName || "").split( " " ).join( this.eventNamespace + " " ) + this.eventNamespace;
		element.unbind( eventName ).undelegate( eventName );
	},
	_delay: function( handler, delay ) {
		function handlerProxy() {
			return ( typeof handler === "string" ? instance[ handler ] : handler )
				.apply( instance, arguments );
		}
		var instance = this;
		return setTimeout( handlerProxy, delay || 0 );
	},
	_hoverable: function( element ) {
		this.hoverable = this.hoverable.add( element );
		this._on( element, {
			mouseenter: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-hover" );
			},
			mouseleave: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-hover" );
			}
		});
	},
	_focusable: function( element ) {
		this.focusable = this.focusable.add( element );
		this._on( element, {
			focusin: function( event ) {
				$( event.currentTarget ).addClass( "ui-state-focus" );
			},
			focusout: function( event ) {
				$( event.currentTarget ).removeClass( "ui-state-focus" );
			}
		});
	},
	_trigger: function( type, event, data ) {
		var prop, orig,
			callback = this.options[ type ];
		data = data || {};
		event = $.Event( event );
		event.type = ( type === this.widgetEventPrefix ?
			type :
			this.widgetEventPrefix + type ).toLowerCase();
		event.target = this.element[ 0 ];
		orig = event.originalEvent;
		if ( orig ) {
			for ( prop in orig ) {
				if ( !( prop in event ) ) {
					event[ prop ] = orig[ prop ];
				}
			}
		}
		this.element.trigger( event, data );
		return !( $.isFunction( callback ) &&
			callback.apply( this.element[0], [ event ].concat( data ) ) === false ||
			event.isDefaultPrevented() );
	}
};
$.each( { show: "fadeIn", hide: "fadeOut" }, function( method, defaultEffect ) {
	$.Widget.prototype[ "_" + method ] = function( element, options, callback ) {
		if ( typeof options === "string" ) {
			options = { effect: options };
		}
		var hasOptions,
			effectName = !options ?
				method :
				options === true || typeof options === "number" ?
					defaultEffect :
					options.effect || defaultEffect;
		options = options || {};
		if ( typeof options === "number" ) {
			options = { duration: options };
		}
		hasOptions = !$.isEmptyObject( options );
		options.complete = callback;
		if ( options.delay ) {
			element.delay( options.delay );
		}
		if ( hasOptions && $.effects && ( $.effects.effect[ effectName ] || $.uiBackCompat !== false && $.effects[ effectName ] ) ) {
			element[ method ]( options );
		} else if ( effectName !== method && element[ effectName ] ) {
			element[ effectName ]( options.duration, options.easing, callback );
		} else {
			element.queue(function( next ) {
				$( this )[ method ]();
				if ( callback ) {
					callback.call( element[ 0 ] );
				}
				next();
			});
		}
	};
});
if ( $.uiBackCompat !== false ) {
	$.Widget.prototype._getCreateOptions = function() {
		return $.metadata && $.metadata.get( this.element[0] )[ this.widgetName ];
	};
}
})( jQuery );
(function( $, undefined ) {
$.ui = $.ui || {};
var cachedScrollbarWidth,
	max = Math.max,
	abs = Math.abs,
	round = Math.round,
rhorizontal = /left|center|right/,
rvertical = /top|center|bottom/,
roffset = /[\+\-]\d+%?/,
rposition = /^\w+/,
rpercent = /%$/,
	_position = $.fn.position;
function getOffsets( offsets, width, height ) {
	return [
parseInt( offsets[ 0 ], 10 ) * ( rpercent.test( offsets[ 0 ] ) ? width / 100 : 1 ),
parseInt( offsets[ 1 ], 10 ) * ( rpercent.test( offsets[ 1 ] ) ? height / 100 : 1 )
	];
}
function parseCss( element, property ) {
	return parseInt( $.css( element, property ), 10 ) || 0;
}
$.position = {
	scrollbarWidth: function() {
		if ( cachedScrollbarWidth !== undefined ) {
			return cachedScrollbarWidth;
		}
		var w1, w2,
div = $( "<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>" ),
			innerDiv = div.children()[0];
		$( "body" ).append( div );
		w1 = innerDiv.offsetWidth;
		div.css( "overflow", "scroll" );
		w2 = innerDiv.offsetWidth;
		if ( w1 === w2 ) {
			w2 = div[0].clientWidth;
		}
		div.remove();
		return (cachedScrollbarWidth = w1 - w2);
	},
	getScrollInfo: function( within ) {
		var overflowX = within.isWindow ? "" : within.element.css( "overflow-x" ),
			overflowY = within.isWindow ? "" : within.element.css( "overflow-y" ),
			hasOverflowX = overflowX === "scroll" ||
				( overflowX === "auto" && within.width < within.element[0].scrollWidth ),
			hasOverflowY = overflowY === "scroll" ||
				( overflowY === "auto" && within.height < within.element[0].scrollHeight );
		return {
			width: hasOverflowX ? $.position.scrollbarWidth() : 0,
			height: hasOverflowY ? $.position.scrollbarWidth() : 0
		};
	},
	getWithinInfo: function( element ) {
		var withinElement = $( element || window ),
			isWindow = $.isWindow( withinElement[0] );
		return {
			element: withinElement,
			isWindow: isWindow,
			offset: withinElement.offset() || { left: 0, top: 0 },
			scrollLeft: withinElement.scrollLeft(),
			scrollTop: withinElement.scrollTop(),
			width: isWindow ? withinElement.width() : withinElement.outerWidth(),
			height: isWindow ? withinElement.height() : withinElement.outerHeight()
		};
	}
};
$.fn.position = function( options ) {
	if ( !options || !options.of ) {
		return _position.apply( this, arguments );
	}
	options = $.extend( {}, options );
	var atOffset, targetWidth, targetHeight, targetOffset, basePosition,
		target = typeof options.of === "string" ?
			$( document ).find( options.of ) :
			$( options.of ),
		within = $.position.getWithinInfo( options.within ),
		scrollInfo = $.position.getScrollInfo( within ),
		targetElem = target[0],
		collision = ( options.collision || "flip" ).split( " " ),
		offsets = {};
	if ( targetElem.nodeType === 9 ) {
		targetWidth = target.width();
		targetHeight = target.height();
		targetOffset = { top: 0, left: 0 };
	} else if ( $.isWindow( targetElem ) ) {
		targetWidth = target.width();
		targetHeight = target.height();
		targetOffset = { top: target.scrollTop(), left: target.scrollLeft() };
	} else if ( targetElem.preventDefault ) {
		options.at = "left top";
		targetWidth = targetHeight = 0;
		targetOffset = { top: targetElem.pageY, left: targetElem.pageX };
	} else {
		targetWidth = target.outerWidth();
		targetHeight = target.outerHeight();
		targetOffset = target.offset();
	}
	basePosition = $.extend( {}, targetOffset );
	$.each( [ "my", "at" ], function() {
		var pos = ( options[ this ] || "" ).split( " " ),
			horizontalOffset,
			verticalOffset;
		if ( pos.length === 1) {
			pos = rhorizontal.test( pos[ 0 ] ) ?
				pos.concat( [ "center" ] ) :
				rvertical.test( pos[ 0 ] ) ?
					[ "center" ].concat( pos ) :
					[ "center", "center" ];
		}
		pos[ 0 ] = rhorizontal.test( pos[ 0 ] ) ? pos[ 0 ] : "center";
		pos[ 1 ] = rvertical.test( pos[ 1 ] ) ? pos[ 1 ] : "center";
		horizontalOffset = roffset.exec( pos[ 0 ] );
		verticalOffset = roffset.exec( pos[ 1 ] );
		offsets[ this ] = [
			horizontalOffset ? horizontalOffset[ 0 ] : 0,
			verticalOffset ? verticalOffset[ 0 ] : 0
		];
		options[ this ] = [
			rposition.exec( pos[ 0 ] )[ 0 ],
			rposition.exec( pos[ 1 ] )[ 0 ]
		];
	});
	if ( collision.length === 1 ) {
		collision[ 1 ] = collision[ 0 ];
	}
	if ( options.at[ 0 ] === "right" ) {
		basePosition.left += targetWidth;
	} else if ( options.at[ 0 ] === "center" ) {
basePosition.left += targetWidth / 2;
	}
	if ( options.at[ 1 ] === "bottom" ) {
		basePosition.top += targetHeight;
	} else if ( options.at[ 1 ] === "center" ) {
basePosition.top += targetHeight / 2;
	}
	atOffset = getOffsets( offsets.at, targetWidth, targetHeight );
	basePosition.left += atOffset[ 0 ];
	basePosition.top += atOffset[ 1 ];
	return this.each(function() {
		var collisionPosition, using,
			elem = $( this ),
			elemWidth = elem.outerWidth(),
			elemHeight = elem.outerHeight(),
			marginLeft = parseCss( this, "marginLeft" ),
			marginTop = parseCss( this, "marginTop" ),
			collisionWidth = elemWidth + marginLeft + parseCss( this, "marginRight" ) + scrollInfo.width,
			collisionHeight = elemHeight + marginTop + parseCss( this, "marginBottom" ) + scrollInfo.height,
			position = $.extend( {}, basePosition ),
			myOffset = getOffsets( offsets.my, elem.outerWidth(), elem.outerHeight() );
		if ( options.my[ 0 ] === "right" ) {
			position.left -= elemWidth;
		} else if ( options.my[ 0 ] === "center" ) {
position.left -= elemWidth / 2;
		}
		if ( options.my[ 1 ] === "bottom" ) {
			position.top -= elemHeight;
		} else if ( options.my[ 1 ] === "center" ) {
position.top -= elemHeight / 2;
		}
		position.left += myOffset[ 0 ];
		position.top += myOffset[ 1 ];
		if ( !$.support.offsetFractions ) {
			position.left = round( position.left );
			position.top = round( position.top );
		}
		collisionPosition = {
			marginLeft: marginLeft,
			marginTop: marginTop
		};
		$.each( [ "left", "top" ], function( i, dir ) {
			if ( $.ui.position[ collision[ i ] ] ) {
				$.ui.position[ collision[ i ] ][ dir ]( position, {
					targetWidth: targetWidth,
					targetHeight: targetHeight,
					elemWidth: elemWidth,
					elemHeight: elemHeight,
					collisionPosition: collisionPosition,
					collisionWidth: collisionWidth,
					collisionHeight: collisionHeight,
					offset: [ atOffset[ 0 ] + myOffset[ 0 ], atOffset [ 1 ] + myOffset[ 1 ] ],
					my: options.my,
					at: options.at,
					within: within,
					elem : elem
				});
			}
		});
		if ( $.fn.bgiframe ) {
			elem.bgiframe();
		}
		if ( options.using ) {
			using = function( props ) {
				var left = targetOffset.left - position.left,
					right = left + targetWidth - elemWidth,
					top = targetOffset.top - position.top,
					bottom = top + targetHeight - elemHeight,
					feedback = {
						target: {
							element: target,
							left: targetOffset.left,
							top: targetOffset.top,
							width: targetWidth,
							height: targetHeight
						},
						element: {
							element: elem,
							left: position.left,
							top: position.top,
							width: elemWidth,
							height: elemHeight
						},
						horizontal: right < 0 ? "left" : left > 0 ? "right" : "center",
						vertical: bottom < 0 ? "top" : top > 0 ? "bottom" : "middle"
					};
				if ( targetWidth < elemWidth && abs( left + right ) < targetWidth ) {
					feedback.horizontal = "center";
				}
				if ( targetHeight < elemHeight && abs( top + bottom ) < targetHeight ) {
					feedback.vertical = "middle";
				}
				if ( max( abs( left ), abs( right ) ) > max( abs( top ), abs( bottom ) ) ) {
					feedback.important = "horizontal";
				} else {
					feedback.important = "vertical";
				}
				options.using.call( this, props, feedback );
			};
		}
		elem.offset( $.extend( position, { using: using } ) );
	});
};
$.ui.position = {
	fit: {
		left: function( position, data ) {
			var within = data.within,
				withinOffset = within.isWindow ? within.scrollLeft : within.offset.left,
				outerWidth = within.width,
				collisionPosLeft = position.left - data.collisionPosition.marginLeft,
				overLeft = withinOffset - collisionPosLeft,
				overRight = collisionPosLeft + data.collisionWidth - outerWidth - withinOffset,
				newOverRight;
			if ( data.collisionWidth > outerWidth ) {
				if ( overLeft > 0 && overRight <= 0 ) {
					newOverRight = position.left + overLeft + data.collisionWidth - outerWidth - withinOffset;
					position.left += overLeft - newOverRight;
				} else if ( overRight > 0 && overLeft <= 0 ) {
					position.left = withinOffset;
				} else {
					if ( overLeft > overRight ) {
						position.left = withinOffset + outerWidth - data.collisionWidth;
					} else {
						position.left = withinOffset;
					}
				}
			} else if ( overLeft > 0 ) {
				position.left += overLeft;
			} else if ( overRight > 0 ) {
				position.left -= overRight;
			} else {
				position.left = max( position.left - collisionPosLeft, position.left );
			}
		},
		top: function( position, data ) {
			var within = data.within,
				withinOffset = within.isWindow ? within.scrollTop : within.offset.top,
				outerHeight = data.within.height,
				collisionPosTop = position.top - data.collisionPosition.marginTop,
				overTop = withinOffset - collisionPosTop,
				overBottom = collisionPosTop + data.collisionHeight - outerHeight - withinOffset,
				newOverBottom;
			if ( data.collisionHeight > outerHeight ) {
				if ( overTop > 0 && overBottom <= 0 ) {
					newOverBottom = position.top + overTop + data.collisionHeight - outerHeight - withinOffset;
					position.top += overTop - newOverBottom;
				} else if ( overBottom > 0 && overTop <= 0 ) {
					position.top = withinOffset;
				} else {
					if ( overTop > overBottom ) {
						position.top = withinOffset + outerHeight - data.collisionHeight;
					} else {
						position.top = withinOffset;
					}
				}
			} else if ( overTop > 0 ) {
				position.top += overTop;
			} else if ( overBottom > 0 ) {
				position.top -= overBottom;
			} else {
				position.top = max( position.top - collisionPosTop, position.top );
			}
		}
	},
	flip: {
		left: function( position, data ) {
			var within = data.within,
				withinOffset = within.offset.left + within.scrollLeft,
				outerWidth = within.width,
				offsetLeft = within.isWindow ? within.scrollLeft : within.offset.left,
				collisionPosLeft = position.left - data.collisionPosition.marginLeft,
				overLeft = collisionPosLeft - offsetLeft,
				overRight = collisionPosLeft + data.collisionWidth - outerWidth - offsetLeft,
				myOffset = data.my[ 0 ] === "left" ?
					-data.elemWidth :
					data.my[ 0 ] === "right" ?
						data.elemWidth :
						0,
				atOffset = data.at[ 0 ] === "left" ?
					data.targetWidth :
					data.at[ 0 ] === "right" ?
						-data.targetWidth :
						0,
				offset = -2 * data.offset[ 0 ],
				newOverRight,
				newOverLeft;
			if ( overLeft < 0 ) {
				newOverRight = position.left + myOffset + atOffset + offset + data.collisionWidth - outerWidth - withinOffset;
				if ( newOverRight < 0 || newOverRight < abs( overLeft ) ) {
					position.left += myOffset + atOffset + offset;
				}
			}
			else if ( overRight > 0 ) {
				newOverLeft = position.left - data.collisionPosition.marginLeft + myOffset + atOffset + offset - offsetLeft;
				if ( newOverLeft > 0 || abs( newOverLeft ) < overRight ) {
					position.left += myOffset + atOffset + offset;
				}
			}
		},
		top: function( position, data ) {
			var within = data.within,
				withinOffset = within.offset.top + within.scrollTop,
				outerHeight = within.height,
				offsetTop = within.isWindow ? within.scrollTop : within.offset.top,
				collisionPosTop = position.top - data.collisionPosition.marginTop,
				overTop = collisionPosTop - offsetTop,
				overBottom = collisionPosTop + data.collisionHeight - outerHeight - offsetTop,
				top = data.my[ 1 ] === "top",
				myOffset = top ?
					-data.elemHeight :
					data.my[ 1 ] === "bottom" ?
						data.elemHeight :
						0,
				atOffset = data.at[ 1 ] === "top" ?
					data.targetHeight :
					data.at[ 1 ] === "bottom" ?
						-data.targetHeight :
						0,
				offset = -2 * data.offset[ 1 ],
				newOverTop,
				newOverBottom;
			if ( overTop < 0 ) {
				newOverBottom = position.top + myOffset + atOffset + offset + data.collisionHeight - outerHeight - withinOffset;
				if ( ( position.top + myOffset + atOffset + offset) > overTop && ( newOverBottom < 0 || newOverBottom < abs( overTop ) ) ) {
					position.top += myOffset + atOffset + offset;
				}
			}
			else if ( overBottom > 0 ) {
				newOverTop = position.top -  data.collisionPosition.marginTop + myOffset + atOffset + offset - offsetTop;
				if ( ( position.top + myOffset + atOffset + offset) > overBottom && ( newOverTop > 0 || abs( newOverTop ) < overBottom ) ) {
					position.top += myOffset + atOffset + offset;
				}
			}
		}
	},
	flipfit: {
		left: function() {
			$.ui.position.flip.left.apply( this, arguments );
			$.ui.position.fit.left.apply( this, arguments );
		},
		top: function() {
			$.ui.position.flip.top.apply( this, arguments );
			$.ui.position.fit.top.apply( this, arguments );
		}
	}
};
(function () {
	var testElement, testElementParent, testElementStyle, offsetLeft, i,
		body = document.getElementsByTagName( "body" )[ 0 ],
		div = document.createElement( "div" );
	testElement = document.createElement( body ? "div" : "body" );
	testElementStyle = {
		visibility: "hidden",
		width: 0,
		height: 0,
		border: 0,
		margin: 0,
		background: "none"
	};
	if ( body ) {
		$.extend( testElementStyle, {
			position: "absolute",
			left: "-1000px",
			top: "-1000px"
		});
	}
	for ( i in testElementStyle ) {
		testElement.style[ i ] = testElementStyle[ i ];
	}
	testElement.appendChild( div );
	testElementParent = body || document.documentElement;
	testElementParent.insertBefore( testElement, testElementParent.firstChild );
	div.style.cssText = "position: absolute; left: 10.7432222px;";
	offsetLeft = $( div ).offset().left;
	$.support.offsetFractions = offsetLeft > 10 && offsetLeft < 11;
	testElement.innerHTML = "";
	testElementParent.removeChild( testElement );
})();
if ( $.uiBackCompat !== false ) {
	(function( $ ) {
		var _position = $.fn.position;
		$.fn.position = function( options ) {
			if ( !options || !options.offset ) {
				return _position.call( this, options );
			}
			var offset = options.offset.split( " " ),
				at = options.at.split( " " );
			if ( offset.length === 1 ) {
				offset[ 1 ] = offset[ 0 ];
			}
if ( /^\d/.test( offset[ 0 ] ) ) {
				offset[ 0 ] = "+" + offset[ 0 ];
			}
if ( /^\d/.test( offset[ 1 ] ) ) {
				offset[ 1 ] = "+" + offset[ 1 ];
			}
			if ( at.length === 1 ) {
if ( /left|center|right/.test( at[ 0 ] ) ) {
					at[ 1 ] = "center";
				} else {
					at[ 1 ] = at[ 0 ];
					at[ 0 ] = "center";
				}
			}
			return _position.call( this, $.extend( options, {
				at: at[ 0 ] + offset[ 0 ] + " " + at[ 1 ] + offset[ 1 ],
				offset: undefined
			} ) );
		};
	}( jQuery ) );
}
}( jQuery ) );
(function( $, undefined ) {
var requestIndex = 0;
$.widget( "ui.autocomplete", {
	version: "1.9.2-snc",
	defaultElement: "<input>",
	options: {
		appendTo: "body",
		autoFocus: false,
		delay: 300,
		minLength: 1,
		position: {
			my: "left top",
			at: "left bottom",
			collision: "none"
		},
		source: null,
		change: null,
		close: null,
		focus: null,
		open: null,
		response: null,
		search: null,
		select: null
	},
	pending: 0,
	_create: function() {
		var suppressKeyPress, suppressKeyPressRepeat, suppressInput;
		this.isMultiLine = this._isMultiLine();
		this.valueMethod = this.element[ this.element.is( "input,textarea" ) ? "val" : "text" ];
		this.isNewMenu = true;
		this.element
			.addClass( "ui-autocomplete-input" )
			.attr( "autocomplete", "off" );
		this._on( this.element, {
			keydown: function( event ) {
				if ( this.element.prop( "readOnly" ) ) {
					suppressKeyPress = true;
					suppressInput = true;
					suppressKeyPressRepeat = true;
					return;
				}
				suppressKeyPress = false;
				suppressInput = false;
				suppressKeyPressRepeat = false;
				var keyCode = $.ui.keyCode;
				switch( event.keyCode ) {
				case keyCode.PAGE_UP:
					suppressKeyPress = true;
					this._move( "previousPage", event );
					break;
				case keyCode.PAGE_DOWN:
					suppressKeyPress = true;
					this._move( "nextPage", event );
					break;
				case keyCode.UP:
					suppressKeyPress = true;
					this._keyEvent( "previous", event );
					break;
				case keyCode.DOWN:
					suppressKeyPress = true;
					this._keyEvent( "next", event );
					break;
				case keyCode.ENTER:
				case keyCode.NUMPAD_ENTER:
					if ( this.menu.active ) {
						suppressKeyPress = true;
						event.preventDefault();
						this.menu.select( event );
					}
					break;
				case keyCode.TAB:
					if ( this.menu.active ) {
						this.menu.select( event );
					}
					break;
				case keyCode.ESCAPE:
					if ( this.menu.element.is( ":visible" ) ) {
						this._value( this.term );
						this.close( event );
						event.preventDefault();
					}
					break;
				default:
					suppressKeyPressRepeat = true;
					this._searchTimeout( event );
					break;
				}
			},
			keypress: function( event ) {
				if ( suppressKeyPress ) {
					suppressKeyPress = false;
					event.preventDefault();
					return;
				}
				if ( suppressKeyPressRepeat ) {
					return;
				}
				var keyCode = $.ui.keyCode;
				switch( event.keyCode ) {
				case keyCode.PAGE_UP:
					this._move( "previousPage", event );
					break;
				case keyCode.PAGE_DOWN:
					this._move( "nextPage", event );
					break;
				case keyCode.UP:
					this._keyEvent( "previous", event );
					break;
				case keyCode.DOWN:
					this._keyEvent( "next", event );
					break;
				}
			},
			input: function( event ) {
				if ( suppressInput ) {
					suppressInput = false;
					event.preventDefault();
					return;
				}
				this._searchTimeout( event );
			},
			focus: function() {
				this.selectedItem = null;
				this.previous = this._value();
			},
			blur: function( event ) {
				if ( this.cancelBlur ) {
					delete this.cancelBlur;
					return;
				}
				clearTimeout( this.searching );
				this.close( event );
				this._change( event );
			}
		});
		this._initSource();
		this.menu = $( "<ul>" )
			.addClass( "ui-autocomplete" )
			.appendTo( this.document.find( this.options.appendTo || "body" )[ 0 ] )
			.menu({
				input: $(),
				role: null
			})
			.zIndex( this.element.zIndex() + 1 )
			.hide()
			.data( "menu" );
		this._on( this.menu.element, {
			mousedown: function( event ) {
				event.preventDefault();
				this.cancelBlur = true;
				this._delay(function() {
					delete this.cancelBlur;
				});
				var menuElement = this.menu.element[ 0 ];
				if ( !$( event.target ).closest( ".ui-menu-item" ).length ) {
					this._delay(function() {
						var that = this;
						this.document.one( "mousedown", function( event ) {
							if ( event.target !== that.element[ 0 ] &&
									event.target !== menuElement &&
									!$.contains( menuElement, event.target ) ) {
								that.close();
							}
						});
					});
				}
			},
			menufocus: function( event, ui ) {
				if ( this.isNewMenu ) {
					this.isNewMenu = false;
if ( event.originalEvent && /^mouse/.test( event.originalEvent.type ) ) {
						this.menu.blur();
						this.document.one( "mousemove", function() {
							$( event.target ).trigger( event.originalEvent );
						});
						return;
					}
				}
				var item = ui.item.data( "ui-autocomplete-item" ) || ui.item.data( "item.autocomplete" );
				if ( false !== this._trigger( "focus", event, { item: item } ) ) {
if ( event.originalEvent && /^key/.test( event.originalEvent.type ) ) {
						this._value( item.value );
					}
				} else {
					this.liveRegion.text( item.value );
				}
			},
			menuselect: function( event, ui ) {
				var item = ui.item.data( "ui-autocomplete-item" ) || ui.item.data( "item.autocomplete" ),
					previous = this.previous;
				if ( this.element[0] !== this.document[0].activeElement ) {
					this.element.focus();
					this.previous = previous;
					this._delay(function() {
						this.previous = previous;
						this.selectedItem = item;
					});
				}
				if ( false !== this._trigger( "select", event, { item: item } ) ) {
					this._value( item.value );
				}
				this.term = this._value();
				this.close( event );
				this.selectedItem = item;
			}
		});
		this.liveRegion = $( "<span>", {
				role: "status",
				"aria-live": "polite"
			})
			.addClass( "ui-helper-hidden-accessible" )
			.insertAfter( this.element );
		if ( $.fn.bgiframe ) {
			this.menu.element.bgiframe();
		}
		this._on( this.window, {
			beforeunload: function() {
				this.element.removeAttr( "autocomplete" );
			}
		});
	},
	_destroy: function() {
		clearTimeout( this.searching );
		this.element
			.removeClass( "ui-autocomplete-input" )
			.removeAttr( "autocomplete" );
		this.menu.element.remove();
		this.liveRegion.remove();
	},
	_setOption: function( key, value ) {
		this._super( key, value );
		if ( key === "source" ) {
			this._initSource();
		}
		if ( key === "appendTo" ) {
			this.menu.element.appendTo( this.document.find( value || "body" )[0] );
		}
		if ( key === "disabled" && value && this.xhr ) {
			this.xhr.abort();
		}
	},
	_isMultiLine: function() {
		if ( this.element.is( "textarea" ) ) {
			return true;
		}
		if ( this.element.is( "input" ) ) {
			return false;
		}
		return this.element.prop( "isContentEditable" );
	},
	_initSource: function() {
		var array, url,
			that = this;
		if ( $.isArray(this.options.source) ) {
			array = this.options.source;
			this.source = function( request, response ) {
				response( $.ui.autocomplete.filter( array, request.term ) );
			};
		} else if ( typeof this.options.source === "string" ) {
			url = this.options.source;
			this.source = function( request, response ) {
				if ( that.xhr ) {
					that.xhr.abort();
				}
				that.xhr = $.ajax({
					url: url,
					data: request,
					dataType: "json",
					success: function( data ) {
						response( data );
					},
					error: function() {
						response( [] );
					}
				});
			};
		} else {
			this.source = this.options.source;
		}
	},
	_searchTimeout: function( event ) {
		clearTimeout( this.searching );
		this.searching = this._delay(function() {
			if ( this.term !== this._value() ) {
				this.selectedItem = null;
				this.search( null, event );
			}
		}, this.options.delay );
	},
	search: function( value, event ) {
		value = value != null ? value : this._value();
		this.term = this._value();
		if ( value.length < this.options.minLength ) {
			return this.close( event );
		}
		if ( this._trigger( "search", event ) === false ) {
			return;
		}
		return this._search( value );
	},
	_search: function( value ) {
		this.pending++;
		this.element.addClass( "ui-autocomplete-loading" );
		this.cancelSearch = false;
		this.source( { term: value }, this._response() );
	},
	_response: function() {
		var that = this,
			index = ++requestIndex;
		return function( content ) {
			if ( index === requestIndex ) {
				that.__response( content );
			}
			that.pending--;
			if ( !that.pending ) {
				that.element.removeClass( "ui-autocomplete-loading" );
			}
		};
	},
	__response: function( content ) {
		if ( content ) {
			content = this._normalize( content );
		}
		this._trigger( "response", null, { content: content } );
		if ( !this.options.disabled && content && content.length && !this.cancelSearch ) {
			this._suggest( content );
			this._trigger( "open" );
		} else {
			this._close();
		}
	},
	close: function( event ) {
		this.cancelSearch = true;
		this._close( event );
	},
	_close: function( event ) {
		if ( this.menu.element.is( ":visible" ) ) {
			this.menu.element.hide();
			this.menu.blur();
			this.isNewMenu = true;
			this._trigger( "close", event );
		}
	},
	_change: function( event ) {
		if ( this.previous !== this._value() ) {
			this._trigger( "change", event, { item: this.selectedItem } );
		}
	},
	_normalize: function( items ) {
		if ( items.length && items[0].label && items[0].value ) {
			return items;
		}
		return $.map( items, function( item ) {
			if ( typeof item === "string" ) {
				return {
					label: item,
					value: item
				};
			}
			return $.extend({
				label: item.label || item.value,
				value: item.value || item.label
			}, item );
		});
	},
	_suggest: function( items ) {
		var ul = this.menu.element
			.empty()
			.zIndex( this.element.zIndex() + 1 );
		this._renderMenu( ul, items );
		this.menu.refresh();
		ul.show();
		this._resizeMenu();
		ul.position( $.extend({
			of: this.element
		}, this.options.position ));
		if ( this.options.autoFocus ) {
			this.menu.next();
		}
	},
	_resizeMenu: function() {
		var ul = this.menu.element;
		ul.outerWidth( Math.max(
			ul.width( "" ).outerWidth() + 1,
			this.element.outerWidth()
		) );
	},
	_renderMenu: function( ul, items ) {
		var that = this;
		$.each( items, function( index, item ) {
			that._renderItemData( ul, item );
		});
	},
	_renderItemData: function( ul, item ) {
		return this._renderItem( ul, item ).data( "ui-autocomplete-item", item );
	},
	_renderItem: function( ul, item ) {
		return $( "<li>" )
			.append( $( "<a>" ).text( item.label ) )
			.appendTo( ul );
	},
	_move: function( direction, event ) {
		if ( !this.menu.element.is( ":visible" ) ) {
			this.search( null, event );
			return;
		}
if ( this.menu.isFirstItem() && /^previous/.test( direction ) ||
this.menu.isLastItem() && /^next/.test( direction ) ) {
			this._value( this.term );
			this.menu.blur();
			return;
		}
		this.menu[ direction ]( event );
	},
	widget: function() {
		return this.menu.element;
	},
	_value: function() {
		return this.valueMethod.apply( this.element, arguments );
	},
	_keyEvent: function( keyEvent, event ) {
		if ( !this.isMultiLine || this.menu.element.is( ":visible" ) ) {
			this._move( keyEvent, event );
			event.preventDefault();
		}
	}
});
$.extend( $.ui.autocomplete, {
	escapeRegex: function( value ) {
return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&");
	},
	filter: function(array, term) {
		var matcher = new RegExp( $.ui.autocomplete.escapeRegex(term), "i" );
		return $.grep( array, function(value) {
			return matcher.test( value.label || value.value || value );
		});
	}
});
$.widget( "ui.autocomplete", $.ui.autocomplete, {
	options: {
		messages: {
			noResults: "No search results.",
			results: function( amount ) {
				return amount + ( amount > 1 ? " results are" : " result is" ) +
					" available, use up and down arrow keys to navigate.";
			}
		}
	},
	__response: function( content ) {
		var message;
		this._superApply( arguments );
		if ( this.options.disabled || this.cancelSearch ) {
			return;
		}
		if ( content && content.length ) {
			message = this.options.messages.results( content.length );
		} else {
			message = this.options.messages.noResults;
		}
		this.liveRegion.text( message );
	}
});
}( jQuery ));
(function( $, undefined ) {
var mouseHandled = false;
$.widget( "ui.menu", {
	version: "1.9.2-snc",
	defaultElement: "<ul>",
	delay: 300,
	options: {
		icons: {
			submenu: "ui-icon-carat-1-e"
		},
		menus: "ul",
		position: {
			my: "left top",
			at: "right top"
		},
		role: "menu",
		blur: null,
		focus: null,
		select: null
	},
	_create: function() {
		this.activeMenu = this.element;
		this.element
			.uniqueId()
			.addClass( "ui-menu ui-widget ui-widget-content ui-corner-all" )
			.toggleClass( "ui-menu-icons", !!this.element.find( ".ui-icon" ).length )
			.attr({
				role: this.options.role,
				tabIndex: 0
			})
			.bind( "click" + this.eventNamespace, $.proxy(function( event ) {
				if ( this.options.disabled ) {
					event.preventDefault();
				}
			}, this ));
		if ( this.options.disabled ) {
			this.element
				.addClass( "ui-state-disabled" )
				.attr( "aria-disabled", "true" );
		}
		this._on({
			"mousedown .ui-menu-item > a": function( event ) {
				event.preventDefault();
			},
			"click .ui-state-disabled > a": function( event ) {
				event.preventDefault();
			},
			"click .ui-menu-item:has(a)": function( event ) {
				var target = $( event.target ).closest( ".ui-menu-item" );
				if ( !mouseHandled && target.not( ".ui-state-disabled" ).length ) {
					mouseHandled = true;
					this.select( event );
					if ( target.has( ".ui-menu" ).length ) {
						this.expand( event );
					} else if ( !this.element.is( ":focus" ) ) {
						this.element.trigger( "focus", [ true ] );
						if ( this.active && this.active.parents( ".ui-menu" ).length === 1 ) {
							clearTimeout( this.timer );
						}
					}
				}
			},
			"mouseenter .ui-menu-item": function( event ) {
				var target = $( event.currentTarget );
				target.siblings().children( ".ui-state-active" ).removeClass( "ui-state-active" );
				this.focus( event, target );
			},
			mouseleave: "collapseAll",
			"mouseleave .ui-menu": "collapseAll",
			focus: function( event, keepActiveItem ) {
				var item = this.active || this.element.children( ".ui-menu-item" ).eq( 0 );
				if ( !keepActiveItem ) {
					this.focus( event, item );
				}
			},
			blur: function( event ) {
				this._delay(function() {
					if ( !$.contains( this.element[0], this.document[0].activeElement ) ) {
						this.collapseAll( event );
					}
				});
			},
			keydown: "_keydown"
		});
		this.refresh();
		this._on( this.document, {
			click: function( event ) {
				if ( !$( event.target ).closest( ".ui-menu" ).length ) {
					this.collapseAll( event );
				}
				mouseHandled = false;
			}
		});
	},
	_destroy: function() {
		this.element
			.removeAttr( "aria-activedescendant" )
			.find( ".ui-menu" ).andSelf()
				.removeClass( "ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons" )
				.removeAttr( "role" )
				.removeAttr( "tabIndex" )
				.removeAttr( "aria-labelledby" )
				.removeAttr( "aria-expanded" )
				.removeAttr( "aria-hidden" )
				.removeAttr( "aria-disabled" )
				.removeUniqueId()
				.show();
		this.element.find( ".ui-menu-item" )
			.removeClass( "ui-menu-item" )
			.removeAttr( "role" )
			.removeAttr( "aria-disabled" )
			.children( "a" )
				.removeUniqueId()
				.removeClass( "ui-corner-all ui-state-hover" )
				.removeAttr( "tabIndex" )
				.removeAttr( "role" )
				.removeAttr( "aria-haspopup" )
				.children().each( function() {
					var elem = $( this );
					if ( elem.data( "ui-menu-submenu-carat" ) ) {
						elem.remove();
					}
				});
		this.element.find( ".ui-menu-divider" ).removeClass( "ui-menu-divider ui-widget-content" );
	},
	_keydown: function( event ) {
		var match, prev, character, skip, regex,
			preventDefault = true;
		function escape( value ) {
return value.replace( /[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&" );
		}
		switch ( event.keyCode ) {
		case $.ui.keyCode.PAGE_UP:
			this.previousPage( event );
			break;
		case $.ui.keyCode.PAGE_DOWN:
			this.nextPage( event );
			break;
		case $.ui.keyCode.HOME:
			this._move( "first", "first", event );
			break;
		case $.ui.keyCode.END:
			this._move( "last", "last", event );
			break;
		case $.ui.keyCode.UP:
			this.previous( event );
			break;
		case $.ui.keyCode.DOWN:
			this.next( event );
			break;
		case $.ui.keyCode.LEFT:
			this.collapse( event );
			break;
		case $.ui.keyCode.RIGHT:
			if ( this.active && !this.active.is( ".ui-state-disabled" ) ) {
				this.expand( event );
			}
			break;
		case $.ui.keyCode.ENTER:
		case $.ui.keyCode.SPACE:
			this._activate( event );
			break;
		case $.ui.keyCode.ESCAPE:
			this.collapse( event );
			break;
		default:
			preventDefault = false;
			prev = this.previousFilter || "";
			character = String.fromCharCode( event.keyCode );
			skip = false;
			clearTimeout( this.filterTimer );
			if ( character === prev ) {
				skip = true;
			} else {
				character = prev + character;
			}
			regex = new RegExp( "^" + escape( character ), "i" );
			match = this.activeMenu.children( ".ui-menu-item" ).filter(function() {
				return regex.test( $( this ).children( "a" ).text() );
			});
			match = skip && match.index( this.active.next() ) !== -1 ?
				this.active.nextAll( ".ui-menu-item" ) :
				match;
			if ( !match.length ) {
				character = String.fromCharCode( event.keyCode );
				regex = new RegExp( "^" + escape( character ), "i" );
				match = this.activeMenu.children( ".ui-menu-item" ).filter(function() {
					return regex.test( $( this ).children( "a" ).text() );
				});
			}
			if ( match.length ) {
				this.focus( event, match );
				if ( match.length > 1 ) {
					this.previousFilter = character;
					this.filterTimer = this._delay(function() {
						delete this.previousFilter;
					}, 1000 );
				} else {
					delete this.previousFilter;
				}
			} else {
				delete this.previousFilter;
			}
		}
		if ( preventDefault ) {
			event.preventDefault();
		}
	},
	_activate: function( event ) {
		if ( !this.active.is( ".ui-state-disabled" ) ) {
			if ( this.active.children( "a[aria-haspopup='true']" ).length ) {
				this.expand( event );
			} else {
				this.select( event );
			}
		}
	},
	refresh: function() {
		var menus,
			icon = this.options.icons.submenu,
			submenus = this.element.find( this.options.menus );
		submenus.filter( ":not(.ui-menu)" )
			.addClass( "ui-menu ui-widget ui-widget-content ui-corner-all" )
			.hide()
			.attr({
				role: this.options.role,
				"aria-hidden": "true",
				"aria-expanded": "false"
			})
			.each(function() {
				var menu = $( this ),
					item = menu.prev( "a" ),
					submenuCarat = $( "<span>" )
						.addClass( "ui-menu-icon ui-icon " + icon )
						.data( "ui-menu-submenu-carat", true );
				item
					.attr( "aria-haspopup", "true" )
					.prepend( submenuCarat );
				menu.attr( "aria-labelledby", item.attr( "id" ) );
			});
		menus = submenus.add( this.element );
		menus.children( ":not(.ui-menu-item):has(a)" )
			.addClass( "ui-menu-item" )
			.attr( "role", "presentation" )
			.children( "a" )
				.uniqueId()
				.addClass( "ui-corner-all" )
				.attr({
					tabIndex: -1,
					role: this._itemRole()
				});
		menus.children( ":not(.ui-menu-item)" ).each(function() {
			var item = $( this );
if ( !/[^\-—–\s]/.test( item.text() ) ) {
				item.addClass( "ui-widget-content ui-menu-divider" );
			}
		});
		menus.children( ".ui-state-disabled" ).attr( "aria-disabled", "true" );
		if ( this.active && !$.contains( this.element[ 0 ], this.active[ 0 ] ) ) {
			this.blur();
		}
	},
	_itemRole: function() {
		return {
			menu: "menuitem",
			listbox: "option"
		}[ this.options.role ];
	},
	focus: function( event, item ) {
		var nested, focused;
		this.blur( event, event && event.type === "focus" );
		this._scrollIntoView( item );
		this.active = item.first();
		focused = this.active.children( "a" ).addClass( "ui-state-focus" );
		if ( this.options.role ) {
			this.element.attr( "aria-activedescendant", focused.attr( "id" ) );
		}
		this.active
			.parent()
			.closest( ".ui-menu-item" )
			.children( "a:first" )
			.addClass( "ui-state-active" );
		if ( event && event.type === "keydown" ) {
			this._close();
		} else {
			this.timer = this._delay(function() {
				this._close();
			}, this.delay );
		}
		nested = item.children( ".ui-menu" );
if ( nested.length && ( /^mouse/.test( event.type ) ) ) {
			this._startOpening(nested);
		}
		this.activeMenu = item.parent();
		this._trigger( "focus", event, { item: item } );
	},
	_scrollIntoView: function( item ) {
		var borderTop, paddingTop, offset, scroll, elementHeight, itemHeight;
		if ( this._hasScroll() ) {
			borderTop = parseFloat( $.css( this.activeMenu[0], "borderTopWidth" ) ) || 0;
			paddingTop = parseFloat( $.css( this.activeMenu[0], "paddingTop" ) ) || 0;
			offset = item.offset().top - this.activeMenu.offset().top - borderTop - paddingTop;
			scroll = this.activeMenu.scrollTop();
			elementHeight = this.activeMenu.height();
			itemHeight = item.height();
			if ( offset < 0 ) {
				this.activeMenu.scrollTop( scroll + offset );
			} else if ( offset + itemHeight > elementHeight ) {
				this.activeMenu.scrollTop( scroll + offset - elementHeight + itemHeight );
			}
		}
	},
	blur: function( event, fromFocus ) {
		if ( !fromFocus ) {
			clearTimeout( this.timer );
		}
		if ( !this.active ) {
			return;
		}
		this.active.children( "a" ).removeClass( "ui-state-focus" );
		this.active = null;
		this._trigger( "blur", event, { item: this.active } );
	},
	_startOpening: function( submenu ) {
		clearTimeout( this.timer );
		if ( submenu.attr( "aria-hidden" ) !== "true" ) {
			return;
		}
		this.timer = this._delay(function() {
			this._close();
			this._open( submenu );
		}, this.delay );
	},
	_open: function( submenu ) {
		var position = $.extend({
			of: this.active
		}, this.options.position );
		clearTimeout( this.timer );
		this.element.find( ".ui-menu" ).not( submenu.parents( ".ui-menu" ) )
			.hide()
			.attr( "aria-hidden", "true" );
		submenu
			.show()
			.removeAttr( "aria-hidden" )
			.attr( "aria-expanded", "true" )
			.position( position );
	},
	collapseAll: function( event, all ) {
		clearTimeout( this.timer );
		this.timer = this._delay(function() {
			var currentMenu = all ? this.element :
				$( event && event.target ).closest( this.element.find( ".ui-menu" ) );
			if ( !currentMenu.length ) {
				currentMenu = this.element;
			}
			this._close( currentMenu );
			this.blur( event );
			this.activeMenu = currentMenu;
		}, this.delay );
	},
	_close: function( startMenu ) {
		if ( !startMenu ) {
			startMenu = this.active ? this.active.parent() : this.element;
		}
		startMenu
			.find( ".ui-menu" )
				.hide()
				.attr( "aria-hidden", "true" )
				.attr( "aria-expanded", "false" )
			.end()
			.find( "a.ui-state-active" )
				.removeClass( "ui-state-active" );
	},
	collapse: function( event ) {
		var newItem = this.active &&
			this.active.parent().closest( ".ui-menu-item", this.element );
		if ( newItem && newItem.length ) {
			this._close();
			this.focus( event, newItem );
		}
	},
	expand: function( event ) {
		var newItem = this.active &&
			this.active
				.children( ".ui-menu " )
				.children( ".ui-menu-item" )
				.first();
		if ( newItem && newItem.length ) {
			this._open( newItem.parent() );
			this._delay(function() {
				this.focus( event, newItem );
			});
		}
	},
	next: function( event ) {
		this._move( "next", "first", event );
	},
	previous: function( event ) {
		this._move( "prev", "last", event );
	},
	isFirstItem: function() {
		return this.active && !this.active.prevAll( ".ui-menu-item" ).length;
	},
	isLastItem: function() {
		return this.active && !this.active.nextAll( ".ui-menu-item" ).length;
	},
	_move: function( direction, filter, event ) {
		var next;
		if ( this.active ) {
			if ( direction === "first" || direction === "last" ) {
				next = this.active
					[ direction === "first" ? "prevAll" : "nextAll" ]( ".ui-menu-item" )
					.eq( -1 );
			} else {
				next = this.active
					[ direction + "All" ]( ".ui-menu-item" )
					.eq( 0 );
			}
		}
		if ( !next || !next.length || !this.active ) {
			next = this.activeMenu.children( ".ui-menu-item" )[ filter ]();
		}
		this.focus( event, next );
	},
	nextPage: function( event ) {
		var item, base, height;
		if ( !this.active ) {
			this.next( event );
			return;
		}
		if ( this.isLastItem() ) {
			return;
		}
		if ( this._hasScroll() ) {
			base = this.active.offset().top;
			height = this.element.height();
			this.active.nextAll( ".ui-menu-item" ).each(function() {
				item = $( this );
				return item.offset().top - base - height < 0;
			});
			this.focus( event, item );
		} else {
			this.focus( event, this.activeMenu.children( ".ui-menu-item" )
				[ !this.active ? "first" : "last" ]() );
		}
	},
	previousPage: function( event ) {
		var item, base, height;
		if ( !this.active ) {
			this.next( event );
			return;
		}
		if ( this.isFirstItem() ) {
			return;
		}
		if ( this._hasScroll() ) {
			base = this.active.offset().top;
			height = this.element.height();
			this.active.prevAll( ".ui-menu-item" ).each(function() {
				item = $( this );
				return item.offset().top - base + height > 0;
			});
			this.focus( event, item );
		} else {
			this.focus( event, this.activeMenu.children( ".ui-menu-item" ).first() );
		}
	},
	_hasScroll: function() {
		return this.element.outerHeight() < this.element.prop( "scrollHeight" );
	},
	select: function( event ) {
		this.active = this.active || $( event.target ).closest( ".ui-menu-item" );
		var ui = { item: this.active };
		if ( !this.active.has( ".ui-menu" ).length ) {
			this.collapseAll( event, true );
		}
		this._trigger( "select", event, ui );
	}
});
}( jQuery ));
;
/*! RESOURCE: /scripts/jquery-ui-fix-tooltip.js */
if (typeof jQuery.fn.bsTooltip === "function")
    jQuery.fn.tooltip = jQuery.fn.bsTooltip;
;
/*! RESOURCE: /scripts/doctype/SetTransactionSource.js */
(function(){
	if (!window.transaction_source) {
		var attrs = [ "Interface=Web", "Interface-Type=Classic Environment" ];
		if ((window.NOW && NOW.isUsingPolaris) || (top.NOW && top.NOW.isPolarisWrapper === "true"))
			attrs.push("Interface-Name=Unified Navigation App");
		else
			attrs.push("Interface-Name=Core UI");
		window.transaction_source = attrs.join();
	}
	if (window.jQuery) {
		window.jQuery.ajaxPrefilter(function(options) {
			if (!options.crossDomain) {
				if (!options.headers)
					options.headers = {};
				options.headers["X-Transaction-Source"] = window.transaction_source;
			}
		});
	}
})()
;
/*! RESOURCE: /scripts/classes/ui/Point.js */
var Point = Class.create();
Point.prototype = {
	initialize : function(x, y) {
		this.x = x;
		this.y = y;
	},
		
		getX: function() {
			return this.x;
		}, 
		
		getY: function() {
			return this.y;
		}
	}
;
/*! RESOURCE: /scripts/classes/util/CookieJar.js */
var CookieJar = Class.create({
	appendString: "__CJ_",
	initialize: function(options) {
		this.options = {
expires: 3600,
path: '',
domain: '',
sameSite: '',
secure: ''
		};
		Object.extend(this.options, options || {});
		if (this.options.expires != '') {
			var date = new Date();
			date = new Date(date.getTime() + (this.options.expires * 1000));
			this.options.expires = '; Expires=' + date.toGMTString();
		}
		if (this.options.path != '') {
			this.options.path = '; Path=' + escape(this.options.path);
		}
		if (this.options.domain != '') {
			this.options.domain = '; Domain=' + escape(this.options.domain);
		}
		if (this.options.sameSite != '') {
			this.options.sameSite = '; SameSite=' + escape(this.options.sameSite);
		}
		if (this.options.secure == 'secure') {
			this.options.secure = '; Secure';
		} else {
			this.options.secure = '';
		}
	},
	put: function(name, value) {
		name = this.appendString + name;
		cookie = this.options;
		var type = typeof value;
		switch(type) {
		  case 'undefined':
		  case 'function' :
		  case 'unknown'  : return false;
		  case 'boolean'  : 
		  case 'string'   : 
		  case 'number'   : value = String(value.toString());
		}
		var cookie_str = name + "=" + escape(Object.toJSON(value));
		try {
			document.cookie = cookie_str + cookie.expires + cookie.path + cookie.domain + cookie.sameSite + cookie.secure;
		} catch (e) {
			return false;
		}
		return true;
	},
	get: function(name) {
		name = this.appendString + name;
		var cookies = document.cookie.match(name + '=(.*?)(;|$)');
		if (cookies) {
			return (unescape(cookies[1])).evalJSON();
		} else {
			return null;
		}
	}
});
;
/*! RESOURCE: /scripts/list_filter.js */
var runFilterHandlers = {}
function setImage(element, src) {
	element = $(element);
	if (!element)
	    return;
	
    element.src = src;
}
function swapImage(imgId, newSrc) {
	return function () {setImage(imgId, newSrc);};
}
function setDisplay(element, display) {
    var i = $(element);
    i.style.display = display;    
}
function runFilter(name, listId) {
	if (queueFilters[name]) {
		columnsGet(name, runFilterCallBack);
		return;
	}
	runFilter0(name, listId);
}
function runFilterCallBack() {
  queueFilters[mainFilterTable] = null;
  runFilter0(mainFilterTable);
}
function runFilter0(name, listId) {  
    var filter = getFilter(name);
	if (name.endsWith('.'))
		name = name.substring(0, name.length - 1);
	if (!runFilterHandlers[name])
		return;
	
	runFilterHandlers[name](name, filter, listId);
} 
function saveFilterRadioChange() {
   var div = gel('savefiltergroupref');
   var grp = getMessage('Group');
   if (getGroupSaveOption() == grp)
      div.style.display = "inline";
   else
      div.style.display = "none";
}
function getFilterVisibility() {
    var vis = getGroupSaveOption();
    var me = getMessage('Me');
    var eone = getMessage('Everyone');
    var grp = getMessage('Group');
    if (vis == me)
       return vis;
       
    if (vis == eone)
       return "GLOBAL";
       
    if (vis != grp)
       return me;
       
    var vis = '';
    var e = gel('save_filter_ref_id').value;
    var e = gel(e);
    if (e) 
        vis = e.value;
    
    if (!vis) 
        return me;
        
    return vis;
}
function getGroupSaveOption() {
  var rb = gel('MeRadio');
  if (rb && rb.checked)
     return rb.value;
     
  rb = gel('EveryoneRadio');
  if (rb && rb.checked)
     return rb.value;
     
  rb = gel('GroupRadio');
  if (rb && rb.checked)
     return rb.value;
     
  return getMessage('Me');
}
;
/*! RESOURCE: /scripts/doctype/simpleStorage.js */
(function(root, factory) {
	"use strict";
	if (typeof define === 'function' && define.amd)
		define(factory);
	else
		root.simpleStorage = factory();
}(this, function() {
    "use strict";
	var VERSION = "0.1.2",
		_storage = false,
		_storage_size = 0,
		_storage_available = false,
		_ttl_timeout = null;
	function _init() {
		window.localStorage.setItem("__simpleStorageInitTest", "tmpval");
		window.localStorage.removeItem("__simpleStorageInitTest");
		_load_storage();
		_handleTTL();
		_setupUpdateObserver();
		if ("addEventListener" in window) {
			window.addEventListener("pageshow", function(event) {
				if (event.persisted) {
					_reloadData();
				}
			}, false);
		}
		_storage_available = true;
	}
	function _setupUpdateObserver() {
		if ("addEventListener" in window) 
			window.addEventListener("storage", _reloadData,false);
		else
			document.attachEvent("onstorage", _reloadData);
	}
	function _reloadData() {
		try {
			_load_storage();
		} catch (E) {
			_storage_available = false;
			return;
		}
		_handleTTL();
	}
	function _load_storage() {
		var source = localStorage.getItem("simpleStorage");
		try {
			_storage = JSON.parse(source) || {};
		} catch (E) {
			_storage = {};
		}
		_storage_size = _get_storage_size();
	}
	function _save() {
		try {
			localStorage.setItem("simpleStorage", JSON.stringify(_storage));
			_storage_size = _get_storage_size();
		} catch (E) {
			return E;
		}
		return true;
	}
	function _get_storage_size() {
		var source = localStorage.getItem("simpleStorage");
		return source ? String(source).length : 0;
	}
    function _handleTTL(){
        var curtime, i, len, expire, keys, nextExpire = Infinity, expiredKeysCount = 0;
        clearTimeout(_ttl_timeout);
        if (!_storage || !_storage.__simpleStorage_meta || !_storage.__simpleStorage_meta.TTL)
            return;
        curtime = +new Date();
        keys = _storage.__simpleStorage_meta.TTL.keys || [];
        expire = _storage.__simpleStorage_meta.TTL.expire || {};
        for (i = 0, len = keys.length; i<len; i++){
            if (expire[keys[i]] <= curtime){
                expiredKeysCount++;
                delete _storage[keys[i]];
                delete expire[keys[i]];
            }else{
                if (expire[keys[i]] < nextExpire){
                    nextExpire = expire[keys[i]];
                }
                break;
            }
        }
        if (nextExpire != Infinity){
            _ttl_timeout = setTimeout(_handleTTL, Math.min(nextExpire - curtime, 0x7FFFFFFF));
        }
        if (expiredKeysCount){
            keys.splice(0, expiredKeysCount);
            _cleanMetaObject();
            _save();
        }
    }
    function _setTTL(key, ttl){
        var curtime = +new Date(), i, len, added = false;
        ttl = Number(ttl) || 0;
        if (ttl !== 0){
            if (_storage.hasOwnProperty(key)){
                if (!_storage.__simpleStorage_meta)
                    _storage.__simpleStorage_meta = {};
                if (!_storage.__simpleStorage_meta.TTL)
                    _storage.__simpleStorage_meta.TTL = {expire: {}, keys:[]};
                _storage.__simpleStorage_meta.TTL.expire[key] = curtime + ttl;
                if (_storage.__simpleStorage_meta.TTL.expire.hasOwnProperty(key)){
                    for (i = 0, len = _storage.__simpleStorage_meta.TTL.keys.length; i<len; i++){
                        if (_storage.__simpleStorage_meta.TTL.keys[i] == key){
                            _storage.__simpleStorage_meta.TTL.keys.splice(i);
                        }
                    }
                }
                for (i = 0, len = _storage.__simpleStorage_meta.TTL.keys.length; i<len; i++){
                    if (_storage.__simpleStorage_meta.TTL.expire[_storage.__simpleStorage_meta.TTL.keys[i]] > curtime + ttl){
                        _storage.__simpleStorage_meta.TTL.keys.splice(i, 0, key);
                    }
                }
                if (!added)
                    _storage.__simpleStorage_meta.TTL.keys.push(key);
            } else
                return false;
        } else {
            if (_storage && _storage.__simpleStorage_meta && _storage.__simpleStorage_meta.TTL){
                if (_storage.__simpleStorage_meta.TTL.expire.hasOwnProperty(key)){
                    delete _storage.__simpleStorage_meta.TTL.expire[key];
                    for (i = 0, len = _storage.__simpleStorage_meta.TTL.keys.length; i<len; i++){
                        if (_storage.__simpleStorage_meta.TTL.keys[i] == key){
                            _storage.__simpleStorage_meta.TTL.keys.splice(i, 1);
                            break;
                        }
                    }
                }
                _cleanMetaObject();
            }
        }
        clearTimeout(_ttl_timeout);
        if (_storage && _storage.__simpleStorage_meta && _storage.__simpleStorage_meta.TTL && _storage.__simpleStorage_meta.TTL.keys.length){
            _ttl_timeout = setTimeout(_handleTTL, Math.min(Math.max(_storage.__simpleStorage_meta.TTL.expire[_storage.__simpleStorage_meta.TTL.keys[0]] - curtime, 0), 0x7FFFFFFF));
        }
        return true;
    }
	function _cleanMetaObject() {
		var updated = false, hasProperties = false, i;
		if (!_storage || !_storage.__simpleStorage_meta)
			return updated;
		if (_storage.__simpleStorage_meta.TTL && !_storage.__simpleStorage_meta.TTL.keys.length) {
			delete _storage.__simpleStorage_meta.TTL;
			updated = true;
		}
		for (i in _storage.__simpleStorage_meta) {
			if (_storage.__simpleStorage_meta.hasOwnProperty(i)) {
				hasProperties = true;
				break;
			}
		}
		if (!hasProperties) {
			delete _storage.__simpleStorage_meta;
			updated = true;
		}
		return updated;
	}
	try {
		_init();
	} catch (E) {}
	return {
		version : VERSION,
		canUse : function() {
			return !!_storage_available;
		},
		set : function(key, value, options) {
			if (key == "__simpleStorage_meta") 
				return false;
			if (!_storage)
				return false;
			if (typeof value == "undefined")
				return this.deleteKey(key);
			options = options || {};
			try {
				value = JSON.parse(JSON.stringify(value));
			} catch (E) {
				return E;
			}
			_storage[key] = value;
			_setTTL(key, options.TTL || 0);
			return _save();
		},
		get : function(key) {
			if (!_storage) 
				return false;
			if (_storage.hasOwnProperty(key)
					&& key != "__simpleStorage_meta") {
				if (this.getTTL(key)) {
					return _storage[key];
				}
			}
		},
		deleteKey : function(key) {
			if (!_storage) 
				return false;
			if (key in _storage) {
				delete _storage[key];
				_setTTL(key, 0);
				return _save();
			}
			return false;
		},
		setTTL : function(key, ttl) {
			if (!_storage) 
				return false;
			_setTTL(key, ttl);
			return _save();
		},
		getTTL : function(key) {
			if (!_storage) 
				return false;
	
			if (_storage.hasOwnProperty(key)) {
				if (_storage.__simpleStorage_meta
						&& _storage.__simpleStorage_meta.TTL
						&& _storage.__simpleStorage_meta.TTL.expire
						&& _storage.__simpleStorage_meta.TTL.expire
								.hasOwnProperty(key)) {
	
					var ttl = Math.max(_storage.__simpleStorage_meta.TTL.expire[key] - (+new Date()) || 0, 0);
					return ttl || false;
				} else {
					return Infinity;
				}
			}
	
			return false;
		},
	flush : function() {
		if (!_storage)
			return false;
		_storage = {};
		_storage_size = 0;
		try {
			localStorage.removeItem("simpleStorage");
			return true;
		} catch (E) {
			return E;
		}
	},
	index : function() {
		if (!_storage) 
			return false;
		var index = [], i;
		for (i in _storage) {
			if (_storage.hasOwnProperty(i)
					&& i != "__simpleStorage_meta") {
				index.push(i);
			}
		}
		return index;
	},
	storageSize : function() {
		return _storage_size;
	}, 
	
	getStorage : function() {
		return _storage;
	}
};
}));
;
/*! RESOURCE: /scripts/doctype/GwtMessage14.js */
var GwtMessage = Class.create({
	DEFAULT_LANGUAGE: "en",
	PREFETCH_ENTRY_KEY : "PREFETCH_ENTRY_KEY",
	
	initialize: function() {},
	set: function(n, v) {
		if (!v)
			GwtMessage._messages[n] = true;
		else
			GwtMessage._messages[n] = v;
	},
	format: function(msg) {
		if (!msg)
			return "";
		var str = msg;
		for (var i = 1; i < arguments.length; i++) {
			var paramIndex = i - 1;
			var rx = new RegExp("\{[" + paramIndex + "]\}", "g");
			str = str.replace(rx, arguments[i]);
		}
		return str;
	},
	getMessage: function(strVal) {
		var valList = [];
		valList.push(strVal);
		var messages = this.getMessages(valList);
		var msg = messages[strVal];
		if (arguments.length > 1) {
			var realArray = [].slice.call(arguments, 0);
			realArray[0] = msg;
			msg = this.format.apply(this, realArray);
		}
		return msg;
	},
	getMessages: function(resolveList) {
		var pageMsgs = {};
		var dataRequiringAjaxCall = [];
		var results = {};
		for (var i = 0; i < resolveList.length; i++) {
			var v = GwtMessage._messages[resolveList[i]]; 
			if (v === true)
				pageMsgs[resolveList[i]] = resolveList[i];
			else if (v)
				pageMsgs[resolveList[i]] = v;
			else 
				dataRequiringAjaxCall.push(resolveList[i]);
		}
		
		if (dataRequiringAjaxCall.length > 0) {
			this._loadNewMessages(dataRequiringAjaxCall);
results = this._buildListFromCache(dataRequiringAjaxCall);
		}
		
		for (var key in pageMsgs)
			results[key] = pageMsgs[key];
		
		return results;
	},
	_loadNewMessages: function(resolveList) {
		var cachedMessages = this._findCachedKeys(resolveList);
		var keysToResolve = this._removeCachedEntries(resolveList, cachedMessages);
		if (keysToResolve.length == 0)
			return;
			
	  	var ajax = new GlideAjax("SysMessageAjax");
  		ajax.addParam("sysparm_keys", keysToResolve.length);
  		ajax.addParam("sysparm_prefetch", this._shouldPrefetch() ? "true" : "false");
  		for (var i = 0; i < keysToResolve.length; i++) {
			var keyVal = "key" + i;
			ajax.addParam(keyVal, keysToResolve[i]);
  		}
	    
		var rxml = ajax.getXMLWait();
		this._processResponse(rxml);
	},
	_removeCachedEntries: function(resolveList) {
		var messagesToResolve = new Array();
		for (var i = 0; i < resolveList.length; i++) {
			var key = resolveList[i];
			if (this._getCache().get(key))
				continue;
			messagesToResolve.push(key);
		}
		return messagesToResolve;
	},
	
	_processResponse: function(rxml) {
		if (rxml == null)
			return;
	  	this._processItems(rxml, "preitem");
	  	this._processItems(rxml, "item");
	},
	
	_shouldPrefetch : function() {
		var pf = this._getCache().get(this._PREFETCH_ENTRY_KEY);
		var now = new Date().getTime();
		if (typeof pf == 'undefined' || (pf + 60000) < now) {
			this._getCache().put(this._PREFETCH_ENTRY_KEY, now);
			return true;
		}
		
		return false;
	},
	
	_processItems: function(xml, name) {
		var items = xml.getElementsByTagName(name);
		for (var i=0; i < items.length; i++) {
			var key = items[i].getAttribute("key");
			var value = items[i].getAttribute("value");
			this.setMessage(key, value);
		}
	},
	
	setMessage: function(key, msg) {
		this._getCache().put(key, msg);
	},
		
	isDefaultLanguage: function() {
		return this.getLanguage() == this.getDefaultLanguage();
	},
	
	getLanguage: function() {
		return g_lang;
	},
	
	getDefaultLanguage: function() {
		return this.DEFAULT_LANGUAGE;
	},
	
	_findCachedKeys: function(resolveList) {
		var answer = new Array();
		var cache = this._getCache();
		for (var i =0; i< resolveList.length; i++) {
			var key = resolveList[i];
			var value = cache.get(key);
			if (value)
				answer.push(key);
		}
		
		return answer;
	},
	
	_buildListFromCache: function(resolveList) {
		var answer = {};
		var cache = this._getCache();
		for (var i =0; i < resolveList.length; i++) {
			var key = resolveList[i];
			var value = cache.get(key);
			answer[key] = value;
		}
		
		return answer;
	},
	_getCache: function() {
		if (NOW.useSimpleStorage && simpleStorage.canUse()) {
			var synch = simpleStorage.get("simpleStorageSynch");
			if (NOW.simpleStorageSynch != synch) {
				jslog("*** simpleStorageSynch, size: " + simpleStorage.storageSize());
				simpleStorage.flush();
				simpleStorage.set("simpleStorageSynch", NOW.simpleStorageSynch);
			}
			
			return {
				put: function(key, value) {
					return simpleStorage.set("MSG_" + NOW.language + "_" + key, value);
				},
				get : function(key) {
					return simpleStorage.get("MSG_" + NOW.language + "_" + key);
				}
			}
		}
		try {
			if (getTopWindow().g_cache_message)
				return getTopWindow().g_cache_message;
		} catch (e) { }
			
		if (typeof(g_cache_message) != "undefined")
			return g_cache_message;
		g_cache_message = new GlideClientCache(500);
		return g_cache_message;
	}, 
	
	fetch: function(resolveList, callback) {
		var cachedMessages = this._findCachedKeys(resolveList);
		var keysToResolve = this._removeCachedEntries(resolveList, cachedMessages);
		if (keysToResolve.length == 0) {
			var answer = this.getMessages(resolveList);
			callback(answer);
			return;
		}
		var ajax = new GlideAjax("SysMessageAjax");
		ajax.addParam("sysparm_keys", keysToResolve.length);
		ajax.addParam("sysparm_prefetch", this._shouldPrefetch() ? "true" : "false");
		for (var i = 0; i < keysToResolve.length; i++) {
			var keyVal = "key" + i;
			ajax.addParam(keyVal, keysToResolve[i]);
		}
		ajax.getXML(this.fetched.bind(this), null, {
			fn : callback,
			list : resolveList
		});
	},
	
	fetched: function(response, parms) {
		this._processResponse(response.responseXML);
var answer = this.getMessages(parms.list);
		parms.fn(answer);
	}
});
GwtMessage._messages = {};
function getMessage(msg, callback) {
	if (typeof callback == "function") {
		if (typeof msg == "object")
			new GwtMessage().fetch(msg, callback);
		else
			new GwtMessage().fetch([msg], function(o){callback(o[msg]);});
	} else {
		if (typeof msg == "object")
			return new GwtMessage().getMessages(msg);
			
		return new GwtMessage().getMessage(msg);
	}
}
function getMessages(msgs) {
	return new GwtMessage().getMessages(msgs);
}
;
/*! RESOURCE: /scripts/doctype/DynamicTranslation.js */
var GET_DYNAMIC_TRANSLATION = "/api/sn_dt/v1/dynamic_translation/get_dynamic_translation";
var GET_DYNAMIC_TRANSLATIONS = "/api/sn_dt/v1/dynamic_translation/get_dynamic_translations";
var GET_DETECTED_LANGUAGE = '/api/sn_dt/v1/dynamic_translation/get_detected_language';
var GET_DETECTED_LANGUAGES = '/api/sn_dt/v1/dynamic_translation/get_detected_languages';
var IS_ENABLED = "/api/sn_dt/v1/dynamic_translation/is_enabled";
function setSourceInParms(parms) {
    parms = parms || {};
    parms.event = parms.event || {};
    parms.event.source = 'clientAPI';
    return parms;
}
function isNotValidInputText(msg) {
    return (typeof msg != 'string');
}
function isNotValidString(str) {
    return ((str === null) || (typeof str !== 'string')) ? true : (str.trim().length === 0);
}
function isNotValidTranslator(translator) {
    return ((translator != null) && (typeof translator != 'string'));
}
function isNotValidTargetLanguages(targetLanguages) {
    if (!Array.isArray(targetLanguages) || (targetLanguages.length === 0)) {
        return true;
    }
    for (var index = 0; index < targetLanguages.length; index++) {
        if (isNotValidString(targetLanguages[index])) {
            return true;
        }
    }
    return false;
}
function isNotValidAdditionalParameters(additionalParameters) {
    if (!Array.isArray(additionalParameters) || (additionalParameters.length === 0)) {
        return true;
    } else {
        for (var index = 0; index < additionalParameters.length; index++) {
            var additionalParameter = additionalParameters[index];
            if (!additionalParameter || (additionalParameter.constructor != {}.constructor) || (Object.keys(additionalParameter).length != 2)) {
                return true;
            }
            for (eachkey in additionalParameter) {
                if (!(eachkey === 'parameterName' || eachkey === 'parameterValue') || isNotValidString(additionalParameter[eachkey])) {
                    return true;
                }
            }
        }
    }
    return false;
}
function isNotValidTexts(texts) {
    if (!Array.isArray(texts) || (texts.length === 0)) {
        return true;
    }
    for (var index = 0; index < texts.length; index++) {
        if (isNotValidInputText(texts[index])) {
            return true;
        }
    }
    return false;
}
var errorHandler = {
    rejectErrorMessage: function(response) {
        if (this.hasMultipleTexts) {
            this.reject({
                'code': this.code,
                'message': response,
                'status': 'Error'
            });
        } else {
            this.reject({
                'code': this.code,
                'message': response
            });
        }
    }
};
function validateOptionalParameters(parms, isTranslation, hasMultipleTexts) {
    errorHandler['hasMultipleTexts'] = hasMultipleTexts;
    if (parms.constructor != {}.constructor) {
        errorHandler['code'] = '40006';
        getMessage("Additional parameters are invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
        return false;
    }
    if (isNotValidTranslator(parms.translator)) {
        errorHandler['code'] = '40003';
        getMessage("Translator (\"translator\" field) is invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
        return false;
    }
    if (isTranslation) {
        if ((parms.sourceLanguage != null) && isNotValidString(parms.sourceLanguage)) {
            errorHandler['code'] = '40008';
            getMessage("Source language (\"sourceLanguage\" field) is invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
            return false;
        }
        if (parms.targetLanguages && isNotValidTargetLanguages(parms.targetLanguages)) {
            errorHandler['code'] = '40007';
            getMessage("Target languages (\"targetLanguages\" field) are invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
            return false;
        }
    }
    if (parms.additionalParameters && isNotValidAdditionalParameters(parms.additionalParameters)) {
        errorHandler['code'] = '40006';
        getMessage("Additional parameters are invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
        return false;
    }
    return true;
}
function handleErrorResponse(response, hasMultipleTexts) {
    errorHandler['hasMultipleTexts'] = hasMultipleTexts;
    if (response.status === 400) {
        errorHandler['code'] = '40001';
        getMessage("Dynamic Translation plugin is not installed", errorHandler.rejectErrorMessage.bind(errorHandler));
    } else {
        errorHandler['code'] = '40051';
        getMessage("Unknown error occurred", errorHandler.rejectErrorMessage.bind(errorHandler));
    }
}
var DynamicTranslation = Class.create({
    getTranslation: function(msg, parms) {
        function getOnSuccessResponse(response) {
            var successResponse = {
                'translations': response.result.translations,
                'translator': response.result.translator
            };
            if (response.result.detectedLanguage) {
                successResponse['detectedLanguage'] = response.result.detectedLanguage;
            }
            return successResponse;
        }
        function getOnErrorResponse(response) {
            return JSON.parse(response.result.errorMessage);
        }
        return new Promise(function(resolve, reject) {
            errorHandler['reject'] = reject;
            if (isNotValidInputText(msg)) {
                errorHandler['code'] = '40000';
                getMessage("Text is missing or invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
            } else if (!parms || validateOptionalParameters(parms, true, false)) {
                translationRequest = JSON.stringify({
                    'textToTranslate': msg,
                    'parms': setSourceInParms(parms)
                });
                $j.ajaxSetup({
                    headers: {
'Content-Type': 'application/json',
'Accept': 'application/json'
                    }
                });
                $j.post(GET_DYNAMIC_TRANSLATION, translationRequest, function(response) {
                        if (!response.result.isError)
                            resolve(getOnSuccessResponse(response));
                        else
                            reject(getOnErrorResponse(response));
                    })
                    .fail(function(response) {
                        handleErrorResponse(response, false);
                    });
            }
        });
    },
    getTranslations: function(msg, parms) {
        function getOnSuccessResponse(response) {
            var successResponse = {
                'status': response.result.status,
                'translations': response.result.translations,
                'translator': response.result.translator
            };
            return successResponse;
        }
        function getOnErrorResponse(response) {
            var errorDetails = JSON.parse(response.result.errorMessage);
            var errorResponse = {
                'status': errorDetails.status,
                'code': errorDetails.code,
                'message': errorDetails.message
            };
            if (errorDetails['translations']) {
                errorResponse['translations'] = errorDetails['translations'];
            }
            return errorDetails;
        }
        return new Promise(function(resolve, reject) {
            errorHandler['reject'] = reject;
            if (!msg || isNotValidTexts(msg)) {
                errorHandler['code'] = '40000';
                errorHandler['hasMultipleTexts'] = true;
                getMessage("Text is missing or invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
            } else if (!parms || validateOptionalParameters(parms, true, true)) {
                translationRequest = JSON.stringify({
                    'textsToTranslate': msg,
                    'parms': setSourceInParms(parms)
                });
                $j.ajaxSetup({
                    headers: {
'Content-Type': 'application/json',
'Accept': 'application/json'
                    }
                });
                $j.post(GET_DYNAMIC_TRANSLATIONS, translationRequest, function(response) {
                        if (!response.result.isError)
                            resolve(getOnSuccessResponse(response));
                        else
                            reject(getOnErrorResponse(response));
                    })
                    .fail(function(response) {
                        handleErrorResponse(response, true);
                    });
            }
        });
    },
    isTranslationEnabled: function(translator) {
        var isEnabled = this.isEnabled;
        return new Promise(function(resolve, reject) {
            if (isNotValidTranslator(translator)) {
                getMessage("Translator (\"translator\" field) is invalid", function(response) {
                    reject({
                        'code': '40003',
                        'message': response
                    });
                });
            } else {
                var params = {
                    event: {
                        eventName: 'isTranslationEnabled'
                    },
                    translator: translator
                };
                isEnabled(params).then(function(response) {
                    resolve(response.translation);
                }, function(response) {
                    reject(false);
                });
            }
        });
    },
    getDetectedLanguage: function(text, parms) {
        function getOnSuccessResponse(response) {
            return {
                'detectedLanguage': response.result.detectedLanguage,
                'alternatives': response.result.alternatives,
                'translator': response.result.translator
            };
        }
        function getOnErrorResponse(response) {
            return JSON.parse(response.result.errorMessage);
        }
        return new Promise(function(resolve, reject) {
            errorHandler['reject'] = reject;
            if (isNotValidInputText(text)) {
                errorHandler['code'] = '40000';
                getMessage("Text is missing or invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
            } else if (!parms || validateOptionalParameters(parms, false, false)) {
                detectionRequest = JSON.stringify({
                    'text': text,
                    'parms': setSourceInParms(parms)
                });
                $j.ajaxSetup({
                    headers: {
'Content-Type': 'application/json',
'Accept': 'application/json'
                    }
                });
                $j.post(GET_DETECTED_LANGUAGE, detectionRequest, function(response) {
                        if (!response.result.isError)
                            resolve(getOnSuccessResponse(response));
                        else
                            reject(getOnErrorResponse(response));
                    })
                    .fail(function(response) {
                        handleErrorResponse(response, false);
                    });
            }
        });
    },
    getDetectedLanguages: function(texts, parms) {
        function getOnSuccessResponse(response) {
            var successResponse = {
                'status': response.result.status,
                'detections': response.result.detections,
                'translator': response.result.translator
            };
            return successResponse;
        }
        function getOnErrorResponse(response) {
            var errorDetails = JSON.parse(response.result.errorMessage);
            var errorResponse = {
                'status': errorDetails.status,
                'code': errorDetails.code,
                'message': errorDetails.message
            };
            if (errorDetails['detections']) {
                errorResponse['detections'] = errorDetails['detections'];
            }
            return errorDetails;
        }
        return new Promise(function(resolve, reject) {
            errorHandler['reject'] = reject;
            if (!texts || isNotValidTexts(texts)) {
                errorHandler['code'] = '40000';
                errorHandler['hasMultipleTexts'] = true;
                getMessage("Text is missing or invalid", errorHandler.rejectErrorMessage.bind(errorHandler));
            } else if (!parms || validateOptionalParameters(parms, false, true)) {
                detectionRequest = JSON.stringify({
                    'texts': texts,
                    'parms': setSourceInParms(parms)
                });
                $j.ajaxSetup({
                    headers: {
'Content-Type': 'application/json',
'Accept': 'application/json'
                    }
                });
                $j.post(GET_DETECTED_LANGUAGES, detectionRequest, function(response) {
                        if (!response.result.isError)
                            resolve(getOnSuccessResponse(response));
                        else
                            reject(getOnErrorResponse(response));
                    })
                    .fail(function(response) {
                        handleErrorResponse(response, true);
                    });
            }
        });
    },
    isEnabled: function(parms) {
        function isValidTranslator(translator) {
            return (translator) && (typeof translator != 'string') ? false : true;
        }
        return new Promise(function(resolve, reject) {
            var translator = (parms && (parms.constructor == {}.constructor)) ? parms.translator : parms;
            if (isValidTranslator(translator)) {
                parms = (typeof parms === 'string') ? {
                    'translator': translator
                } : parms;
                isEnabledRequest = JSON.stringify({
                    'parms': setSourceInParms(parms)
                });
                $j.ajaxSetup({
                    headers: {
'Content-Type': 'application/json',
'Accept': 'application/json'
                    }
                });
                $j.post(IS_ENABLED, isEnabledRequest, function(response) {
                        var res = response.result;
                        resolve(res);
                    })
                    .fail(function() {
                    	resolve({
                            'translation': false,
                            'detection': false,
                            'batchTranslation': false,
                            'batchDetection': false
                        });
                    });
            } else {
                getMessage("Translator (\"translator\" field) is invalid", function(response) {
                    reject({
                        'code': '40003',
                        'message': response
                    });
                });
            }
        });
    }
});
DynamicTranslation.getTranslation = function(textToTranslate, parms) {
    return new DynamicTranslation().getTranslation(textToTranslate, parms);
};
DynamicTranslation.getTranslations = function(textsToTranslate, parms) {
    return new DynamicTranslation().getTranslations(textsToTranslate, parms);
};
DynamicTranslation.isTranslationEnabled = function(translator) {
    return new DynamicTranslation().isTranslationEnabled(translator);
};
DynamicTranslation.getDetectedLanguage = function(text, parms) {
    return new DynamicTranslation().getDetectedLanguage(text, parms);
};
DynamicTranslation.getDetectedLanguages = function(texts, parms) {
    return new DynamicTranslation().getDetectedLanguages(texts, parms);
};
DynamicTranslation.isEnabled = function(parms) {
    return new DynamicTranslation().isEnabled(parms);
};
;
/*! RESOURCE: /scripts/classes/GlideFilterDescription.js */
var GlideFilterDescription = Class.create({
	initialize: function() {},
	choices: null,
	
	setParsedQuery: function(strVal) {
		this.parsedQuery = strVal;
	},
	
	getParsedQuery: function() {
		return this.parsedQuery;
	},
	
	setBaseLine: function(value) {
		this.baseLine = value;
	},
	
	getBaseLine: function() {
		return this.baseLine;
	},	
	
	setMetaData: function(value) {
		this.metaData = value;
	},
	
	getMetaData: function() {
		return this.metaData;
	},
	
	setPreferenceParam: function(value) {
		this.preference = value;
	},
	
	getPreferenceParam: function() {
		return this.preference;
	},
	
	setExpanded: function(value) {
		this.expanded = value;
	},
	
	getExpanded: function() {
		return this.expanded;
	},
	setName: function(value) {
		this.name = value;
	},
	
	getName: function() {
		return this.name;
	},
	
	
	setFilter: function(value) {
		this.filter = value;
	},
	
	getFilter: function() {
		return this.filter;
	},
	
	setTableName: function(value) {
		this.tableName = value;
	},
	
	getTableName: function() {
		return this.tableName;
	},
	
	setPinned: function(value) { 
		this.pinned = value;
	},
	
	getPinned: function() {
		return this.pinned;
	},
	
	setMainFilterTable: function(filterTable) {
		this.mainFilterTable = filterTable;
	},
	
	getMainFilterTable: function() {
		return this.mainFilterTable;
	},
	setPinnable: function(value) {
		this.pinnable = value;
	},
	
	getPinnable: function() {
		return this.pinnable;
	},
	
	setShowRelated: function(value) {
		this.showRelated = value;
	},
	
	getShowRelated: function() {
		return this.showRelated;
	},
	
	setChoiceListMap: function(value) {
		this.choiceList = value;
	},
	
	getChoiceList: function(table) {
		if (typeof this.choiceList == 'undefined')
			return null;
		return this.choiceList[table];	
	}
});
;
/*! RESOURCE: /scripts/classes/GlideFilterHandlers.js */
var GlideFilterHandler = Class.create({
	MAP_OPEN: "$" + "{",
	filterClass: "",
	
	initialize: function(tableName, item, mappingId) {
		this.maxValues = 0;
		this.tableName = tableName;
		this.item = item;
		this.isRightOperandShowingRelatedFields = false;
		this.lastOperator = null;
		this.mappingId = mappingId;
		window.NOW.GlideFilterHandlersResponseCache = window.NOW.GlideFilterHandlersResponseCache || new GlideClientCache();
	},
	
	destroy: function() {
		if (this.tr) {
			if (this.tr.operSel)
				this.tr.operSel.onchange = null;
			this.tr = null;
		}
		for (i = 0; i < this.inputCnt; i++) {
			this.inputs[i].onkeypress = null;
			this.inputs[i].onchange = null;
			this.inputs[i] = null;
		}
		this.destroyMappingSupport();
	},
	create: function(tr, values, filterClass) {
		this.tr = tr;
		if (values && values.indexOf(this.MAP_OPEN) != -1) {
			console.log("implement GlideFilterHandler#create mapping support");
		}
		this._setup(values);
		this._init(values);
		this._build(filterClass);
		if (this.listenForOperChange)
			this.tr.operSel.onchange = this._operOnChange.bind(this);
		
		this.isRightOperandShowingRelatedFields = false;
		
		this.lastOperator = this._getOperator();
	},
	
	_setup: function(values) {
	},
	
	getTableName: function() {
		return this.tableName;
	},
	
	getFilterText: function(oper) {
		return '';
	},
	
	_init: function(values) {
		this._initValues(values);
		this._initialMappingValue = values;
		this._initInputs();
	},
	
	_initValues: function(values) {
		var op = this._getOperator();
		if (!values) {
			this.values = [];
		} else if (this.tr && this.tr.varType === "variables" && !this.userDateFormat) {
			this.values = [ values ];
		} else {
			if (this.tr && this.tr.varType === "boolean") {
				if (values === "0")
					values = "false";
				else if (values === "1")
					values = "true";
				else if (values === "False")
					values = "false";
			}
			this.values = values.split("@");
		}
			
		for (var i = this.values.length; i < this.maxValues; i++) 
			this.values[i] = "";				
		
	},
	
	_initInputs: function() {
		this.inputCnt = 0;
		this.inputs = [];
		for (var i = 0; i < this.maxValues; i++)
			this.inputs[i] = null;
	},
	
	_clearValues: function() {
		this.values = [];
		for (var i = 0; i < this.maxValues; i++) 
			this.values[i] = "";
	},
	
		
	_isEmptyOper: function() {
		var op = this._getOperator();
		if (op == 'ISEMPTY' || op == 'ISNOTEMPTY' || op == 'ANYTHING' || op == 'EMPTYSTRING' || op == 'VALCHANGES') {
			this._clearValues();
			return true;
		}
		
		return false;
	},
	
	_getOperator: function() {
		return getSelectedOption(this.tr.operSel).value;
	},
	
	_getInputValue: function(el) {
		var value = "";
		if (el == null)
			return value;
			
		if (el.tagName.toUpperCase() == "TEXTAREA") {
			value = el.value;
			return this._isTemplate() ? this._removeTrailingSpaces(value) : value;
		}
		
		if (el.tagName.toUpperCase() == "INPUT") {
			value = this._escapeIfRequired(el.value);
			return this._isTemplate() ? this._removeTrailingSpaces(value) : value;
		}
		
		var options = el.options;
		if (el.multiple) {
			var vals = [];
			for (var i = 0; i < options.length; i++) {
				if (options[i].selected)
					vals.push(options[i].value);
			}
			return vals.join(",");
		}
		return options[el.selectedIndex].value;
	},
	
	_escapeIfRequired: function(value) {
		if (this._getOperator() == "BETWEEN") {
			if (value == null) {
				for (var i = 0; i < this.values; i++)
					this.values[i] = this._escape(this.values[i]);
				return this.values;
			} 
			return this._escape(value);
		} 
		return value;
	},
	
	_escape: function (value) {
		if (value == null)
			return;
value = value.replace(/\\/g, "\\\\")
value = value.replace(/@/g, "\\@")
		return value;
	},
	
	_unescapeIfRequired: function() {
		if (this._getOperator() == "BETWEEN")
			for (var i=0; i < this.values.length; i++) 
				this.values[i] = this._unescape(this.values[i]);	
	},
	
	_unescape: function (value) {
		return this._parseValues(value,'@')[0];
	},
	
	
	_addTextInput: function(type, td, label) {
		if (!td)
			td = this.tr.tdValue;
		if (!this._isEmptyOper()) {
			if (this.tr.tdMapping)
				this.tr.tdMapping.show();
		}
		var associatedField = this.item && this.item.label;
		var input = addTextInput(td, this.values[this.inputCnt], type, associatedField, label);
		this.inputs[this.inputCnt] = input;
		this.inputCnt++;
		return input;
	},
	_addInvisibleTextInput: function(type, td) {
		var input = $(this._addTextInput(type, td));
		input.addClassName('sr-only');
		input.setAttribute('disabled', 'disabled');
		input.siblings().each(function(sibling){ sibling.hasAttribute('data-date-format') && sibling.remove()});
		this.inputCnt--;
		this.inputs.pop();
		getMessage('No value needed', function(msg) {
			input.value = msg;
		});
	},
	_addBetweenTextInput: function(type, td) {	
		if (!td)
			td = this.tr.tdValue;
			
		var associatedField = this.item && this.item.label;
		var input = addTextInput(td, this.values[this.inputCnt], type, associatedField);
		this.inputs[this.inputCnt] = input;
		this.inputCnt++;
		return input;
	},
	
	_addTextArea: function() {	
		if (!this._isEmptyOper()) {
			if (this.tr.tdMapping)
				this.tr.tdMapping.show();
		}
		var associatedField = this.item && this.item.label;
		var input = addTextArea(this.tr.tdValue, this.values[this.inputCnt], associatedField);
		this.inputs[this.inputCnt] = input;
		this.inputCnt++;
		return input;
	},
	_addSelect: function(width, multi, size) {
		var associatedField = this.item && this.item.label;
		var s = _createFilterSelect(width, multi, associatedField);
		this.tr.tdValue.setAttribute("data-value", associatedField);
		this.tr.tdValue.appendChild(s);
		this.inputs[this.inputCnt] = s;
		this.inputCnt++;
		return s;
	},
	
	_operOnChange: function() {
		var lastOp = this.lastOperator; 
		this.lastOperator = this._getOperator();
	 
		
		if((fieldComparisonOperators.indexOf(lastOp) >= 0) != (fieldComparisonOperators.indexOf(this.lastOperator) >= 0) || lastOp == "DYNAMIC") {
			this.inputCnt = 0;
			this.input = [];
		}
		this.getValues();
		this._unescapeIfRequired();
		this._build();	
	},
	
	
	_isTemplate: function() {
		var t = this.tr;
		while (t) {
			t = findParentByTag(t, 'table');
			if (t) {				
				var id = t.id + '';
				if (id.indexOf('filters_table') != -1)
					break;
			}
		}
		if (!t)
			return false;
			
		return t.getAttribute('gsft_template') == 'true';
	},
	_renderDynamicOperandInput: function(op) {
		if (typeof g_dynamic_filter_options == "undefined")
			return false;
		if (op != "DYNAMIC")
			return false;
		var addedReferenceInput = false;
		var arr = g_dynamic_filter_options.split("##");
		for (var i = 0; i < arr.length; i++) {
			var aItem = arr[i];
			if (aItem.length == 0)
				continue;
			var aItemArr = aItem.split("::");
			if (aItemArr.length < 3)
				continue;
			var isExclusiveDynamic = typeof gtf_exclusive_dynamics != 'undefined' && gtf_exclusive_dynamics == "true";
			if ( !isExclusiveDynamic && this.item && this.item.getReference() == aItemArr[2] || this.originalTableName == aItemArr[3] ) {
				if (!addedReferenceInput)
					var input = this._addSelect(180, false, 1);
				var arrInput = [];
				arrInput.push(aItemArr[1]);
				var translated = getMessages(arrInput);
				addOption(input, aItemArr[0], translated[aItemArr[1]], this.rightOperand == aItemArr[0]);
				addedReferenceInput = true;
			}
		}
		return addedReferenceInput;
	},
	setOriginalTable: function(tableNameFull) {
		if (tableNameFull.indexOf(".") == -1)
			this.originalTableName = tableNameFull;
		else
			this.originalTableName = tableNameFull.split(".")[1];
	},
	
	getValues: function() {
		this._clearValues();
		if (this.inputCnt == 0)
			return "";
			
		for (var i = 0; i < this.maxValues; i++) 
			this.values[i] = this._getInputValue(this.inputs[i]);
		if (this._isMappingEnabled)
			return this.getMappingValue();
		if (this.inputCnt == 1)
			return this.values[0];
		else 
			return this.values.join("@");
	},
	
	_getFilterTable: function() {
		if (this.tr && this.tr.conditionRow && this.tr.conditionRow.tableName) {
			var conditionRowTableName = this.tr.conditionRow.tableName.split(".");
			if (conditionRowTableName.length > 0 && conditionRowTableName[0]) {
				return conditionRowTableName[0];
			}
		}
		return firstTable;
	},
	 _populateRightOperandChoices : function() {
		var field = this.item.name;
		var table = "";
		if (typeof mainFilterTable == "undefined")
			table = this._getFilterTable();
		else
			table = mainFilterTable;
		var selection = this.values[0];
		if (null != table && "" != table && null != field && "" != field) {
			var s = this._addSelect(this.width, false, 1);
			s.onchange = this.rightOperandfieldOnChange.bind(s, table,this);
			var completeSelection = "";
			if (selection)
				completeSelection = table + '.' + selection;
			else
				completeSelection = table;
			var showRelatedFields = "no";
			if (this.isRightOperandShowingRelatedFields || (selection && selection.indexOf(".") >= 0))
				showRelatedFields = "yes";
			this.addChoices(s, completeSelection, "",
					this._filterRightOperand, selection, null,
					showRelatedFields, this.item);
			if (null != selection)
				this.selectRightOperand(s, selection);
		}
	},
	
	selectRightOperand : function(select, selection) {
		var o = getSelectedOption(select);
		var options = select.options;
		for (var i = 0; i < options.length; i++) {
			var option = options[i];
			if (null != option && option.value == selection) {
				option.innerHTML = getFullLabel(option);
				option.style.color = 'green';
				option.wasSelected = 'true';
				select.style.width = "240px";
				option.selected = true;
				select.selectedIndex = i;
				break;
			}
		}
	},
	_getReportTable : function() {
return firstTable;
	},
		
	rightOperandfieldOnChange : function(table, t) {
		var fieldName = this.value;
		var idx = fieldName.indexOf("...");
		var f = fieldName.substring(0, idx);
		if (f != table)
			f = table + "." + f;
		f = f + ".";
		if (idx != -1) {
			if (fieldName == '...Show Related Fields...') {
				t.isRightOperandShowingRelatedFields = true;
				t.addChoices(this, f, "", t._filterRightOperand,
						fieldName, null, "yes", t.item);
			} else if (fieldName == '...Remove Related Fields...') {
				t.isRightOperandShowingRelatedFields = false;
				t.addChoices(this, f, "", t._filterRightOperand,
						fieldName, null, "no", t.item);
			}
else {
				t.isRightOperandShowingRelatedFields = true;
				t.addChoices(this, f, "", t._filterRightOperand,
						fieldName, null, "yes", t.item);
			}
			return;
		}
		var o = getSelectedOption(this);
		var fieldName = o.value;
		var name = currentTable = getTableFromOption(o);
		var options = this.options;
		for (var i = 0; i < options.length; i++) {
			var option = options[i];
			if (optionWasSelected(option)) {
				option.innerHTML = getNormalLabel(option);
				option.style.color = 'black';
				option.wasSelected = 'false';
				break;
			}
		}
		if (setup(name) == false)
			return;
		var tr = this.parentNode.parentNode;
		o.normalLabel = o.innerHTML;
		o.innerHTML = getFullLabel(o);
		o.style.color = 'green';
		o.wasSelected = 'true';
		this.style.width = "240px";
	},
	
	addChoices : function(s, target, fValue, filterMethod, fieldName, filter, showRelated, leftOperandElement) {
		var forFilter;
		var onlyRestrictedFields;
		if (filter) {
			forFilter = filter.getOpsWanted();
			onlyRestrictedFields = filter.onlyRestrictedFields;
		}
		var messages = getMessages(MESSAGES_CONDITION_RELATED_FILES);
		while (s.length > 0)
			s.remove(0);
		var placeholder = false;
		var selindex = 0;
		var indentLabel = false;
		var savedItems = new Object();
		var savedLabels = new Array();
		var labelPrefix = '';
		var headersAdded = false;
		var parts = target.split(".");
		var tableName = parts[0];
		var tableDef = getTableReference(tableName);
		var extension = '';
		var prefix = '';
		if (parts.length > 1 && parts[1] != null && parts[1] != '') {
			var o = null;
			if (filterExpanded && parts.length > 2) {
				var tableLabel = tableDef.getLabel();
				if (tableLabel == null)
					tableLabel = "Parent";
				o = addOption(s, tableDef.getName() + "...", tableLabel
						+ " " + messages['lowercase_fields'], false);
				o.tableName = tableDef.getName();
				o.style.color = 'blue';
			}
			if (parts[1] == PLACEHOLDERFIELD) {
				o = addOption(s, PLACEHOLDER,
						messages['-- choose field --'], true);
				o.style.color = 'blue';
				o.tableName = tableDef.getName();
				o.fullLabel = messages['-- choose field --'];
				placeholder = true;
			}
			var sPeriod = "";
			var cname = '';
			for (var i = 1; i < parts.length - 1; i++) {
				var f = parts[i];
				if (f == null || f == '')
					break;
				var elementDef = tableDef.getElement(parts[i]);
				if (elementDef == null)
					break;
				var childTable = tableName;
				if (elementDef.isReference()) {
					childTable = elementDef.getReference();
					if (elementDef.isExtensionElement())
						extension = childTable;
					else
						extension = '';
				} else {
					if (fieldName != null && fieldName.indexOf("...") > -1) {
						childTable = parts[0];
					} else {
						break;
					}
				}
				var parentTable = (extension != '') ? extension : elementDef.getTable().getName();
				var tableDef = getTableReference(childTable, parentTable);
				if (cname.length)
					cname = cname + ".";
				cname += elementDef.getName();
				sPeriod = "." + sPeriod;
				var clabel = sPeriod + elementDef.getLabel() + "-->"
						+ elementDef.getRefLabel() + " "
						+ messages['lowercase_fields'];
				if (s.length === 0) {
					o = addOption(s, PLACEHOLDER,
						messages['-- choose field --'], true);
					o.style.color = 'blue';
					o.tableName = tableDef.getName();
					o.fullLabel = messages['-- choose field --'];
				}
				o = addOption(s, cname + "...", clabel, false);
				o.tablename = tableDef.getName();
				o.style.color = 'blue';
				selindex++;
				indentLabel = true;
				headersAdded = true;
				if (labelPrefix.length)
					labelPrefix += ".";
				labelPrefix += elementDef.getLabel();
				if (prefix.length)
					prefix += ".";
				prefix += elementDef.getName();
			}
		}
		columns = tableDef.getColumns();
		queueColumns[tableDef.getName()] = columns;
		var textIndex = false;
		if (!noOps && !indentLabel) {
			var root = columns.getElementsByTagName("xml");
			if (root != null && root.length == 1) {
				root = root[0];
				textIndex = root.getAttribute("textIndex");
			}
		}
		var items = (extension != '') ? tableDef.getTableElements(extension) : tableDef.getElements();
		for (var i = 0; i < items.length; i++) {
			var item = items[i];
			var t = item.getName();
			if (filterMethod != null && t != fValue) {
				if (filterMethod(leftOperandElement, item,
						this.isRightOperandShowingRelatedFields) == true) {
					continue;
				}
			}
			var t = item.getName();
			if (prefix != '')
				t = prefix + '.' + t;
			if (!noOps && item.getAttribute("filterable") == "no" && !allowConditionsForJournal(item.getAttribute("type"), filter))
				continue;
			if (!item.canRead()) {
				if (t != fValue) {
					continue;
				} else {
					item.setCanRead('yes');
				}
			}
			if (!item.isActive()) {
				if (t != fValue) {
					continue;
				} else {
					item.setActive('yes');
				}
			}
			var label = item.getLabel();
			if ((!elementDef || elementDef.getType() != "glide_var")
					&& !item.isReference()) {
				savedItems[label] = t;
				savedLabels[savedLabels.length] = label;
			}
			if (item.isReference() && leftOperandElement.isReference()) {
				if (item.getReference() == leftOperandElement.getReference()) {
					savedItems[label] = t;
					savedLabels[savedLabels.length] = label;
				}
			}
			if (item.isReference() && !item.isRefRotated()
					&& item.getType() != 'glide_list' && filterExpanded
					&& showRelated == 'yes') {
				label += "-->" + item.getRefLabel();
				label += " " + messages['lowercase_fields'];
				t += "...";
				savedItems[label] = t;
				savedLabels[savedLabels.length] = label;
			}
		}
		items = tableDef.getExtensions();
		for (var i = 0; i < items.length; i++) {
			var item = items[i];
			var label = item.getLabel() + " (+)";
			t = item.getExtName() + "...";
			if (prefix != '')
				t = prefix + '.' + t;
			savedItems[label] = t;
			savedLabels[savedLabels.length] = label;
		}
		if (!onlyRestrictedFields
				&& ((fValue == TEXTQUERY || textIndex)
						&& filterMethod == null || forFilter)) {
			o = addOption(s, TEXTQUERY, messages['Keywords'], (fValue == TEXTQUERY));
			o.fullLabel = messages['Keywords'];
		}
		for (var i = 0; i < savedLabels.length; i++) {
			var sname = savedLabels[i];
			if (s.length === 0 && sname.includes("-->")) {
				this._addPlaceholderOption(s, tableDef, messages);
			}
			var o = addOption(s, savedItems[sname], sname, savedItems[sname] == fValue);
			o.tableName = tableDef.getName();
			if (labelPrefix != '')
				o.fullLabel = labelPrefix + "." + sname;
			else
				o.fullLabel = sname;
			if (indentLabel) {
				var yyy = o.innerHTML;
				o.innerHTML = "&nbsp;&nbsp;&nbsp;" + yyy;
			}
			var v = o.value;
			if (v.indexOf("...") != -1)
				if (o.fullLabel.indexOf("(+)") == -1)
					o.style.color = 'blue';
				else
					o.style.color = 'darkred';
		}
		if (filterExpanded && !onlyRestrictedFields) {
			if (s.length === 0) {
				this._addPlaceholderOption(s, tableDef, messages);
			}
			
			if (showRelated != 'yes') {
				var o = addOption(s, "...Show Related Fields...", messages['Show Related Fields'], false);
				o.style.color = 'blue';
			} else {
				var o = addOption(s, "...Remove Related Fields...",messages['Remove Related Fields'], false);
				o.style.color = 'blue';
			}
		}
		if (!placeholder && (s.selectedIndex == 0 && ((textIndex && fValue != TEXTQUERY) || headersAdded)))
			s.selectedIndex = selindex;
		if (s.selectedIndex >= 0) {
			fValue = getSelectedOption(s).value;
		}
		return s;
	},
	_addPlaceholderOption: function(s, tableDef, messages) {
		var o = addOption(s, PLACEHOLDER,
			messages['-- choose field --'], true);
		o.style.color = 'blue';
		o.tableName = tableDef.getName();
		o.fullLabel = messages['-- choose field --'];
	},
	_filterRightOperand : function(leftOperandElement, rightOperandElement, isRightOperandShowingRelatedFields) {
		var filterOut = true;
		if (null != leftOperandElement && null != rightOperandElement) {
			var leftType = leftOperandElement.getType();
			var rightType = rightOperandElement.getType();
			if ('reference' != leftType) {
				if ('reference' == rightType && isRightOperandShowingRelatedFields)
					filterOut = false;
				if (leftType == rightType)
					filterOut = false;
			} else {
				if ('reference' == rightType)
					filterOut = false;
			}
		}
		return filterOut;
	},
	_renderRightOperandAsFieldList : function(operation) {
		if ("SAMEAS" == operation || "NSAMEAS" == operation
				|| "GT_FIELD" == operation || "LT_FIELD" == operation
				|| "GT_OR_EQUALS_FIELD" == operation
				|| "LT_OR_EQUALS_FIELD" == operation)
			return true;
		return false;
	},
	_addSameAsLabels : function(t, op) {
		if (op == 'SAMEAS' || op == 'NSAMEAS') {
			var ASMSG = getMessage('as');
			var FROMMSG = getMessage('from');
			var span = cel("span", t.tr.tdValue);
			span.style.marginLeft = "3px";
			span.style.marginRight = "5px";
			if (op == 'SAMEAS')
				span.innerHTML = ASMSG;
			else
				span.innerHTML = FROMMSG;
		}
	},
	_parseValues : function(value, delimiter) {
		var sb = "";
		var parts = [];
		if (value == null)
			value = ""
		var escapeChar = '\\';
		var escaped = false;
		for (var i = 0; i < value.length; i++) {
			var checkChar = value.substr(i, 1);
			if (!escaped) {
				if (checkChar == escapeChar) {
					escaped = true;
					continue;
				}
				if (checkChar == delimiter) {
					parts.push(sb);
					sb = "";
					continue;
				}
			} else
				escaped = false;
			sb += checkChar;
		}
		parts.push(sb);
		return parts;
	},
setFilterClass : function(filterClass) {
		this.filterClass = filterClass;
	},
	getFilterClass : function() {
		return this.filterClass;
	},
	initMappingSupport: function(shouldEnable, type, mappingMgr) {
		var that = this;
		var td = this.tr.tdMapping;
		this._parentMappingMgr = mappingMgr;
		if (!td || !mappingMgr)
			return;
		this.mappingType = type;
		if (shouldEnable) {
			td.innerHTML = '<input type="hidden" class="mapping_condition_input" >';
		} else {
			td.innerHTML = "";
		}
		this.mappingInput = td.querySelector(".mapping_condition_input");
		var value = this._initialMappingValue || "";
		this._initMappingValue(value);
		this._initialMappingValue = null;
		this._parentMappingMgr.initElement(this);
	},
	_initMappingValue: function(value) {
		if (value.indexOf("{{") !== -1) {
			this.setMappingValue(value);
			this.activateMapping();
		} else {
			this.deactivateMapping();
		}
	},
	destroyMappingSupport: function() {
		if (this._parentMappingMgr && typeof this._parentMappingMgr.destroyElement === "function")
			this._parentMappingMgr.destroyElement(this);
	},
	activateMapping: function() {
		this._isMappingEnabled = true;
		if (!this.tr)
			return;
		this.tr.tdValue.style.display = "none";
		addClassName(this.tr.tdMapping, "active");
		if (this._parentMappingMgr && typeof this._parentMappingMgr.notifyStateChange === "function")
			this._parentMappingMgr.notifyStateChange(this);
	},
	deactivateMapping: function() {
		this._isMappingEnabled = false;
		if (!this.tr)
			return;
		this.tr.tdValue.style.display = "";
		removeClassName(this.tr.tdMapping, "active");
		if (this._parentMappingMgr && typeof this._parentMappingMgr.notifyStateChange === "function")
			this._parentMappingMgr.notifyStateChange(this);
	},
	_getMappingInput: function() {
		return this.tr.tdMapping.querySelector(".mapping_condition_input");
	},
	getMappingValue: function() {
		return this._getMappingInput().value;
	},
	setMappingValue: function(value) {
		this._getMappingInput().value = value;
	},
	_removeTrailingSpaces: function(value) {
return value.replace(/ +$/, "");
	},
	
	type: "GlideFilterHandlers"
});
var GlideFilterString = Class.create(GlideFilterHandler, {
	_setup : function(values) {
		this.maxValues = 2;
		this.listenForOperChange = true;
		this.rightOperand = values;
	},
	_build : function() {
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			if (this.tr.tdMapping)
				this.tr.tdMapping.hide();
			return;
		}
		var op = this._getOperator();
		if (this._renderDynamicOperandInput(op))
			return;
		if (this._renderRightOperandAsFieldList(op)) {
			this._addSameAsLabels(this, op);
			this._populateRightOperandChoices();
		} else if (op == 'IN') {
			var saveMe = useTextareas;
			useTextareas = true;
			var inp = this._addTextArea();
			inp.style.width = '20em';
			var v = this.values[this.inputCnt - 1];
			if (this._isTemplate()) {
				inp.value = v;
			} else {
				if (v) {
					if (isMSIE)
v = v.replace(/,/g, '\n\r');
					else
v = v.replace(/,/g, '\n');
					inp.value = v;
				}
			}
			useTextareas = saveMe;
		} else if (op === "BETWEEN") {
			this._addTextInput(null, null, 'First input value');
			var txt = document.createTextNode(" " + getMessage('and') + " ");
			this.tr.tdValue.appendChild(txt);
			this._addTextInput(null, null, 'Second input value');
		} else {
			this._addTextInput();
		}
	},
	_getInputValue : function(el) {
		if (el == null)
			return '';
		if (!(el.tagName.toUpperCase() == "TEXTAREA"))
			return GlideFilterHandler.prototype._getInputValue.call(this, el);
		var value = el.value + '';
		if (!this._isTemplate()) {
value = value.replace(/[\n\t]/g, ',');
value = value.replace(/\r/g, '');
		} else
value = this._removeTrailingSpaces(value);
		return this._escapeIfRequired(value);
	},
	_initMappingValue: function(value) {
		this.setMappingValue(value);
		this.activateMapping();
	},
	getValues : function() {
		this._clearValues();
		if (this.inputCnt == 0)
			return "";
		for (var i = 0; i < this.maxValues; i++)
			this.values[i] = this._getInputValue(this.inputs[i]);
		if (this._isMappingEnabled)
			return this.getMappingValue();
		if (this.inputCnt == 1)
			return this.values[0];
		else {
			this._escapeIfRequired();
			return this.values.join("@");
		}
	},
	_initInputs : function() {
		if (this._getOperator() == "DYNAMIC") {
			this.inputCnt = 1;
			this.maxValues = 1;
		} else
			this.inputCnt = 0;
		this.inputs = [];
		for (var i = 0; i < this.maxValues; i++)
			this.inputs[i] = null;
	},
	_initValues : function(values) {
		var op = this._getOperator();
		if (op == "BETWEEN") {
			if (!values)
				this.values = [];
			else
				this.values = this._parseValues(values, "@");
			for (var i = this.values.length; i < this.maxValues; i++)
				this.values[i] = "";
		} else {
			this.values = [];
			this.values[0] = values;
		}
	},
	type: "GlideFilterString"
});
var GlideFilterNumber = Class.create(GlideFilterString, {
	_initValues : function(values) {
		var op = this._getOperator();
		if (op == "BETWEEN") {
			if (!values)
				this.values = [];
			else
				this.values = values.split("@");
			for (var i = this.values.length; i < this.maxValues; i++)
				this.values[i] = "";
		} else {
			this.values = [];
			this.values[0] = values;
		}
	},
	type: "GlideFilterNumber"
});
var GlideFilterDuration = Class.create(GlideFilterHandler, {
	
	_setup: function(values) {
		this.maxValues = 2;
		var valueArray = this._parseValues (values, "@");
this.duration = new GlideDuration(valueArray[0],  this.item);
		if (this._getOperator() == "BETWEEN") {
			this.maxValues = 2;
			if (valueArray.length > 1)
this.durationTo = new GlideDuration(valueArray[1],  this.item);
			else
this.durationTo = new GlideDuration(valueArray[0],  this.item);
				
		}
		this.listenForOperChange = true;
	},
	destroy: function() {
		if (this.tr)
			this.tr.tdValue.innerHTML = "";
		this.inputCnt = 0;
		GlideFilterHandler.prototype.destroy.call(this);
	},
		
	_initValues: function(values) {
		this.values = new Array();
		this.values[0] = this.duration.getDays();
		this.values[1] = this.duration.getHours();
		this.values[2] = this.duration.getMinutes();
		this.values[3] = this.duration.getSeconds();
		this.inputCnt = 4;
		if (this._getOperator() == "BETWEEN") {
			this.values[4] = this.duration.getDays();
			this.values[5] = this.duration.getHours();
			this.values[6] = this.duration.getMinutes();
			this.values[7] = this.duration.getSeconds();
			this.inputCnt = 8;
		}
	},	
	
	getValues: function() {
		this._clearValues();
		if (this.inputCnt == 0)
			return "";
			
		var answer = this.duration.getValue();
		this.values[0] = this.duration.getDays();
		this.values[1] = this.duration.getHours();
		this.values[2] = this.duration.getMinutes();
		this.values[3] = this.duration.getSeconds();
		if (this._isMappingEnabled)
			return this.getMappingValue();
		if (this._getOperator() == "BETWEEN") {
			if (this.durationTo) {
				var answer1 = this.durationTo.getValue();
				this.values[4] = this.durationTo.getDays();
				this.values[5] = this.durationTo.getHours();
				this.values[6] = this.durationTo.getMinutes();
				this.values[7] = this.durationTo.getSeconds();
				return "javascript:gs.getDurationDate('" + answer + "')@javascript:gs.getDurationDate('" + answer1 + "')";
			}
		}
		return "javascript:gs.getDurationDate('" + answer + "')";
	},
	
	_build: function() {
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			if (this.tr.tdMapping)
				this.tr.tdMapping.hide();
			return;
		} else if (this.tr.tdMapping)
			this.tr.tdMapping.show();
		if(this._renderRightOperandAsFieldList(this._getOperator())) {
			this._addSameAsLabels(this, this._getOperator());
			this._populateRightOperandChoices();
		} else {
			this.inputCnt = 1;
			this.duration.buildHTML(this.tr.tdValue);
			
			if (this._getOperator() == "BETWEEN" && this.maxValues == 2) {
				var txt = document.createTextNode(" " + getMessage('and') + " ");
				this.tr.tdValue.appendChild(txt);
				if (!this.durationTo)
					this.durationTo = new GlideDuration();
				this.durationTo.buildHTML(this.tr.tdValue);
			}
			
			
		}
	},
	type: "GlideFilterDuration"
});
var GlideFilterStringMulti = Class.create(GlideFilterString, {
	_setup : function(values) {
		this.maxValues = 1;
		this.listenForOperChange = true;
		this.rightOperand = values;
	},
	_build : function() {
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			return;
		}
		if (this._renderDynamicOperandInput(this._getOperator()))
			return;
		if (this._renderRightOperandAsFieldList(this._getOperator())) {
			this._addSameAsLabels(this, this._getOperator());
			this._populateRightOperandChoices();
		} else
			this._addTextArea();
	},
	type: "GlideFilterStringMulti"
});
var GlideFilterChoice = Class.create(GlideFilterHandler, {
	
	_setup: function(values) {
		this.maxValues = 2;
		this.listenForOperChange = true;
	},
	
	setChoices: function(choices) {
		this.choices = choices;
	},
	
	setWidth: function(width) {
		this.width = width;
	},
	
	setMulti: function(multi) {
		this.multi = multi;
	},
	
	setSize: function(size) {
		this.size = size;
	},
	
	_build: function() {
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			if (this.tr.tdMapping)
				this.tr.tdMapping.hide();
			return;
		}
		if(this._renderRightOperandAsFieldList(this._getOperator())) {
			this._addSameAsLabels(this, this._getOperator());
			this._populateRightOperandChoices();
		}else {		
			var s = this._addSelect(this.width, this.multi, this.size);
			this._fillSelect();
		}
	},
	
	_fillSelect: function(inputIndex) {
		if (inputIndex == null)
			inputIndex = 0;
		if (!this._isEmptyOper() && this.tr.tdMapping)
			this.tr.tdMapping.show();
		var vars = {};
		if (this.values[inputIndex]) {
			var valSplit = this.values[inputIndex].split(',');
			for (var i = 0; i < valSplit.length; i++) {
				vars[valSplit[i]] = true;
			}
		}
		
		var removeNone = false;
		var oper = this._getOperator();
		if ((oper == 'IN') || (oper == 'NOT IN'))
			removeNone = true;
			
		if (isMSIE && this.inputs[0].multiple) {
var isIE6 = /MSIE 6/.test(navigator.userAgent);
			if (isIE6)
				this.inputs[0].focus();
		}
		for (var i = 0; i < this.choices.length; i++) {
			var option = this.choices[i];
			if (option[0] == '' && removeNone)
			 	continue;
			var selected = (vars[option[0]] != null || this.values[inputIndex] == option[0]);
			addOption(this.inputs[inputIndex], option[0], option[1], selected);
		}
	},
	type: "GlideFilterChoice"
});
var GlideFilterChoiceDynamic = Class.create(GlideFilterChoice, {
	
	_initValues: function(values) {
		this.values = (typeof values !== "undefined") ? [values] : [];
	},
	_setup: function(values) {
		this.size = 4;
		this.maxValues = 2;
		this.listenForOperChange = true;
	},
	
	setChoices: function(choices) {
		this.choices = choices;
	},
	_initMappingValue: function(value) {
		this.mappingType = 'choice';
		if (value.indexOf("{{") !== -1) {
			this.setMappingValue(value);
			this.activateMapping();
		} else {
			this.deactivateMapping();
		}
	},
	
	_build: function() {
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			if (this.tr.tdMapping)
				this.tr.tdMapping.hide();
			return;
		}
		var oper = this._getOperator();
		if (this._renderRightOperandAsFieldList(oper)) {
			this._addSameAsLabels(this, oper);
			this._populateRightOperandChoices();
		} else if ((oper == 'LIKE') || (oper == 'STARTSWITH') || (oper == 'ENDSWITH') || (oper == 'NOT LIKE')) {
			if (this.prevOper && (this.prevOper != 'LIKE') && (this.prevOper != 'STARTSWITH') && (this.prevOper != 'ENDSWITH'))
				this._clearValues();
				
			this._addTextInput();
		} else if ((oper == 'IN') || (oper == 'NOT IN')) {
			this.multi = true;
			var s = this._addSelect(this.width, this.multi, this.size);
			if (!this.hasChoices) {
				s.disabled = true;
				this._getChoices();
			} else 
				this._fillSelect();
			
		} else if (oper == 'BETWEEN')	 {
			this.multi = false;
			if (Array.isArray(this.values) && this.values.length === 1)
				this.values = this.values.join('').split("@");
			var s = this._addSelect(this.width, this.multi, 1);
			if (!this.hasChoices) {
				s.disabled = true;
				this._getChoices();
			} else 
				this._fillSelect();
	
			var txt = document.createTextNode(" " + getMessage('and') + " ");
			this.tr.tdValue.appendChild(txt);
			this.multi = false;
			var s = this._addSelect(this.width, this.multi, 1);
			if (!this.hasChoices) {
				s.disabled = true;
				this._getChoices();
			} else 
				this._fillSelect(1);
		} else {
			this.multi = false;
			var s = this._addSelect(this.width, this.multi, 1);
			if (!this.hasChoices) {
				s.disabled = true;
				this._getChoices();
			} else 
				this._fillSelect();
		}
		this.prevOper = oper;
	},
	
	_getChoices: function() {
		if (typeof g_filter_description != 'undefined' && g_filter_description.getChoiceList(this.tr.tableField) != null) {
			var response = loadXML(g_filter_description.getChoiceList(this.tr.tableField));
			this._addChoices(response);	
		} else {
			var ajax = new GlideAjax('PickList');
			ajax.addParam('sysparm_chars', '*');
			ajax.addParam('sysparm_nomax', 'true');
			ajax.addParam('sysparm_name', this.tr.tableField);
			var domain = gel('sysparm_domain');
			if (domain)
				ajax.addParam('sysparm_domain', domain.value);
			if (this.tr.includeExtendedChoices === 'false')
				ajax.addParam('sysparm_include_extended_choices', 'false');
			response = this._resolveChoicesFromCache(ajax);
			this._addChoices(response);
		}
	},
	_resolveChoicesFromCache : function (request) {
		var cacheKey = JSON.stringify(request.params, Object.keys(request.params).sort());
		var choiceCache = window.NOW.GlideFilterHandlersResponseCache;
		var cachedItem = choiceCache.get(cacheKey);
		if (!cachedItem) {
			var response = request.getXMLWait();
			choiceCache.put(cacheKey, response);
			return response;
		}
		return cachedItem;
	},
	_addChoices : function(xml) {
		if (!xml)
			return;
		
		var msg = new GwtMessage();
		var select = this.inputs[0];
		select.disabled = false;
		select.options.length = 0;
		this.choices = [];
		this.hasChoices = true;
		var root = xml.documentElement;
		var dep = root.getAttribute("dependent");
		var items = xml.getElementsByTagName("item");
		var addNone = (root.getAttribute("include_none") === "false") ? false : true;
		for (var i = 0; i < items.length; i++) {
			var item = items[i];
			if (item.getAttribute("value") == '')
				addNone = false;
		}
		if (addNone)
			this.choices[0] = [ '', msg.getMessage('-- None --') ];
		
		for (var i = 0; i < items.length; i++) {
			var item = items[i];
			var v = item.getAttribute("value");
			var l = item.getAttribute("label");
			var option = [ v, l ];
			this.choices.push(option);
		}
		if (dep != null) {
			this.choices = this.choices
					.sort(function(a, b) {
						if ((a[1].toLowerCase() + "") < (b[1]
								.toLowerCase() + "")) {
							return -1;
						}
						if ((a[1].toLowerCase() + "") > (b[1]
								.toLowerCase() + "")) {
							return 1;
						}
						return 0;
					});
			for (var i = 0; i < this.choices.length - 1; i++) {
				if (this.choices[i][1] == this.choices[i + 1][1])
					i = this.amendLabel(i);
			}
		}
		this._fillSelect();
	},
	
	amendLabel: function(i) {
		var dupe = this.choices[i][1];
		while (i < this.choices.length && this.choices[i][1] == dupe) {
			var c = this.choices[i];
			c[1] = c[1] + " - " + c[0];
			i++;
		}
		return i-1;
	},
	type: "GlideFilterChoiceDynamic"
});
var GlideFilterSnapshotChoice = Class.create(GlideFilterChoiceDynamic, {
	_getChoices: function() {
		this._addChoices(this.item.attributes.options);
	},
	_addChoices: function(options) {
		if (!options)
			return;
		var select = this.inputs[0];
		select.disabled = false;
		select.options.length = 0;
		this.hasChoices = true;
		this.choices = JSON.parse(options);
		this._fillSelect();
	},
	type: "GlideFilterSnapshotChoice"
});
var GlideFilterCurrency = Class.create(GlideFilterString, {
	
	initialize: function(tableName, item) {
		GlideFilterHandler.prototype.initialize.call(this, tableName, item);
	},
	
	_operOnChange: function() {
		var lastOp = this.lastOperator; 
		this.lastOperator = this._getOperator();
		
		if((fieldComparisonOperators.indexOf(lastOp) >= 0) != (fieldComparisonOperators.indexOf(this.lastOperator) >= 0)) {
			this.inputCnt = 0;
			this.input = [];
		}
		this.getValues();
		if (lastOp != 'BETWEEN' && this._getOperator() == 'BETWEEN') {
			this.values[2] = this.values[1];
			this.values[1] = '';
		}
		this._unescapeIfRequired();
		this._build();	
	},
	_setup: function(values) {
		this.maxValues = 2;
		this.id = this.tr.tableField + "." + guid();
		this.listenForOperChange = true;
	},
	
	_build: function() {
		GlideFilterString.prototype._build.call(this);
		var s = this._addSelect(60, false, 1);
		this._getCurrencies(s);
	},
	
	_getCurrencies: function(s) {
		var currencies = new Array();
		if (currencies.length != 0)
			return currencies;
		
		var ajax = new GlideAjax("CurrencyConverter");
		ajax.addParam("sysparm_name", "getCurrencies");
		ajax.getXMLAnswer(this._getCurrenciesResponse.bind(this), null, s);
	},
	
	_getCurrenciesResponse: function(answer, s) {		
		var values = answer;
		var currencies = values.split(",");
	var cache = this._getCache();
		cache.put("currencies", values);
		for (var i = 0; i < currencies.length; i++)
			addOption(s, currencies[i], currencies[i]);
			
		this.currency_widget = s;
		this._parseValue();
	},
	
	_resolveFromCache:function() {
		var cache = this._getCache();
		var value = cache.get("currencies");
		if (value)
			return value.split(",");
		
		return [];
	},
	
	_getCache:function() {
		if (typeof(g_cache_currency) != "undefined")
			return g_cache_currency;
			
		g_cache_currency = new GlideClientCache(1);
		
		return g_cache_currency;
	},
	_parseValue: function() {
		if (this.inputs.length == 0)
			return;
		var processSelect = false;
		var currency;
		for (var i=0; i < this.inputs.length; i++) {
			var v = this.inputs[i].value;
			if (!v)
				continue;
			if (v.indexOf('javascript') < 0) {
if (v.match(/[A-Z]+[,;][0-9]+/g)) {
					processSelect = true
var splitValue = v.split(/[,;]+/);
					currency = splitValue[0];
					this.inputs[i].value = splitValue[1];
				}
				continue;
			}
			processSelect = true;
			var sa = v.split(';');
			var first = sa[0].split('\'');
			currency = first[first.length - 1];
			var price = sa[sa.length - 1];
			var priceIndex = price.indexOf('\'');
			price = price.substring(0, priceIndex);
			this.inputs[i].value = price;
		}
		if (!processSelect)
			return;
		var sel = new Select(this.currency_widget);
		sel.selectValue(currency);
	},
	getValues: function() {
		if (this._isMappingEnabled)
			return this.getMappingValue();
		if (!this.currency_widget)
			return '';
		var v = GlideFilterString.prototype.getValues.call(this);
		var tn = this.item.table.tableName;
		var fn = this.item.name;
		var valList = v.split('@');
		if (valList[0] === "NULL")
return "NULL";
		var	fromVal = 'javascript:global.getCurrencyFilter(\'' + tn + '\',\'' + fn + '\', \'' + this.currency_widget.value + ';' + valList[0] + '\')'
		if ((valList.length > 1 && this._getOperator() == 'BETWEEN') || (valList.length > 2))
			return fromVal + '@javascript:global.getCurrencyFilter(\'' + tn + '\',\'' + fn +'\', \'' + this.currency_widget.value + ';' + valList[1] + '\')'
		return fromVal;
	},
	
	destroy : function() {
		GlideFilterString.prototype.destroy.call(this);
		this.currency_widget = null;
	},
	type: "GlideFilterCurrency",
	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideDuration.js */
var GlideDuration = Class.create({
	
	MAX_UNIT_DAYS: 4,
	MAX_UNIT_HOURS: 3,
	MAX_UNIT_MINUTES: 2,
	MAX_UNIT_SECONDS: 1,
	
	initialize: function(value, item) {
		this.values = new Array();
		var gMessage = new GwtMessage();
		var values = ["Days", "Hours", "Minutes", "Seconds"];
		var answer = gMessage.getMessages(values);
		this.daysMessage = answer["Days"];
		this.hourMessage = answer["Hours"];
		this.minutesMessage = answer["Minutes"];
		this.secondsMessage = answer["Seconds"];
		this.maxLevel = this.MAX_UNIT_DAYS;
		if (item) {
			this.item = item;
			this.maxLevel = this._parseMaxUnit(this.item.getNamedAttribute('max_unit'));
		}
		if (value)
			this.values = GlideDuration.parseDurationToParts(value);
		for (var i = this.values.length; i < 4; i++)
			this.values[i] = "0";
	},
	
	buildHTML: function(parent) {		
		this.parent = parent;
		this.days = 0;
		this.hour = 0;
		this.minute = 0;
		this.second = 0;
		if (this.maxLevel == this.MAX_UNIT_DAYS) {
			this._addSpan(this.daysMessage);
			this.days = this._addInput("dur_day", this.getDays());
			this.days.maxLength = "5";
			this.days.style.marginRight = "5px";
		}
		else
			this.hour = (this.getDays() * 24);
		if (this.maxLevel >= this.MAX_UNIT_HOURS) {
			this._addSpan(this.hourMessage);
			this.hour = this._addInput("dur_hour", this.hour + parseInt(this.getHours(), 10));
			if (this.maxLevel == this.MAX_UNIT_HOURS)
this.hour.maxLength = "7";
			this._addSpan(":");
		}
		else
			this.minute = ((this.hour + parseInt(this.getHours(),10)) * 60);
		if (this.maxLevel == this.MAX_UNIT_MINUTES)
			this._addSpan(this.minutesMessage);
		if (this.maxLevel >= this.MAX_UNIT_MINUTES) {
			this.minute = this._addInput("dur_min", this.minute + parseInt(this.getMinutes(), 10));
	        if (this.maxLevel == this.MAX_UNIT_MINUTES)
	            this.minute.maxLength = "9";
			this._addSpan(":");
		}
		else
			this.second = ((this.minute + parseInt(this.getMinutes(),10)) * 60);
		
		if (this.maxLevel == this.MAX_UNIT_SECONDS)
			this._addSpan(this.secondsMessage);
		this.second = this._addInput("dur_sec", this.second + parseInt(this.getSeconds(), 10));
		if (this.maxLevel == this.MAX_UNIT_SECONDS)
		    this.second.maxLength = "10";
	},
	
	_addInput: function (id, value) {
		var ic = cel("input", this.parent);
		ic.className = 'filerTableInput form-control';
		ic.id = id;
		ic.size = "2";
		ic.maxLength = "2";
		ic.value = value;
		ic.setAttribute('aria-label', this.getAriaLabel(id));
		return ic;
	},
	
	_addSpan: function(text) {
		var sp = cel("label", this.parent);
		sp.className = 'condition';
        sp.innerHTML = text;
	},
	
	getDays: function() {
		return this.values[0];
	},
	
	getHours: function() {
		return this.values[1];
	},
	
	getMinutes: function() {
		return this.values[2];
	},
	
	getSeconds: function() {
		return this.values[3];
	},
	
	getValue: function() {
		var day = 0;
		var hour = 0;
		var min = 0;
		var sec = 0;
		if (this.maxLevel == this.MAX_UNIT_DAYS)
			day = parseInt(this.days.value, 10);
		if (this.maxLevel >= this.MAX_UNIT_HOURS)
			hour = parseInt(this.hour.value, 10);
		if (this.maxLevel >= this.MAX_UNIT_MINUTES)
			min = parseInt(this.minute.value, 10);
		if (this.maxLevel >= this.MAX_UNIT_SECONDS)
			sec = parseInt(this.second.value, 10);
		
		if (sec >= 60) {
min += Math.floor(sec / 60);
			sec = sec % 60;
		}
		if (min >= 60) {
hour += Math.floor(min / 60);
			min = min % 60;
		}
		if (hour >= 24) {
day += Math.floor(hour / 24);
			hour = hour % 24;
		}
		
		if (!day || day == null)
			day = 0;
		if (!hour || hour == null)
			hour = 0;
		if (!min || min == null)
			min = 0;
		if (!sec || sec == null)
			sec = 0;
		this.values[0] = day + '';
		this.values[1] = hour + '';
		this.values[2] = min + '';
		this.values[3] = sec + '';
		return day + " " + hour + ":" + min + ":" + sec;
	},
	
	_parseMaxUnit: function(max_unit) {
		switch (max_unit) {
		case 'hours':
			maxLevel = this.MAX_UNIT_HOURS;
			break;
		case 'minutes':
			maxLevel = this.MAX_UNIT_MINUTES;
			break;
		case 'seconds':
			maxLevel = this.MAX_UNIT_SECONDS;
			break;
		default:
			maxLevel = this.MAX_UNIT_DAYS;
		}
		
		return maxLevel;
	},
	getAriaLabel: function(id) {
		var gMessage = new GwtMessage();
		var label = '';
		switch (id) {
			case 'dur_day':
				label = gMessage.getMessage('Days');
				break;
			case 'dur_hour':
				label = gMessage.getMessage('Hours');
				break;
			case 'dur_min':
				label = gMessage.getMessage('Minutes');
				break;
			case 'dur_sec':
				label = gMessage.getMessage('Seconds');
				break;
		}
		return label;
	}
});
GlideDuration.parseDurationToParts = function(value) {
	var MS_IN_DAY = 86400000;
	if (value.indexOf("javascript:") == 0) {
		var s = value.split("'");
		value = s[1];
	}
	var parts = value.split(" ");
	if (parts.length == 2) {
		var times = parts[1].split(":");
		for (var i=0; i < times.length; i++)
			parts[1+i] = times[i];
		var dateParts = parts[0].split("-");
		if (dateParts.length == 3)
parts[0] = parseInt(Date.parse(dateParts[1] + '/' + dateParts[2] + '/' + dateParts[0] + ' 00:00:00 UTC')) / MS_IN_DAY;
	} else if(parts.length === 1) {
		var newPart = [];
		newPart[0] = 0;
		var times = value.split(":");
		for (var i=0; i < times.length; i++)
			newPart[1+i] = times[i];
		parts = newPart;
	}
	return parts;
}
;
/*! RESOURCE: /scripts/classes/GlideFilterReference.js */
var GlideFilterReference = Class.create(GlideFilterHandler, {
	_setup: function(values) {
		this.maxValues = 1;
		this.tableField = this.tr.tableField;
		this.id = this.tableField + "." + guid();
		this.listenForOperChange = true;
		this.rightOperand = values;
	
	},
	
	_initValues: function(values) {
		this.values = [];
        if (values)
           this.values[0] = values;
	},
	_build: function() {
		clearNodes(this.tr.tdValue);
		var inDoctypeMode = (document.documentElement.getAttribute('data-doctype') == 'true');
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			if (this.tr.tdMapping)
				this.tr.tdMapping.hide();
			return;
		}
		var op = this._getOperator();
		var input = this._addTextInput("hidden");
		input.id = this.id;
		
		
		if (this._renderRightOperandAsFieldList(op)) {
			this._addSameAsLabels(this, op);
			this._populateRightOperandChoices();
			return;
		}
		
		if (this._renderDynamicOperandInput(op))
			return;
			
		input = this._addTextInput();
		input.id = "sys_display." + this.id;
		input.onfocus = this._onFocus.bind(this);
		input.onkeydown = this._onKeyDown.bindAsEventListener(this);
		input.onkeypress = this._onKeyPress.bindAsEventListener(this);
		input.onkeyup = this._onKeyUp.bindAsEventListener(this);
		input.autocomplete = "off";
		input.ac_columns = "";
		input.ac_order_by = "";
		if (inDoctypeMode) {
			input.setAttribute("class", "pull-left form-control filter-reference-input");
			input.setAttribute("style", "width: 80%");
		}
		setAttributeValue(input, 'autocomplete', 'off');
		var displayValue = gel('fancy.' + this.values[0]);
		if (displayValue && displayValue.value != '')
			this.inputs[1].value = displayValue.value;
		else if (this.values) {
			this.inputs[1].value = this.values;
			this._resolveReference();
		}
		
		var view = $$("[name='sysparm_view']")[0];
    	if (view && (view.value == "sys_ref_list"))
    		return;
		if (inDoctypeMode) {
			var btn = cel("button");
			btn.setAttribute("class", "icon-search btn btn-default filerTableAction");
			btn.setAttribute("style", "margin-left: 2px");
			var nameOfStackEl = gel("sysparm_nameofstack");
			if (nameOfStackEl && nameOfStackEl.value == "reflist") {
				btn.setAttribute("aria-label", getMessage('Lookup unavailable in Reference Lists, use autocomplete'));
				btn.setAttribute("title", getMessage('Lookup unavailable in Reference Lists, use autocomplete'));
				btn.setAttribute("disabled", "disabled");
			} else {
				btn.setAttribute("aria-label", getMessage('Lookup using list'));
				btn.setAttribute("title", getMessage('Lookup using list'));
				btn.setAttribute("aria-haspopup", true);
				btn.onclick = this._refListOpen.bindAsEventListener(this);
			}
			this.tr.tdValue.style.minWidth = "200px";
			this.tr.tdValue.appendChild(btn);
		} else {
var image = createImage("images/reference_list.gifx", "Lookup using list", this, this._refListOpen);
			image.setAttribute("class", "filerTableAction");
			this.tr.tdValue.appendChild(image);
		}
	},
	_refListOpen: function() {
		var target = this.id;
		if (target.indexOf("IO:") > -1)
			target = target.substring(target.indexOf("IO:"), target.length);
		if (this.useRefQual && this.item.getRefQual() && !this.item.getRefQual().startsWith("javascript:"))
			reflistOpen(target, this.item.getName(), this.item.getReference(), null, false, null, this.item.getRefQual());
		else {
			var qualifier;
			var reference = this.item.getReference();
			if (!reference) {
				reference = "sys_choice";
				qualifier = "table=" + this.getTableName() + "^element=" + this.item.getName();
			}
			reflistOpen(target, this.item.getName(), reference, null, null, null, qualifier);
		}
		this._onRefListOpen();
		return false;
	},
	_onRefListOpen: function () {
	},
	setUseRefQual: function(useRefQual) {
		this.useRefQual = useRefQual;
	},
	getValues: function() {
		this._clearValues();
		if (this._isMappingEnabled)
			return this.getMappingValue();
		if (this._isEmptyOper())
            return '';
		   
  		var oper = this._getOperator();
  		var input = this.inputs[0];
		if (this.inputCnt == 2) {
	   		var userInput = this.inputs[1];
	   		var userInputVal = userInput.value;
	   		if (userInputVal != null && (userInputVal.indexOf("javascript:") > -1))
	   			input = userInput;
	   		else if (this._useDisplayValue(oper))
	   			input = userInput;
	   		else if (this.item.getType() == 'glide_list' && oper == "DYNAMIC")
	   			input = userInput;
		}
		if (input) {
  			return input.value;
		} else
  			return '';
	},
	_useDisplayValue: function(oper) {
		return this.item.getType() != 'glide_list' && oper != '=' && oper != '!=' && oper != "CHANGESFROM" && oper != "CHANGESTO"; 
	},
	
	_resolveReference: function() {
		if (this.values[0]) {
			var ajax = new GlideAjax("ResolveRef");
			ajax.addParam("sysparm_name", this.tableField);
			ajax.addParam("sysparm_value", this.values[0]);
			ajax.getXML(this._resolveReferenceResponse.bind(this));
		}
	},
	_resolveReferenceResponse: function(request) {
		if (!request)
			return;
		
		var xml = request.responseXML;
		if (!xml)
			return;
			
		if (xml) {
		    var items = xml.getElementsByTagName("item");
			if (items && items.length > 0 && items[0] && this.inputs[1])
				this.inputs[1].value = items[0].getAttribute("label");
		}
	},
	_onFocus: function(evt) {
		if (!this.inputs[1].ac) {
			var partialSearchFilterTypes = ',STARTSWITH,ENDSWITH,LIKE,NOT LIKE,';
			var tdOper = this.inputs[1].up(1).tdOper;
			var currentFilterType = (tdOper.firstElementChild || tdOper.children[0] || {}).value;
			if (partialSearchFilterTypes.indexOf(','+currentFilterType+',') > -1)
				this.inputs[1].setAttribute('is_filter_using_contains', 'true');
			this.inputs[1].ac = new AJAXReferenceCompleter(this.inputs[1], this.id, '');
			this.inputs[1].ac.elementName = this.tableField;
			
			this.inputs[1].ac.clearDerivedFields = true;
			if (this.useRefQual && this.item.getRefQual()) {
				this.inputs[1].ac.setIgnoreRefQual(false);
				this.inputs[1].ac.setRefQual(this.item.getRefQual());
			} else {
				this.inputs[1].ac.setIgnoreRefQual(true);
			}
		}
	},
	
	_onKeyDown: function(evt) {
		return acReferenceKeyDown(this.inputs[1], evt);
	},
	
	_onKeyPress: function(evt) {
		return acReferenceKeyPress(this.inputs[1], evt);
	},
	
	_onKeyUp: function(evt) {
		return acReferenceKeyUp(this.inputs[1], evt);
	},
	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideFilterVariables.js */
var GlideFilterVariables = Class.create(GlideFilterHandler, {
	_setup: function(values) {
		this.maxValues = 1;
		this.id = this.tr.tableField + "." + guid();
		this.catID = "item_option_new.cat_item." + guid();
		this.listenForOperChange = true;
		this.rightOperand = values;
	
	},
	
	_initValues: function(values) {
		this.values = [];
		this.varValue = '';
        if (values) {
           this.values[0] = values.substring(0,32);
           this.refQuery = values.substring(32);
           var query = new GlideEncodedQuery(this.tableName, "IO:" + this.values[0] + this.refQuery, null);
           query.parse();
           var terms = query.getTerms();
           var term = terms[0];
           this.varOp = term.getOperator();
           this.varValue = term.getValue();
        }
   	},
	_build: function() {
	    this.queryID = this.tr.tdValue.queryID;
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			return;
		}
        
        this._hideOperators();	
		 
		var input = this._addTextInput("hidden");
		input.id = this.id;
			
		input = this._addTextInput();
		input.id = "sys_display." + this.id;
		input.onfocus = this._onFocus.bind(this);
		input.onRefPick = this._onFocus.bind(this);
		input.onkeydown = this._onKeyDown.bindAsEventListener(this);
		input.onkeypress = this._onKeyPress.bindAsEventListener(this);
		input.onkeyup = this._onKeyUp.bindAsEventListener(this);
		input.autocomplete = "off";
		input.data_completer = "AJAXTableCompleter";
		input.ac_columns = "cat_item;category";
		input.ac_order_by = "";
		input.placeholder = getMessage("Select Variable");
		setAttributeValue(input, 'autocomplete', 'off');
		var displayValue = gel('fancy.' + this.values[0]);
		if (displayValue && displayValue.value != '')
			this.inputs[1].value = displayValue.value;
		else if (this.values) {
			this.inputs[1].value = this.values;
			this._resolveReference();
		}
		if (document.documentElement.getAttribute('data-doctype') == 'true') {
			var btn = cel("button");
			btn.setAttribute("class", "icon-search btn btn-default filerTableAction");
			btn.setAttribute("aria-label", getMessage('Lookup using list'));
			btn.setAttribute("aria-haspopup", true);
			btn.onclick = this._refListOpen.bindAsEventListener(this);
			this.tr.tdValue.appendChild(btn);
		} else {
var image = createImage("images/reference_list.gifx", "Lookup using list", this, this._refListOpen);
			image.setAttribute("class", "filerTableAction")
			this.tr.tdValue.appendChild(image);
		}
		
		this._buildCatItemReference();
		this._makeCatItemFirst();
		
		if (!this.values[0]) 
			return;
		      
	    this._getVariableType(this.values[0]);
	},
	
	_buildCatItemReference: function() {
	   var queryID = this.queryID;
	   td = this.tr.conditionRow.addTD(this.tr, queryID);
	   td.nowrap = true;
	   this.tr.catTD = td;
	   
		var input = this._addTextInput("hidden", td);
		input.id = this.catID;
			
		input = this._addTextInput("", td);
		input.id = "sys_display." + this.catID;
		input.onfocus = this._onFocusCat.bind(this);
		input.onRefPick = this._onFocusCat.bind(this);
		input.onkeydown = this._onKeyDownCat.bindAsEventListener(this);
		input.onkeypress = this._onKeyPressCat.bindAsEventListener(this);
		input.onkeyup = this._onKeyUpCat.bindAsEventListener(this);
		input.autocomplete = "off";
		input.data_completer = "AJAXTableCompleter";
		input.ac_columns = "cat_item;category";
		input.ac_order_by = "";
		input.placeholder = getMessage("Select Item");
		setAttributeValue(input, 'autocomplete', 'off');
		if (document.documentElement.getAttribute('data-doctype') == 'true') {
			var btn = cel("button");
			btn.setAttribute("class", "icon-search btn btn-default filerTableAction");
			btn.setAttribute("aria-label", getMessage('Lookup using list'));
			btn.setAttribute("aria-haspopup", true);
			btn.onclick = this._refListOpenCat.bindAsEventListener(this);
			td.addClassName("form-inline");
			td.appendChild(btn);
		} else {
var image = createImage("images/reference_list.gifx", "Lookup using list", this, this._refListOpenCat);
			image.setAttribute("class", "filerTableAction");
			td.appendChild(image);
		}
	},
	
	destroy: function() {
		this.inputCnt = 0;
		if (this.tr) {
			this.tr.tdValue.innerHTML = "";
            
			if (this.tr.variableID) {	
				this.tr.removeChild(this.tr.variableID);
				this.tr.variableID = null;
			}
			
			if (this.tr.catTD) {
				this.tr.removeChild(this.tr.catTD);
				this.tr.catTD = null;
			}
			
			var td = this.tr.tdOper;
			if (td)	
				td.style.display="inline";	
		}
		
		GlideFilterHandler.prototype.destroy.call(this);
	},
    
	setOriginalTable: function(tableName) {
		this.originalTableName = tableName;
	},
	
	_hideOperators: function() {
	    if (this.tr.tdOper)
		   this.tr.tdOper.style.display="none";
	},
	
    _refListOpen: function() {
        if (this.values[2])
        	reflistOpen(this.id, this.item.getName(), this.item.getReference(), "", false, "", "cat_item="+this.variableRefQual);
        else
        	reflistOpen(this.id, this.item.getName(), this.item.getReference());
        
        return false;
    },  
    
    _refListOpenCat: function() {
        reflistOpen(this.catID, "cat_item", "sc_cat_item");
        return false;
    },      
	
   	getValues: function() {
		this._clearValues();
		if (this._isMappingEnabled)
			return this.getMappingValue();
  		var oper = this._getOperator();
  		var input = this.inputs[0];
		if (input) {
  			return input.value; 	
		} else
  			return '';
	},
	
	getFilterText: function(oper) {
		if (!this.variableFilter)
			return '';
	   return "variables." + this.getValues() + oper + this.variableFilter.getValues();
	},
	
	_useDisplayValue: function(oper) {
		return this.item.getType() != 'glide_list' && oper != '=' && oper != '!=' && oper != "CHANGESFROM" && oper != "CHANGESTO"; 
	},
	
	_resolveReference: function() {
		if (this.values[0]) {
			var ajax = new GlideAjax("ResolveRef");
			ajax.addParam("sysparm_name", this.tr.tableField);
			ajax.addParam("sysparm_value", this.values[0]);
			ajax.getXML(this._resolveReferenceResponse.bind(this));
		}
	},
	_resolveReferenceResponse: function(request) {
		if (!request)
			return;
		
		var xml = request.responseXML;
		if (!xml)
			return;
			
		if (xml) {
		    var items = xml.getElementsByTagName("item");
			if (items && items.length > 0 && items[0] && this.inputs[1])
				this.inputs[1].value = items[0].getAttribute("label");
		}
	},
	
	_resolveReferenceCat: function() {
		if (this.values[2]) {
			var ajax = new GlideAjax("ResolveRef");
			ajax.addParam("sysparm_name", "item_option_new.cat_item");
			ajax.addParam("sysparm_value", this.values[2]);
			ajax.getXML(this._resolveReferenceResponseCat.bind(this));
		}
	},
	
	_resolveReferenceResponseCat: function(request) {
		if (!request)
			return;
		
		var xml = request.responseXML;
		if (!xml)
			return;
			
		if (xml) {
		    var items = xml.getElementsByTagName("item");
			if (items && items.length > 0 && items[0]) {
				this.inputs[3].value = items[0].getAttribute("label");
				this.values[3] = this.inputs[3].value;
			}
		}
	},
	_onFocus: function(evt) {
		if (!this.inputs[1].ac) {	
			this.inputs[1].ac = new AJAXTableCompleter(this.inputs[1], this.id, '');
			this.inputs[1].ac.setFilterCallBack(this._refValueChange.bind(this));
			this.inputs[1].ac.elementName = this.tr.tableField;
			this.inputs[1].ac.setAdditionalValue("ac_columns","cat_item;category");
			if (this.values[2])
			   this.inputs[1].ac.setAdditionalValue("sysparm_ref_qual","cat_item=" + this.variableRefQual);
			else
			   this.inputs[1].ac.setAdditionalValue("sysparm_ref_qual","");
			
			this.inputs[1].ac.clearDerivedFields = true;
		}
	},
	
	_refValueChange: function() {
	   var ref = this.inputs[1].ac;
	   var e = ref.getKeyElement();
	   var id = e.value;
	   this._clearQuery();
	   this.values[0] = id;  
	   if (id) 
	   	 this._getVariableType(id);
	},
	
	_catValueSet: function(catValue) {
	   if (this.values[2] == catValue)
	      return;
	   
	   this.values[2] = catValue;
	   this.variableRefQual = catValue;
	   this.values[3] = catValue;
	   this._resolveReferenceCat();
	   this._setQualifier(this.inputs[1].ac, this.values[2]);
	},
	
	_refValueChangeCat: function() {
	   var ref = this.inputs[3].ac;
	   var e = ref.getKeyElement();
	   var id = e.value;
	   this.values[2] = id;
	   this.variableRefQual = id;
	   this._clearVariable();
	   this._hideOperators();
	   this._clearHandler();
	   this._filterVariableReference();
	},
	
	_clearVariable: function() {
	   var e = gel(this.id);
	   if (e)
	      e.value = '';
	      
	   e = gel("sys_display." + this.id);
	   if (e)
	      e.value = '';
	},
	
	_clearHandler: function() {
	   if (!this.vType)
	      return;
	      
	   this.variableFilter = this._getHandler();
	   var conditionRow = this.tr.conditionRow;
	   var td = this.tr.tdOper;
	   if (td)
	      this.tr.removeChild(td);
	      
	   this.tr.tdOper = null;
	   
	   if (this.tr.tdValue && this.tr.variableID) {
	      this.tr.removeChild(this.tr.tdValue);
	   	  this.tr.tdValue = null;
	   }
	},
	
	_filterVariableReference: function() {
	   this._onFocus();
	   if (this.values[2])
	    this._setQualifier(this.inputs[1].ac, this.values[2]);
	   else
	   	this.inputs[1].ac.setAdditionalValue("sysparm_ref_qual","");
	   	
	   this._clearQuery();
	},
	
	_setQualifier: function(ac, catItem) {
	   if (ac)
	      ac.setAdditionalValue("sysparm_ref_qual","cat_item="+catItem);
	      
	   this._addVariableSets(ac, catItem);
	},
	
	_addVariableSets: function(ac, catItem) {
	   var sets = new GlideRecord('io_set_item');
	   var callback = this._getSetResponse.bind(this, ac, catItem, sets)
	   var fn = function(gr) {
	      callback(ac, catItem, sets);
	   };
	   sets.addQuery("variable_set.type", "one_to_one");
	   sets.query('sc_cat_item', catItem, fn);
	},
	
	_getSetResponse: function(ac, catItem, sets) {
	   if (!sets.hasNext())
	      return;
	      
	   var setList = new Array();
	   while (sets.next()) 
	      setList.push(sets.variable_set+'');
	   
	   this.variableRefQual = catItem + "^OR" + "variable_setIN" + setList.join(",");
	   if (ac)
	      ac.setAdditionalValue("sysparm_ref_qual","cat_item=" + this.variableRefQual);
	},
	
	_clearQuery: function() {
       this.values[0] = "";
       this.refQuery = ""
       this.varOp = ""
       this.varValue = ""  
	},
	
	_getVariableType: function(id) {
	   this.grVariable = new GlideRecord('item_option_new');
	   var callback = this._getVariableResponse.bind(this)
	   var fn = function(gr) {
	      callback();
	   };
	   
	   this.grVariable.query('sys_id', id, fn);
	},
	
	_getVariableResponse: function() {
	   if (!this.grVariable.next()) {
	      this.grVariable = null;
	      this._buildStringType();
	   } else
	      this._buildType(this.grVariable);
	         
	   this._setFilterBasedOnType();
	   
	   if (this.grVariable && this.grVariable.cat_item)
	      this._catValueSet(this.grVariable.cat_item);
	},
	
	_buildStringType: function() {
	   this.vItem = new TableElement("string", "String");
	   this.vItem.setType("string");
	},
	
	_setFilterBasedOnType: function() {
	   this.variableFilter = this._getHandler();
	   if (!this.tr)
	   	  return;
	   var conditionRow = this.tr.conditionRow;
	   var td = this.tr.tdOper;
	   if (td)
	      this.tr.removeChild(td);
	   td = conditionRow.addTD(this.tr, this.queryID);
	   conditionRow.tdOper = td;
	   td.id = "oper";
	   this.tr.tdOper = td;
	   td.style.width="99px";
	   if (!this.tr.variableID) {
	   	   this.tr.tdValue.id = "variableid";
	   	   this.tr.variableID = this.tr.tdValue;
	   	   this.tr.tdValue = null;
	   }
	   if (this.tr.tdValue)
	      this.tr.removeChild(this.tr.tdValue);
	   td = conditionRow.addTD(this.tr, this.queryID);
	   conditionRow.tdValue = td;
	   td.id = "value";
	   td.noWrap = true;
	   this.tr.tdValue = td;
	   this._moveButtons();
       var operSel = addOperators(this.tr.tdOper, this.vType, this.varOp, this.isChoice, false, false);
       this.tr.operSel = operSel;
  	   var tid = this.tr.tableField;
  	   this.tr.tableField = "IO:" + this.values[0];
	   this.variableFilter.create(this.tr, this.varValue);
	   this.tr.tableField = tid;
	},
	
	_makeCatItemFirst: function() {
	    var td = this.tr.tdValue;
	    this.tr.removeChild(td);
	    this.tr.appendChild(td);
		this._moveButtons();
	},
	
	_moveButtons: function() {
	   var td = this.tr.tdOrButton;
	   this.tr.removeChild(td);
	   this.tr.appendChild(td);
	   td = this.tr.tdRemoveButton;
	   this.tr.removeChild(td);
	   this.tr.appendChild(td);
	},
	
	_buildType: function(gr) {
	   	this.vItem = new TableElement(gr.type, gr.type);
	   	if (gr.type == "1")
	      	this.vItem.setType("boolean");
	   	else if (gr.type == "8") {
		     this.vItem.setType("reference");
		     this.vItem.setReference(gr.reference);
	        } else if (gr.type == "10") {
	             this.vItem.setType("calendar");
	   	} else if (gr.type == "7") {
	             this.vItem.setType("checkbox");
	   	} else if (gr.type == "18" || gr.type == "22" || gr.type == "3") {
	      	     this.vItem.setType("multiple_choice");
	   	} else if (gr.type == "5") {
	             this.vItem.setType("select");
	   	} else if (gr.type == "4") {
	      	     this.vItem.setType("numeric_scale");
	   	} else if (gr.type == "9") {
	      	     this.vItem.setType("calendar");
	   	} else if (gr.type == "21") {
		     this.vItem.setType("glide_list");
		     this.vItem.setReference(gr.list_table);
	        } else
	   	     this._buildStringType();
	},
	
	_getHandler: function() {
		if (this.vItem.type == "boolean") {
		   this.vType = "boolean";
		   var handler = new GlideFilterChoice(this.tableName, this.item);
		   handler.setChoices(sysvalues["catalog_boolean"]);
		   return handler;
		}
		
		if (this.vItem.type == "checkbox") {
		   this.vType = "boolean";
		   var handler = new GlideFilterChoice(this.tableName, this.item);
		   handler.setChoices(sysvalues["boolean"]);
		   return handler;
		}
		
		if (this.vItem.type == "multiple_choice") {
		   this.vType = "referencechoice";
		   var handler = new GlideFilterVariablesChoiceDynamic("var.IO:" + this.values[0], this.item);
		   return handler;
		}
		
		if (this.vItem.type == "select") {
		   this.vType = "referencechoice";
		   var handler = new GlideFilterVariablesChoiceDynamic("var.IO:" + this.values[0], this.item);
		   return handler;
		}
		
		if (this.vItem.type == "numeric_scale") {
		   this.vType = "integer";
		   this.isChoice = true;
		   var handler = new GlideFilterVariablesChoiceDynamic("var.IO:" + this.values[0], this.item);
		   return handler;
		}
		
		if (this.vItem.type == "reference") {
this.vType = "referencevariable";
		   var handler = new GlideFilterReference("var.IO:" + this.values[0], this.vItem);
		   return handler;
		}
		if (this.vItem.type == "glide_list") {
		   this.vType = "reference";
		   var handler = new GlideFilterReference("var.IO:" + this.values[0], this.vItem);
		   return handler;
		}
		
		if (this.vItem.type == "calendar") {
		  	this.vType = "calendar";
			var handler = new GlideFilterDate(this.tableName, this.vItem);
			return handler;
		}
		
		this.vType = "string"; 
	   	return new GlideFilterString(this.tableName, this.item);
	},
	
	_onKeyDown: function(evt) {
		return acReferenceKeyDown(this.inputs[1], evt);
	},
	
	_onKeyPress: function(evt) {
		return acReferenceKeyPress(this.inputs[1], evt);
	},
	
	_onKeyUp: function(evt) {
		return acReferenceKeyUp(this.inputs[1], evt);
	},
	
	_onKeyDownCat: function(evt) {
		return acReferenceKeyDown(this.inputs[3], evt);
	},
	
	_onKeyPressCat: function(evt) {
		return acReferenceKeyPress(this.inputs[3], evt);
	},
	
	_onKeyUpCat: function(evt) {
		return acReferenceKeyUp(this.inputs[3], evt);
	},
	
	_onFocusCat: function(evt) {
		if (!this.inputs[3].ac) {	
			this.inputs[3].ac = new AJAXTableCompleter(this.inputs[3], this.catID, '');
			this.inputs[3].ac.setFilterCallBack(this._refValueChangeCat.bind(this));
			this.inputs[3].ac.elementName = "item_option_new.cat_item";
			this.inputs[3].ac.setAdditionalValue("ac_columns","short_description;category");
			this.inputs[3].ac.setAdditionalValue("sysparm_ref_qual","active=true");
			
			this.inputs[3].ac.clearDerivedFields = true;
		}
	},
	z: null
});
var GlideFilterVariablesChoiceDynamic = Class.create(GlideFilterChoiceDynamic, {
	_getChoices: function() {
			var ajax = new GlideAjax('PickList');
			ajax.addParam('sysparm_chars', '*');
			ajax.addParam('sysparm_nomax', 'true');
			ajax.addParam('sysparm_name', this.tableName);
			var response = ajax.getXMLWait();
			this._addChoices(response);
	}
});
;
/*! RESOURCE: /scripts/classes/GlideFilterQuestions.js */
var GlideFilterQuestions = Class.create(GlideFilterVariables, {
	
    _refListOpenCat: function() {
        reflistOpen(this.catID, "cat_item", "sc_cat_item_producer");
        return false;
    },   
    
	_onFocusCat: function(evt) {
		if (!this.inputs[3].ac) {	
			this.inputs[3].ac = new AJAXTableCompleter(this.inputs[3], this.catID, '');
			this.inputs[3].ac.setFilterCallBack(this._refValueChangeCat.bind(this));
			this.inputs[3].ac.elementName = "item_option_new.cat_item";
			this.inputs[3].ac.setAdditionalValue("ac_columns","short_description;category");
			this.inputs[3].ac.setAdditionalValue("sysparm_ref_qual","active=true^sys_class_name=sc_cat_item_producer");
			
			this.inputs[3].ac.clearDerivedFields = true;
		}
	},   
	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideFilterItemVariables.js */
var GlideFilterItemVariables = Class.create(GlideFilterVariables, {
	getFilterText: function(oper) {
		if (!this.variableFilter)
			return '';
		var varSyntax = "variables.";
		if ($j(this.tr).closest('.filter_controls-with-overflow').attr('has-item-variable-syntax') === 'true')
			varSyntax = "variablesHASITEMVARIABLE:";
		return varSyntax + this.getValues() + oper + this.variableFilter.getValues();
	},
	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideFilterVariableMap.js */
var GlideFilterVariableMap = Class.create(GlideFilterHandler, {
	
	_setup: function(values) {
		this.maxValues = 1;
		this.id = this.tr.tableField + "." + guid();
		this.selectedOption = values;
		this.usedFields = {};
		this.varTypes = { 1 : ['string'] };
	},
	_build: function() {
	    this.queryID = this.tr.tdValue.queryID;
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			return;
		}
		
		this._hideOperators();
		this.select = this._addSelect(380, false, 1);
		this.select.onchange = this._updateFields.bind(this);
		
		var displayValue = gel('fancy.' + this.values[0]);
		if (displayValue && displayValue.value != '')
			this.select.value = displayValue.value;
		else if (this.values) {
			this.select.value = this.values;
		}
		      
		this._buildVariableSelect();
		$(this.select).addClassName('filter_type');
		var $select = $j(this.select);
		if (!$select.data('select2'))
			$select.select2();
		
	},
	
	_buildVariableSelect: function() {	
		if (this.values.length == 0 ||  this.values == '-- value --')
			addOption(this.select, this.values, getMessage("-- Select Variable --"), true);
		
		if (this.item == null)
			return;
		
		var arr = g_dynamic_filter_variable_options.split("##");
		for (var i = 0; i < arr.length; i++) {
			var aItem = arr[i];
			if (aItem.length == 0)
				continue;
			var aItemArr = aItem.split("::");
			if (aItemArr.length < 3)
				continue;
			var arrInput = [];
			arrInput.push(aItemArr[1]);
			var translated = getMessages(arrInput);
			addOption(this.select, aItemArr[0], translated[aItemArr[1]], this.selectedOption == aItemArr[0]);
		}
	},
	
	_hideOperators: function() {
	    if (this.tr.tdOper)
		   this.tr.tdOper.style.display="none";
	},      
	
   	getValues: function() {
		this._clearValues();
		if (this._isMappingEnabled)
			return this.getMappingValue();
  		var oper = this._getOperator();
  		var input = this.inputs[0];
		if (input) {
  			return input.value; 	
		} else
  			return '';
	},
	
	_updateFields : function() {
	},
	
	_clearFieldUsed : function(name, condition) {
		this.usedFields[name] = false;
	},
	
	_buildType: function(gr) {
	   	this.vItem = new TableElement(gr.type, gr.type);
	   	if (gr.type == "1")
	      	this.vItem.setType("boolean");
	   	else if (gr.type == "8") {
	   		this.vItem.setType("reference");
	   		this.vItem.setReference(gr.reference);
	    } else if (gr.type == "10") {
	        this.vItem.setType("calendar");
	   	} else if (gr.type == "7") {
	      	this.vItem.setType("checkbox");
	   	} else if (gr.type == "18" || gr.type == "22" || gr.type == "3") {
	      	this.vItem.setType("multiple_choice");
	   	} else if (gr.type == "5") {
	      	this.vItem.setType("select");
	   	} else if (gr.type == "4") {
	      	this.vItem.setType("numeric_scale");
	   	} else if (gr.type == "9") {
	      	this.vItem.setType("calendar");
	   	} 
	},
	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideFilterLabels.js */
var GlideFilterLabels = Class.create(GlideFilterHandler, {
	_setup: function(values) {
		this.maxValues = 1;
		this.id = this.tr.tableField + "." + guid();
		this.labID = "label_entry.label." + guid();
		this.listenForOperChange = true;
		this.rightOperand = values;
	
	},
	
	_initValues: function(values) {
		this.values = [];
		this.varValue = '';
        if (values) {
           this.values[0] = values.substring(0,32);
           this.refQuery = values.substring(32);
           this.varValue = this.refQuery;
        }
   	},
	_build: function() {
	    this.queryID = this.tr.tdValue.queryID;
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			return;
		}
        var enhancedFiltersEnabled = this.getProperty('glide.enable.enhanced.tag.filter.options');
	  if (!enhancedFiltersEnabled)
			this._hideOperators();
		var inDoctypeMode = (document.documentElement.getAttribute('data-doctype') == 'true');
		 
		var input = this._addTextInput("hidden");
		input.id = this.labID;
			
		input = this._addTextInput();
		input.id = "sys_display." + this.labID;
		input.onfocus = this._onFocus.bind(this);
		input.onRefPick = this._onFocus.bind(this);
		input.onkeydown = this._onKeyDown.bindAsEventListener(this);
		input.onkeypress = this._onKeyPress.bindAsEventListener(this);
		input.onkeyup = this._onKeyUp.bindAsEventListener(this);
		input.autocomplete = "off";
		input.data_completer = "AJAXTableCompleter";
		input.ac_columns = "short_description";
		input.ac_order_by = "";
		if (!enhancedFiltersEnabled || this._getOperator() === '=' || this._getOperator() === '!=')
			input.placeholder = getMessage("Select Label");
		setAttributeValue(input, 'autocomplete', 'off');
		var displayValue = gel('fancy.' + this.values[0]);
		if (displayValue && displayValue.value != '')
			this.inputs[1].value = displayValue.value;
		else if (this.values) {
			this.inputs[1].value = this.values;
			this._resolveReference();
		}
		if (inDoctypeMode) {
			var btn = cel("button");
			btn.setAttribute("class", "icon-search btn btn-default filerTableAction");
			btn.setAttribute("aria-label", getMessage('Lookup using list'));
			btn.setAttribute("aria-haspopup", true);
			btn.setAttribute("style", "margin-left: 2px");
			btn.onclick = this._refListOpen.bindAsEventListener(this);
			this.tr.tdValue.appendChild(btn);
		} else {
var image = createImage("images/reference_list.gifx", "Lookup using list", this, this._refListOpen);
			image.setAttribute("class", "filerTableAction")
			this.tr.tdValue.appendChild(image);
		}
		if (!this.varValue) 
			return;
		      
	    this._getVariableType(this.values[0]);
	},
	
	
	destroy: function() {
		this.inputCnt = 0;
		if (this.tr) {
			this.tr.tdValue.innerHTML = "";
            
			if (this.tr.variableID) {	
				this.tr.removeChild(this.tr.variableID);
				this.tr.variableID = null;
			}
			
			var td = this.tr.tdOper;
			if (td)	
				td.style.display="block";	
		}
		
		GlideFilterHandler.prototype.destroy.call(this);
	},
    
	setOriginalTable: function(tableName) {
		this.originalTableName = tableName;
	},
	
	_hideOperators: function() {
	    if (this.tr.tdOper)
		   this.tr.tdOper.style.display="none";
	},
	
    _refListOpen: function() {
        reflistOpen(this.labID, this.item.getName(), "label");
        return false;
    },  
    
	getProperty: function(property) {
		var gr = new GlideRecord('sys_properties');
		gr.addQuery('name', property);
		gr.query();
		if (gr.next())
			return gr.value == "true";
		return false;
	},
	
   	getValues: function() {
		this._clearValues();
		if (this._isMappingEnabled)
			return this.getMappingValue();
		if (this._isEmptyOper())
            return '';
		   
  		var oper = this._getOperator();
  		var input = this.inputs[0];
		if (this.inputCnt == 2) {
			var userInput = this.inputs[1];
			if (this._useDisplayValue(oper))
				input = userInput;
		}
		if (input) {
  			return input.value; 	
		} else
  			return '';
	},
	
	getFilterText: function(oper) {
	   var dot = '.';
	   var operatorToUse = this.getProperty('glide.enable.enhanced.tag.filter.options') ? oper : '=';
	   return dot + this.getValues() + operatorToUse + this.getValues();
	},
	
	_useDisplayValue: function(oper) {
		return this.item.getType() != 'glide_list' && oper != '=' && oper != '!=' && oper != "CHANGESFROM" && oper != "CHANGESTO"; 
	},
	
	_resolveReference: function() {
		if (this.values[0]) {
			var ajax = new GlideAjax("ResolveRef");
			ajax.addParam("sysparm_name", "label_entry.label");
			ajax.addParam("sysparm_value", this.values[0]);
			ajax.getXML(this._resolveReferenceResponse.bind(this));
		}
	},
	_resolveReferenceResponse: function(request) {
		if (!request)
			return;
		
		var xml = request.responseXML;
		if (!xml)
			return;
			
		if (xml) {
		    var items = xml.getElementsByTagName("item");
			if (items && items.length > 0 && items[0] && this.inputs[1])
				this.inputs[1].value = items[0].getAttribute("label");
		}
	},
	
	_onFocus: function(evt) {
		if (!this.inputs[1].ac) {
			var oper = this._getOperator();
			var partialSearchFilterType = oper != '=';
			if (partialSearchFilterType)
				this.inputs[1].setAttribute('is_filter_using_contains', 'true');
			this.inputs[1].ac = new AJAXTableCompleter(this.inputs[1], this.labID, '');
			this.inputs[1].ac.setFilterCallBack(this._refValueChange.bind(this));
			this.inputs[1].ac.elementName = "label_entry.label";
			this.inputs[1].ac.setAdditionalValue("ac_columns","short_description");
			
			this.inputs[1].ac.clearDerivedFields = true;
		}
	},
	
	_refValueChange: function() {
	   var ref = this.inputs[1].ac;
	   var e = ref.getKeyElement();
	   var id = e.value;
	   this.values[0] = id; 
	},
	
	_moveButtons: function() {
	   var td = this.tr.tdOrButton;
	   this.tr.removeChild(td);
	   this.tr.appendChild(td);
	   td = this.tr.tdRemoveButton;
	   this.tr.removeChild(td);
	   this.tr.appendChild(td);
	},
	
	_onKeyDown: function(evt) {
		return acReferenceKeyDown(this.inputs[1], evt);
	},
	
	_onKeyPress: function(evt) {
		return acReferenceKeyPress(this.inputs[1], evt);
	},
	
	_onKeyUp: function(evt) {
		return acReferenceKeyUp(this.inputs[1], evt);
	},
	
	_onKeyDownCat: function(evt) {
		return acReferenceKeyDown(this.inputs[3], evt);
	},
	
	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideFilterReferenceMulti.js */
var GlideFilterReferenceMulti = Class.create(GlideFilterReference, {
	
	_setup: function(values) {
		this.maxValues = 20;
		this.id = this.tr.tableField + "." + guid();
		this.listenForOperChange = true;
	},
	_initAutoCompleter: function() {
		if (!this.inputs[1].ac) {
			if(this.item.getReference("reference") == "sys_user"){
				$(this.inputs[1]).setAttribute('allow_invalid', true)
				$(this.inputs[1]).setAttribute('reference', "sys_user");
			}
			this.inputs[1].ac = new AJAXReferenceCompleterMulti(this.inputs[1], this.id, '');
			this.inputs[1].ac.elementName = this.tr.tableField;
			
			this.inputs[1].ac.clearDerivedFields = true;
		}
	},
	_onFocus: function(evt) {
		this._initAutoCompleter();
	},
	_onRefListOpen: function() {
		this._initAutoCompleter();
	},
	_resolveReference: function() {
		if (this.values) {
			var ajax = new GlideAjax("ResolveRefMulti");
			ajax.addParam("sysparm_name", this.tr.tableField);
			ajax.addParam("sysparm_value", this.values);
			ajax.getXML(this._resolveReferenceResponse.bind(this));
		}
	},
	
	_resolveReferenceResponse: function(request) {
		if (!request)
			return;
		
		var xml = request.responseXML;
		if (!xml)
			return;
			
		if (xml) {
		    var items = xml.getElementsByTagName("item");
		    if (items && items.length > 0) {
		    	this._initAutoCompleter();
		    	this.inputs[1].ac.resetHash();
		    	for (var i=0; i<items.length; i++) {
		    		this.inputs[1].ac.setHash(items[i].getAttribute("name"), items[i].getAttribute("label"));
		    	}
		    	this.inputs[1].ac._setFormValues();
		    }
		}
	},
	
	getValues: function() {
		this._initAutoCompleter();
		if (this._isMappingEnabled)	
			return this.getMappingValue();
		
		return this.inputs[1].ac.getKeyValue();
	},
	
	_initValues: function(values) {
		if (!values)
		   this.values = [];
		else
			this.values = values;
	}
	
});
;
/*! RESOURCE: /scripts/classes/GlideFilterDate.js */
var GlideFilterDate = Class.create(GlideFilterHandler, {
	SYS_DATE_FORMAT: "yyyy-MM-dd",
	SYS_TIME_FORMAT: "HH:mm:ss",
	SYS_DATE_TIME_FORMAT: "yyyy-MM-dd HH:mm:ss",
	_setup: function(values) {
		this.maxValues = 4;
		this.listenForOperChange = true;
		this.userDateFormat = g_user_date_format;
		this.userTimeFormat = g_user_date_time_format.substring(g_user_date_format.length + 1);
		this.userDateTimeFormat = g_user_date_time_format;
		this.id = "GwtGFD_" + guid();
		this.allowTime = this.item.isDateTime();
	},
	_build: function() {
		if (!window.date_calendars) {
			window.date_calendars = {};
		}
		if (window.date_calendars[this.tableName]) {
			this.buildDate(window.date_calendars[this.tableName]);
			return;
		}
            var req = new XMLHttpRequest();
var path = "/api/now/ui/date_time/legacy"
            if(this.tableName)
            	path = path + "?table_name=" + this.tableName;
            req.open("GET", path, false);
req.setRequestHeader('Accept', 'application/json');
            if (typeof g_ck != 'undefined' && g_ck != "") {
                req.setRequestHeader('X-UserToken', g_ck);
            }
			req.setRequestHeader('X-Transaction-Source', window.transaction_source);
            var responseFunction = function(request) {
                var result = JSON.parse(request.response).result;
                var calendar = result.timeAgoDates;
                calendar.DATEPART = result.datePartNoTranslation;
                calendar.BETWEEN = result.between;
                calendar.RELATIVE = result.relative;
                calendar.TRENDVALUES = result.trendValues;
                calendar.WHEN = result.when;
                calendar.TRENDVALUES_WITH_FIELDS_PLURAL = result.trendValuesWithFieldsPlural;
                calendar.TRENDVALUES_WITH_FIELDS = result.trendValuesWithFields;
                calendar.WHEN_WITH_FIELDS = result.whenWithFields;
                window.date_calendars[this.tableName] = calendar;
                
                this.buildDate(calendar);
            }.bind(this);
            req.onreadystatechange = function() { processReqChange(req, responseFunction)};
            req.send(null);
	},
	buildDate: function(dateFilterOptions) {
		this.calendar = dateFilterOptions;
		if (window.sysvalues && window.sysvalues.calendar) {
			var getUniqueExternalDates = this.getUniqueExternalDates(this.calendar, window.sysvalues.calendar);
			for (var i = 0; i < getUniqueExternalDates.length; i++) {
				this.calendar.push(getUniqueExternalDates[i]);
			}
		}
		this.ANDMSG = getMessage('and');
		this.FROMMSG = getMessage('from');
		this.ASMSG = getMessage('as');
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			return;
		}
		var oper = this._getOperator();
		if (this.prevOper && (this.prevOper != oper))
			this._clearValues();
		switch (oper) {
			case 'SAMEAS':
			case 'NSAMEAS':
				if (this.getFilterClass() != "GlideTemplateFilter") {
					this._addDateSelect(this.id, this.calendar['TRENDVALUES_WITH_FIELDS'], this.values[1], [1]);
					var span = cel("span", this.tr.tdValue);
					span.style.marginLeft = "3px";
					span.style.marginRight = "5px";
					if(oper == 'SAMEAS')
						span.innerHTML = this.ASMSG;
					else
						span.innerHTML = this.FROMMSG;
				}
				this._populateRightOperandChoices();
				break;
			case '=':
				var input = this._addCalendar(this.id);
				this.inputs = [input];
				input.type = "text";
				input.value = (this.values[0].indexOf("{{") !== -1 ? "" : this.values[0]);
				input.id = this.id + "_input_1";
				input.allowTime = this.allowTime
				this.inputCnt = 1;
				break;
			case '!=':
			case 'ON':
			case 'NOTON':
				var val = this.values[0];
				if (val)
					val += "@" + this.values[1] + "@" + this.values[2];
				this._addDateChoices(this.id, val, [0, 1, 2], false);
				break;
case '<':
case '>=':
				var pos = 1;
				this._addDateChoices(this.id, this.values[0], [pos], this.allowTime, 'start');
				break;
case '>':
case '<=':
				var pos = 3;
				this._addDateChoices(this.id, this.values[0], [pos], this.allowTime, 'end');
				break;
			case 'BETWEEN':
				this._addDateChoices(this.id, this.values[0], [1], this.allowTime, 'start', oper);
				var span = cel("span", this.tr.tdValue);
				span.style.marginLeft = "3px";
				span.style.marginRight = "5px";
				span.className = "filter-inline-label";
				span.innerHTML = this.ANDMSG;
				this._addDateChoices(this.id + "_2", this.values[1], [3], this.allowTime, 'end', oper);
				this.initBetweenMapping(this.values[0], this.values[1]);
				break;
			case 'DATEPART':
				var trendOper = "EE";
				if (this.values[1]) {
					var parts = this.values[1].split(",");
					if (parts.length == 3)
						trendOper = parts[2].substring(1, 3);
				}
				this._addDateSelect(this.id, this.calendar['RELATIVE'], trendOper, [1]);
				this._addDateSelect(this.id + "_2", this.calendar['DATEPART'], this.values[0], [0]);
				break;
			case 'RELATIVE':
                var thisValues = this.values;
var newOptionsList = this.calendar['RELATIVE'].filter(function(el) { return !(el[1].match(/[GEL]E/i) && !(thisValues && thisValues[0].match(el[1])))});
				this._addDateSelect("1", newOptionsList, this.values[0], [1]);
				var input = this._addTextInput();
				input.value = this.values[3];
				input.style.width = "30px";
				input.maxLength = 5;
				this._addDateSelect(this.id + "_2", this.calendar['TRENDVALUES'], this.values[1], [1]);
				this._addDateSelect(this.id + "_3", this.calendar['WHEN'], this.values[2], [1]);
				break;
			case 'MORETHAN':
			case 'LESSTHAN':
				var input = this._addTextInput();
				if(null == this.values[3] || "" == this.values[3])
					this.values[3]=0;
				if (isMSIE)
					input.style.marginTop = "-1px";
				input.value = this.values[3];
				input.style.width = "30px";
				input.style.marginRight = "2px";
				input.maxLength=2;
				this._addDateSelect(this.id + "_2", this.calendar['TRENDVALUES_WITH_FIELDS_PLURAL'], this.values[1], [1]);
				this._addDateSelect(this.id + "_3", this.calendar['WHEN_WITH_FIELDS'], this.values[2], [1]);
				this._populateRightOperandChoices();
				break;
			case 'SINCE':
				var s = this._addSelect(this.width, this.multi, this.size);
				s.style.marginRight = "3px";
				s.id = this.id + "_select_1";
				var base = new GlideRecord('cmdb_baseline');
				base.addOrderBy('name');
				base.query();
				while (base.next()) {
					var selected = false;
					var value = "javascript:getBaseFilter('" + base.name + "')";
					if (value == this.values[0])
						selected = true;
					var o = addOption(s, value, base.name, selected);
				}
				break;
			case 'ANYTHING':
				break;
		}
		this.prevOper = oper;
		if (notOneOf('BETWEEN ANYTHING RELATIVE SINCE MORETHAN LESSTHAN SAMEAS NSAMEAS DATEPART')) {
			this.initAlphaMapping(this.values[0]);
		}
		function notOneOf(str) {
			return str.split(' ').indexOf(oper) == -1;
		}
	},
	getUniqueExternalDates: function(calendar, globals) {
		if (!Array.isArray(calendar) || !Array.isArray(globals)) return [];
		var stringifiedCalendar = JSON.stringify(calendar);
		return globals.filter(function(item) {
			return stringifiedCalendar.indexOf(JSON.stringify(item)) === -1;
		});
	},
	getValues: function() {
		if (this.inputCnt == 0)
			return "";
		for (var i = 0; i < this.maxValues; i++)
			this.values[i] = this._getInputValue(this.inputs[i]);
		if (this.supportsMapping) {
			if (this._getOperator() == 'BETWEEN') {
				var $td = $j(this.tr.tdValue);
				var $in1 = $td.find('#em_input_1');
				var $in2 = $td.find('#em_input_2');
				if ($in1.val() || $in2.val()) {
					return (
						($in1.val() || this._getDateGenerate(this._convertDate(this.values[0]), 'start')) +
						"@" +
						($in2.val() || this._getDateGenerate(this._convertDate(this.values[1]), 'end'))
					);
				}
			} else if (this._getOperator() == 'ON') {
				var gemVal = $j(this.tr.tdValue).find('#em_input_1').val();
				if (gemVal)
					return gemVal + "@" + gemVal + "@" + gemVal;
			} else {
				var gemVal = $j(this.tr.tdValue).find('#em_input_1').val();
				if (gemVal) {
					return gemVal;
				}
			}
		}
		switch (this._getOperator()) {
			case 'ON':
			case 'NOTON':
				if (this.values[0].indexOf('@') != -1)
					return this.values[0];
				var value = this._convertDate(this.values[0]);
				return value + "@" + this._getDateGenerate(value, 'start') + "@" + this._getDateGenerate(value, 'end');
			case '<':
			case '<=':
				var value = this._convertDate(this.values[0]);
				return this._getDateGenerate(value, 'start');
			case '>':
			case '>=':
				var value = this._convertDate(this.values[0]);
				return this._getDateGenerate(value, 'end');
			case 'BETWEEN':
				var start = this._convertDate(this.values[0]);
				start = this._getDateGenerate(start, 'start');
				var end = this._convertDate(this.values[1]);
				end = this._getDateGenerate(end, 'end');
				return start + "@" + end;
			case 'DATEPART':
				var trendOper = this.values[0];
				var datePart = this.values[1];
				var values = this.calendar['DATEPART'];
				for (var i = 0; i < values.length; i++) {
					if (datePart == values[i][0]) {
						datePart = values[i][1];
						break;
					}
				}
				datePart = datePart.split(")")[0] + ",'" + trendOper + "')";
				return this.values[1] + "@" + datePart;
				break;
			case '=':
			case '!=':
				return this.values[0];
				break;
			case 'RELATIVE':
				return this.values[0] + "@" + this.values[2] + "@" + this.values[3] + "@" + this.values[1];
				break;
			case 'SAMEAS':
			case 'NSAMEAS':
				if (this.values[1] == "")
					return this.values[0];
				return this.values[1] + "@" + this.values[0];
				break;
			case 'MORETHAN':
			case 'LESSTHAN':
				if (isNaN(this.values[0]))
					this.values[0] = 0;
				return this.values[3] + "@" + this.values[1] + "@" + this.values[2] + "@" + this.values[0];
				break;
			case 'SINCE':
				return this.values[0];
				break;
			case 'ANYTHING':
				return "";
				break;
			default:
				if (this.inputCnt == 1)
					return this.values[0];
				else
					return this.values.join("@");
		}
	},
    _addDateSelect: function (id, values, matchValue, positions, dynamicOptions) {
        var s = this._addSelect(this.width, this.multi, this.size);
        s.style.marginRight = "3px";
        s.id = this.id + "_select_" + id;
        this._addDateSelectOptions(s, values, matchValue, positions);
        if (dynamicOptions)
            this._addDateSelectOptions(s, dynamicOptions, matchValue, positions);
        return s;
    },
    _addDateSelectOptions: function(select, values, matchValue, positions) {
        if(!values)
            return;
        var map = getMessages(buildMap(values, 0));
        var previousValue = null;
        for (var i = 0; i < values.length; i++) {
            var option = values[i];
            var value = "";
            for (var pos = 0; pos < positions.length; pos++) {
                if (pos > 0)
                    value += "@";
                value += option[positions[pos]];
            }
            if (previousValue == null || previousValue != value)
                addOption(select, value, map[option[0]], value == matchValue);
            previousValue = value;
        }
    },
	_addDateChoices: function(id, matchValue, positions, allowTime, defaultTime, operator) {
        var dynamicOptions = this._getDynamicCalendarOption();
        var select = this._addDateSelect(id, this.calendar, matchValue, positions, dynamicOptions);
		this._addDatePicker(id, select, matchValue, allowTime, defaultTime, operator);
	},
    _getDynamicCalendarOption: function() {
        if (typeof g_dynamic_filter_options_calendar == 'undefined' || g_dynamic_filter_options_calendar == '')
            return [];
        var dynamicOptions = [];
        var items = g_dynamic_filter_options_calendar.split('##');
        for (var i = 0; i < items.length; i++) {
            if (items[i].length <= 0)
                continue;
            var option = items[i].split('::');
            dynamicOptions.push(option);
        }
        return dynamicOptions;
    },
	_addDatePicker: function(id, select, value, allowTime, defaultTime, operator) {
		var found = (select.selectedIndex != -1);
		if ((select.selectedIndex == 0) && (value) && (value != select.options[0].value))
			found = false;
		if (!found) {
			value = this._getDateFromValue(value);
			addOption(select, value, value, true);
		}
		select.allowTime = allowTime;
		select.defaultTime = defaultTime;
		if (defaultTime === 'start' && operator === 'BETWEEN') {
			select.title = getMessage('Choose first option');
		} else if (defaultTime === 'end' && operator === 'BETWEEN') {
			select.title = getMessage('Choose second option');
		}
		this._addCalendar(id, defaultTime, operator);
	},
	_addCalendar: function(id, defaultTime, operator) {
		var chooseDate = getMessage('Choose date...');
		var associatedField = this.item && this.item.label;
		if (defaultTime && operator === 'BETWEEN') {
			if (defaultTime === 'start') {
				chooseDate = getMessage('Choose start date...');
			} else {
				chooseDate = getMessage('Choose end date...');
			}
		} else {
			chooseDate = getMessage('Choose date...');
		}
		if (document.documentElement.getAttribute('data-doctype') == 'true') {
			var input = addTextInput(this.tr.tdValue, "", "hidden", associatedField);
			var cal = cel("button", this.tr.tdValue);
			cal.id = "cal_" + id;
			cal.name = cal.id;
			cal.setAttribute('type', 'button');
			cal.setAttribute('aria-label', chooseDate);
			cal.title = chooseDate;
			cal.onclick = this._calendarPopup.bind(this, id, cal);
			cal.style.marginRight = "1px";
			cal.style.verticalAlign = "top";
			cal.className = "btn btn-default icon-calendar";
			input.id = this.id + "_input_" + id;
			input.onchange = this._dateTimeComplete.bind(this, id);
		} else {
			var cal = cel("img", this.tr.tdValue);
			cal.id = "cal_" + id;
			cal.name = cal.id;
cal.src = "images/small_calendar.gifx";
			cal.alt = chooseDate;
			cal.title = chooseDate;
			cal.onclick = this._calendarPopup.bind(this, id);
			cal.style.marginLeft = "2px";
			cal.className = "button";
			var input = addTextInput(this.tr.tdValue, "", "hidden", associatedField);
			input.id = this.id + "_input_" + id;
			input.onchange = this._dateTimeComplete.bind(this, id);
		}
		return input;
	},
	_getDateFromValue: function(value) {
		var value = value.split("@")[0];
		var prefixString = "javascript:gs.dateGenerate(";
		if (value.indexOf(prefixString) == 0) {
			var parts = value.split("'");
			if (parts.length == 5) {
				value = parts[1];
				if (isDate(parts[3], this.SYS_TIME_FORMAT)) {
					var dt = getDateFromFormat(parts[3], this.SYS_TIME_FORMAT);
					value += " " + formatDate(new Date(dt), this.SYS_TIME_FORMAT);
				}
			}
		}
		if (isDate(value, this.SYS_DATE_TIME_FORMAT)) {
			var dt = getDateFromFormat(value, this.SYS_DATE_TIME_FORMAT);
			value = formatDate(new Date(dt), this.userDateTimeFormat);
		} else if (isDate(value, this.SYS_DATE_FORMAT)) {
			var dt = getDateFromFormat(value, this.SYS_DATE_FORMAT);
			value = formatDate(new Date(dt), this.userDateFormat);
		}
		return value;
	},
	_getDateGenerate: function(value, tag) {
		if (value.indexOf("javascript:") != -1)
			return value;
		if (isDate(value, this.SYS_DATE_TIME_FORMAT)) {
			var dt = getDateFromFormat(value, this.SYS_DATE_TIME_FORMAT);
			value = formatDate(new Date(dt), this.SYS_DATE_FORMAT);
			tag = formatDate(new Date(dt), this.SYS_TIME_FORMAT);
		}
		return "javascript:gs.dateGenerate('" + value + "','" + tag + "')";
	},
	_convertDate: function(value) {
		if (value.indexOf("javascript:") != -1)
			return value;
		if (isDate(value, this.userDateTimeFormat)) {
			var dt = getDateFromFormat(value, this.userDateTimeFormat);
			value = formatDate(new Date(dt), this.SYS_DATE_TIME_FORMAT);
		} else if (isDate(value, this.userDateFormat)) {
			var dt = getDateFromFormat(value, this.userDateFormat);
			value = formatDate(new Date(dt), this.SYS_DATE_FORMAT);
		}
		return value;
	},
	_getCalendarInput: function(id) {
		return gel(this.id + "_select_" + id);
	},
	_calendarPopup: function(id, btn) {
		var select = this._getCalendarInput(id);
		var currentDate = '';
		var defaultTime = "start";
		var allowTime = this.allowTime;
		if (select) {
			if (select && select.value.indexOf('javascript') == -1)
				currentDate = select.value;
			defaultTime = select.defaultTime
			allowTime = select.allowTime;
		}
		var format;
		if (allowTime) {
			format = this.userDateTimeFormat;
			if (!isDate(currentDate, format)) {
				var dt = new Date();
				if (isDate(currentDate, this.userDateFormat))
					dt = new Date(getDateFromFormat(currentDate, this.userDateFormat));
				if (defaultTime == 'end')
					dt.setHours(23, 59, 59);
				else
					dt.setHours(0, 0, 0);
				currentDate = formatDate(dt, this.userDateTimeFormat);
			}
		} else {
			format = this.userDateFormat;
		}
		var input = gel(this.id + "_input_" + id);
		if (!input)
			input = gel(this.id + '_input_1');
		input.value = currentDate;
ScriptLoader.getScripts('scripts/classes/GwtDateTimePicker.js', function() {
			new GwtDateTimePicker(input.id, format, allowTime, select || input );
		})
		return false;
	},
	_dateTimeComplete: function(id) {
		var select = gel(this.id + "_select_" + id);
		var input = gel(this.id + "_input_" + id);
		if (!select)
			return;
		var option = select.options[select.selectedIndex];
		var value = option.value;
		if (isDate(value, this.userDateFormat) || isDate(value, this.userDateTimeFormat)) {
			option.value = input.value;
			option.text = input.value;
		} else
			addOption(select, input.value, input.value, true);
    },
	initBetweenMapping: function(value1, value2) {
		var $td = $j(this.tr.tdValue);
		var $btn1   = this.emTemplate.makeBtn();
		var $field1 = this.emTemplate.makeField();
		var $input1 = this.emTemplate.makeInput('em_input_1', value1);
		var $nativeInput1 = $j(this.inputs[0]);
		var $dateBtn = $td.find('#cal_1');
		$dateBtn.after($btn1);
		$dateBtn.after($field1);
		$dateBtn.after($input1);
		var id = this.id;
		this._initMappingComponent($field1, $btn1, id, {
			glideType: 'calendar',
			isMultiText: false,
			originalMapping: value1.indexOf("{{") !== -1 ? value1 : "",
			parent: {
				show: function() {
					$td.find('#cal_1, select[id*="_select_1"]').show();
				},
				hide: function() {
					$td.find('#cal_1, select[id*="_select_1"]').hide();
				},
				onValue: function(msg) {
					var value = msg.wrappedValue;
					$input1.val(value);
					if (value.indexOf("{{") == -1) {
						$nativeInput1.val($nativeInput1.find("option:first").val());
					}
				}
			}
		});
		var $btn2   = this.emTemplate.makeBtn();
		var $field2 = this.emTemplate.makeField();
		var $input2 = this.emTemplate.makeInput('em_input_2', value2);
		var $nativeInput2 = $j(this.inputs[1]);
		$btn2.css({"margin-right": "90px"})
		$td.append($input2);
		$td.append($field2);
		$td.append($btn2);
		this._initMappingComponent($field2, $btn2, id, {
			glideType: 'calendar',
			isMultiText: false,
			originalMapping: value2.indexOf("{{") !== -1 ? value2 : "",
			parent: {
				show: function() {
					$td.find('#cal_2, select[id*="'+ id +'_select_'+ id +'_2"]').show();
					$td.find('button[id*="cal_'+ id +'_2"]').show();
				},
				hide: function() {
					$td.find('#cal_2, select[id*="'+ id +'_select_'+ id +'_2"]').hide();
					$td.find('button[id*="cal_'+ id +'_2"]').hide();
				},
				onValue: function(msg) {
					var value = msg.wrappedValue;
					$input2.val(value);
					if (value.indexOf("{{") == -1) {
						$nativeInput2.val($nativeInput2.find("option:first").val());
					}
				}
			}
		});
		$j(this.tr.tdValue)[this.supportsMapping ? 'removeClass' : 'addClass']("gem-unsupported");
		this._removePlaceholderBtn();
	},
	initAlphaMapping: function(value) {
		value = value.indexOf("{{") !== -1 ? value : "";
		var $td = $j(this.tr.tdValue);
		var $btn = this.emTemplate.makeBtn();
		var $field = this.emTemplate.makeField();
		var $input = this.emTemplate.makeInput('em_input_1', value);
		$td.append($field).append($btn).append($input);
		var $nativeInput = $j(this.inputs[0]);
		var id = this.id;
		this._initMappingComponent($field, $btn, id, {
			glideType: 'calendar',
			isMultiText: false,
			originalMapping: value.indexOf("{{") !== -1 ? value : "",
			parent: {
				show: function() {
					$td.find('#cal_1, select[id*="' + id + '_select_' + id +'"]').show();
						$td.find('input[id*="_input_1"]').show();
					$td.find('button[id*="cal_"]').show();
				},
				hide: function() {
					$td.find('#cal_1, select[id*="' + id + '_select_' + id +'"]').hide();
						$td.find('input[id*="_input_1"]').hide();
					$td.find('button[id*="cal_"]').hide();
				},
				onValue: function(msg) {
					var value = msg.wrappedValue;
					$input.val(value);
					if (value.indexOf("{{") == -1) {
						$nativeInput.val($nativeInput.find("option:first").val());
					}
				}
			}
		});
		$j(this.tr.tdValue)[this.supportsMapping ? 'removeClass' : 'addClass']("gem-unsupported");
		this._removePlaceholderBtn();
	},
	_removePlaceholderBtn: function() {
		$j(this.tr.tdMapping).html("");
		$j(this.tr.tdValue).css("display", "");
	},
	emTemplate: {
		makeBtn: function() {
			return $j(
				'<button role="button" class="btn btn-default em-field-toggle em-alt-btn em-icon-em gem-unsupported-target" ' +
						 'title="Set date from a contextual value"' +
						 'style="vertical-align: top;">' +
'</button>'
			);
		},
		makeField: function() {
			return $j(
'<em-alt-input class="hidden gem-unsupported-target"></em-alt-input>'
			);
		},
		makeInput: function(id, value) {
			var x = $j('<input type="hidden" id="' + id + '">');
			x.val(value || "");
			return x;
		}
	},
	_initMappingComponent: function($field, $btn, id, opts) {
		if (window.g_elementMappingMgr) {
			g_elementMappingMgr.initSubField($field, $btn, this.mappingId, opts)
		}
	},
	initMappingSupport: function(shouldEnable, type, mappingMgr) {
		var td = this.tr.tdMapping;
		if (!td || !mappingMgr)
			return;
		this.mappingType = type;
		this.supportsMapping = !!shouldEnable;
		$j(this.tr.tdValue)[this.supportsMapping ? 'removeClass' : 'addClass']("gem-unsupported");
	},
	destroyMappingSupport: function() {
	},
	activateMapping: function() {
	},
	deactivateMapping: function() {
	},
	_initMappingValue: function(value) {
	},
	type: 'GlideFilterDate'
});
var GlideFilterDateEncrypted = Class.create(GlideFilterDate, {
	_getCalendarInput: function(id) {
		return gel(this.id + "_input_1");
	},
	_getDateGenerate: function(value) {
		return value;
	},
	_build: function() {
		clearNodes(this.tr.tdValue);
		this.inputCnt = 0;
		if (this._isEmptyOper()) {
			this._addInvisibleTextInput();
			return;
		}
		var oper = this._getOperator();
		if (this.prevOper && (this.prevOper != oper))
			this._clearValues();
		switch (oper) {
			case 'ON':
			case 'NOTON':
			case '=':
			case '!=':
			case '<':
			case '<=':
			case '>':
			case '>=':
				var value = this.values[0];
				this.setTextInput(this.id, value, this.allowTime);
				break;
			default:
				return '';
		}
		this.prevOper = oper;
	},
	setTextInput: function(id, value, allowTime) {
		var input = this._addCalendar(id);
		this.inputs = [input];
		input.type = "text";
		input.readOnly = true;
		input.value = (value.indexOf("{{") !== -1 ? "" : value);
		input.onclick = this._calendarPopup.bind(this, id);
		if (input.value == "") {
			var msg = NOW.msg;
			input.placeholder = msg.getMessage('-- choose date --');
		}
		input.id = id + "_input_1";
		input.allowTime = allowTime;
		this.inputCnt = 1;
	},
});
;
/*! RESOURCE: /scripts/classes/GlideFilterGeopoint.js */
var GlideFilterGeopoint = Class.create(GlideFilterString, {
	initialize: function(tableName, item) {
		GlideFilterHandler.prototype.initialize.call(this, tableName, item);
		this.FROMMSG = getMessage('from');
		this.POINTLABEL = getMessage('Coordinates');
		this.CNVRTMSG = getMessage('Convert value to a different unit')
		this.unit = "m";
		this.id = "GwtGFG_" + guid();
	},
	_setup: function() {
		this.maxValues = 1;
		this.id = this.tr.tableField + "." + guid();
		this.listenForOperChange = true;
	},
	_init: function(values) {
		this.inputs = [];
		this.parts = [];
		if ("=" == this._getOperator() || "!=" == this._getOperator()) {
			if (!values) {
				this.values = "";
				this.parts = [""];
				return;
			}
			this.values = [values];
			this.parts = [values];
			return;
		}
		if (!values && "DISTANCE_SPHERE_WITHIN" == this._getOperator())
			values = "";
		var distance = "";
		var unit = "m";
		var point = "";
var pointMatches = values.match(/\((.*?)\)/);
var distMatches =  values.match(/[\d\.,]+$/);
		if (!distMatches) {
			this.parts = [distance, unit, point];
			this.values = point;
			return;
		}
		var analyzed = this._getDistanceAndUnitFromConversion(distMatches[0]);
		distance = analyzed.distance;
		unit = analyzed.unit;
		if(pointMatches)
			point = pointMatches[0];
		this.parts = [distance, unit, point];
		this.values = [distance];
	},
	_build: function() {
		GlideFilterString.prototype._build.call(this);
		var input = this.inputs[0];
		if (!input.id)
			input.id = "distance_" + this.id;
		if (this.parts && this.parts.length == 3) {
			var s = this._addSelect(80, false, 1);
			if (!s.id)
				s.id = "unit_" + this.id;
			addOption(s, "m", "-- unit--");
			this._getUnits(s);
			this.unit_widget = s;
			s.addEventListener("change", (e) => {
				this.unit = e.currentTarget.value;
			});
			this._addUnitConverter(this.tr.tdValue, input, s);
			this._addCoordinateInput(this.tr.tdValue, input);
		}
	},
	_addUnitConverter: function(element, input, unit) {
		var converter = cel("button", element);
		converter.className = 'filter-inline-label';
converter.innerHTML = '<i className="icon-edit"></i>';
		converter.id = "cnv_" + this.id;
		converter.name = converter.id;
		converter.setAttribute('type', 'button');
		converter.setAttribute('aria-label', this.CNVRTMSG);
		converter.title = this.CNVRTMSG;
		converter.addEventListener('click', (e) => {
			this._converterPopup(input, unit);
		});
		converter.style.marginInlineEnd = "1px";
		converter.style.verticalAlign = "top";
		converter.className = "btn btn-default icon-edit";
	},
	_addCoordinateInput: function(element, input) {
		var span = cel("span", element);
		span.className = 'filter-inline-label';
		span.innerHTML = this.FROMMSG;
		var pointInput = this._addTextInput(null, null, "Point");
		pointInput.value = this.parts[2];
	},
	_operOnChange: function() {
		var lastOp = this.lastOperator;
		this.lastOperator = this._getOperator();
		var newOp = this._getOperator();
		if (lastOp == newOp)
			return this._build();
		var unit = this.parts[1] || "m";
		var point = this.parts[2] || this.parts[0];
		this.values = [];
		if ( "DISTANCE_SPHERE_WITHIN" == newOp) {
			this.inputCnt = 3;
			this.values =[];
			this.parts =["", unit, point];
		}
		if ("=" == newOp || "!=" == newOp) {
			this.inputCnt = 1;
			this.values = [point];
			this.parts = [point];
		}
		this._unescapeIfRequired();
		this._build();
	},
	_converterPopup: function(inputElement, unitElement) {
ScriptLoader.getScripts('scripts/classes/GwtGeopointUnitPicker.js?v=' + g_builddate, function() {
			new GwtGeopointUnitPicker({inputFieldId: inputElement.id, unitSelectId: unitElement.id,
					positionElement: inputElement, initialValue: inputElement.value, initialFrom: unitElement.value})
		})
	},
	_getDistanceAndUnitFromConversion: function(distance) {
		var asNumber = Number(distance);
		var ret = {distance: distance, unit: "m"};
		if (isNaN(asNumber))
			return ret;
		ret.distance = asNumber;
		ret.unit = this._determineBestUnit(asNumber);
		this.unit = ret.unit ? ret.unit : "m";
		if (ret.unit == 'm')
			return ret;
		ret.distance = this._convertFromUnitToUnit(ret.distance, "m", this.unit);
		return ret;
	},
	_getUnits: function(s) {
		var units = this._resolveFromCache("geo_point_units");
		if (units.length != 0)
			return this._addUnitsToSelect(units, s);
		var ajax = new GlideAjax("snAJAXGeoPointUtility");
		ajax.addParam("sysparm_name", "getUnits");
		ajax.getXMLAnswer(this._getUnitsResponse.bind(this), null, s);
	},
	_getUnitsResponse: function(answer, s) {
		var units = [];
		try {
			units = JSON.parse(answer);
		} catch (e) {
			units = [];
		}
		if (units.length > 0) {
			var cache = this._getCache();
			cache.put("geo_point_units", units);
		}
		return this._addUnitsToSelect(units, s);
	},
	_addUnitsToSelect: function(units, s) {
		this._removeAllOptions(s);
		for (var i = 0; i < units.length; i++)
			addOption(s, units[i]["abbreviation"], units[i]["display_value"]);
		if(this.unit)
			s.value = this.unit;
	},
	_determineBestUnit: function(num) {
		return "m";
	},
	_convertFromUnitToUnit: function(distance, unitFrom, unitTo) {
		var conversionToMeters = {
			m: function(val) {
				return val;
			},
			km: function(val) {
				return val * 1000;
			},
			ft: function(val) {
				return val * .3048
			},
			mi: function(val) {
				return val * 1609.34;
			}
		}
		var conversionFromMeters = {
			m: function(val) {
				return val;
			},
			km: function(val) {
return val / 1000;
			},
			ft: function(val) {
				return val * 3.28084
			},
			mi: function(val) {
				return val * 0.000621371;
			}
		}
		if (!unitTo || !unitFrom || unitTo == unitFrom)
			return distance;
		if (!conversionToMeters.hasOwnProperty(unitTo) || !conversionFromMeters.hasOwnProperty(unitFrom))
			return distance;
		if (unitFrom == "m")
			return this._convertToIntegerIfNeeded(conversionFromMeters[unitTo].call(this, distance));
		var distanceMeters = this._convertToIntegerIfNeeded(conversionToMeters[unitFrom].call(this, distance));
		return this._convertToIntegerIfNeeded(conversionFromMeters[unitTo].call(this, distanceMeters));
	},
	_convertToIntegerIfNeeded: function(number, tolerance = 0.0001) {
		if (isNaN(number))
			return number;
		if (number < 1)
			return Number.parseFloat(number).toFixed(4);
		var rounded = Math.round(number);
		if (Math.abs(number - rounded) < tolerance)
			return rounded;
		return Number.parseFloat(number).toFixed(4);
	},
	_getTables: function(s) {
		var tables = this._resolveFromCache("geo_point_tables");
		if (tables.length != 0)
			return this._addTablesToSelect(tables, s);
		var ajax = new GlideAjax("GeopointUtility");
		ajax.addParam("sysparm_name", "getTables");
		ajax.getXMLAnswer(this._getTablesResponse.bind(this), null, s);
	},
	_getTablesResponse: function(answer, s) {
		var tables = [];
		try {
			tables = JSON.parse(answer);
		} catch (e) {
			tables = [];
		}
		if (tables.length > 0) {
			var cache = this._getCache();
			cache.put("geo_point_tables", tables);
		}
		this._addTablesToSelect(tables, s);
	},
	_addTablesToSelect: function(tables, s) {
		this._removeAllOptions(s);
		for (var i = 0; i < tables.length; i++)
			addOption(s, tables[i]["table"], tables[i]["label"]);
		this.table_widget = s;
	},
	_resolveFromCache:function(name) {
		var cache = this._getCache();
		var value = cache.get(name);
		if (value)
			return value;
		return [];
	},
	_getCache:function() {
		if (typeof(g_cache_units) != "undefined")
			return g_cache_units;
		g_cache_units = new GlideClientCache(1);
		return g_cache_units;
	},
	_removeAllOptions: function(select) {
		if (!select)
			return;
		var s = new Select(select);
		s.clear();
	},
	getValues: function() {
		if (!this.inputs)
			return "";
		if (this.inputs && this.inputs.length == 3 && this.parts && this.parts.length == 3) {
			var distance = this._convertFromUnitToUnit(this.inputs[0].value, this.inputs[1].value, "m");
			var point = this._ensureFormat(this.inputs[2].value);
			return point + "<" + distance;
		}
		return this._ensureFormat(this.inputs[0].value);
	},
	_ensureFormat: function(value) {
		if (!value)
			return "(0,0)"
		value = value + "";
		if (!value.startsWith("("))
			value = "(" + value;
		if (!value.endsWith(")"))
			value = value + ")";
		return value;
	},
	destroy : function() {
		GlideFilterString.prototype.destroy.call(this);
		this.unit_widget = null;
	},
	type: 'GlideFilterGeopoint',
	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideEventHandler.js */
var GlideEventHandler = Class.create({
    initialize: function (handlerName, handler, fieldName) {
        this.handlerName = handlerName;
        this.handler = handler;
        this.fieldName = fieldName;
    }
});
;
/*! RESOURCE: /scripts/classes/GlideUIElement.js */
var GlideUIElement = Class.create({
	CACHE_ELEMENTS: true,
	ENABLE_CHILD_WALKING: false,
	
	initialize: function (tableName, fieldName, type, mandatory, reference, attributes, scope, isChoice, xmlView) {
		this.tableName = tableName;
		this.fieldName = fieldName;
		this.type = type;
		this.mandatory = mandatory;
		this.reference = reference;
		this.attributes = attributes;
		this.elementFetched = false;
		this.elementParentNode;
		this.fetchedNodes = {};
		this.scope = scope || "global";
		this.isChoice = isChoice;
		this.xmlView = xmlView;
	},
	
	getType: function() {
		return this.type;	
	},
	
	getID: function() {
		return this.tableName + '.' + this.fieldName;
	},
	
	getElementParentNode: function() {
		if (!this.elementFetched) {
			this.elementParentNode = gel('element.' + this.getID());
			this.elementFetched = true;
		}
			
		return this.elementParentNode;
	},
	
	getElement: function() {
		return this.getChildElementById(this.getID());
	},
	
	getLabelElement: function() {
		var parentElementNode = this.getElementParentNode();
		if (!parentElementNode)
			parentElementNode = document;
			
	    var labels = parentElementNode.getElementsByTagName('label');
	    for (var i = 0; (label = labels[i]); i++) {
	        if (label.htmlFor == this.getID())
	           return label;
	    }
		
		return this.getStatusElement();
	},
	
	getStatusElement: function() {
		return this.getChildElementById('status.' + this.getID());		
	},
	
	getChildElementById: function(id) {
		if (this.fetchedNodes[id])
			return this.fetchedNodes[id];
			
		var element = this.getChildElementById0(id);
		if (element)
			this.fetchedNodes[id] = element;
			
		return element;
	},
	
	getChildElementById0: function(id) {
		var element;
		
		if (this.ENABLE_CHILD_WALKING) {
			element = this._findSubChild(this.getElementParentNode(), id);
			if (element)
				return element;
		}
		
		return gel(id);
	},
	
	isMandatory: function() {
		return this.mandatory;
	},
	isDerived: function() {
		if (!this.fieldName)
			return false;
			
		return this.fieldName.indexOf('.') > -1;
	},
	setMandatory: function(mandatory) {
		this.mandatory = mandatory;
	},
	getValue: function() {
		var element = this.getElement();
		return element && element.value;
	},
	
	getScope: function() {
		return this.scope;
	},
	isXmlView: function() {
		return this.xmlView;
	},
	_findSubChild: function(startNode, id) {
		if (!startNode || (startNode.id && startNode.id == id))
			return startNode;
			
		var childNodes = startNode.children || startNode.childNodes;
		for(var i = 0; i < childNodes.length; i++) {
			var foundNode = this._findSubChild(childNodes[i], id);
			if (foundNode)
				return foundNode;
		}
		
		return;
	},
	
	type: "GlideUIElement"
});
function newGlideUIElement(tableName, fieldName, type, mandatory, reference, attributes, scope, isChoice, isXmlView) {
	if (mandatory && fieldName && fieldName.indexOf('.') > -1)
		return new GlideMandatoryDerivedUIElement(tableName, fieldName, type, mandatory, reference, attributes, scope, isChoice, isXmlView);
	return new GlideUIElement(tableName, fieldName, type, mandatory, reference, attributes, scope, isChoice, isXmlView);
}
;
/*! RESOURCE: /scripts/classes/GlideMandatoryDerivedUIElement.js */
var GlideMandatoryDerivedUIElement = Class.create(GlideUIElement, {
	initialize: function ($super, tableName, fieldName, type, mandatory, reference, attributes, scope, isChoice, xmlView) {
		$super(tableName, fieldName, type, mandatory, reference, attributes, scope, isChoice, xmlView);
		this.referenceFieldName = fieldName ? fieldName.substr(0, fieldName.lastIndexOf('.')) : '';
		this.mandatoryDerived = mandatory && this.referenceFieldName ? true : false;
		if (this.mandatoryDerived) {
this.mandatory = null;
			var e = this.getElement();
			if (e)
				e.setAttribute("mandatory", mandatory);
		}
		this.referenceField;
	},
	isMandatory: function() {
		return this.mandatory == null ?
				!this._isDisabled() && this.isMandatoryByReferenceField() :
				this.mandatory;
	},
	isMandatoryByReferenceField: function() {
		return this.referenceField && (this.referenceField.isMandatory() || this.referenceField.getValue()) ? true : false;
	},
	getElementMandatory: function() {
		var e = this.getElement();
		return e ? e.getAttribute('mandatory') : null; 
	},
	setReferenceField: function(reference) {
		this.referenceField = reference;
	},
	_isDisabled: function() {
		var control = this.getElement();
		if (!control)
			return true;
		if (control.getAttribute('derived-waiting') === "true")
			return false;
		return control.disabled || control.readOnly ||
			((typeof control.hasClassName === "function") && control.hasClassName("readonly")) ||
			((typeof control.getAttribute === "function") && control.getAttribute("writeaccess") == "false");	
	},
	type: "GlideMandatoryDerivedUIElement"
});
;
/*! RESOURCE: /scripts/classes/GlideUser.js */
var GlideUser = Class.create({
    initialize: function(userName, firstName, lastName, nonDefaultRoles, userID, departmentID) {
        this.userName = userName;
        this.firstName = firstName;
        this.lastName = lastName;
		this.setFullName(this.firstName + " " + this.lastName);
		this.setRoles(nonDefaultRoles);
        this.userID = userID;
		this.departmentID = departmentID;
		this.preferences = new Object();
		this.clientData = new Object();
    },
    
    hasRoleExactly: function(role, includeDefaults) {
    	if (!role || typeof role != 'string')
    		return false;
    	
    	var rolesToCheck = this.roles;
    	if (includeDefaults)
    		rolesToCheck = this.allRoles;
    	for (var x = 0, l = rolesToCheck.length; x < l; x++) {
            if (rolesToCheck[x].toLowerCase() == role.toLowerCase())
                return true;
        }
        return false;
    },
    hasRoles: function(includeDefaults) {
    	if (includeDefaults)
    		return (this.allRoles.length > 0);
    	else
    		return (this.roles.length > 0);
    },
    
    hasRole: function(role, includeDefaults) {
       if (this.hasRoleExactly('maint', includeDefaults))
           return true;
       if (this.hasRoleExactly(role, includeDefaults))
           return true;
       if (role == 'maint')
           return false;
       if (this.hasRoleExactly('admin', includeDefaults))
           return true;
       return false;
    },
	
	hasRoleFromList: function(roles, includeDefaults) {
		var rolesToMatch = new Array();
		
		if (roles)
rolesToMatch = roles.split(/\s*,\s*/);
		
		if (rolesToMatch.length == 0)
			return true;
			
		for(var i = 0; i < rolesToMatch.length; i++) {
			var r = rolesToMatch[i];
			if (r && this.hasRole(r, includeDefaults))
				return true;
		}
		
		return false;
	},
	
	getFullName: function() {
		return this.fullName;
	},
	
	getUserName: function() {
		return this.userName;
	},
	
	getUserID: function() {
		return this.userID;
	},
	
	getDepartmentID: function() {
		return this.departmentID;
	},
	
	setFullName: function(fn) {
		this.fullName = fn;
	},
	
	getRoles: function(includeDefaults) {
		if (includeDefaults)
			return this.allRoles;
		return this.roles;
	},
	
	getAvailableElevatedRoles: function() {
		return this.elevatedRoles;
	},
	
	setRoles: function(r, includeDefaults) {
		if (includeDefaults) {
	        if (r)
this.allRoles = r.split(/\s*,\s*/);
	        else
	            this.allRoles = new Array();
		} else {
	        if (r)
this.roles = r.split(/\s*,\s*/);
	        else
	            this.roles = new Array();			
		}
	},
	setElevatedRoles: function(r) {
        if (r)
this.elevatedRoles = r.split(/\s*,\s*/);
        else
            this.elevatedRoles = new Array();
	},
	
	setActiveElevatedRoles: function(r) {
	  if (r)
this.activeElevatedRoles = r.split(/\s*,\s*/);
	  else
	      this.activeElevatedRoles = new Array();
	},
	
	getActiveElevatedRoles: function() {
	  return this.activeElevatedRoles;
	},
	
	setDomain: function(d) {
		this.domain = d;
	},
	
	getPreference: function(n) {
		return this.preferences[n];
	},
	
	setPreference: function(n, v) {
		this.preferences[n] = v;
	},
	
	deletePreference: function(n) {
		delete this.preferences[n];
	},
	
	getClientData: function(n) {
		return this.clientData[n];
	},
	
	setClientData: function(n, v) {
		this.clientData[n] = v;
	},
	
	setBannerImage: function(s) {
		this.bannerImage = s;
	},
	
	getBannerImage: function() {
		return this.bannerImage;
	},
	
	setBannerText: function(s) {
		this.bannerText = s;
	},
	
	getBannerText: function() {
		return this.bannerText;
	},
	
	setHomePages: function(s) {
		this.homePages = s;
	},
	
	getHomePages: function() {
		return this.homePages;
	},
	
	type: "GlideUser"
});
;
/*! RESOURCE: /scripts/classes/ContextMenuExportHandler.js */
var ContextMenuExportHandler = Class.create({
    initialize: function(g_list, export_format) {
        this.g_list = g_list;
        this.export_format = export_format;
    },
    exportRecords: function() {
        var sysparm_rows = this.g_list.grandTotalRows;
        var num_rows = parseInt(sysparm_rows);
        var sysparm_query = this.g_list.getQuery({ orderby: true, fixed: true });
        var sysparm_view = this.g_list.view;
        var sysparm_query_no_domain = false;
        if ('submitValues' in this.g_list && 'sysparm_query_no_domain' in this.g_list.submitValues)
            sysparm_query_no_domain = this.g_list.submitValues.sysparm_query_no_domain;
        if (num_rows < g_export_warn_threshold) {
            var dialog = new GwtPollDialog(this.g_list.tableName, sysparm_query, sysparm_rows, sysparm_view, this.export_format, undefined, undefined, sysparm_query_no_domain);
            dialog.execute();
            return;
        }
        var dialog = new GwtExportScheduleDialog(this.g_list.tableName, sysparm_query, sysparm_rows, sysparm_view, this.export_format, undefined, this.export_format, sysparm_query_no_domain);
        dialog.execute();
    }
});
;
/*! RESOURCE: /scripts/doctype/GlideForm14.js */
function default_on_submit() {
	if (!g_form)
		return true;
	return g_form.onSubmit();
}
var GlideForm = Class.create({
	INFO_CLASS: "fieldmsg notification notification-info",
	ERROR_CLASS: "fieldmsg notification notification-error",
	WARNING_CLASS: "fieldmsg notification notification-warning",
	MSG_ROW: "_message_row",
	initialize : function(tableName, mandatory, checkMandatory, checkNumeric, checkInteger, isSearch) {
		this.tableName = tableName;
this.modified = false;
this.modifiedFields = {};
		this.mandatoryOnlyIfModified = false;
		this.elements = [];
		this.mandatory = mandatory;
		this.checkMandatory = checkMandatory;
		this.checkNumeric = checkNumeric;
		this.checkInteger = checkInteger;
		this.nameMap = [];
		this.attributes = [];
		this.validators = [];
		this.disabledFields = [];
		this.securityReadOnlyFields = [];
		this.genAIModifiedFields = {};
		this.elementHandlers = {};
		this.prefixHandlers = {};
		this.derivedWaiting = {};
		this.newRecord = gel('sys_row') && gel('sys_row').value == "-1";
		this.personalizeHiddenFields = null;
		this.personalizePrefKey = "personalize_" + this.tableName + "_" + this.getViewName();
		this._isLiveUpdating = false;
		this._onUserChangedHandlers = [];
		this.mandatoryDerivedFields = {};
		this.isEsLatestVisible = true;
		this.submitAttemptsCount = 0;
		
		if (isSearch) {
			var gf = this;
			setTimeout(function() {CachedEvent.emit('glideform.initialized', gf)}, 0);
		}
		else {
			if (this.classname !== 'ServiceCatalogForm' && this.classname !== 'ServiceCatalogForm17') {
				CachedEvent.emit('glideform.initialized', this);
			}
		}
		window.addEventListener("load", function() {
			if (g_form) {
				var formElement = g_form.getFormElement();
				formElement && formElement.removeAttribute("autocomplete");
			}
		});
	},
	fieldChanged : function(elementName, changeFlag) {
		if (!this._internalChange) {
			if (changeFlag) {
				this.modified = true;
				this.modifiedFields[elementName] = true;
			} else if (this.modifiedFields[elementName]) {
				this.modifiedFields[elementName] = false;
				this._checkModified();
			}
		}
		var uniqueValue = this.getUniqueValue();
		CustomEvent.fireAll('form.isModified', {uniqueValue: uniqueValue, isModified: this.modified, iframeElId: window.frameElement ? window.frameElement.id : null});
		if (window.parent !== window) {
			window.onBeforeClose = function(callback) {
				var message = getMessage("Changes have been made, continuing will discard the changes. Click 'OK' to discard changes.");
				if (this.modified && !confirm(message))
					return;
				callback();
			}.bind(this);
		}
		var field = this.mandatoryDerivedFields[elementName];
		if (field && this._isDerivedWaiting(elementName)) {
			var newValue = field.getValue();
			if (newValue && field.getElementMandatory() != 'true')
				this._setMandatory(field.fieldName, field, true);
			else if (!newValue && !field.isMandatory() && field.getElementMandatory() != 'false')
				this._setMandatory(field.fieldName, field, false);
		}
	},
 	triggerOnUserChangeValue: function(fieldName, originalValue, newValue) {		
 		if (this._internalChange || this._onUserChangedHandlers.length === 0) 
 			return;	
		this._onUserChangedHandlers.forEach(function(fn) {	
			fn.call(fn, fieldName, originalValue, newValue);	
		});
 	},
	_checkModified: function() {
		for (var n in this.modifiedFields) {
			if (this.modifiedFields[n]) {
				this.modified = true;
				return;
			}
		}
		this.modified = false;
	},
	setMandatoryOnlyIfModified : function() {
		this.mandatoryOnlyIfModified = true;
	},
	disableMandatoryCheck : function() {
		this.checkMandatory = false;
	},
	enableMandatoryCheck : function() {
		this.checkMandatory = true;
	},
	addNameMapEntry : function(entry) {
		this.nameMap.push(entry);
	},
addGlideUIElement : function(ed) {
		this._checkDerivedFieldMandatory(ed);
		this.elements.push(ed);
	},
_checkDerivedFieldMandatory : function(ed) {
		if (ed.mandatoryDerived) {
			ed.setReferenceField(this.getGlideUIElement(ed.referenceFieldName));
			if (!ed.isMandatory() && (!ed.getValue() || this.isNewRecord()))
				this._setMandatory(ed.fieldName, ed, false);
			var key = this.getTableName() + '.' + ed.fieldName;
			this.mandatoryDerivedFields[key] = ed;
		}
		this._setDerivedFieldsMandatory(ed);		
	},
	_setDerivedFieldsMandatory : function(ed) {
		if (ed.getType() !== 'reference')
			return;
		for (var name in this.mandatoryDerivedFields) {
			var field = this.mandatoryDerivedFields[name]
			if (field.referenceFieldName == ed.fieldName) {
				if (!field.referenceField)
					field.setReferenceField(ed);
				var mandatory = field.isMandatory();
				if (mandatory.toString() != field.getElementMandatory()) {
					this._setMandatory(field.fieldName, field, mandatory);
					this._setDerivedFieldsMandatory(field);
				}
			}
		}
	},
	registerHandler: function(id, handler) {
		this.elementHandlers[id] = handler;
	},
	registerPrefixHandler: function(prefix, handlerObject) {
		var handler = new GlideFormPrefixHandler(handlerObject);
		this.prefixHandlers[prefix] = handler;
	},
	getPrefixHandler: function(id) {
		if (!id)
			return;
		if (id.indexOf('.') < 0)
			id = 'variables.' + id;
		var idSplit = id.split(".");
		var handler = this.prefixHandlers[idSplit[0]];
		if (typeof handler == "undefined")
			return;
		handler.setFieldName(id);
		return handler;
	},
	getElement: function(id) {
		if (this.elementHandlers[id] && (typeof this.elementHandlers[id].getElement == "function"))
			return this.elementHandlers[id].getElement();
		else
			return this.getControl(id);
	},
	getParameter : function(parm) {
		if (!(parm.substr(0, 8) == 'sysparm_'))
			parm = 'sysparm_' + parm;
		var pcel = gel(parm);
		if (pcel)
			return pcel.value;
		else
			return '';
	},
	hasAttribute : function(s) {
		if (this.attributes[s])
			return true;
		return false;
	},
	addAttribute : function(s) {
		this.attributes[s] = s;
	},
	addValidator : function(fieldType, validator) {
		this.validators[fieldType] = validator;
	},
	_getPersonalizeHiddenFields: function() {
		if (this.personalizeHiddenFields == null) {
			var prefVal = NOW[this.personalizePrefKey] || getPreference(this.personalizePrefKey);
			if ('false' == prefVal)
				this.personalizeHiddenFields = [];
			else if (prefVal.length)
				this.personalizeHiddenFields = prefVal.split(",");
			else
				this.personalizeHiddenFields = [];
		}
		return this.personalizeHiddenFields;
	},
	
	resetPersonalizeHiddenFields: function() {
		this.personalizeHiddenFields = [];
		
		this._savePersonalizeHiddenFields(function(){window.reloadWindow(window);});
	},
	_savePersonalizeHiddenFields: function(callback) {
		setPreference(this.personalizePrefKey, this.personalizeHiddenFields.join(","), callback);
	},
	isUserPersonalizedField: function(fieldName){
		fieldName = this.removeCurrentPrefix(fieldName); 
		return this.personalizeHiddenFields === null ? false : this.personalizeHiddenFields.indexOf(fieldName) != -1;
	},
	setUserDisplay: function(fieldName, display) {
		fieldName = this.removeCurrentPrefix(fieldName);
		this._getPersonalizeHiddenFields();
		for(var i = this.personalizeHiddenFields.length-1; i>=0; i--) {
			if (this.personalizeHiddenFields[i] === fieldName) {
				this.personalizeHiddenFields.splice(i, 1);
			}
		}
		this.setDisplay(fieldName, display);
		if ((display === false || display === 'false') && !this.isMandatory(fieldName))
			this.personalizeHiddenFields.push(fieldName);
		this._savePersonalizeHiddenFields();
	},
	setDisplay : function(fieldName, display) {
		fieldName = this.removeCurrentPrefix(fieldName);
		if (!this.getGlideUIElement(fieldName) && !!this._hasSCUIElement(fieldName))
			g_sc_form.setDisplay(fieldName, display);
		else
			this._setDisplay(fieldName, display, this.isMandatory(fieldName), this.getValue(fieldName));
	},
	_hasSCUIElement : function(name) {
		return this._hasSCForm() && typeof g_sc_form.getSCUIElement !== 'undefined' && g_sc_form.getSCUIElement(name);
	},
	_hasSCForm : function() {
		return typeof g_sc_form != "undefined" && g_sc_form;
	},
	_setDisplay: function(fieldName, display, isMandatory, fieldValue) {
		var s = this.tableName + '.' + fieldName;
		var control = this.getControl(fieldName);
		
		var displayValue = 'none';
		if (display == 'true' || display == true) {
			display = true;
			displayValue = '';
		} else {
			display = false;
		}
		var opticsVisibleMessage = "Visibility set to " + (display ? 'visible' : 'hidden');
		
		if (!control) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler) {
				handler.getObject().setDisplay(handler.getFieldName(), display);
				opticsLog(this.tableName, fieldName, opticsVisibleMessage);
			}
			return;
		}
		if ((display != true) && isMandatory && fieldValue == '')
			return;
		var theElement = control;
		if (this.elementHandlers[control.id] && (typeof this.elementHandlers[control.id].getElement == "function"))
			theElement = this.elementHandlers[control.id].getElement();
		if (this.elementHandlers[control.id] && (typeof this.elementHandlers[control.id].setDisplay == "function")) {
			this.elementHandlers[control.id].setDisplay(display ? '' : 'none');
		} else {
			this.changeElementStyle(fieldName, 'display', displayValue);
		}
		opticsLog(this.tableName, fieldName, opticsVisibleMessage);
		this.setSensitiveDisplayValue(s + ".ui_policy_sensitive", displayValue);
		var glideElement = this.getGlideUIElement(fieldName);
		if (glideElement)
			if (glideElement.type == 'script' || glideElement.type == 'script_plain' || glideElement.type == 'xml')
				CustomEvent.fire('element_script_display_' + display, {'element': glideElement});
		if (theElement.tagName === 'TEXTAREA' && display) {
			$j(theElement).trigger("autosize.resize");
		}
		_frameChanged();
	},
	setSensitiveDisplayValue: function(name, displayValue) {
		var elements = document.getElementsByName(name);
		for (i = 0; i < elements.length; i++ ) {
			elements[i].style.display = displayValue;
		}
	},
	setValidation : function(fieldName, validate) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		if (!control)
			return;
		if (validate == 'false')
			validate = false;
		if (validate != false) {
			control.removeAttribute('validate');
			return;
		}
		control.setAttribute('validate', 'false');
	},
	getViewName: function(){
		var sysparmView = gel('sysparm_view');
		var view = "default";
		if (sysparmView && sysparmView.value)
			view = sysparmView.value;
		
		return view;
	},
	setVisible : function(fieldName, visibility) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		if (!control) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				handler.getObject().setVisible(handler.getFieldName(),
						visibility);
		}
		var v = 'hidden';
		if (visibility == 'true')
			visibility = true;
		if (visibility)
			v = 'visible';
		if ((visibility != true) && this.isMandatory(fieldName) && (this.getValue(fieldName) == ''))
			return;
		this.changeElementStyle(fieldName, 'visibility', v);
		opticsLog(this.tableName, fieldName, "Visibility set to " + v);
	},
	changeElementStyle: function(fieldName, name, value) {
		var ge = this.getGlideUIElement(fieldName);
		if (!ge)
			return;
		if (this.changeElementParent(ge, name, value))
			return;
		var labelElement = ge.getLabelElement();
		if (labelElement)
			labelElement.parentNode.parentNode.style[name] = value;
		var parentTR = findParentByTag(ge.getElement(), "tr");
		if (parentTR && parentTR != labelElement)
			parentTR.style[name] = value;
	},
	changeElementParent : function(ge, name, value) {
		var element = ge.getElementParentNode();
		if (element) {
			element.style[name] = value;
			var decoration = $(element).select(".reference_decoration, .btn-ref");
			var isEmptyRef = ge.type == 'reference' && this.getValue(ge.fieldName) == '';
			if (decoration && decoration.length > 0) {
				for (var i = 0; i < decoration.length; i++) {
					if (decoration[i].getAttribute('list-read-only') === "true")
						continue;
					if (isEmptyRef && (decoration[i].getAttribute('data-type') == 'reference_popup'))
						decoration[i].style[name] = 'none';
					else
						decoration[i].style[name] = value;
				}
			}
			return true;
		}
		return false;
	},
	getLabel : function(id) {
		id = this.removeCurrentPrefix(id);
		var label;
		var labels = document.getElementsByTagName('label');
		for (var i = 0; (label = labels[i]); i++) {
			if (label.htmlFor.endsWith('.' + id))
				return label;
		}
		for (var i = 0; (label = labels[i]); i++) {
			if(label.htmlFor.endsWith(id))
				return label;
			if (label.htmlFor.indexOf("autogen") !== -1) {
				var children = label.children;
				for (var j = 0; j < children.length; j++) {
					var child = children[j];
					if (child.id && child.id.endsWith('.' + id))
						return label;
				}
			}
		}
		return false;
	},
	isNewRecord : function() {
		return this.newRecord;
	},
	isMandatory: function(fieldName) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var thisElement = this.getGlideUIElement(fieldName);
		if (!thisElement) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				return handler.getObject().isMandatory(handler.getFieldName());
			else
			return false;
		}
		return thisElement.isMandatory();
	},
	addSecurityReadOnlyFields: function (fields) {
		this.securityReadOnlyFields = fields.split(',').filter(function(item) {
			return item !== undefined && item !== null && item !== "";
		});
	},
	isSecurityReadOnlyField: function(fieldName) {
		return this.securityReadOnlyFields.some(function(securityField) {
			return securityField === this.tableName + "." + fieldName;
		}, this);
	},
	setRequiredChecked: function(fieldName, required) {
		if(!fieldName || !fieldName.startsWith('ni.VE') || !fieldName.startsWith("ni.QS")) {
			jslog("Invalid variable id");
			return;
		}
		var handler = this.getPrefixHandler(this.resolvePrettyNameMap(fieldName));
		if(!handler) {
			jslog("Invalid variable id");
			return;
		}	
		handler.getObject().setRequiredChecked(fieldName, required);
	},
	_setAriaRequired : function(fieldName, value) {
		if (!fieldName) {
			return;
		}
		value = value || false;
		var visibleControls = this._getVisibleControls(fieldName);
		visibleControls.forEach(function(visibleControl){
			visibleControl.setAttribute('aria-required', value);
		});
	},
	setMandatory : function(fieldName, mandatory) {
		var thisElement = this.getGlideUIElement(fieldName);
		if (!thisElement) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				handler.getObject().setMandatory(handler.getFieldName(), mandatory);
			return;
		}
		if (this.isSecurityReadOnlyField(fieldName)) {
			opticsLog(this.tableName, fieldName, "Unable to set security read-only field's mandatory state to " + mandatory);
			return;
		}
		thisElement.setMandatory(mandatory);
		this._setMandatory(fieldName, thisElement, mandatory);
		this._setDerivedFieldsMandatory(thisElement);
	},
	_setMandatory : function(fieldName, thisElement, mandatory) {
		if (!thisElement)
			return;
		var e = thisElement.getElement();
		if (e) {
			e.setAttribute("mandatory", mandatory);
			onChangeLabelProcessByEl(e, thisElement.getStatusElement());
			this._setAriaRequired(fieldName, mandatory);
		}
		var control = this.getControl(fieldName);
		if (control && control.id && this.elementHandlers[control.id] && (typeof this.elementHandlers[control.id].setMandatory == "function"))
			this.elementHandlers[control.id].setMandatory(mandatory);
		if (mandatory) {
			setMandatoryExplained(true);
			var value = this.getValue(fieldName);
			if (value == '') {
				this._setDisplay(fieldName, true, true, '');
				this._setReadonly(fieldName, false, true, '');
			}
		}
		opticsLog(this.tableName, fieldName, "Mandatory set to " + mandatory);
	},
	setDisabled: function (fieldName, disabled) {
		this.setReadonly(fieldName, disabled);
	},
	setReadOnly: function (fieldName, disabled) {
		this.setReadonly(fieldName, disabled);
	},
	setReadonly: function (fieldName, disabled) {
		fieldName = this.removeCurrentPrefix(fieldName);
		if (fieldName && this._isDerivedWaiting(fieldName))
			addSetDerivedReadOnlyListener(fieldName, disabled);
		else
			this._setReadonly(fieldName, disabled, this.isMandatory(fieldName), this.getValue(fieldName));
	},
	_setDerivedWaitingReadonly: function (fieldName, disabled) {
		fieldName = this.removeCurrentPrefix(fieldName);
		this._setReadonly(fieldName, disabled, this.isMandatory(fieldName), this.getValue(fieldName));
		var control = this.getControl(fieldName);
		if (!control)
			return;
		if (disabled)
			control.setAttribute('derived-waiting', true);
		else
			control.removeAttribute('derived-waiting');
	},
	_setReadonly : function(fieldName, disabled, isMandatory, fieldValue) {
		var s = this.tableName + '.' + fieldName;
		var control = this.getControl(fieldName);
		if (!control) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				handler.getObject()._setReadonly(
						handler.getFieldName(), disabled, isMandatory,
						fieldValue);
			return;
		}
		var ge = this.getGlideUIElement(fieldName);
		if (!ge) {
			opticsLog(this.tableName, fieldName, "Unable to set invalid field's ReadOnly to " + disabled);
			return;
		}
		this._setReadonly0(ge, control, s, fieldName, disabled, isMandatory, fieldValue);
	},
	_setReadonly0: function (ge, control, s, fieldName, disabled, isMandatory, fieldValue) {
		if (disabled && isMandatory && fieldValue == '') {
			opticsLog(this.tableName, fieldName, "Unable to set blank mandatory field's read-only state to " + disabled);
			return;
		}
		if (this.isSecurityReadOnlyField(fieldName)) {
			opticsLog(this.tableName, fieldName, "Unable to set security read-only field's read-only state to " + disabled);
			return;
		}
		if (control.getAttribute('gsftlocked') == 'true') {
			opticsLog(this.tableName, fieldName, "Unable to set locked field's ReadOnly to " + disabled);
			return;
		}
		if (this.elementHandlers[control.id] && (typeof this.elementHandlers[control.id].setReadOnly == "function")) {
			if (this.elementHandlers[control.id].setReadOnly(disabled) == true)
				return;
		} else
			this.setDisabledControl(control, disabled);
		this._setDisabledField(control, disabled);
		onChangeLabelProcessByEl(control, ge.getStatusElement());
		this._setFieldReadOnly(ge, "sys_display." + s, disabled);
		this._setFieldReadOnly(ge, "sys_select." + s, disabled);
		var $inputGroup = $j(ge.getElementParentNode()).find(".input-group");
		if ($inputGroup.length){
			if (disabled)
				$inputGroup.addClass('input-group-disabled');
			else
				$inputGroup.removeClass('input-group-disabled');
		}
		this.setSensitiveDisplayValue(s + ".ui_policy_sensitive", disabled ? 'none' : '');
		this._setFieldReadOnly(ge, "ni." + this.tableName + "." + fieldName, disabled);
if (this.tableName == "ni")
			this._setFieldReadOnly(ge, "ni." + ge.fieldName, disabled);
		
		var suggestionExists = gel('ni.dependent_reverse.' + this.tableName + '.' + fieldName);
		
		if (suggestionExists){
			this._setFieldReadOnly(ge, "lookup." + this.tableName + "." + fieldName, disabled, true);
		}
		opticsLog(this.tableName, fieldName, "ReadOnly set to " + disabled);
	},
	_setFieldReadOnly : function(ge, s, disabled, skipProcessLabelChange) {
		var control = ge.getChildElementById(s);
		var value;
		if (control) {
			this.setDisabledControl(control, disabled);
			this._setDisabledField(control, disabled);
			if (!skipProcessLabelChange) {
				value = (ge.type === "reference" || ge.type === "glide_list") && ge.getElement() ?
						ge.getElement().value : control.value;
				onChangeLabelProcessByEl(control, ge.getStatusElement(), value);
			}
		}
	},
	setDisabledControl: function (control, disabled) {
		if (disabled) {
			control.setAttribute("readonly", "readonly");
			addClassName(control, 'disabled');
		} else {
			control.removeAttribute("readonly");
			removeClassName(control, 'disabled');
		}
		if (control.tagName == "SELECT") {
			var $control = $j(control);
			$control.find('option').prop('disabled', disabled);
			if ($control.data('select2'))
				$control.select2('container').toggleClass('select2-container-disabled', disabled);
		} else if (control.getAttribute('type') == 'checkbox')
			control.setAttribute('aria-readonly', disabled);
	},
	_setDisabledField: function (control, disabled) {
		if (disabled) {
			addClassName(control, 'disabled');
			addClassName(control, 'readonly');
			this._addDisabledField(control);
		} else  {
			removeClassName(control, 'disabled');
			removeClassName(control, 'readonly');
			this._removeDisabledField(control);
		}
	},
	_addDisabledField: function (control) {
		var n = this.disabledFields.length;
		this.disabledFields[n] = control;
	},
	_removeDisabledField: function (control) {
		var n = this.disabledFields.length;
		for (i = 0; i < n; i++) {
			if (this.disabledFields[i] == control) {
				this.disabledFields.splice(i,1);
				break;
			}
		}
	},
	onSubmit: function () {
		this.getFormElement().addClassName('form-submitted');
		this.submitAttemptsCount++;
		CustomEvent.fireTop('glideform.submit_attempted');
		var action = this.getActionName();
		if (action && !action.startsWith("sysverb_no_update"))
			this.submitted = true;
		if (action == 'sysverb_back' || action == 'sysverb_cancel' || action == 'sysverb_delete' || action == 'sysverb_query')
			return true;
		
		if (action == 'sysverb_m2ms'){
			CustomEvent.fire('sn.stream.clearOnSilentSubmit');
		}
		this._sendGenAIFeedback();
		var rc = this.mandatoryCheck();
if (rc && this._hasSCForm())
			rc = g_sc_form.mandatoryCheck() && g_sc_form.catalogOnSubmit();
		rc = rc && this.validate();
		return rc;
	},
	_sendGenAIFeedback() {
		var req = new XMLHttpRequest();
		Object.keys(this.genAIModifiedFields).forEach((genAIResponseLogID) => {
		  let fieldsData = {};
		  this.genAIModifiedFields[genAIResponseLogID].forEach((field) => {
			const fieldName = field.fieldName;
			const fieldValue = this.getValue(fieldName);
			const genAIGeneratedValue = field.fieldValue;
			if(fieldValue !== genAIGeneratedValue)
			fieldsData[fieldName] = this.getValue(fieldName);
		  });
		  if(Object.keys(fieldsData).length != 0)
		  {
req.open("POST", "/api/sn_uxc_gen_ai/uxc_generative_ai/feedback", true);
req.setRequestHeader("Content-Type", "application/json");
		  req.setRequestHeader("X-userToken", window.g_ck);
		  req.send(
			JSON.stringify({
			  logId: genAIResponseLogID,
			  isResponseEdited: true,
			  edited_response: fieldsData
			})
		  );
		}
		});
		
	},
	enableUIPolicyFields: function() {
		for (var i = 0; i < this.disabledFields.length; i++) {
			var field = this.disabledFields[i];
			var disabledID = field.id;
			if (!field.parentNode)
				continue;
			if (this._isDerivedWaiting(disabledID)) {
				continue;
			}
			var existingElement = document.querySelector('input[name="' + field.name + '"]');
			if (existingElement) {
				if (existingElement.uiPolicyField == field) {
					existingElement.value = field.value;
					continue;
				}
				if (!existingElement.disabled)
					continue;
			}
			var hiddenInput = document.createElement('input');
			hiddenInput.name = field.name;
			hiddenInput.type = "hidden";
			hiddenInput.value = field.value;
			hiddenInput.uiPolicyField = field;
			field.parentNode.appendChild(hiddenInput);
		}
		
		var derivedWaiting = this.derivedWaiting;
		Object.keys(derivedWaiting).forEach(function (key) {
			var fieldId = derivedWaiting[key].refFieldName + '.' + key;
			jslog("Disabling field: " + fieldId)
			$j("[id='"+fieldId+"']").prop('disabled', true);
			$j("[id='sys_original."+fieldId+"']").prop('disabled', true);
		});
	},
	
	focusFirstVisibleField : function(fields) {
		var focusDetermined = false;
		for (var i = 0; i < fields.length && !focusDetermined; i++) {
			var field = fields[i];
			var widget = this.getControl(field);
			if (g_tabs2Sections.isActivated()) {
				var tabName = this.getTabNameForField(field);
				var tabIndex = g_tabs2Sections.findTabIndexByName(tabName);
				if (tabName && g_tabs2Sections.activeTab !== tabIndex && g_tabs2Sections.setActiveNoPreference)
					g_tabs2Sections.setActiveNoPreference(tabIndex);
			}
			
				var tryLabel = !$j(widget).is(':visible');
				if (!tryLabel) {
					try {
						var formEle = this.getFormElement();
						if (formEle) {
							var firstInvalidEle = formEle.querySelector("[aria-invalid='true']");
							if(firstInvalidEle)
								firstInvalidEle.focus();
							else
								widget.focus();
						} else
						widget.focus();
						focusDetermined = true;
					} catch (e) {
						tryLabel = true;
					}
				}
				if (tryLabel) {
					var displayWidget = this.getDisplayBox(field);
					if (displayWidget && displayWidget.getAttribute("type") == "hidden"){
						var streamDisplayWidget = gel("activity-stream-" + field + "-textarea");
						if (streamDisplayWidget) {
							try {
								streamDisplayWidget.focus();
								focusDetermined = true;
							} catch (exception) {
							}
						}
					}
					else if (displayWidget) {
						try {
							displayWidget.focus();
							focusDetermined = true;
						} catch (exception) {
						}
					}
				}
			}
	},
	mandatoryCheck : function() {
		if (!this.checkMandatory || (!this.modified && this.mandatoryOnlyIfModified))
			return true;
		var rc = true;
		var invalidFields = new Array();
		var labels = new Array();
		var missing = this.getMissingFields();
		var invalidWidgets = [];
		for (var i = 0; i < missing.length; i++) {
			rc = false;
			var field = missing[i];
			var widgetVisibleControls = this._getVisibleControls(field);
			if (widgetVisibleControls.length > 0) {
				invalidWidgets.push(widgetVisibleControls);
			}
			labels.push(this.tableName + '.' + field);
			var widgetLabel = this.getLabelOf(field);
			var shortLabel = trim(widgetLabel + '');
			invalidFields.push(shortLabel);
		}
		if (!rc) {
			var theText = invalidFields.join(', ');
			theText = getMessage('The following mandatory fields are not filled in') + ': ' + theText;
			try {
				this.addErrorMessage(theText);
				CustomEvent.fireAll('glideform.mandatorycheck.failed', theText);
				this.submitted = false;
				this.focusFirstVisibleField(missing);
			} catch (e) {
			}
		}
		for (var i = 0; i < labels.length; i++) {
			if(window.NOW.isUsingPolaris) {
				this.flash(labels[i], "RGB(var(--now-alert--warning--background-color,var(--now-color_alert--warning-0,244,240,191)))", 0);
			} else {
				this.flash(labels[i], "#FFFACD", 0);
			}
		}
		for (var i = 0; i < invalidWidgets.length; i++) {
			for (var j = 0; j < invalidWidgets[i].length; j++) {
				invalidWidgets[i][j].setAttribute('aria-invalid', 'true');
			}
		}
		return rc;
	},
	setVariablesReadOnly: function(readOnly) {
		for (var x=0; x < g_form.elements.length; x++) {
			for (var i = 0; i < this.nameMap.length; i++) {
				var entry = this.nameMap[i];
				var element = g_form.elements[x];
				if (entry.realName == element.fieldName && element.tableName == "variable") {
					if (!this._hasSCForm())
						this.setReadOnly(entry.prettyName, readOnly);
					else
						g_sc_form.setReadOnly(entry.prettyName, readOnly);
				}
			}
		}
	},
	getHelpTextControl : function(variableName) {
		var handler = this.getPrefixHandler(variableName);
		var ele;
		if (handler) {
			var handlerObject = handler.getObject();
			ele = handlerObject.getHelpTextControl(handlerObject.removeCurrentPrefix(variableName));
		}
		if(!ele) {
			jslog("getHelpTextControl is supported for only Service Catalog Variables");
			return;
		}
		return ele;
	},
	getEditableFields : function() {
		var fa = this.elements;
		var answer =[];
		for (var i = 0; i < fa.length; i++) {
			var ed = fa[i];
			var widget = this.getControl(ed.fieldName);
			if (!widget)
				continue;
			if (this.isEditableField(ed, widget))
				answer.push(ed.fieldName);
		}
		return answer;
	},
	isEditableField : function(ge, control) {
		var isEditableFieldFn = this._getHandlerFn(control, 'isEditableField');
		if (isEditableFieldFn)
			return isEditableFieldFn(ge, control);
		if (!this.isTemplateCompatible(ge, control))
			return false;
		if (!this.isVisible(ge, control))
			return false;
		if (this.isReadOnly(ge, control))
			return false;
		if (this.isDisplayNone(ge, control))
			return false;
		return true;
	},
	isTemplateCompatible: function(ge, control) {
		var isTemplatableFn = this._getHandlerFn(control, 'isTemplatable');
		return !isTemplatableFn || isTemplatableFn(ge, control);
	},
	_getHandlerFn : function(control, fn) {
		if (!control)
			return;
		var handler = this.elementHandlers[control.id];
		if (!handler)
			return;
		var handlerFn = handler[fn];
		if (!handlerFn || typeof handlerFn !== "function")
			return;
		return handlerFn;
	},
	isFieldVisible: function(fieldName) {
		var ge = this.getGlideUIElement(this._removeTableName(fieldName));
		return !!ge && this.isVisible(ge, this.getControl(fieldName));
	},
	isVisible : function(ge, control) {
		if (typeof ge === "string")
return this.isFieldVisible(ge);
		
		var elHandlersCtrl = control && this.elementHandlers[control.id];
		var controlType = elHandlersCtrl && elHandlersCtrl.type;
		
		if (controlType !== 'GlideStreamJournalElement')
			if (this.isDisplayNone(ge, control))
				return false;
	
		if (elHandlersCtrl)
			if (typeof this.elementHandlers[control.id].isVisible == "function")
				return this.elementHandlers[control.id].isVisible();
		if (control && ge.getType() != "glide_duration" && ge.getType != "glide_time") {
			var xx = control.style['visibility'];
			if (xx == 'hidden'){
				var readOnlyField = gel("sys_readonly." + control.id);
				if ((readOnlyField && readOnlyField.style['visibility'] == 'hidden') || !readOnlyField)
					return false;
			}
		}
		xx = this._getElementStyle(ge, 'visibility');
		if (xx == 'hidden' || this._elementHasClass(ge, "hidden"))
			return false;
		var tab = this._getTabNameForElement(control);
		if (tab && !this.isSectionVisible(tab))
			return false;
		if (!control && !ge.getElementParentNode())
			return false;
		return true;
	},
	isDisabled : function(fieldName) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		if (!control)
			return true;
		if (this.elementHandlers[control.id])
			if (typeof this.elementHandlers[control.id].isDisabled == "function")
				return this.elementHandlers[control.id].isDisabled();
		return this.isReadOnly("", control);
	},
	isReadOnly : function(ge, control) {
		if (!control)
			return true;
		if (this.elementHandlers[control.id])
			if (typeof this.elementHandlers[control.id].isReadOnly == "function")
				return this.elementHandlers[control.id].isReadOnly();
		return control.disabled ||
			control.readOnly ||
			((typeof control.hasClassName === "function") && control.hasClassName("readonly")) ||
			((typeof control.getAttribute === "function") && control.getAttribute("writeaccess") == "false");
	},
	isDisplayNone : function(ge, control) {
		var parentNode = ge.getElementParentNode();
		if(parentNode && parentNode.style.display == 'none')
			return true;
		if (((ge.isXmlView && ge.isXmlView()) || ['xml', 'script', 'script_plain'].indexOf(ge.getType() > -1)) &&
			parentNode &&
			parentNode.closest('.section') &&
			parentNode.closest('.section').style.display == 'none')
			return true;
		if ((ge.isXmlView && ge.isXmlView()) || ['html', 'html_script', 'translated_html', 'composite_name', 'url', 'xml', 'script', 'script_plain'].indexOf(ge.getType()) > -1)
			return false;
		if (!control)
			return;
		else {
			var xx = control.style['display'];
			if (xx == 'none') {
				var readOnlyField = gel("sys_readonly." + control.id);
				if ((readOnlyField && readOnlyField.style['display'] == 'none') || !readOnlyField)
					return true;
			}
		}
		var xx = this._getElementStyle(ge, 'display');
		if (xx == 'none')
			return true;
		return false;
	},
	_getElementStyle : function(ge, style) {
		var element = ge.getElementParentNode();
		if (element)
			return element.style[style];
		var labelElement = ge.getLabelElement();
		if (labelElement)
			return labelElement.parentNode.parentNode.style[style];
		var parentTR = findParentByTag(ge.getElement(), "tr");
		if (parentTR && parentTR != labelElement)
			return parentTR.style[name];
		return "";
	},
	
	_elementHasClass : function(ge, className) {
		var element = ge.getElementParentNode();
		if (element)
			return element.className === className || element.className.indexOf(className + " ") === 0 ||  element.className.indexOf(" " + className) > -1;
		return false;
	},
	getMissingFields: function() {
		var fa = this.elements;
		var answer = [];
		for (var i = 0; i < fa.length; i++) {
			var ed = fa[i];
			if (!ed.isMandatory())
				continue;
			var widget = this.getControl(ed.fieldName);
			if (!widget)
				continue;
			if (this._isMandatoryFieldEmpty(ed))
				answer.push(ed.fieldName);
		}
		if (this._hasSCForm())
			g_sc_form.getMissingFields(answer);
		return answer;
	},
	_isMandatoryFieldEmpty : function(ed) {
		var widgetValue = this.getValue(ed.fieldName);
		if (widgetValue != null && widgetValue != '' && widgetValue != 'NULL')
			return false;
		if (ed.supportsMapping) {
			var id = "sys_mapping." + ed.tableName + "." + ed.fieldName;
			var mappingValue = this.getValue(id);
			if (mappingValue.trim())
				return false;
			var nonMappedFieldValue = this.getValue(ed.tableName + "." + ed.fieldName);
			if (nonMappedFieldValue.trim())
				return false;
			return true;
		}
		var displayBox = this.getDisplayBox(ed.fieldName);
		if (displayBox != null) {
			var displayValue = displayBox.value;
			if (displayValue != null && displayValue != '' && displayBox.getAttribute('data-ref-dynamic') == 'true') {
				return false;
			}
		}
		if ((this.isNewRecord() || this.mandatory))
			return true;
		widgetName = "sys_original." + this.tableName + '.' + ed.fieldName;
		widget = gel(widgetName);
		if (widget) {
			widgetValue = widget.value;
			if ((widgetValue === null || widgetValue === '') && ed.type !== "journal_input" && ed.type !== "glide_list")
				return false;
		}
		return true;
	},
	resolveNameMap : function(prettyName) {
		var rc = prettyName;
		for (var i = 0; i < this.nameMap.length; i++) {
			var entry = this.nameMap[i];
			if (entry.prettyName == prettyName) {
				rc = entry.realName;
			}
		}
		return rc;
	},
	
	resolveLabelNameMap : function(name) {
		var pname = name;
		for (var i = 0; i < this.nameMap.length; i++) {
			var el = this.nameMap[i];
			if (el.realName === pname || el.prettyName === pname) {
				pname = el.label;
				break;
			}
		}
		return pname;
	},
	
	resolvePrettyNameMap: function(realName) {
		var pname = realName;
		for (var i = 0; i < this.nameMap.length; i++)
			if ('ni.VE' + this.nameMap[i].realName == realName
					|| 'ni.QS' + this.nameMap[i].realName.substring(3) == realName
					|| this.nameMap[i].realName == realName) {
				pname = this.nameMap[i].prettyName;
				break;
			}
		return pname;
	},
	getFormElement: function() {
		return gel(this.tableName + '.do');
	},
	getControl: function(fieldName) {
		var ge = this.getGlideUIElement(fieldName);
		if (ge) {
			var widget = ge.getElement();
			if (widget) {
				return widget;
			}
		}
		return this.getControlByForm(fieldName);
	},
	getControlByForm : function(fieldName) {
		var form = this.getFormElement();
		if (!form)
			return;
		widget = form[this.tableName + '.' + fieldName];
		if (!widget)
			widget = form[fieldName];
		if (!widget)
			widget = $j(form).find("[data-action-name='" + fieldName + "']").get(0);
		if (widget && typeof widget != 'string' && widget.length && widget.tagName != "SELECT") {
			for (var i = 0; i < widget.length; i++) {
				if (widget[i].checked)
					return widget[i];
				else if (widget[i].id == fieldName && widget[i].tagName == "INPUT" && widget[i].type != 'radio')
					return widget[i];
			}
			var wt = widget[0].type;
			if (typeof wt != 'undefined' && wt == 'radio')
				return widget[0];
		}
		return widget;
	},
	_tryLabelRow: function(fieldName) {
		var element = this._tryLabelRowElement(fieldName);
		if(element)
			return element.innerText || element.textContent;
		return null;
	},
	_tryLabelRowElement: function(fieldName) {
		var id = "label_" + fieldName;
		var row = gel(id);
		if (row) {
			var child = row.firstChild;
			if (child) {
				return child;
			}
		}
		return null;
	},
	getLabelOf : function(fieldName) {
		var fieldid = this.tableName + '.' + fieldName;
		var widgetLabel = this.getLabel(fieldid);
		var labelContent = "";
		if (widgetLabel) {
			labelContent = $j(widgetLabel).find('.label-text').text()
					|| widgetLabel.innerText
					|| widgetLabel.textContent;
			if (labelContent.indexOf('*') == 0
					&& document.documentElement.getAttribute('data-doctype') == 'true')
				labelContent = labelContent.toString().substring(1);
			if ((labelContent.lastIndexOf(":") + 1) == labelContent.length)
				labelContent = labelContent.toString().substring(0, (labelContent.length - 1));
		}
		if (labelContent == null || labelContent == '')
			labelContent = this._tryLabelRow(fieldName);
		if (labelContent == null || labelContent == '') {
			var handler = this.getPrefixHandler(this.resolvePrettyNameMap(fieldName));
			if(handler)
				labelContent = handler.getObject().getLabelOf(fieldName);
			else
				labelContent = fieldName;
		}
		
		return labelContent.trim();
	},
	setLabelOf: function(fieldName, value) {
		var control = g_form.getControl(fieldName);
		var setLabelOfSomething = false;
		if (this.elementHandlers[control.id] && (typeof this.elementHandlers[control.id].setLabelOf == "function"))
			setLabelOfSomething = this.elementHandlers[control.id].setLabelOf(value);
		var labelEl = this._getLabelEl(fieldName);
		if (labelEl) {
			$j(labelEl).find('.label-text').text(value);
			setLabelOfSomething = true;
		}
		return setLabelOfSomething;
	},
	_getLabelEl: function(fieldName) {
		var fieldID = this.tableName + '.' + fieldName;
		var labelEl = this.getLabel(fieldID);
		if (labelEl)
			return labelEl;
		labelEl = this._tryLabelRowElement(fieldName);
		if (labelEl)
			return labelEl;
		return false;
	},
	
	_getDecorationsEl: function(field) {
		var label = (field instanceof jQuery) ? field : $j(this._getLabelEl(field));
		if (!label.length)
			return null;
		var decorations = label.find('.field_decorations');
		if(!decorations.length) {
$j('<span class="field_decorations" data-label-decorations="[]" />').prependTo(label);
			decorations = label.find('.field_decorations');
		}
		return decorations;
	},
	_getDecorations: function(fieldName) {
		var attrName = 'data-label-decorations';
		var decorations = this._getDecorationsEl(fieldName);
		if (decorations && decorations.length) {
			var raw = decorations.attr(attrName);
			var json = JSON.parse(raw);
			if(json)
				return json;
		}
		return [];
	},
	_setDecorations: function(fieldName, decorations) {
		var isArr = Array.isArray || function(obj) { return $j.type(obj) === "array"; };
		if (!isArr(decorations))
			return false;
		var attrName = 'data-label-decorations';
		var labelEl = this._getLabelEl(fieldName);
		if (labelEl) {
			var raw = JSON.stringify(decorations);
			var decorEl = this._getDecorationsEl($j(labelEl));
			decorEl.empty();
decorEl.attr(attrName, raw);
			for (var i = 0; i < decorations.length; i++) {
				var dec = decorations[i];
				var $dec = $j('<span class="field_decoration ' + dec.icon + ' ' + dec.color + '" ' +
					'title="' + dec.text + '" ' +
'data-placement="right" data-container=".touch_scroll"></span>')
				decorEl.append($dec);
				$dec.tooltip().hideFix();
			}
			return true;
		}
		return false;
	},
	addDecoration: function(field, icon, text, color) {
		text = text || '';
		color = color || '';
		var decorations = this._getDecorations(field);
		var deco = {
			icon: icon,
			text: text,
			color: color
		};
		var isDuplicate = false;
		var maxi = decorations.length;
		for (var i = 0; i < maxi; i++) {
			var dec = decorations[i];
			if (dec.icon == icon
				&& dec.text == text
				&& dec.color == color) {
				isDuplicate = true;
			}
		}
		if(!isDuplicate)
			decorations.push(deco);
		this._setDecorations(field, decorations);
	},
	removeDecoration: function(field, icon, text, color) {
		text = text || '';
		color = color || '';
		var decorations = this._getDecorations(field);
		var out = [];
		var maxi = decorations.length;
		for (var i = 0; i < maxi; i++) {
			var dec = decorations[i];
			if (!(dec.icon == icon
				&& dec.text == text
				&& dec.color == color)) {
				out.push(dec);
			}
		}
		this._setDecorations(field, out);
	},
	removeAllDecorations: function(){
		$j('.field_decorations').remove();
	},
	getSectionNames: function() {
		return g_tabs2Sections.tabNames;
	},
	setSectionDisplay: function(name, display) {
		var index = g_tabs2Sections.findTabIndexByName(name);
		if (index === -1)
			return false;
		if (display === 'true' || display === true)
			g_tabs2Sections.showTab(index);
		else
			g_tabs2Sections.hideTab(index);
		return true;
	},
	isSectionVisible: function(name) {
		var index = g_tabs2Sections.findTabIndexByName(name);
		if(index !== -1)
			return g_tabs2Sections.isVisible(index);
		return false;
	},
	activateTab: function(name) {
		var index = g_tabs2Sections.findTabIndexByName(name);
		if (index !== -1)
			return g_tabs2Sections.setActive(index);
		return false;
	},
	getTabNameForField: function(fieldName) {
		if (!g_form.hasField(fieldName))
			return null;
		var control = g_form.getControl(fieldName);
		return this._getTabNameForElement(control);
	},
	_getTabNameForElement: function(element) {
		var sectionId = $j(element).closest('[data-section-id]').attr('id');
		if (sectionId) {
			var tabIndex = g_tabs2Sections.findTabIndexByID(sectionId);
			return g_tabs2Sections.tabNames[tabIndex];
		}
		return null;
	},
	_instanceofAny: function (obj, classes) {
		if (typeof obj === "undefined" || obj === null || typeof classes === "undefined" || !Array.isArray(classes))
			return false;
		for (var i = 0, iMax = classes.length; i < iMax; i += 1) {
			var aClass = window[classes[i]];
			if (typeof aClass === "undefined")
				continue;
			var constructor = obj.constructor;
			while (constructor) {
				if (constructor === aClass)
					return true;
				constructor = constructor.parent;
			}
			if (obj instanceof aClass)
				return true;
		}
		return false;
	},
	_getVisibleControls : function(field) {
		if (!field)
			return [];
		var visibleControls = [];
		var widgets = this.getControl(field) || [];
		if (widgets.length && this._instanceofAny(widgets, ['RadioNodeList', 'HTMLCollection']))
			widgets = Array.prototype.slice.call(widgets);
		widgets = [].concat(widgets);
		widgets.forEach(function(widget) {
			var widgetType = widget.getAttribute('type');
			if (!widgetType && widget.tagName === 'INPUT')
				widgetType = 'text';
			if (widget.tagName === 'TEXTAREA' && widgetType !== 'hidden')
				visibleControls.push(widget);
			else if (typeof widgetType === 'string' && widgetType.toLowerCase() !== 'hidden')
				visibleControls.push(widget);
			else {
				var widgetDisplayBox = this.getDisplayBox(field);
				if (widgetDisplayBox)
					visibleControls.push(widgetDisplayBox);
			}
		}.bind(this));
		return visibleControls;
	},
	validate : function() {
		var fa = this.elements;
		var rc = true;
		var labels = [];
		var invalidWidgets = [];
		var errorTab = -1;
		for (var i = 0; i < fa.length; i++) {
			var ed = fa[i];
			var widgetName = this.tableName + '.' + ed.fieldName;
			var widget = this.getControl(ed.fieldName);
			if (!widget)
				continue;
			if (!this.isEditableField(ed, widget))
				continue;
			if (widget.getAttribute("validate") == "false")
				continue;
			var widgetValue = widget.value;
			var widgetType = ed.type;
			var specialType = widget.getAttribute("specialtype");
			if (specialType)
				widgetType = specialType;
			var validator = this.validators[widgetType];
			if (!validator)
				continue;
			this.hideFieldMsg(widget);
			var isValid = validator.call(this, widgetValue);
			if (isValid != null && isValid != true) {
				var widgetLabel = this.getLabelOf(ed.fieldName);
				labels.push(widgetName);
				rc = false;
				if (isValid == false || isValid == "false")
					isValid = getMessage("Invalid text");
				this.showFieldMsg(widget, isValid, 'error');
				var widgetVisibleControls = this._getVisibleControls(ed.fieldName);
				if (widgetVisibleControls.length > 0) {
					invalidWidgets.push(widgetVisibleControls);
				}
				if (g_tabs2Sections.activeTab >= 0 && errorTab !== g_tabs2Sections.activeTab) {
					var tabName = this.getTabNameForField(ed.fieldName);
					if (tabName)
						errorTab = g_tabs2Sections.findTabIndexByName(tabName);
				}
			}
		}
		if (errorTab >= 0 && errorTab !== g_tabs2Sections.activeTab)
			g_tabs2Sections.setActiveNoPreference(errorTab);
		for (var i = 0; i < labels.length; i++) {
			if(window.NOW.isUsingPolaris) {
				this.flash(labels[i], "RGB(var(--now-alert--warning--background-color,var(--now-color_alert--warning-0,244,240,191)))", 0);
			} else {
				this.flash(labels[i], "#FFFACD", 0);
			}
		}
		for (var i = 0; i < invalidWidgets.length; i++) {
			for (var j = 0; j < invalidWidgets[i].length; j++) {
				invalidWidgets[i][j].setAttribute('aria-invalid', 'true');
			}
		}
		return rc;
	},
	removeCurrentPrefix: function(id) {
		if (id){
		   if (id.indexOf('current.') == 0){
			 id = id.substring(8);
		   }
		   return id;
		}
	},
	
	removeVariablesPrefix: function(id) {
		return id && id.startsWith("variables.") ? id.substring(10) : id;
	},
	
	hasVariablesPrefix: function(id) {
		return id && id.startsWith("variables.");
	},
	isNumeric: function(internaltype) {
		if (internaltype == 'decimal')
			return true;
		if (internaltype == 'float')
			return true;
		if (internaltype == 'integer')
			return true;
		if (internaltype == 'numeric')
			return true;
		return false;
	},
	isInteger: function(internaltype) {
		if (internaltype == 'integer')
			return true;
		return false;
	},
	setTemplateValue: function(fieldName, value, displayValue) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		if (control)
		   control.templateValue = 'true';
		var text = "Field modified by template";
		var status = this.setValue(fieldName, value, displayValue, true);
		if (status)
			return status;
		this.addDecoration(fieldName, 'icon-success', text);
	},
	sendFeedbackOnSubmit: function (fieldName, response) {
		const genAIResponseLogID = response.logId;
		if (genAIResponseLogID) {
		  if (this.genAIModifiedFields[genAIResponseLogID])
			this.genAIModifiedFields[genAIResponseLogID].push({ fieldName, fieldValue: this.getValue(fieldName) });
		  else this.genAIModifiedFields[genAIResponseLogID] = [{ fieldName, fieldValue: this.getValue(fieldName) }];
		}
	},
	setValue : function(fieldName, value, displayValue, fromSetTemplateValue) {
var oldValue = this.getValue(fieldName);
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		if (!control) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				handler.getObject().setValue(handler.getFieldName(),
						value, displayValue);
			return;
		} else {
			var isChoicePresent = false;
			if (control.options && control.options.length) {
				for (var i = 0; i < control.options.length; i++) {
					control.options[i].removeAttribute('selected');
					if (control.options[i].value === value)
						isChoicePresent = true;
				}
				if (!isChoicePresent && g_allow_field_dependency_for_templates && fromSetTemplateValue)
					return this._getDependentFieldErrorObject(fieldName);
			}
		}
		var previousInternalChangeValue = this._internalChange;
		this._internalChange = true;
		var response = this._setValue(fieldName, value, displayValue, true, fromSetTemplateValue);
		this._internalChange = previousInternalChangeValue;
		this._opticsInspectorLog(fieldName, oldValue);
		if (response && response.success === false)
			return response;
	},
	getNiBox: function(fieldName) {
		var niName = 'ni.' + this.tableName + '.' + fieldName;
		return gel(niName);
	},
	getDisplayBox: function(fieldName) {
		var dName, field;
		dName = 'sys_display.' + this.tableName + '.' + fieldName;
		field = gel(dName);
		if (field)
			return field;
		dName = 'sys_display.' + fieldName;
		field = gel(dName);
		if (field)
			return field;
		var handler = this.getPrefixHandler(fieldName);
		if (handler) {
			var handlerObject = handler.getObject();
			return handlerObject.getDisplayBox(handlerObject.removeCurrentPrefix(fieldName));
		}
		return;
	},
	clearValue: function(fieldName) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		if (!control) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				control = handler.getObject().clearValue(handler.getFieldName());
		   return;
		}
		if (control.id && this.elementHandlers[control.id] && (typeof this.elementHandlers[control.id].clearValue === "function")) {
			this.elementHandlers[control.id].clearValue();
			return;
		}
		if (!control.options) {
			this.setValue(fieldName, '', '');
			return;
		}
		var opt = this._getEmptyOrDefaultOption(control.options);
		if (opt && (control.selectedIndex == -1 || control.value != opt.value))
			this.setValue(fieldName, opt.value, opt.text);
	},
	_getEmptyOrDefaultOption : function(options) {
		if (!options || options.length == 0)
			return null;
		for (i = 0; i < options.length; i++) {
			var opt = options[i];
			if (opt.value === '')
				return opt;
		}
		return options[0];
	},
	_setEmptyMandatoryFieldsVisible : function(fieldName) {
		fieldName = this._sanitizeFieldName(fieldName);
		if (!this.isMandatory(fieldName) || this._isDerivedWaiting(fieldName))
			return;
		var ge = this.getGlideUIElement(fieldName)
		if (ge && !this.isVisible(ge, this.getControl(fieldName))) {
			this.setVisible(fieldName, true);
			this.setDisplay(fieldName, true);
		}
	},
	_sanitizeFieldName : function(fieldName){
		if (fieldName){
			fieldName = this.removeCurrentPrefix(fieldName);
			fieldName = this._removeTableName(fieldName);
		}
		return fieldName;
	},
	_removeTableName : function(fieldName) {
		var tablePrefix = this.tableName + ".";
		if (fieldName && fieldName.startsWith(tablePrefix))
			return fieldName.substring(tablePrefix.length);
		return fieldName;
	},
	_setReadOnlyValue: function(fieldName, value, displayValue, control) {
		var updatedValue = value;
		var readOnlyField = gel('sys_readonly.' + control.id);
		if (readOnlyField) {
			if (g_form.getGlideUIElement(fieldName).type === 'currency') {
				var handler = new CurrencyElement(control.id, 'currency');
				var extractedValues = handler._extractCurrency(value, displayValue);
				if (extractedValues && extractedValues.withSymbolGrouping) {
					readOnlyField.value = extractedValues.withSymbolGrouping;
					updatedValue = extractedValues.type + ';' + extractedValues.amount;
				}
			} else if (readOnlyField.tagName == "SPAN") {
				var fieldType = readOnlyField.getAttribute('gsft_fieldtype');
				if (fieldType && fieldType.indexOf("html") > -1)
					readOnlyField.innerHTML = value;
				else if (fieldType === "timer")
					readOnlyField.innerHTML = htmlEscape(displayValue);
				else
					readOnlyField.innerHTML = htmlEscape(value);
			} else if (displayValue && readOnlyField.tagName != "SELECT") {
				readOnlyField.value = displayValue;
			} else {
				readOnlyField.value = value;
				if (readOnlyField.tagName == "SELECT")
					$j(readOnlyField).trigger('change');
			}
		} else {
			readOnlyField = gel(control.id + "_label");
			if (readOnlyField && this.isReadOnly("", readOnlyField)) {
				displayValue = this._ensureDisplayValue(fieldName, value, displayValue);
				if (readOnlyField.tagName === 'SPAN' || readOnlyField.tagName === 'P')
					readOnlyField.innerHTML = displayValue;
				else
					readOnlyField.value = displayValue;
			}
		}
		if (readOnlyField)
			$j(readOnlyField).trigger("autosize.resize");
		return updatedValue;
	},
	_setValue: function(fieldName, value, displayValue, updateRelated, fromSetTemplateValue) {
		fieldName = this._sanitizeFieldName(fieldName);
		var control = this.getControl(fieldName);
		if (typeof control === 'undefined')
			return;
		var defaultControlValue = this._setReadOnlyValue(fieldName, value, displayValue, control);
		if (!value && value !== 0 && value !== false && !control.options)
			this._setEmptyMandatoryFieldsVisible(fieldName);
		if (control && control.id && this.elementHandlers[control.id] && (typeof this.elementHandlers[control.id].setValue == "function")) {
			this.elementHandlers[control.id].setValue(value, displayValue);
		} else if (control.options) {
			var isSelect2 = $j(control).data() && 'select2' in $j(control).data();			
			if (isSelect2)
				$j(control).select2('destroy');
			var i = this._getSelectedIndex(control, value, displayValue);
			control.selectedIndex = i;
			if (isSelect2)
				$j(control).select2().select2('val', value);
      
			if (!control.options[i].value)
				this._setEmptyMandatoryFieldsVisible(fieldName);
			onChange(this.tableName + "." + fieldName, fromSetTemplateValue, this);
		} else if (control.type == 'hidden') {
			var nibox = this.getNiBox(fieldName);
			if (nibox && nibox.type == 'checkbox') {
				if (value && value == '0')
					value = 'false';
				if (value && value == '1')
					value = 'true';
				control.value = value;
				onChange(this.tableName + "." + fieldName, false, this);
				if (value && value == 'false')
					nibox.checked = null;
				else if (value || value == 'true')
					nibox.checked = 'true';
				else
					nibox.checked = null;
				setCheckBox(nibox);
				return;
			}
			var displaybox = this.getDisplayBox(fieldName);
			if (displaybox) {
				var sel = gel("sys_select." + this.tableName + "." + fieldName);
				if (typeof(displayValue) === 'undefined' && value)
					displayValue = this._ensureDisplayValue(fieldName, value, displayValue, displaybox, fromSetTemplateValue);
				if (displayValue === "" && g_allow_field_dependency_for_templates && fromSetTemplateValue)
					return this._getDependentFieldErrorObject(fieldName);
				control.value = value != null ? value : '';
				if (typeof(displayValue) !== 'undefined') {
					displaybox.value = displayValue;
					onChange(this.tableName + "." + fieldName, fromSetTemplateValue, this);
					removeClassName(displaybox, 'ref_invalid');
					removeClassName(displaybox, 'ref_dynamic');
					displaybox.title = "";
					this._setReferenceSelect(control, sel, value, displayValue);
					refFlipImage(displaybox, control.id);
					if (updateRelated) {
						updateRelatedGivenNameAndValue(this.tableName + '.' + fieldName, value);
					}
					return;
				}
				onChange(this.tableName + "." + fieldName, fromSetTemplateValue, this);
				if (value == null || value == '')
					displayValue = '';
				displaybox.value = displayValue;
				this._setReferenceSelect(control, sel, value, displayValue);
				refFlipImage(displaybox, control.id);
				updateRelatedGivenNameAndValue(this.tableName + '.' + fieldName, value);
			} else if ($(control).hasClassName('glide_destroy_filter') || $(control).hasClassName('glideform-set-value')) {
				$j(control).val(value);
				onChange(this.tableName + "." + fieldName, false, this);
			} else {
				control.value = value;
				onChange(this.tableName + "." + fieldName, false, this);
			}
		} else {
			control.value = defaultControlValue;
			onChange(this.tableName + "." + fieldName, false, this);
		}
	},
	_setReferenceSelect: function(control, sel, value, displayValue) {
		if (control && !control.options && sel) {
			var i = this._getSelectedIndex(sel, value, displayValue);
			var $sel = $j(sel);
			sel.selectedIndex = i;
			if ($sel.data() && 'select2' in $sel.data())
				$sel.select2().select2('val', value);
		}
	},
	_getDependentFieldErrorObject : function(fieldName) {
		return {
			success: false,
message: new GwtMessage().getMessage("Value of the field <b>{0}</b> is incorrect.", fieldName)
		};
	},
	_getSelectedIndex : function(control, value, displayValue) {
		var options = control.options;
		for (var i = 0; i < options.length; i++) {
			var option = options[i];
			if (option.value == value) {
				return i;
			}
		}
		var dv = value;
		if (typeof (displayValue) != 'undefined')
			dv = displayValue;
		var newOption = new Option(dv, value);
		control.options[control.options.length] = newOption;
		return control.options.length - 1;
	},
	_ensureDisplayValue : function(fieldName, value, displayValue, displayBox, fromSetTemplateValue) {
		if (displayValue || value == null || value.toString() === '')
			return displayValue || '';
		var ed = this.getGlideUIElement(fieldName);
		if (!ed)
			return displayValue;
		if (ed.type != 'reference' && ed.type != 'domain_id' && ed.type != 'glide_list')
			return displayValue;
		var ga = new GlideAjax('AjaxClientHelper');
		ga.addParam('sysparm_name', 'getDisplay');
		ga.addParam('sysparm_table', ed.reference);
		ga.addParam('sysparm_value', value);
		if (displayBox !== 'undefined' && g_allow_field_dependency_for_templates && fromSetTemplateValue) {
			var dependentField = displayBox.getAttribute("data-dependent");
			var dependentFieldValue = dependentField ? g_form.getValue(dependentField) : '';
			ga.addParam('sysparm_dependent', dependentField);
			ga.addParam('sysparm_dependent_value', dependentFieldValue);
		}
		ga.getXMLWait();
		return ga.getAnswer();
	},
	getUniqueValue: function() {
		return this.getValue('sys_uniqueValue');
	},
	isDatabaseView: function() {
		var id = this.getUniqueValue();
		return id && id.indexOf('__ENC__') == 0;
	},
	getTitle: function() {
		return this.getValue('sys_titleValue');
	},
	getValue : function(fieldName) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		if (!control) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				return handler.getObject().getValue(
						handler.getFieldName());
			return '';
		}
		return this._getValueFromControl(control);
	},
	getDisplayValue: function() {
		return this.getValue('sys_displayValue');
	},
	_getValueFromControl: function(control) {
		var value;
		if (this.elementHandlers[control.id] && (typeof this.elementHandlers[control.id].getValue == "function")) {
			value = this.elementHandlers[control.id].getValue();
		} else {
			value = control.value;
		}
		return (typeof value !== 'undefined') ? value.toString() : '';
	},
	getIntValue: function(fieldName) {
		var val = this.getValue(fieldName);
		if (!val || val.length == 0)
			return 0;
		return parseInt(formatClean(val));
	},
	getDecimalValue: function(fieldName) {
		var val = this.getValue(fieldName);
		if (!val || val.length == 0)
			return 0;
		var fc = formatClean(val);
fc = fc.replace(/,/g, '.');
		return parseFloat(fc);
	},
	getBooleanValue: function(fieldName) {
		var val = this.getValue(fieldName);
		val = val ? val + '' : val;
		if (!val || val.length == 0 || val =="false")
			return false;
		return true;
	},
	addOption: function (fieldName, choiceValue, choiceLabel, choiceIndex) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		var isSelect2 = $j(control).data() && 'select2' in $j(control).data();
		if (!control) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				handler.getObject().addOption(handler.getFieldName(), choiceValue, choiceLabel, choiceIndex);
			return;
		}
		
		if (isSelect2){
			if (!choiceLabel)
				choiceLabel = choiceValue;
			$j(control).select2('destroy');
			var newOption = new Option(choiceLabel, choiceValue);
			$j(control).append(newOption).trigger('change');
			$j(control).select2();
		}
		if (!control.options)
			return;
		var len = control.options.length;
		var evalLength;
		
		if (!isSelect2)
			evalLength = len
		else if (isSelect2) 
			evalLength = len - 1;
		
		for (i = 0; i < evalLength; i++) {
			if (control.options[i].text == choiceLabel) {
				return;
			}
		}
		if (choiceIndex == undefined)
choiceIndex = len;
		if (choiceIndex < 0 || choiceIndex > len)
choiceIndex = len;
		var newOption = new Option(choiceLabel, choiceValue);
		var value = choiceValue;
if (len > 0) {
value = this.getValue(fieldName);
			control.options[len] = new Option('', '');
			for (var i = len; i > choiceIndex; i--) {
				control.options[i].text = control.options[i - 1].text;
				control.options[i].value = control.options[i - 1].value;
			}
		}
		if (control.readAttribute("readonly") === "readonly") 
			newOption.disabled = true;
		control.options[choiceIndex] = newOption;
		if (isSelect2)
			control.options[len].remove();
		this.setValue(fieldName, value);
	},
	enableOption : function(control, choiceValue, choiceLabel) {
		var len = control.options.length;
		for (var i = len - 1; i >= 0; i--) {
			if (control.options[i].text == choiceLabel && control.options[i].value == choiceValue) {
				control.options[i].disabled = false;
				return true;
			}
		}
		return false;
	},
	clearOptions : function(fieldName) {
		fieldName = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(fieldName);
		if (control && !control.options) {
			var name = "sys_select." + this.tableName + "." + fieldName;
			control = gel(name);
		}
		if (!control) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				handler.getObject().clearOptions(handler.getFieldName());
			return;
		}
		if (!control.options)
			return;
		control.innerHTML = '';
	},
	getOptionControl : function(fieldName, choiceValue) {
		var noPrefix = this.removeCurrentPrefix(fieldName);
		var control = this.getControl(noPrefix);
		if (control && !control.options) {
			var name = "sys_select." + this.tableName + "." + noPrefix;
			control = gel(name);
		}
		return control;
	},
	removeOption : function(fieldName, choiceValue) {
		var control = this.getOptionControl(fieldName, choiceValue);
		if (!control)
			return;
		if (!control.options)
			return;
		var options = control.options;
		for (var i = 0; i < options.length; i++) {
			var option = options[i];
			if (option.value == choiceValue) {
				control.options[i] = null;
				break;
			}
		}
	},
	getOption : function(fieldName, choiceValue) {
		var control = this.getOptionControl(fieldName, choiceValue);
		if (!control)
			return null;
		if (!control.options)
			return null;
		var options = control.options;
		for (var i = 0; i < options.length; i++) {
			var option = options[i];
			if (option.value == choiceValue)
				return option;
		}
		return null;
	},
	removeContextItem: function(itemID) {
		for (av in contextMenus) {
			if (contextMenus[av]) {
				var menu = contextMenus[av];
				var c = menu.context;
				if (c)
					this.removeItem(menu, itemID);
			}
		}
	},
	removeItem: function(menu, itemID) {
		var items = menu.childNodes;
		for (var i = 0; i < items.length; i++) {
		var item = items[i];
			if (item.innerHTML == itemID) {
				menu.removeChild(item);
				clearNodes(item);
				break;
			}
		}
		return;
	},
	getGlideUIElement: function (fieldName) {
		fieldName = this.removeCurrentPrefix(fieldName);
		for (var i = 0; i < this.elements.length; i++) {
			var thisElement = this.elements[i];
			if (thisElement.fieldName == fieldName)
				return thisElement;
		}
	},
	getDerivedFields: function(fieldName, immediateOnly) {
		var parts = fieldName.split(".");
		parts.shift();
		fieldName = parts.join(".")+".";
		var list = new Array();
		for (var i = 0; i < this.elements.length; i++) {
			var thisElement = this.elements[i];
			if (thisElement.fieldName.indexOf(fieldName) == 0) {
				var target = thisElement.fieldName.substring(fieldName.length);
				list.push(target);
			}
		}
		if (list.length == 0)
		   return null;
		if (immediateOnly !== true)
			return list;
		list.sort(function(a, b) {
			return a.split('.').length - b.split('.').length;
		});
		list = list.filter(function(a, index, arr) {
			return !g_form._hasDerivedInBetween(a, arr);
		});
		if (list.length == 0)
			return null;
		return list;
	},
	_hasDerivedInBetween: function(derived, allDerived) {
		var levels = derived.split('.').length;
		for (var i = 0; i < allDerived.length; i++) {
			var d = allDerived[i];
			if (d === derived || d.split('.').length >= levels)
				break;
			if (derived.startsWith(d + '.'))
				return true;
		}
		return false;
	},
	_addDerivedWaiting: function(fieldName, refFieldName, isReadOnly) {
		if (!this.derivedWaiting[fieldName])
			this.derivedWaiting[fieldName] = { fieldName: fieldName, refFieldName: refFieldName, isReadOnly: isReadOnly || false };
		if (!isReadOnly)
			this._setDerivedWaitingReadonly(fieldName, true);
	},
	_isDerivedWaiting: function(fieldName) {
		var shortFieldName = this._removeTableName(fieldName);
		return (shortFieldName in this.derivedWaiting);
	},
	_removeDerivedWaiting: function(fieldName) {
		var shortFieldName = this._removeTableName(fieldName);
		if (shortFieldName in this.derivedWaiting)
			delete this.derivedWaiting[shortFieldName];
	},
	_resetDerivedField: function(fieldName) {
		if (this._isDerivedWaiting(fieldName)) {
			var shortFieldName = this._removeTableName(fieldName);
			if (!this.derivedWaiting[shortFieldName].isReadOnly)
				this._setDerivedWaitingReadonly(fieldName, false);
			this._removeDerivedWaiting(fieldName);
			CustomEvent.fire('derived_waiting_removed.' + fieldName);
		}
	},
	getReference: function(fieldName, callback) {
		var opticsContext = null;
		if (window['g_optics_inspect_handler'] && g_optics_inspect_handler.opticsContextStack.length > 0)
			opticsContext = g_optics_inspect_handler.opticsContextStack[g_optics_inspect_handler.opticsContextStack.length - 1];
		fieldName = this.removeCurrentPrefix(fieldName);
		var ed = this.getGlideUIElement(fieldName);
		if (!ed) {
			var handler = this.getPrefixHandler(fieldName);
			if (handler)
				return handler.getObject().getReference(handler.getFieldName(), callback);
			return;
		}
		if (ed.type != 'reference' && ed.type != 'domain_id')
			return;
		var value = this.getValue(fieldName);
		var gr = new GlideRecord(ed.reference);
		if (value == "") {
			if (callback)
				callback(gr);
			return gr;
		}
		if (window.g_event_handlers_localCache && !callback) {
			var cachedObj = window.g_event_handlers_localCache[fieldName];
			if (typeof cachedObj !== 'undefined' && cachedObj.sys_id === value) {
				jslog("GlideForm: getReference cache hit on " + this.getTableName() + "." + fieldName + ":" + value + ", skipped synchronous ajax call");
				return cachedObj;
			}
		}
		gr.addQuery(ed.referenceKey, value);
		if (callback) {
			var fn = function(gr) {
				gr.next();
				if (opticsContext)
					CustomEvent.fire('glide_optics_inspect_put_context', opticsContext["category"], opticsContext["name"], opticsContext["sys_id"]);
				callback(gr);
				if (opticsContext)
					CustomEvent.fire('glide_optics_inspect_pop_context');
			};
			gr.query(fn);
			return;
		} else {
			var sw = new StopWatch();
			sw.jslog("*** WARNING *** GlideForm: synchronous getReference call on " + this.getTableName() + " for " + fieldName);
			if (g_event_handlers_queryTracking) {
				gr.addAdditionalParam("sysparm_reference_query_table", this.getTableName());
				gr.addAdditionalParam("sysparm_reference_query_field", fieldName);
			}
		}
		gr.query();
		gr.next();
		return gr;
	},
	submit: function(actionName) {
		actionName = actionName || 'sysverb_update';
		var action = gel(actionName);
		if (!action)
			action = this._getLinkActionByAttribute(actionName);
		if (action)
			return gsftSubmit(action);
	},
	_getLinkActionByAttribute: function(actionName, attribute) {
		var attr = attribute || 'gsft_action_name';
		var selector = 'a[' + attr + '="' + actionName + '"]';
		var el = $j(selector);
		if (el.length === 0)
			return;
		return el[0];
	},
	save: function() {
		return this.submit('sysverb_update_and_stay');
	},
	getActionName : function() {
		var form = this.getFormElement();
		if (form) {
			var theButton = form.sys_action;
			if (theButton)
				return theButton.value;
		}
		return this.action;
	},
	getTableName: function() {
		return this.tableName;
	},
	getSections: function() {
		return $$('form span.tabs2_section span[data-header-only="false"]');
	},
	serialize: function (filterFunc) {
		var formName = this.tableName + '.do';
		if (!filterFunc)
			return Form.serialize(gel(formName)) + this._serializeDisabled();
		var elements = Form.getElements(gel(formName));
		var queryComponents = new Array();
		for (var i = 0; i < elements.length; i++) {
			if (filterFunc(elements[i])) {
				var queryComponent;
				if (elements[i].disabled)
					queryComponent = elements[i].id + '=' + encodeURIComponent(elements[i].value);
				else
					queryComponent = Form.Element.serialize(elements[i]);
				if (queryComponent)
					queryComponents.push(queryComponent);
			}
		}
		return queryComponents.join('&');
	},
	_serializeDisabled : function() {
		var n = this.disabledFields.length;
		var dfa = [];
		for (var i = 0; i < n; i++) {
			var e = this.disabledFields[i];
			if (!e.value || !e.id)
				continue;
			dfa.push(e.id + '=' + encodeURIComponent(e.value));
		}
		if (dfa.length)
			return '&' + dfa.join('&');
		return '';
	},
	serializeChanged: function() {
		var s = this.serializeTargetFields();
		var f = this.serialize(this.changedFieldsFilter.bind(this));
		if (f)
			f = "&" + f;
		return s + f;
	},
	serializeChangedAll: function() {
		var s = this.serializeTargetFields();
		var f = this.serialize(this.allChangedFieldsFilter.bind(this));
		if (f)
			f = "&" + f;
		return s + f;
	},
  	_serializeElementIfEmpty: function(key, value) {
		var obj = {};
		obj[key] = value;
		return key && value ? "&" + Object.toQueryString(obj) : "";
  	},
    
	serializeTargetFields: function() {
		var s = this._serializeElement("sys_target") || this._serializeElementIfEmpty("sys_target", this.getTableName());
		s += this._serializeElement("sys_uniqueValue");
		s += this._serializeElement("sys_row");
		s += this._serializeElement("sysparm_encoded_record");
		return s;
	},
	_serializeElement: function(id) {
		var e = gel(id);
		if (e) {
			var queryComponent = Form.Element.serialize(e);
			if (queryComponent)
				return "&" + queryComponent;
		}
		return "";
	},
	changedFieldsFilter: function(element) {
		if (element.changed
			&& element.id.startsWith(this.getTableName() + ".")
			&& (element.tagName.toUpperCase() != "TEXTAREA"))
			return true;
		if (element.id.startsWith("ni.VE") || element.id.startsWith("ni.QS")) {
			if (element.id.endsWith("read_only"))
				return false;
			return true;
		}
		if (element.name.startsWith("ni.WATERMARK"))
			return true;
		return false;
	},
	allChangedFieldsFilter: function(element) {
		if (element.changed && element.id.startsWith(this.getTableName() + "."))
			return true;
		return false;
	},
	flash: function (widgetName, color, count) {
		var row = null;
		var labels = new Array();
		var realLabel = this.getLabel(widgetName);
		if (realLabel)
			row = $(realLabel.parentNode.parentNode);
		else {
			jslog("flash() called for '" + widgetName + "' but there is no label for it")
			return;
		}
		var temp = row.select('.label_left');
		for (var i = 0; i < temp.length; i++)
			labels.push(temp[i]);
		temp = row.select('.label_right');
		for (var i = 0; i < temp.length; i++)
			labels.push(temp[i]);
		temp = row.select('.label');
		for (var i = 0; i < temp.length; i++)
			labels.push(temp[i]);
temp = row.select('.control-label');
		for (var i = 0; i < temp.length; i++)
			labels.push(temp[i]);
		count = count + 1;
		for (var i = 0; i < labels.length; i++) {
			var widget = labels[i];
			if (widget) {
				var originalColor = widget.style.backgroundColor;
				widget.style.backgroundColor = (count < 4 || isNaN(count)) ? color : '';
			}
		}
		if (count < 4)
				setTimeout('g_form.flash("' + widgetName + '", "' + originalColor + '", ' + count + ')', 500);
	},
	enable: function () {
		var form = this.getFormElement();
		if (form)
			for (var i = 0; i < form.elements.length; i++)
				form.elements[i].disabled = false;
	},
	disable: function() {
		var form = this.getFormElement();
		if (form)
			for (var i = 0; i < form.elements.length; i++)
				form.elements[i].disabled = true;
	},
	showRelatedList: function(listTableName) {
		CustomEvent.fire('related_lists.show', listTableName);
	},
	hideRelatedList: function(listTableName) {
		CustomEvent.fire('related_lists.hide', listTableName);
	},
	getRelatedListNames: function() {
		if (window.NOW.g_relatedLists)
			return window.NOW.g_relatedLists.lists;
		if (window.g_tabs2List) {
			var relatedListNames = [];
			var trimmedNames = g_tabs2List.tabIDs;
			for (var i = 0; i < trimmedNames.length; i++) 
				relatedListNames.push(trimmedNames[i].split('.').slice(1).join('.'));
			return relatedListNames;
		}
		var listWrapper = gel("related_lists_wrapper");
		if (!listWrapper)
			return [];
		var forthcomingTabs = listWrapper.getAttribute('data-lists');
		if (!forthcomingTabs)
			return [];
		return forthcomingTabs.split(',');
	},
	_getRelatedListID: function(listTableName) {
		var relatedList = this.findV2RelatedListName(listTableName);
		var relatedListId;
if (relatedList)
			relatedListId = relatedList.getAttribute("id");
		if (!relatedListId)
			relatedListId = this.getTableName() + "." + listTableName;
		return relatedListId;
	},
	findV2RelatedListName : function(listTableName) {
		var tableName = this.getTableName();
		var compareId = tableName + "." + listTableName;
		var rlw = gel("related_lists_wrapper");
		if (!rlw)
			return "";
		for (var i = 0; i < rlw.childNodes.length; i++) {
			var node = rlw.childNodes[i];
			if (node.nodeName != "DIV")
				continue;
			var idName = node.getAttribute("id");
			if (idName.length == 0)
				continue;
			if (idName.indexOf(compareId) > -1)
				return node;
		}
		if (typeof GlideLists2 == "undefined")
			return;
		for ( var id in GlideLists2) {
			var list = GlideLists2[id];
			if (list.getTableName() == listTableName && list.getParentTable() == tableName)
				return list.getContainer();
		}
		return "";
	},
	showRelatedLists : function() {
		var listNames = g_form.getRelatedListNames();
		for (var i = 0; i < listNames.length; i++) {
			this.showRelatedList(listNames[i]);
		}
	},
	hideRelatedLists : function() {
		var listNames = g_form.getRelatedListNames();
		for (var i = 0; i < listNames.length; i++) {
			this.hideRelatedList(listNames[i]);
		}
	},
	addInfoMessage: function(msg, id) {
		this._addFormMessage(msg, "info", id);
	},
	addWarningMessage: function(msg, id) {
		this._addFormMessage(msg, "warning", id);
	},
	addErrorMessage: function(msg, id) {
		this._addFormMessage(msg, "error", id);
	},
	addSuggestionMessage: function(msg, id) {
		this._addFormMessage(msg, 'suggestion', id)
	},
	addFormMessage: function(msg, type) {
		if (type !== 'error' && type !== 'warning' && type !== 'suggestion')
			type = 'info';
		this._addFormMessage(msg, type);
	},
	
	_addFormMessage: function(msg, type, id) {
		var scrollToMsg = gel("ni.escape_form_message");
		if (scrollToMsg && scrollToMsg.value === 'true')
			msg = htmlEscape(msg);
		GlideUI.get().addOutputMessage({msg: msg, type: type, id: id, preventDuplicates: true});
		var scrollDiv = getFormContentParent();
		scrollDiv.scrollTop = 0;
		window.GlideUXMetrics && GlideUXMetrics.track('Form Alerts', {name : msg, type: type});
	},
	clearMessages: function() {
		GlideUI.get().clearOutputMessages();
	},
showFieldMsg: function(input, message, type,  scrollForm, key) {
		var msgClass;
		var msgImage;
		var msgImageAlt;
		var msgRowType;
		switch(type) {
			case "info":
				msgClass = this.INFO_CLASS;
				msgRowType = 'info' + this.MSG_ROW;
				break;
			case "error":
				msgClass = this.ERROR_CLASS;
				msgRowType = 'error' + this.MSG_ROW;
				break;
			case "warning":
				msgClass = this.WARNING_CLASS;
				msgRowType = 'warning' + this.MSG_ROW;
				break;
			default:
				type = 'info';
				msgClass = this.INFO_CLASS;
				msgRowType = 'info' + this.MSG_ROW;
				break;
		}
		var inputElement = input;
if (typeof(inputElement)=="string")
		   inputElement = this.getControl(inputElement);
		if (!inputElement) {
			var handler = this.getPrefixHandler(input);
			if (handler) {
				var handlerObject = handler.getObject();
				var fieldName = handler.getFieldName();
				var actualName = handlerObject.getActualName(fieldName);
				inputElement = handlerObject.getControl(actualName);
			}
		}
		if (!inputElement || !message) {
			jslog("ERROR: invalid field or missing message passed to g_form.showFieldMsg('" + input + "','" + message + "')");
			return;
		}
		if (inputElement.id && this.elementHandlers[inputElement.id] && (typeof this.elementHandlers[inputElement.id].showFieldMsg == "function"))
			this.elementHandlers[inputElement.id].showFieldMsg(input, message, type);
		var positionedCursor = this._positionCursorAtError(inputElement, message);
		var fieldRowId = "element." + inputElement.id;
		var fieldRow = document.getElementById(fieldRowId);
		var doc;
		var isVariable = false;
		var variableMsgRow = null;
		if (!fieldRow) {
			var parent = inputElement.parentNode;
			while (parent != null) {
				if (parent.nodeName.toUpperCase() == 'TR') {	
					fieldRow = parent;
					isVariable = true;
					break;
				}	
				parent = parent.parentNode;
			}
		}
		if (!fieldRow) {
			jslog("Error adding field message. Couldn't find the row to add the field message to.");
			return;
		}
		doc = fieldRow.ownerDocument;
		var inputContainer = inputElement.up('.form-field');
		if (!inputContainer)
			inputContainer = inputElement.up();
		var fieldMsgContainer = inputContainer.down('.fieldmsg-container');
		if (!fieldMsgContainer) {
			fieldMsgContainer = doc.createElement('div');
			fieldMsgContainer.className = 'fieldmsg-container';
			if (isVariable)
				fieldMsgContainer.className = 'variable-field-msg';
			fieldMsgContainer.id = inputElement.id + '_fieldmsg';
			fieldMsgContainer.setAttribute('aria-live', 'polite');
			inputContainer.insert(fieldMsgContainer);
			inputElement.setAttribute('aria-describedby', fieldMsgContainer.id);
			if (inputElement.getAttribute('data-type') === 'glide_element_date_time') {
				var inputSibling = inputElement.siblings(inputElement.id + '_date_field_msg');
				if(inputSibling.length > 0){
					inputSibling[0].setAttribute('aria-describedby', fieldMsgContainer.id);
				}
				var buttonGroupSiblings = inputElement.siblings('.input-group-btn');
				if (buttonGroupSiblings.length > 0) {
					var buttonGroup = buttonGroupSiblings[0];
					var button = buttonGroup.querySelector('.date_time_trigger');
					if (button) {
						button.setAttribute('aria-describedby', fieldMsgContainer.id);
					}
				}
			}
		}
		var fieldMsgRow = doc.createElement('DIV');
		fieldMsgRow.className = msgClass;
		fieldMsgRow.hasFieldmsg = true;
		if (key)
			fieldMsgRow.setAttribute('data-fieldmsg-key', inputElement.id + '_fieldmsg_' + key);
		var fieldmsgMsg = doc.createTextNode(message);
		fieldMsgRow.appendChild(fieldmsgMsg);
		
		fieldMsgContainer.insert(fieldMsgRow);
		if (!fieldRow.visible() && fieldRow.getAttribute("data-type") == "journal_input") {
			var multipleInput = $("multiple-input-journal-entry");
			if (multipleInput && multipleInput.visible())
				fieldRow = $j("#multiple-input-journal-entry textarea")[0];
			else
				fieldRow = $("activity-stream-textarea");
		}
if (!positionedCursor)
			this._scrollToElementTR(fieldRow, fieldMsgRow, scrollForm);
		_frameChanged();
	},
	_scrollToElementTR: function(labelTR, msgTR, scrollForm) {
		var scroll = scrollForm;
		if (typeof scroll == "undefined") {
			var scrollToMsg = gel("ni.scroll_to_messsage_field");
			if (scrollToMsg == null)
				scroll = true;
			else {
				if (scrollToMsg.value != "false")
					scroll = true;
				else
					scroll = false;
			}
		}
		if (!scroll)
			return;
		var scrollDiv = getFormContentParent();
		var refControl = gel("sys_target");
		var ref;
		var titleDiv;
		if (refControl != null) {
			ref = refControl.value;
			titleDiv = gel(ref + ".form_header");
		} else {
			titleDiv = gel("form_header");
		}
		var headerHeight = 0;
		if (titleDiv && titleDiv.clientHeight)
			headerHeight = titleDiv.clientHeight;
		var topOfLabel = grabOffsetTop(labelTR);
		var needToScroll = false;
		if (topOfLabel > scrollDiv.scrollTop + scrollDiv.clientHeight)
needToScroll = true;
		else if (topOfLabel < scrollDiv.scrollTop + headerHeight)
needToScroll = true;
else {
			var topOfMsg = grabOffsetTop(msgTR);
			if (topOfMsg > scrollDiv.scrollTop + scrollDiv.clientHeight)
				needToScroll = true;
		}
		if (!needToScroll)
			return;
		var scrollTopSetting = topOfLabel - headerHeight;
		if (scrollDiv.id)
			setTimeout("$('" + scrollDiv.id + "').scrollTop = " + scrollTopSetting, 100);
		else
			scrollDiv.scrollTop = scrollTopSetting;
	},
showErrorBox: function(input, message,  scrollForm) {
		this.showFieldMsg(input, message, "error", scrollForm);
	},
	hideFieldMsg: function(input, clearAll, key) {
		var inputElement = input;
if (typeof(inputElement) == "string")
		   inputElement = this.getControl(inputElement);
		
		if (!inputElement) {
			var handler = this.getPrefixHandler(input);
			if (handler) {
				var handlerObject = handler.getObject();
				var fieldName = handler.getFieldName();
				var actualName = handlerObject.getActualName(fieldName);
				inputElement = handlerObject.getControl(actualName);
			}
		}
		
		if (!inputElement) {
			jslog("ERROR: invalid field ('" + input + "') passed to g_form.hideFieldMsg");
			return;
		}
		if (inputElement.id && this.elementHandlers[inputElement.id] && (typeof this.elementHandlers[inputElement.id].hideFieldMsg == "function"))
			this.elementHandlers[inputElement.id].hideFieldMsg(input, clearAll);
		var fieldTrId = "element." + inputElement.id;
		var tr = document.getElementById(fieldTrId);
		if (!tr) {
			var parent = inputElement.up("div.form-field.input_controls");
			if (!parent)
				parent = inputElement.up("td");
			if (parent) {
				var msgs = $(parent).select(".variable-field-msg");
				if (msgs)
					for (var i = 0; i < msgs.length; i++) {
						try {
							parent.removeChild(msgs[i]);}
						catch (err){
							msgs[i].parentNode.removeChild(msgs[i]);}
						if (!clearAll)
							return;
					}
			}
		}
		if (tr == null)
			return;
		var msgContainer = tr.down('.fieldmsg-container');
		if (!msgContainer)
			return;
		if (clearAll)
			msgContainer.update('');
		else {
			var selector;
			if (key)
				selector = '[data-fieldmsg-key="' + inputElement.id + '_fieldmsg_' + key + '"]';
			else
				selector = '.fieldmsg';
			var messages = msgContainer.select(selector);
			if (messages[0])
				messages[0].remove();
		}
	},
	hasFieldMsgs: function(type) {
		var formHasFieldMsgs = false;
		if (type) {
			var msgTRs = $(document.body).select('.fieldmsg.notification-' + type);
			formHasFieldMsgs = msgTRs.length > 0;
		}
		else {
			var msgTRs = $(document.body).select('.fieldmsg');
			formHasFieldMsgs = msgTRs.length > 0;
		}
		return formHasFieldMsgs;
	},
	hideAllFieldMsgs: function(type) {
		if (type) {
			var msgTRs = $(document.body).select('.fieldmsg.notification-' + type);
			for (var i = 0; i < msgTRs.length;i++) {
				msgTRs[i].parentNode.removeChild(msgTRs[i]);
			}
		}
		else {
			var msgTRs = $(document.body).select('.fieldmsg');
			for (var i = 0; i < msgTRs.length;i++) {
				msgTRs[i].parentNode.removeChild(msgTRs[i]);
			}
		}
		CustomEvent.fire('sn.form.hide_all_field_msg', type);
	},
	hideErrorBox: function(input) {
		this.hideFieldMsg(input);
	},
	setStreamJournalFieldsDisplay: function(show) {
		CustomEvent.fire('sn.stream.change_input_display', this.getTableName(), show);
		CustomEvent.fire('sn.form.change_input_display', !show);
	},
	_positionCursorAtError: function(elem, message) {
		if (typeof elem == "undefined" || elem.disabled)
			return false;
		var index = message.indexOf("line (");
		if (index > -1) {
			var parenIndex = message.indexOf(")", index+6);
			if (parenIndex > -1) {
				var lineNo = message.substring(index + 6, parenIndex);
				lineNo = parseInt(lineNo, 10);
				index = message.indexOf("(", parenIndex);
				if (index > -1) {
					parenIndex = message.indexOf(")", index);
					if (parenIndex > -1) {
						var columnNo = message.substring(index + 1, parenIndex);
						columnNo = parseInt(columnNo, 10);
						return this._setCaretPositionLineColumn(elem, lineNo, columnNo);
					}
				} else
					return this._setCaretPositionLineColumn(elem, lineNo, 1);
			}
		}
		return false;
	},
	_setCaretPositionLineColumn: function(elem, lineNo, columnNo) {
		var pl = 1;
		var data = elem.value;
		var len = data.length;
		var position = 0;
		while (pl < lineNo && position > -1) {
			position = data.indexOf('\n', position);
			if (position > -1)
				position++;
			pl++;
		}
		if (position == -1) {
			jslog("Failed to find editor caret position for error");
return false;
		}
		position += columnNo - 1;
		if (elem.createTextRange)
position -= lineNo - 1;
		try {
			this._setCaretPosition(elem, position);
		} catch (err) {
			jslog("Failed to position cursor at the error");
			return false;
		}
		return true;
	},
	_setCaretPosition: function(elem, caretPos) {
if (elem.createTextRange) {
			var range = elem.createTextRange();
			range.move('character', caretPos);
			range.select();
		} else {
if (elem.setSelectionRange) {
				if (caretPos == 0)
					caretPos = 1;
				elem.setSelectionRange(caretPos, caretPos + 1);
if (isSafari || isChrome)
					elem.focus();
else {
					var ev = document.createEvent("KeyEvents");
					ev.initKeyEvent("keypress", true, true, window, false, false, false, false, 0, elem.value.charCodeAt(caretPos - 1));
					elem.dispatchEvent(ev);
					elem.focus();
				}
			} else
				elem.focus();
		}
	},
	disableAttachments: function() {
		var icon = gel("header_add_attachment");
		if (icon)
			icon.style.display = 'none';
		AttachmentUploader.disableAttachments();
	},
	enableAttachments: function() {
		var icon = gel("header_add_attachment");
		if (icon)
			icon.style.display = '';
		AttachmentUploader.enableAttachments();
	},
	hasField: function(fieldName) {
		return !!this.getControl(fieldName);
	},
	setAction: function(action) {
		this.action = action;
	},
	getAction: function() {
		return this.action;
	},
	
	setScope: function(scope) {
		this.scope = scope;
	},
	
	getScope: function() {
		return this.scope;
	},
	setLiveUpdating: function(isLiveUpdating) {
		this._isLiveUpdating = isLiveUpdating;
	},
	isLiveUpdating: function() {
		return this._isLiveUpdating;
	},
	setLiveUpdateOriginalValue: function(fieldName, value, displayValue) {
		var element = this.getElement(fieldName);
		if (!element)
			return;
		if (this.elementHandlers[element.id] && (typeof this.elementHandlers[element.id].setLiveUpdateOriginalValue == "function"))
			return this.elementHandlers[element.id].setLiveUpdateOriginalValue(value, displayValue);
		var widgetName = "sys_original." + element.id;
		var widget = gel(widgetName);
		if (widget)
			widget.value = value;
		var originalDisplay = gel('sys_display.original.' + element.id);
		if (originalDisplay)
			originalDisplay.value = displayValue;
	},
	_opticsInspectorLog: function(fieldName, oldValue){
		var value = this.getValue(fieldName);
		opticsLog(this.tableName, fieldName, "Value changed from "
				+ (oldValue ? oldValue : "(empty)") + " to "
				+ (value ? value : "(empty)"), oldValue, value);
	},
	insertContentAtCursor: function(fieldName, content) {
		var element = this.getElement(fieldName);
		if (!element)
			return;
		if (this.elementHandlers[element.id] && (typeof this.elementHandlers[element.id].insertContentAtCursor == "function"))
			return this.elementHandlers[element.id].insertContentAtCursor(content);
		var cursorLocation = element.selectionStart;
		if (!cursorLocation)
			cursorLocation = 0;
		var originalContent = this.getValue(fieldName);
		if (typeof originalContent == 'string') {
			var newContent = originalContent.substr(0, cursorLocation) + content + originalContent.substr(cursorLocation);
			this.setValue(fieldName, newContent);
		}
	},
 	onUserChangeValue: function(handler) {
 		if (this._onUserChangedHandlers != null && this._onUserChangedHandlers.indexOf(handler) === -1)
 			this._onUserChangedHandlers.push(handler);
 		var gf = this;
 		return function() { 	
 			var index = gf._onUserChangedHandlers.indexOf(handler);	
 			if (index > -1)	
 				gf._onUserChangedHandlers.splice(index, 1);	
 		};	
 	},
	useEsLatest: function() {
		var useEsLatestToggle = document.querySelector('.use-es-latest-toggle');
		if (useEsLatestToggle)
			return useEsLatestToggle.checked === true && this.isEsLatestVisible;
		return false;
	},
	handleEsLatestVisibilty: function(value) {
		var useEsLatestContainer = gel('es-latest-container');
		if (useEsLatestContainer)
			useEsLatestContainer.style.display = value === 'true' ? 'flex' : 'none';
		this.isEsLatestVisible = value === 'true';
	},
	type: "GlideForm"
});
var GlideFormPrefixHandler = Class.create({
	initialize: function (handlerObject) {
		this.handlerObject = handlerObject;
		this.fieldName = "";
	},
	getObject: function() {
		return this.handlerObject;
	},
	getFieldName: function() {
		return this.fieldName;
	},
	setFieldName: function(id) {
		this.fieldName = id;
	},
	type: "GlideFormPrefixHandler"
});
;
/*! RESOURCE: /scripts/doctype/GwtContextMenu.js */
var gActiveContext;
var contextMenus = new Object();
var shortcuts = new Object();
var sanitizeText = /[^a-zA-Z0-9_ ]/g;
var GwtContextMenu = Class.create({
SUBMENU_INDICATOR: "<i class='icon-chevron-right context_submenu_indicator'/>",
CHECKED_IMAGE_PATH: "images/checked.pngx",
    CHECKED_ICON_CLASSES: ['icon-check','selected_item'],
    initialize: function(id, useBodyAsParent) {
        this.timeout = null;
        this.properties = new Object();
        this.setID(id);
        this.getMenu();
        this.onshow = null;
        this.onhide = null;
        this.beforehide = null;
        this.docRoot = this._getDocRoot();
        this.hasItems = false;
        this.hideOnlySelf = false;
	    this.trackSelected = false;
	    if (typeof useBodyAsParent == "undefined")
	        useBodyAsParent = false;
	    this._getParentElement(useBodyAsParent);
	    this.opener = undefined;
    },
    isEmpty: function() {
        return !this.hasItems;
    },
    _getParentElement: function(useBodyAsParent) {
        if (useBodyAsParent) {
            this.parentElement = document.body;
            return;
        }
        this.parentElement = getFormContentParent();
    },
    _getDocRoot: function() {
var docRoot = window.location.protocol + "//" + window.location.host;
if (window.location.pathname.indexOf("/") > -1) {
            var fp = window.location.pathname;
fp = fp.substring(0, fp.lastIndexOf("/"));
if (fp.substring(0, 1).indexOf("/") != -1)
                docRoot = docRoot + fp;
            else
docRoot = docRoot + "/" + fp;
        }
docRoot += "/";
        return docRoot;
    },
    add: function(label, id, keys) {
        this.hasItems = true;
        var m = this.getMenu();
        var d = document.createElement("div");
        d.setAttribute("item_id", id);
		if (g_accessibility === true) {
			d.className = "context_item default-focus-outline";
		} else {
			d.className = "context_item";
		}
        d.isMenuItem = true;
        d.setAttribute('role', 'menuitem');
        d.setAttribute('tabindex', '-1');
        var l = !keys ? label : (label + ' (' + keys + ')');
        d.innerHTML = l;
        if(keys)
        	d.setAttribute("data-label", label);
        m.appendChild(d);
        return d;
    },
    addHref: function(label, href, img, title, id, keys) {
        keys = this.addKeyShortcut(keys, href);
        var d = this.add(label, id, keys);
        d.setAttribute("href", href);
        if (title && title != null) {
            d.setAttribute("title", title);
d.addClassName("accessibility_no_tooltip");
		}
        this.setImage(d, img);
        return d;
    },
    addFunc: function(label, func, id) {
        var d = this.add(label, id);
        d.setAttribute("func_set", "true");
        d.func = func;
        return d;
    },
    addURL: function(label, url, target, id) {
        var d = this.add(label, id);
        url = this._updateURL(d, label, url);
        d.setAttribute("url", url);
        if (target)
            d.setAttribute("target", target);
        return d;
    },
    addHrefNoSort: function(label, href, id) {
        var item = this.addHref(label, href, null, null, id);
        item.setAttribute("not_sortable", "true");
        return item;
    },
    addHrefNoFilter: function(label, href, id) {
        var item = this.addHref(label, href, null, null, id);
        item.setAttribute("not_filterable", "true");
        return item;
    },
    addMenu: function(label, menu, id) {
        var item = this.add(label + this.SUBMENU_INDICATOR, id);
        item.setAttribute("aria-haspopup", "true");
        item.setAttribute("aria-controls", menu.id);
        item.setAttribute("label", "true");
        item.setAttribute("data-context-menu-label", label);
        menu.setParent(this);
        item.subMenu = menu;
        return item;
    },
    addAction: function(label, action, id) {
        return this.addHref(label, "contextAction('" + this.getTableName() + "', '" + action + "')", null, null, id);
    },
    addConfirmedAction: function(label, action, id) {
        return this.addHref(label, "contextConfirm('" + this.getTableName() + "', '" + action + "')", null, null, id);
    },
    addLine: function() {
        this.hasItems = true;
        var m = this.getMenu();
        var d = document.createElement("div");
        d.className = "context_item_hr";
        d.isMenuItem = true;
        d.disabled = "disabled";
        m.appendChild(d);
        return d;
    },
    addLabel: function(label, id) {
        var m = this.getMenu();
        var d = document.createElement("div");
        d.setAttribute("item_id", id);
        d.className = "context_item";
        d.isMenuItem = true;
        d.innerHTML = label;
        d.disabled = "disabled";
        m.appendChild(d);
        return d;
    },
    addKeyShortcut: function(keys, href) {
    	var topWindow = getTopWindow();
    	var keyboardEnabled = topWindow.com && topWindow.com.glide && topWindow.com.glide.ui && topWindow.com.glide.ui.keyboard;
        if(!keyboardEnabled)
        	return null;
    	if(!keys)
    		return keys;
        if(shortcuts[keys])
        	return keys;
        shortcuts[keys] = {};
        var callback = function(e) {
        	var start = e.data.href.indexOf('javascript:') == 0 ? 11 : 0;
        	var startParen = e.data.href.indexOf('(');
        	var functionName = startParen > start ? e.data.href.substring(start, startParen) : {};
        	var func = eval(functionName);
        	if(typeof func == 'function')
        		eval(e.data.href);
        	else
        		document.location.href = e.data.href;
        };
		addLoadEvent(function() {
			var keyboard = getTopWindow().com.glide.ui.keyboard;
			var isMainFrame = window.frameElement.id == keyboard.mainFrame;
			var isFormFrame = window.frameElement.id == keyboard.formFrame;
if(isMainFrame)
				shortcuts[keys] = keyboard.bind(keys, callback, {href:href}).global(keyboard.formFrame);
else if(isFormFrame)
				shortcuts[keys] = keyboard.bind(keys, callback, {href:href}).formFrame();
else
				shortcuts[keys] = null;
		});
		return keys;
    },
    getItem: function(itemId) {
        var items = this.getMenu().getElementsByTagName("div");
        for (var i = 0; i < items.length; i++) {
            var item = items[i];
            if (item.getAttribute("item_id") == itemId)
                return item;
        }
        return null;
    },
    setImage: function(item, img) {
        if (item && img) {
            var imageIsCheckmark = img === this.CHECKED_IMAGE_PATH;
            if (imageIsCheckmark) {
                this.setCheckedIcon(item);
                var selectedText = item.innerText || item.textContent;
                var ariaLabel = getMessage('Currently selected: ') + selectedText;
                item.setAttribute('aria-label', ariaLabel);
            } else {
                item.style.backgroundImage = "url(" + this.docRoot + img + ")";
                item.style.backgroundRepeat = "no-repeat";
            }
        }
    },
    setChecked: function(item) {
        if (item)
            this.setImage(item, this.CHECKED_IMAGE_PATH);
    },
    _generateCheckElement: function() {
        var classNames = this.CHECKED_ICON_CLASSES.join(' ');
        var checkElem = document.createElement("div");
        checkElem.setAttribute("class", classNames);
        return checkElem;
    },
    setCheckedIcon: function(item) {
        if (item) {
            var checkElem = this._generateCheckElement();
            item.appendChild(checkElem);
        }
    },
    clearImage: function(item) {
        if (item) {
            item.style.backgroundImage = "";
            item.style.backgroundRepeat = "";
            item.setAttribute('aria-label', '');
        }
    },
    clearCheckedIcon: function(item) {
        if (item) {
            var classNames = this.CHECKED_ICON_CLASSES.map(function(className) {return '.' + className}).join('');
            var checkedIcon = item.querySelector(classNames);
            if (checkedIcon)
                checkedIcon.remove();
        }
    },
    setDisabled: function(item) {
        if (!item)
            return;
        this._dullItem(item);
    },
    setEnabled: function(item) {
        if (!item)
            return;
        this._undullItem(item);
    },
    setHidden : function(item) {
        if (!item)
            return;
        this._hideItem(item);
    },
    setVisible : function(item) {
        if (!item)
            return;
        this._showItem(item);
    },
    setLabel: function(item, label) {
        if (item)
            item.innerHTML = label;
    },
    setHideOnlySelf: function(hideSelf) {
        this.hideOnlySelf = hideSelf;
    },
    clearSelected: function() {
        var items = this.getMenu().getElementsByTagName("div");
        for (var i = 0; i < items.length; i++) {
            var item = items[i];
            this.clearImage(item);
            this.clearCheckedIcon(item);
        }
    },
    clear: function() {
        var m = this.getMenu();
        clearNodes(m);
        this._setMinWidth();
        this.hasItems = false;
    },
    destroy: function() {
        this.parentElement = null;
        this.menu.context = null;
        this.menu.onmouseover = null;
        this.menu.onmouseout = null;
        this.menu.onclick = null;
        if (isMSIE)
            this.menu.outerHTML = null;
        this.parentMenu = null;
        this.onshow = null;
        this.onhide = null;
        this.properties = null;
        this.timeout = null;
        this.menu = null;
    },
    display: function(e) {
        if (!this.getParent())
            CustomEvent.fireAll('body_clicked', null);
        menuSort = true;
        this._dullMenu();
        this._toggleMenuItems("not_sortable", this.getProperty('sortable'));
        this._toggleMenuItems("not_filterable", this.getProperty('filterable'));
        this.setFiringObject(this._getElement(e));
        e = this._getRealEvent(e);
        this.opener = this._getOpener(e);
        var menu = this.getMenu();
        if (this.opener.hasAttribute('data-context-menu-label'))
            menu.setAttribute('aria-label', this.opener.getAttribute('data-context-menu-label'));
        if (this._isEmpty(menu))
            return;
        menu.style.left = "0";
        menu.style.top = "0";
        this.parentElement.appendChild(menu);
        this.opener && this.opener.setAttribute("aria-expanded", "true");
        if (this.getProperty("top") > 0 && ((this.getProperty("left") > 0) || (this.getProperty("right") > 0))) {
            menu.style.visibility = 'hidden';
            menu.style.display = 'block';
            this.moveMenuToXY(e, this.getProperty("left"), this.getProperty("top"), this.getProperty("right"));
        } else if (this.getParent()) {
            var x = this._getElement(e);
            menu.style.visibility = 'hidden';
            menu.style.display = 'block';
            this.moveMenuToParent(e, x);
        } else {
            var x = this._getElement(e);
            menu.style.visibility = 'hidden';
            menu.style.display = 'block';
            this.moveMenuToCursor(e);
        }
        gActiveContext = this;
        showObject(menu);
        this._focusFirstItem(menu);
    },
	hide : function(openModal) {
		gActiveContext = "";
		hideObject(this.getMenu());
		if (this.getMenu().parentNode)
			this.getMenu().parentNode.removeChild(this.getMenu());
		this.opener && this.opener.setAttribute("aria-expanded", "false");
		if (this.onhide)
			this.onhide();
		var firingObj = this.getFiringObject();
		if (firingObj) {
if (firingObj.tagName == 'I')
				this._toggleFocusLock(true);
if (!openModal)
				firingObj.focus();
		}
		CustomEvent.fire('refresh.event');
	},
	hideAll : function() {
		var m = this;
		while (m) {
			m.hide(m.parentElement.hasClassName("modal-open"));
			m = m.getParent();
		}
		this.opener && this.opener.setAttribute("aria-expanded", "false");
	},
    isListMenuGroupBy: function (x) {
return x.getAttribute("item_id") === "ab83ca6d0ad337020037c078040600bc";
    },
    isCreateFavorite: function(x) {
return x.getAttribute("item_id").includes('create_favorite');
    },
    isRefresh: function(x) {
return x.getAttribute("item_id").includes("216ac28a0a0a0bb200af43eb879c30ae");
    },
    isShowRecordCount: function() {
return this.id.includes('385356ad0a0a0b7c00b3d75ea03e5eb4');
    },
    isGroupBy: function() {
return this.id.includes('b16a5dbe0a0a0bbb00043b7b284050b6');
    },
    isFilter: function() {
return this.id.includes('b17a69630a0a0bbb00f2601a9fa1e2da');
    },
    isView: function() {
return this.id.includes('b169dd7f0a0a0bbb0062fb97a5ea1e1c');
    },
    _trackRunListActionMetrics(x) {
        var list = window.list;
        if (!list)
            return;
        var options = this._getHardCodedListTitleActions(x);
        if (options) {
            options.path = this._getMenuPathForUxMetrics();
            GlideListUxMetricsUtils.track('Run List Action', list, options);
            return;
        }
        var menuData = this._getTopmostMenuData();
        var topmostMenuOpener = menuData.opener;
        var topmostMenuId = menuData.id;
        options = {
            path: this._getMenuPathForUxMetrics(),
            actionName: x && x.innerText.replace(sanitizeText, '')
        }
        if (topmostMenuId.includes('context_list_row')) {
            var columnIndex = topmostMenuOpener.closest('td').cellIndex;
            options.contextMenuType = 'row';
            options.selectedSysId = topmostMenuOpener.closest('tr').getAttribute('sys_id');
            options.fieldName = list.fieldNames[columnIndex];
        }
        else if (topmostMenuId.includes('context_list_title')) {
            options.contextMenuType = "title"
        }
        else if (topmostMenuId.includes('context_list_header')) {
            var columnHeader = topmostMenuOpener.closest('th');
            options.contextMenuType = 'header';
            options.columnName = columnHeader.getAttribute('glide_label');
            options.fieldName = columnHeader.getAttribute('name');
            options.fieldType = columnHeader.getAttribute('glide_type');
        }
        else {
            return;
        }
        GlideListUxMetricsUtils.track('Run List Action', list, options);
    },
    _getHardCodedListTitleActions(x) {
        if (!x)
            return;
        var actionName, actionData;
        var itemId =  x.getAttribute('item_id');
        if (this.isCreateFavorite(x)) {
            actionName = 'UI16 Create Favorite';
        } else if (this.isRefresh(x)) {
            actionName = 'Refresh List';
        } else if (this.isShowRecordCount()) {
            actionName = 'Show Rows Per Page';
            actionData = {
                numRows: itemId
            };
        } else if (this.isGroupBy()) {
            actionName = 'Select Group By';
            actionData = {
                columnName: itemId
            };
        } else if (this.isFilter()) {
            actionName = 'Select List Filter';
            actionData = {
                filterQuery: itemId
            };
        } else if (this.isView()) {
            actionName = 'Select List View';
            actionData = {
                listViewName: x && x.innerText.replace(sanitizeText, '') || ''
            };
        } else {
            return;
        }
        return {
            actionName,
            actionData
        };
    },
    execute: function(e) {
        var x = this._getElement(e);
        var ariaDisabled = x.getAttribute('aria-disabled');
        if (x.isMenuItem && !x.disabled && (!ariaDisabled || ariaDisabled == 'false')) {
        	if (x.getAttribute("label") == "true") {
                this._getRealEvent(e).cancelBubble = true;
                return;
            }
            this._trackRunListActionMetrics(x);
            if (x.getAttribute("target")) {
              window.open(x.getAttribute("url"), x.getAttribute("target"));
            } else if (x.getAttribute("href")) {
              var expression = x.getAttribute("href");
              gActiveContext = this;
              eval(expression);
            } else if (x.getAttribute("func_set") == "true") {
                x.func();
            } else {
              window.location = x.getAttribute("url");
            }
            if (this.trackSelected) {
                this.clearSelected();
                this.setChecked(x);
            }
            if (this.id === 'context_labelMenu') {
                var options = {
                    name: x && x.innerText.replace(sanitizeText, '') || ''
                };
                GlideUXMetrics && GlideUXMetrics.track('Select Form View', options);
            }
            else if (this._isFormContextMenuEvent(this.id)) {
                this._trackContextMenuSelectUsage(x);
            }
        }
        
        if (x.subMenu)
            x.subMenu.hideAll();
        else
            this.hideAll();
        return false;
    },
    _trackContextMenuSelectUsage: function(x) {
        if (typeof (g_form) !== 'undefined') {
            var options = {
                name: x && x.innerText.replace(sanitizeText, '') || '',
                table: g_form.tableName || '',
                path: this._getMenuPathForUxMetrics()
            };
            GlideUXMetrics && GlideUXMetrics.track('Select Additional Action', options);
        }
    },
    _getMenuPathForUxMetrics: function() {
        return this._getMenuPath(this, []).join(' > ');
    },
    _getMenuPath: function(menuItem, path) {
        var parentMenu = menuItem.getParent();
        if (parentMenu)
            this._getMenuPath(parentMenu, path);
        var selectedMenu = menuItem.menu.getElementsByClassName('context_menu_hover')[0];
        if (selectedMenu)
            path.push(selectedMenu.innerText)
        return path;
    },
    _getTopmostMenuData: function() {
        var parentMenu = this.parentMenu;
        if (!parentMenu)
            return {
                opener: this.opener,
                id: this.id
            };
        while(parentMenu.parentMenu) {
            parentMenu = parentMenu.parentMenu;
        }
        return {
            opener: parentMenu.opener,
            id: parentMenu.id
        };
    },
    _isFormContextMenuEvent: function(id) {
        return id && id.includes('context_') && id !== 'context_personalize_menu' && !id.includes('context_list_');
    },
    menuLowLight: function(e) {
        var x = this._getElement(e);
        this._handleTimeout(false, x, e.relatedTarget);
        if (!x.isMenuItem)
            return;
        if (!x.subMenu || x.subMenu.getMenu().style.display == 'none')
			this._disableItem(x);
        window.status = '';
        CustomEvent.fire('refresh.event');
    },
    menuHighLight: function(e) {
        var x = this._getElement(e);
        this._handleTimeout(true, x);
        if (!x.isMenuItem)
            return;
        this._hideAllSubs(x.parentNode);
        this._enableItem(x);
        if (x.subMenu)
            this._expandSubMenu(x, e);
    },
    _expandSubMenu: function(menu, evt) {
menu.subMenu.setParent(this);
		menu.subMenu.display(evt);
    },
    menuKeyUp: function(e) {
    	var x = this._getElement(e);
        var handled = false;
        switch (e.keyCode) {
case 27:
	            this.hide();
	            handled = true;
	            break;
        }
        if (handled) {
            e.stopPropagation();
            e.preventDefault();
        }
    },
    menuKeyDown: function(e) {
if (e.keyCode !== 9)
            e.preventDefault();
        var x = this._getElement(e);
        var handled = false;
        switch (e.keyCode) {
case 9:
        		this.hideAll();
        		handled = true;
        		break;
case 32:
case 13:
                if (x.subMenu)
                    this._expandSubMenu(x, e);
                else
                    this.execute(e)
				handled = true;
                break;
case 40:
                this._dullMenu();
                this._focusNext(x);
				handled = true;
                break;
case 38:
                this._dullMenu();
				this._focusPrevious(x);
				handled = true;
                break;
case 39:
	            if (x.subMenu)
					this._expandSubMenu(x, e);
	            handled = true;
				break;
case 37:
                var parentMenu = this.getParent();
                if (parentMenu && parentMenu.menu) {
                    var parent = parentMenu.menu.select('[aria-controls="' + this.id + '"]');
                    parent[0].focus();
					this._hideAllSubs(parentMenu.menu);
                }
	            handled = true;
	            break;
        }
        if (handled) {
            e.stopPropagation();
        }
    },
	_isFocusableMenuItem: function(element) {
		return (!(element.classList.contains('context_item_hr'))
                && !(element.classList.contains('context-menu-minwidth'))
                && !(element.style.display == 'none'));
	},
    _focusNext: function(item) {
        var nextSibling = item.nextSibling;
        while (nextSibling && !this._isFocusableMenuItem(nextSibling))
		    nextSibling = nextSibling.nextSibling;
        if (nextSibling)
            nextSibling.focus();
        else {
			var firstItem = item.parentElement.querySelector("div.context_item");
			while (firstItem && !this._isFocusableMenuItem(firstItem))
			    firstItem = firstItem.nextSibling;
			if (firstItem && this._isFocusableMenuItem(firstItem))
			    firstItem.focus();
        }
    },
	_focusPrevious: function(item) {
		var previousSibling = item.previousSibling;
		while (previousSibling && !this._isFocusableMenuItem(previousSibling))
		    previousSibling = previousSibling.previousSibling;
		if (previousSibling)
			previousSibling.focus();
		else {
			var lastItem = item.parentElement.querySelector("div:last-child");
			while (lastItem && !this._isFocusableMenuItem(lastItem))
			    lastItem = lastItem.previousSibling;
			if (lastItem && this._isFocusableMenuItem(lastItem))
			    lastItem.focus();
		}
	},
moveMenuToXY: function(e, left, top, right) {
        var menu = this.getMenu();
        if (right)
            left = right - menu.offsetWidth;
        var offsetTop = window.pageYOffset + top;
        var offsetLeft = window.pageXOffset + left;
        this.moveMenu(top, left, 0, 0, offsetTop, offsetLeft);
    },
    moveMenuToCursor: function(e) {
        var offsetTop = 0;
        var offsetLeft = 0;
        var clientY = e.clientY;
        var clientX = e.clientX;
        if (isTouchDevice) {
            offsetTop = e.pageY;
            offsetLeft = e.pageX;
        } else if (!e.clientX && e.target) {
	        var $target = $j(e.target);
	        var rect = e.target.getBoundingClientRect();
            offsetTop = clientY = rect.top + $target.height();
            offsetLeft = clientX = rect.left + $target.width();
        } else {
			offsetTop = e.clientY;
			offsetLeft = e.clientX;
        }
        this.moveMenu(clientY, clientX, 0, 0, offsetTop, offsetLeft);
    },
	moveMenuToParent : function(e, firingObject) {
		    var parent = this.getParent().getMenu();
            var offsetTop = grabOffsetTop(firingObject) - parent.scrollTop;
            var borderLeftWidth = parseInt($j(this.getParent().getMenu()).css('border-right-width'), 10);
            var offsetLeft = grabOffsetLeft(parent) - borderLeftWidth;
            this.moveMenu(offsetTop, offsetLeft, firingObject.offsetHeight, parent.offsetWidth, offsetTop, offsetLeft);
	},
    moveMenu: function(top, left, height, width, offsetTop, offsetLeft) {
        var menu = this.getMenu();
        menu.style.overflowY = "visible";
        menu.setAttribute('gsft_has_scroll', false);
        if (menu.getAttribute('gsft_width'))
            menu.style.width = menu.getAttribute('gsft_width') + "px";
        if (menu.getAttribute('gsft_height'))
            menu.style.height = menu.getAttribute('gsft_height') + "px";
        var leftPos;
        var viewport = new WindowSize();
        if ((left + width + menu.offsetWidth) > viewport.width) {
            leftPos = offsetLeft - menu.offsetWidth;
        } else if (left < menu.offsetWidth) {
            leftPos = offsetLeft + width;
        } else {
            if(isTextDirectionRTL()) {
                leftPos = offsetLeft - menu.offsetWidth;
            } else {
                leftPos = offsetLeft + width;
            }
        }
        menu.style.left = leftPos + "px";
        var scrollOffsets = this._getScrollOffsets(this.parentElement);
        var scrollTop = scrollOffsets.top;
        var direction = 'down';
        var clip = 0;
        if ((top + menu.offsetHeight) > viewport.height) {
            var bottomClip = menu.offsetHeight - (viewport.height - top);
            var topClip = menu.offsetHeight - top + height;
            if (topClip < bottomClip) {
                direction = 'up';
                clip = topClip;
            } else
                clip = bottomClip;
        }
        var topPos;
        if (direction == 'up') {
            var mHeight = menu.offsetHeight;
            var bottomEdge = offsetTop + height;
            topPos = (bottomEdge > mHeight) ? (bottomEdge - mHeight): 0;
        } else
            topPos = offsetTop;
        var scrollbarWidth = getScrollBarWidthPx();
        if ((topPos - scrollTop + menu.offsetHeight) > viewport.height)
            clip = (topPos - scrollTop + menu.offsetHeight) - viewport.height + scrollbarWidth;
        menu.style.top = topPos + "px";
        if (clip > 0) {
            if (!menu.getAttribute('gsft_width')) {
                menu.setAttribute('gsft_width', menu.offsetWidth);
                menu.setAttribute('gsft_height', menu.offsetHeight);
            }
            menu.setAttribute('gsft_has_scroll', true);
            menu.style.overflowY = "auto";
            var w = menu.offsetWidth + 18;
            menu.style.width = w + "px";
var h = menu.offsetHeight - clip - 4;
            menu.style.height = h + "px";
        }
    },
    _getScrollOffsets: function(e) {
        var offsets = {};
        if (e.nodeName.toUpperCase() == "BODY") {
            offsets.top = window.pageYOffset || document.documentElement.scrollTop  || document.body.scrollTop;
            offsets.left = window.pageXOffset || document.documentElement.scrollLeft  || document.body.scrollLeft;
        } else {
            offsets.top = e.scrollTop;
            offsets.left = e.scrollLeft;
        }
        return offsets;
    },
    getFiringObject: function() {
        return this.eventObject;
    },
    getID: function() {
        return this.id;
    },
    getMenu: function() {
        if (!this.menu) {
            this.menu = contextMenus[this.getID()];
            if (!this.menu)
                this._createMenu();
            this._setMenuAttrs();
            this._setMinWidth();
        }
        return this.menu;
    },
    getParent: function() {
        return this.parentMenu;
    },
    getProperty: function(c) {
    	if (this.properties)
    		return this.properties[c];
    	else
    		return "";
    },
    getTableName: function() {
        return this.tableName;
    },
    setFiringObject: function(e) {
        this.eventObject = e;
    },
    setID: function(id) {
        this.id = id;
    },
    setOnShow: function(onshow) {
        this.onshow = onshow;
    },
    setOnHide: function(oh) {
        this.onhide = oh;
    },
    setBeforeHide: function(beforeHide) {
        this.beforehide = beforeHide;
    },
    setParent: function(m) {
        this.parentMenu = m;
        this.parentElement = m.parentElement;
    },
    setProperty: function(c, v) {
        this.properties[c] = v;
    },
    setTableName: function(name) {
        this.tableName = name;
    },
    setTimeout: function(t) {
        this.timeout = t;
    },
    setTrackSelected: function(flag) {
        this.trackSelected = flag;
    },
    _createMenu : function() {
        this.menu = document.createElement("div");
        this.menu.name = this.menu.id = this.getID();
        contextMenus[this.getID()] = this.menu;
    },
    _disableItem: function(item) {
    	var ariaDisabled = item.getAttribute('aria-disabled');
        if (item && !item.disabled && (!ariaDisabled || ariaDisabled == 'false')) {
            removeClassName(item, "context_menu_hover");
        }
        if (item && item.subMenu)
		item.setAttribute("aria-expanded", "false");
    },
    _dullMenu: function() {
        var items = this.getMenu().childNodes;
        for(var i = 0; i < items.length; i++) {
            var item = items[i];
            this._disableItem(item);
        }
    },
    _enableItem: function(item) {
    	var ariaDisabled = item.getAttribute('aria-disabled');
        if (item && !item.disabled && (!ariaDisabled || ariaDisabled == 'false')) {
            addClassName(item, "context_menu_hover");
            item.focus();
        }
		if (item && item.subMenu) {
			item.setAttribute("role", "menuitem");
			item.setAttribute("aria-expanded", "true");
		}
    },
    _getElement: function(e) {
        var x = e.target;
        try {
	        if (!x.isMenuItem && x.parentNode.isMenuItem)
	            x = x.parentNode;
        } catch (err) {}
        return x;
    },
    _getOpener: function(e) {
		var targetEl = this._getElement(e);
		var opener = $j(targetEl).closest("a.list_action");
		return opener[0] || targetEl;
	},
    _getRealEvent: function(e) {
        return e;
    },
    _handleTimeout: function(lght, firingObject, movingTo) {
        if (this.getProperty("timeout") > 0) {
            if (lght) {
                clearTimeout(this.timeout);
            } else {
                if (gActiveContext && gActiveContext.menu.contains(movingTo))
                    return;
                if (!firingObject.subMenu || firingObject.subMenu != gActiveContext)
                    this.timeout = setTimeout('contextHide()', this.getProperty("timeout"));
            }
        }
    },
    _hideAllSubs : function(el) {
      var list = el.getElementsByTagName("div");
      for (var i = 0; i < list.length; i++) {
            var element = list[i];
            if (element.subMenu) {
                var subMenu = element.subMenu.getMenu();
                this._hideAllSubs(element.subMenu.getMenu());
                hideObject(subMenu);
                this._disableItem(element);
            }
      }
    },
    _setMenuAttrs : function() {
        this.menu.context = this;
        this.menu.className = "context_menu";
        this.menu.style.display = "none";
        this.menu.style.zIndex = (this.getParent() ? GwtContextMenu.zIndex+1 : GwtContextMenu.zIndex);
        this.menu.setAttribute('role', 'menu');
        this.menu.onmouseover = this.menuHighLight.bind(this);
        this.menu.onmouseout = this.menuLowLight.bind(this);
        this.menu.onkeyup = this.menuKeyUp.bind(this);
        this.menu.onkeydown = this.menuKeyDown.bind(this);
        if ("ontouchstart" in window  && (typeof FastButton != 'undefined'))
        	new FastButton(this.menu, this.execute.bind(this));
        else
        	this.menu.onclick = this.execute.bind(this);
    },
    _setMinWidth: function() {
        var widther = document.createElement("div");
        widther.style.width = "120px";
        widther.style.height = "1px";
        widther.style.overflow = "hidden";
        widther.className = 'context-menu-minwidth';
        this.menu.appendChild(widther);
    },
    _toggleMenuItems: function(attr, enabled) {
        var items = this.getMenu().childNodes;
        for(var i = 0; i < items.length; i++) {
            var item = items[i];
            if (item.getAttribute(attr) == "true") {
                if (enabled) {
                    this._undullItem(item);
                } else {
                    this._dullItem(item);
                }
            }
        }
    },
    _dullItem: function(item) {
    	item.setAttribute('aria-disabled', true);
        addClassName(item, "is-disabled");
        removeClassName(item, "context_menu_hover");
    },
    _undullItem: function(item) {
    	item.setAttribute('aria-disabled', false);
        removeClassName(item, "is-disabled");
    },
    _hideItem: function(item) {
        item.style.display = 'none';
    },
    _showItem: function(item) {
        item.style.display = '';
    },
    _isEmpty: function(menu) {
        if (!menu)
            return true;
        if (!menu.firstChild)
            return true;
        return false;
    },
    _updateURL: function(d, label, url) {
		if(typeof GlideTransactionScope != 'undefined') {
			GlideTransactionScope.appendTransactionScope(function(name, value) {
				url += "&" + name + "=" + value;
			});
			return url;
		}
		if(typeof g_form != 'undefined') {
			this.dmap = this.dmap || {};
			this.dmap[label] = d;
			$(g_form.getFormElement()).observe('glidescope:initialized', function(e) {
				e.memo.gts.appendTransactionScope(function(name, value) {
					var _d = this.dmap[label];
					var _url = _d.getAttribute("url");
					_url += "&" + name + "=" + value;
					_d.setAttribute("url", _url);
				}.bind(this));
			}.bind(this));
		}
		return url;
    },
    _focusFirstItem: function(menu) {
        var contextItems = $(menu).select('.context_item');
        var firstItem = contextItems.shift();
        while (firstItem.style.display == 'none' && contextItems.length > 0)
            firstItem = contextItems.shift();
	    if (firstItem) {
	    	this._toggleFocusLock(false);
	    	firstItem.focus();
	    }
    },
    z: function() {
    },
    _toggleFocusLock: function(focusLockOn) {
    	var focusLockedElem = $j('#show_list');
    	if (!focusLockedElem[0])
    		return;
    	if (focusLockOn)
    		focusLockedElem.attr('tabindex', -1);
    	else
    		focusLockedElem.removeAttr('tabindex');
    }
});
GwtContextMenu.zIndex = 1100;
function displayContextMenu(e, name, filterable) {
	if (!getMenuByName(name))
		return;
	var contextMenu = getMenuByName(name).context;
	contextMenu.setProperty('sortable', true);
	contextMenu.setProperty('filterable', filterable);
	contextMenu.display(e);
}
function contextShow(e, tableName, timeoutValue, ttop, lleft, rright) {
	var frameWindow = null;
	try {
		frameWindow = window.frameElement;
		if (frameWindow && frameWindow.id == "dialog_frame" && frameWindow.noContext == true)
			return true;
	} catch(err) { }
    if (shouldSkipContextMenu(e))
        return true;
    e = getRealEvent(e);
    menuTable = tableName;
    var name = tableName;
    if (name && name.substring(0, 8) != "context_")
        name = "context_" + name;
    if (document.readyState && document.readyState != "complete" && document.readyState != "interactive" && typeof window.g_hasCompleted == "undefined") {
        jslog("Ignored context menu show for " + name + " because document was not ready");
        return false;
    }
window.g_hasCompleted = true;
    if (getMenuByName(name)) {
        var contextMenu = getMenuByName(name).context;
        contextMenu.setProperty('timeout', timeoutValue);
        contextMenu.setProperty('top', ttop);
        contextMenu.setProperty('left', lleft);
        contextMenu.setProperty('right', rright);
        if (contextMenu.menu.style.display == "block")
            contextMenu.menu.style.display = "none";
        else
            contextMenu.display(e);
        if (contextMenu.onshow)
            contextMenu.onshow();
        if (contextMenu.id === 'context_labelMenu') {
            if (typeof (g_form) !== 'undefined') {
                var options = {
                    table: g_form.tableName || '',
                    name: g_form.getViewName() || '',
                }
                GlideUXMetrics && GlideUXMetrics.track('Click Form View', options);
            }
        }
    }
    var metricEventActionsMap = {
        'contextmenu': 'Right Click',
        'click': 'Open Menu'
    };
    if (contextMenu.id === 'context_1') {
        var options = {
            action: metricEventActionsMap[e.type],
            table: g_form.tableName || ''
        }
        GlideUXMetrics && GlideUXMetrics.track('Open Form Context Menu', options);
    }
    return false;
}
function contextQuestionLabel(e, sys_id, type) {
    if (shouldSkipContextMenu(e))
        return true;
    e = getRealEvent(e);
    var name = "context_question_label";
    menuTable = "not_important";
    menuField = "not_important";
    rowSysId = sys_id;
    addQuestionActionItems(rowSysId, type);
	if (getMenuByName(name)) {
		var contextMenu = getMenuByName(name).context;
		contextMenu.setProperty('sysparm_sys_id', sys_id);
		contextMenu.display(e);
	}
    return false;
}
function addQuestionActionItems(id, type) {
	var jr = new GlideAjax("AJAXJellyRunner", "AJAXJellyRunner.do");
	jr.addParam('template', 'variable_context.xml');
	jr.addParam('sysparm_catalog_id', g_form.getUniqueValue());
	jr.addParam('sysparm_variable_id', id);
	jr.addParam('sysparm_variable_type', type);
	jr.addParam('sysparm_contextual_security', g_form.hasAttribute('contextual_security'));
	jr.setWantRequestObject(true);
	var response = jr.getXMLWait();
	if (!response)
		return;
	var html = response.responseText;
	html.evalScripts(true);
	return gcm;
}
function shouldSkipContextMenu(e) {
	if (e.ctrlKey && trustCtrlKeyResponse())
		return true;
	return false;
}
function trustCtrlKeyResponse() {
	return isMacintosh || !isSafari;
}
function contextTimeout(e, tableName, waitCount) {
	var name = "context_" + tableName;
	if (!getMenuByName(name))
		return;
	var contextMenu = getMenuByName(name).context;
	if (typeof waitCount == "undefined")
		waitCount = 500;
	contextMenu.setProperty("timeout", waitCount);
	var hideParam;
	if (contextMenu.hideOnlySelf == true)
		hideParam = '"' + name + '"';
	contextMenu.setTimeout(setTimeout('contextHide(' + hideParam + ')', waitCount));
}
function getMenuByName(name) {
	return contextMenus[name];
}
function getRowID(e) {
	var id = null;
	var cell = e.srcElement;
	if (cell == null)
		cell = e.target;
	var row = cell.parentNode;
	var id = row.id;
	if (id == null || id.length == 0)
		id = row.parentNode.id;
	return id;
}
function contextHide(name) {
	if (!gActiveContext)
		return;
	if (typeof name != "undefined" && gActiveContext.getID() != name)
			return;
	if (gActiveContext.beforehide) {
		if (gActiveContext.beforehide() == false)
			return;
	}
	gActiveContext.hideAll();
}
function elementAction(e, event, gcm) {
	var type = e.getAttribute("type");
	var choice = e.getAttribute("choice");
	var id = e.id;
	var fName = id.substring(id.indexOf('.') + 1);
	var tableName = fName.substring(0, fName.indexOf('.'));
	var haveAccess = $("personalizer_" + tableName);
	if (typeof (g_user) != 'undefined') {
		var count = 1;
		if (!gcm)
			gcm = addActionItems(fName, tableName, type, choice);
		if (gcm)
			return contextShow(event, gcm.getID(), -1, 0, 0);
	}
	return true;
}
function addActionItems(id, table, type, choice) {
	var jr = new GlideAjax("AJAXJellyRunner", "AJAXJellyRunner.do");
	jr.addParam('template', 'element_context.xml');
	jr.addParam('sysparm_id', id);
	jr.addParam('sysparm_table', table);
	jr.addParam('sysparm_type', type);
	jr.addParam('sysparm_choice', choice);
	jr.addParam('sysparm_contextual_security', g_form.hasAttribute('contextual_security'));
	jr.setWantRequestObject(true);
	var response = jr.getXMLWait();
	if (!response)
		return;
	var html = response.responseText;
	html.evalScripts(true);
	return gcm;
}
Event.observe(window, 'unload', clearMenus, false);
Event.observe(window, 'scroll', debounceContextScroll(100));
function debounceContextScroll(ms) {
    var timeout;
    return function () {
        if (timeout)
            clearTimeout(timeout);
        timeout = setTimeout(function () {
            contextMenuHide();
            timeout = null;
        }, ms);
    }
}
function clearMenus() {
	for (av in contextMenus) {
		if (contextMenus[av]) {
			var c = contextMenus[av].context;
			if (c) {
				c.destroy();
			}
			contextMenus[av] = null;
		}
	}
	for ( var keys in shortcuts) {
		if (shortcuts[keys])
			shortcuts[keys].clear();
	}
	shortcuts = null;
}
;
/*! RESOURCE: /scripts/doctype/functions.js */
function isDoctype() {
	return true;
}
function isPolarisWrapper() {
	return top.NOW && top.NOW.isPolarisWrapper === "true";
}
function isPolaris() {
	return window.NOW && window.NOW.isPolarisEnabled === "true" && isPolarisWrapper();
}
function isPolarisTemplate() {
	return window.NOW && window.NOW.polaris_page_info && window.NOW.polaris_page_info.canUsePolarisTemplates === true;
}
function gsftSubmitBack() {
	var backButton = document.getElementById('sysverb_back');
	checkDirtyForm(function save() {
		if (isDirtyFormAutosave())
			gsftSubmit(backButton);
		else
			gsftSubmit(null, $j(backButton).closest('form')[0], 'sysverb_check_save');
	}, function discard() {
		gsftSubmit(backButton);
	});
}
function gsftSubmitOnExternalClick(e, tableName) {
	if (!e.target || !e.target.href)
		return false;
	
	if (e.metaKey || e.ctrlKey)
		return true;
	
	var url = e.target.href;
	if (g_form && g_form.modified) {
		e.preventDefault();
		if (window.g_form_dirty_support) {
			if (window.g_form_dirty_autosave)			
				saveAndRedirect(tableName, url);			
			else {	
				renderSaveChangesDialog(function save() {	
					saveAndRedirect(tableName, url);	
				}, function discard() {	
					g_navigation.open(url);	
				});	
			}	
		} else
			g_navigation.open(url);
	}
	return true;
}
function encodeFormDataValue(str) {
return encodeURIComponent(str).replace(/[!'()~]/g, function (c) {
		return '%' + c.charCodeAt(0).toString(16).toUpperCase();
	})
.replace(/%20/g, '+')
.replace(/%0A/g, '%0D%0A');
}
function isFormDataBig(form) {
var formDataSizeLimit = 2 * 1024 * 1024;
	var postFormDataSize = 0;
	var bigFormData = false;
	for (var i = 0, iMax = form.elements.length; i < iMax; i += 1) {
		var element = form.elements.item(i);
		var tagName = element.tagName;
		var name = element.name || '';
		if (tagName !== 'INPUT' && tagName !== 'TEXTAREA' && tagName !== 'SELECT')
			continue;
		if (name === '' || element.disabled)
			continue;
		if (tagName === 'SELECT' && (element.selectedIndex === -1
			|| (element.options.length && element.options[element.selectedIndex].disabled)))
			continue;
		if (tagName === 'INPUT' && element.type === 'checkbox' && !element.checked)
			continue;
		var value = encodeFormDataValue(element.value);
		postFormDataSize += (name + '=' + value + '&').length;
		if (postFormDataSize >= formDataSizeLimit) {
			bigFormData = true;
			break;
		}
	}
	return bigFormData;
}
function gsftSubmit(control,  form,  action_name) {
	var f;
	if (typeof form == "undefined") {
		f = findParentByTag(control, 'form');
		if (typeof form == "undefined") {
var sectionFormId = $("section_form_id");
			if (sectionFormId)
				f = $(sectionFormId.value);
		}
	} else 
		f = form;
	if (g_submitted)
		return false;
	if (typeof action_name == "undefined" && control)
		action_name = control.hasAttribute('data-action-name') ? control.getAttribute('data-action-name') : control.id;
	if (action_name == 'sysverb_delete') {
		if  (!confirm(getMessage("Delete this record") + "?")) {
			g_submitted = false;
			return false;
		}
	}
	f.sys_action.value=action_name;
	
	if (typeof f.onsubmit == "function" && action_name != 'sysverb_back') {
		var rc = f.onsubmit();
		if (rc === false) {
			g_submitted = g_form.submitted = false;
			return false;
		}
		top.NOW.magellan && top.NOW.magellan.setNavigatingState && top.NOW.magellan.setNavigatingState(true);
	}
	if (control && control.getAttribute('gsft_id')) {
		action_name = control.getAttribute('gsft_id');
		f.sys_action.value=action_name;
	}	
	if (action_name == 'sysverb_back') 
		g_submitted = false;  
	else
		g_submitted = true;
	
	if (typeof g_form != 'undefined' && g_form && g_submitted) {
g_form.enableUIPolicyFields();
	}
	CustomEvent.fireTop("glide:form_submitted");
	try {
		GlideAjax.disableSessionMessages();
		if (isFormDataBig(f)) {
			var appendChar = (f.action.indexOf('?') === -1) ? '?' : '&';
			f.action += appendChar + 'useMultipartAwareServlet=true';
f.enctype = 'multipart/form-data';
		}
		f.submit();
	} catch (ex) {
		GlideAjax.enableSessionMessages();
		if (ex.message.indexOf('Unspecified') == -1)
			throw ex;
	}
	return false;
}
function setCheckBox(box) {
  var name = box.name;
  var id = name.substring(3);
  var frm = box.form;
  if (frm)
  	frm[id].value = box.checked;
  else {
  	var widget = $(id);
  	if (widget)
  		widget.value = box.checked;
  }
  if (box['onchange'])
  	box.onchange();
}
function populateParmQuery(form, prefix, defaultNULL, action) {
  var keys = ['No records selected', 'Delete the selected item?', 'Delete these', 'items?'];
  var msgs = getMessages(keys);
  var keyset = getChecked(form);
  
  if (!action)
  	action = form.sys_action.value;
  if (action.indexOf("sysverb") != 0) {
	  if (keyset == '') {
	  	if (!alert(msgs["No records selected"])) 
	  		return false;
	  } else {
	  	if (action == "delete_checked") {
	  		var items = keyset.split(",");
	  		if (items.length == 1) {
	  			if (!confirm(msgs["Delete the selected item?"])) 
	  				return false;
	  			
	  		} else if (items.length > 0) {
	  			if (!confirm(msgs["Delete these"] + " " + items.length + " " + msgs["items?"])) 
	  				return false;
	  		}
	  	}
	  }
  } else if (form.sys_action.value == "sysverb_new") {
  	addInput(form, 'HIDDEN', 'sys_id', '-1');
  }
	  
  if (keyset == '' && defaultNULL)
  	keyset = defaultNULL;
  	
  if (prefix)
  	keyset = prefix + keyset;
  addInput(form, 'HIDDEN', 'sysparm_checked_items', keyset);
  return true;
}
function getChecked(form) {
  var keyset = '';
  var lookup = form;
  
  for (i = 0; i < lookup.elements.length; i++) {
	if ( lookup.elements[i].type != "checkbox") 
		continue;
	var v = lookup.elements[i];
	if (v.checked) {
   		var id = v.id.substring(3);
   		var skip = v.name.substring(0,4);
   		if (skip == "SKIP")
   		  continue;
   		
   		if (id == "all")
   			continue;
   		
   		if (keyset == '')
      		keyset = id;
   		else 
      		keyset = keyset + ',' + id;
	}
  } 
  return keyset;
}
function iterateList(e, row, value, update) {
	update = (typeof update === 'undefined') ? true : update;
	if (update)
		g_form.setMandatoryOnlyIfModified(true);
	var form = g_form.getFormElement();
	form.sys_action.value = value;
	var query = e.getAttribute("query");
	addInput(form, 'HIDDEN', 'sys_record_row', row);
	addInput(form, 'HIDDEN', 'sys_record_list', query);
	addInput(form, 'HIDDEN', 'sysparm_exclude_tiny_parms', ['sys_id','sysparm_record_row'].join());
	if (update && typeof form.onsubmit == "function") {
		var rc = form.onsubmit();
		if (!rc) {
			g_submitted = false;
			return false;
		}
	}
	try {
		form.submit();
	} catch (ex) {
		if (ex.message.indexOf('Unspecified') == -1)
			throw ex;
	}
	return false;
}
function refreshNav() {
	CustomEvent.fireTop('navigator.refresh');
}
function checkSave(tableName, urlBase, idField, refKey, viewOverride) {
	var sysid = document.getElementsByName(idField)[0].value;
	checkSaveID(tableName, urlBase, sysid, refKey, viewOverride);
}
function checkSaveID(tableName, urlBase, sysid, refKey, viewOverride) {
	sysid = trim(sysid);
	var url = urlBase+"?sys_id="+sysid;
	if (refKey)
		url += "&sysparm_refkey=" + refKey;
	if (viewOverride) {
		url += "&sysparm_view=" + viewOverride;
	} else {
	var view = $('sysparm_view');
    if (view != null) {
		view = view.value;
		if (view != '')
			url += "&sysparm_view=" + view;
	}
	}
	var nameOfStack = $('sysparm_nameofstack');
	if (nameOfStack != null) {
		nameOfStack = nameOfStack.value;
		if (nameOfStack != '')
			url += "&sysparm_nameofstack=" + nameOfStack;
	}
	if(typeof GlideTransactionScope != 'undefined') {
		GlideTransactionScope.appendTransactionScope(function(name, value) {
			url += "&" + name + "=" + value;
		});
	}
	return checkSaveURL(tableName, url);
}
function isDirtyFormAutosave() {
	return !window.g_form_dirty_support || window.g_form_dirty_autosave || !window.g_form || !g_form.modified;
}
function checkDirtyForm(successCallback, discardCallback) {
	if (isDirtyFormAutosave()) {
		successCallback();
		return;
	}
	
	renderSaveChangesDialog(successCallback, discardCallback);
}
function renderSaveChangesDialog(saveCallback, discardCallback) {
	
	if (isMSIE11) {
		if (confirm(getMessage("Changes have been made, continuing will discard the changes. Click 'OK' to discard changes."))) {
			g_form.modified = false;
			discardCallback();
		} else {
			saveCallback();
		}
		return;
	}
	
	var gm = new GlideModal('dirty_form_modal_confirmation');
	gm.setPreference('focusTrap', true);
	gm.setPreference('autoFocus', false);
	gm.setSize(200);
	gm.setTitle(getMessage('Save changes'));
	var content = $j(new XMLTemplate('dirty_form_modal').evaluate({displayValue: g_form.getDisplayValue()}));
	content.on('click', 'button', function(evt) {
		var button = evt.target;
		if (button.getAttribute('data-action') == 'discard') {
			g_form.modified = false;
			discardCallback();
		} else if (button.getAttribute('data-action') == 'save') {
button.disabled = true;
			saveCallback();
		}
	});
	window.nowapi.g_popup_manager && window.nowapi.g_popup_manager.destroypopDiv();
	gm.on('bodyrendered', function() {
		setTimeout(function() {
			gel("dirty_form_modal_confirmation_closemodal").focus();
		},0);
	});
	gm.renderWithContent(content);
}
function checkSaveURL(tableName, url) {
	checkDirtyForm(function save() {
		saveAndRedirect(tableName, url);
	}, function discard() {
		g_navigation.open(url);
	});
}
function saveAndRedirect(tableName, url) {
	if (g_submitted)
		return false;
	var f = document.getElementById(tableName + ".do");
	if (g_form.getTableName() == tableName) {
		var fs = document.forms;
		for (var z=0; z < fs.length; z++) {
			if (typeof fs[z].sys_uniqueValue != 'undefined') {
				f = fs[z];
				break;
			}
		}
	}
	
	if (!g_form.isNewRecord())
	   g_form.setMandatoryOnlyIfModified(true);
	
	f.sys_action.value = 'sysverb_check_save';
	addInput(f, 'HIDDEN', 'sysparm_goto_url', url);
    if (typeof f.onsubmit == "function") {
      var rc = f.onsubmit();
      if (!rc) {
	  	g_submitted = false;
	  	return false;
	  }
    } 
    
    g_submitted = true;
	if (typeof g_form != 'undefined' && g_form)
g_form.enableUIPolicyFields();
	f.submit();
	return false;
}
function submitTextSearch(event, tableName) {
	if (event != true && event.keyCode != 13)
		return;
	var form = getControlForm(tableName);
	addHidden(form, 'sysverb_textsearch', form['sys_searchtext'].value);
	addHidden(form, 'sysparm_query', '');
	addHidden(form, 'sysparm_referring_url', '');
	form.submit();
}
function getControlForm(name) {
	var form = document.forms[name + '_control'];
if (isSafari || isChrome) {
		if (form) {
			var collectionType = form.toString();
			if (collectionType != "[object HTMLFormElement]")
				form = form[0];
		}
	}
	return form;
}
function getFormForList(listId) {
	return $(listId + "_control");
}
function getFormForElement(element) {
	var f = element.form;
	if (f)
		return f;
		
	return findParentByTag(element, "form");
}
function hideReveal(sectionName, imagePrefix, snap) {
	var el = $(sectionName);
	if (!el)
		return;
	var $s = $j('#section-' + sectionName);
	if ($s.length == 0)
		return _hideRevealDirect(sectionName, imagePrefix, snap);
	var $b = $j(".section-content", $s);
	
	if (!isPolarisTemplate()) {
		if ($s.hasClass("state-closed"))
	 		$b.show("medium");
		else
	 		$b.hide("medium");
	}
	$s.toggleClass('state-closed');
	$j('[data-aria-label-toggle]', $s).each(function(){
		var ariaLabel = $j(this).attr('aria-label');
		var ariaLabelToggle = $j(this).data('aria-label-toggle');
		$j(this).attr('aria-label', ariaLabelToggle);
		$j(this).data('aria-label-toggle', ariaLabel);
		var ariaExpanded = $j(this).attr('aria-expanded')
		$j(this).attr('aria-expanded',ariaExpanded === 'false' );
	});
	setPreference("collapse.section." + sectionName, $s.hasClass('state-closed') ? "true" : "false");
}
function _hideRevealDirect(sectionName, imagePrefix, snap) {
	var el = $(sectionName);
	if (!el)
		return;
	var img = $("img." + sectionName);
	var imageName = "section";
	if (imagePrefix)
		imageName = imagePrefix;
	if (el.style.display == "block") {
		hide(el);
		if (img) {
img.src = "images/"+imageName+"_hide.gifx";
img.alt = getMessage("Display / Hide");
		}
	} else {
		show(el);
		if (img) {
img.src = "images/"+imageName+"_reveal.gifx";
img.alt = getMessage("Display / Hide");
		}
	}
}
function hideRevealWithTitle(name, hideMsg, showMsg) {
	var el = $(name);
	if (!el)
		return;
	var img = $("img." + name);
	if (el.style.display == "block"){
		el.style.display = "none";
img.src = "images/section_hide.gifx"
		img.title = showMsg;
		img.alt = showMsg;
	} else {
		el.style.display = "block";
img.src = "images/section_reveal.gifx"
		img.title = hideMsg;
		img.alt = hideMsg;
	}
}
function toggleDisplaySetPreference(img, hideMsg, showMsg) {
	if (!img || !img.id)
		return;
	var id = img.id.substring(4);
	if (!id)
		return;
	var root = img.parentElement;
	while (root && root.id !== 'element.' + id) {
		root = root.parentElement;
	}
	if (!root)
		return;
	var el = root.querySelector('[id="' + id + '"]');
	if (!el)
		return;
	var msg = showMsg;
	if (el.style.display === 'none') {
		el.style.display = 'block';
img.src = 'images/section_reveal.gifx';
		msg = hideMsg;
	}
	else {
		el.style.display = 'none';
img.src = 'images/section_hide.gifx';
	}
	img.title = msg;
	img.alt = msg;
	if (img.hasAttribute('data-original-title'))
		img.setAttribute("data-original-title", msg);
	setPreference('collapse.' + id, el.style.display == 'none', null);
}
function forceHideWithTitle(name, msg) {
	var el = $(name);
	if (!el)
		return;
	var img = $("img." + name);
	el.style.display = "none";
img.src = "images/section_hide.gifx"
	img.title = msg;
	img.alt = msg;
}
function forceHide(sectionName){
	var el = $(sectionName);
	if (!el)
		return;
	var img = $("img." + sectionName);
	el.style.display = "none";
img.src = "images/section_hide.gifx";
	img.alt = getMessage("Collapse");
}
function forceReveal(sectionName, sectionNameStarts, tagName){	
    var els = $$(tagName);	
	if (els) {
		for(var c=0;c<els.length;++c) {
			if ( els[c].id.indexOf(sectionNameStarts) == 0 ) {			    
				forceHide(els[c].id);
		    }
		}
	}
	
	var el = $(sectionName);
	if (!el)
		return;
	var img = $("img." + sectionName);
	el.style.display = "block";
img.src = "images/section_reveal.gif";
	img.alt = getMessage("Expand");
	window.location = '#' + sectionName;
}
function insertAtCursor(textField, value) {
	if (document.selection) {
		textField.focus();
		sel = document.selection.createRange();
		sel.text = value;
	} else if (textField.selectionStart || textField.selectionStart == 0) {
		var startPos = textField.selectionStart;
		var endPos = textField.selectionEnd;
	
		textField.value = textField.value.substring(0, startPos) + value +
			textField.value.substring(endPos, textField.value.length);
	} else {
		textField.value += value;
	}
}
function insertScriptVar(textBoxName, selectBoxName) {
var textBox = $(textBoxName);
  var select = $(selectBoxName);
  var options = select.options;
  
  for (var i = 0; i != select.length; i++) {
    var option = options[i];
    if (!option.selected) 
      continue; 
   
    var label = option.text; 
    var v = option.value.split('.');
    v = 'current.' + v[1];
	insertAtCursor(textBox, v);
  }
}
function fieldTyped(me) {
	formChangeKeepAlive();
}
function setPreference(name, value, func) {
	var u = getActiveUser();
	if (u)
		u.setPreference(name, value);
	
	var url = new GlideAjax("UserPreference");
	url.addParam("sysparm_type", "set");
	url.addParam("sysparm_name", name);
	url.addParam("sysparm_value", value);
  	url.getXML(func);
}
function deletePreference(name) {
	var u = getActiveUser();
	if (u)
		u.deletePreference(name);
		
	var url = new GlideAjax("UserPreference");
	url.addParam("sysparm_type", "delete");
	url.addParam("sysparm_name", name);
  	url.getXML(doNothing);
}
function getPreference(name) {
	var u = getActiveUser();
	if (u) {
		var opinion =  u.getPreference(name);
		if (typeof opinion != 'undefined')
			return opinion;
	}
	console.warn("Preference " + name + " not found in the active user cache. Making a blocking AJAX call to load it. Consider pre-loading this property in glide_user.")
	var url = new GlideAjax("UserPreference");
	url.addParam("sysparm_type", "get");
	url.addParam("sysparm_name", name);
	var xml = url.getXMLWait();
	if (!xml)
		return '';
		
   	var items = xml.getElementsByTagName("item");
	for (var i = 0; i < items.length; i++) {
		var item = items[i];
		var value = item.getAttribute("value");
		if (u)
			u.setPreference(name, value);
		return value;
	}
	return '';
}
function getActiveUser() {
	return getTopWindow().g_active_user || window.g_user;
}
function labelClicked(label, elementType) {
	var hFor = label.htmlFor;
	if (hFor) {
		var elpaco = $("sys_display." + hFor);
		if (!elpaco || elpaco.type == "hidden") 
			elpaco = $(hFor);
		
if (elpaco === null) {
			var temp = hFor.split(".").slice(2).join(".");
			elpaco = $(temp+'_label');
		}
		
		if (elpaco && elpaco.type != "hidden" && elpaco.style.visibility != "hidden") {
			if (elpaco.disabled != true) {
				if (elementType == "html" || elementType == "translated_html") {
					var handler = g_form.elementHandlers[hFor];
					if (handler && handler.focusEditor) {
handler.focusEditor();
					}
				} else {
					elpaco.focus();
				}
			}
		}
	}
	
	return false;
}
function insertFieldName(textBoxName, label) {
var textBox = $(textBoxName);
	var index = label.indexOf(":");
	if (index > -1)
		insertAtCursor(textBox, "\n" + label);
	else
		insertAtCursor(textBox, label);
	
	var form = textBox.up('form');
	if (form) {
		var onChangeData = {id : textBox.id, value : textBox.value, modified : true};
		form.fire('glideform:onchange', onChangeData);
	}
}
function replaceRegEx(text, doc, tableName) {
  var s = "";
  var re = new RegExp("%\\{\\w+[\\}]");
  var m = re.exec(text);
  if (m != null) {  
    for (i = 0; i < m.length; i++) {
      s = s + m[i];
    }
  }
  
  if (tableName.indexOf('.') > 0)
  	tableName = tableName.split('.')[0];
  
  if (s.length > 0) {
	  var field = s.substring(2, s.length - 1);
	  var obj = doc.getElementById("sys_display." + tableName + "." +  field);
	  var val = "?";
	  if (obj != null)
		  val = obj.value;
		  
	  if (val.length == 0) {
var labelText = "?";
		  var labels = doc.getElementsByTagName("label");
		  for(i = 0; i < labels.length; i++){
		  	if (labels[i].htmlFor == tableName + "." + field) {
		  		labelText = labels[i].innerHTML;
		  		break;
		  	}
		  }
		  if (labelText.indexOf(':') > 0)
		  	labelText = labelText.split(':')[0];
		  		  
		  val = labelText;
	  }
	  re = new RegExp("%\\{" + field + "[\\}]", "g");	  
	  var result = text.replace(re, val);
	  if (result.indexOf("%{") > 0)
	  	result = replaceRegEx(result, doc, tableName);
	  
	  return result;
  }
  
  		return text;
}
function toggleInline(name) {
	_toggleDisplay(name, 'inline');
}
function _toggleDisplay(name, displayType) {
	var e = $(name);
	if (e.style.display == 'none' ) {
		e.style.display = displayType;
		setPreference(name, displayType, null);
	} else {
		e.style.display = 'none';
		setPreference(name, 'none', null);
	}	
}
function textareaResizer(id, change) {
  objectResizer(id, change, 'rows');
}
function textareaSizer(id, rows) {
	var element = $(id);
	if (element)
		setAttributeValue(element, 'rows', rows);
}
function selectResizer(id, change) {
  objectResizer(id, change, 'size');
}
function objectResizer(id, change) {
	var tinymceEditor = getTinyEditor(id);
	if (tinymceEditor) {
		resizeTinymce(tinymceEditor, change, true);
	} else {
		var element = $(id);
		if (!element)
			return;
	
		var value = parseInt($j(element).css("height"), 10);
	
		value += change;
		if (value < 1)
		  value = 1;
		if (element.tagName == 'INPUT') {
			element = $("div."+id);
			if (element) {
				if (change > 0) {
					  element.show();
				} else {
					element.hide();
				   value = 1;
				}
			}
		} else {
			var oldRows = element.rows;
				element.style.height = value + 'px';
				handleMaxMinHeights(element, value);
				resizeTextAreaIframe(true, id, value);
		}
		setPreference('textarea_height.' + id, value);
		_frameChanged();
	}
}
function isTinyMCEIncluded() {
	return !!(typeof tinymce !== 'undefined' && tinymce !== undefined && tinymce !== null && tinymce);
}
function getTinyEditor(id) {
	return isTinyMCEIncluded() ? tinymce.get(id) : null;
}
function resizeTinymce(editor, value, isDelta, force) {
	if (editor) {
		var isV5editor = tinymce.majorVersion === '5';
		var isV6editor = tinymce.majorVersion === '6';
		if (isDelta) {
			(isV5editor || isV6editor)
				? editor.theme.ui.resizeBy({ left: 0, top: value }) 
				: editor.theme.resizeBy(0, value);
		} else if (!force) {
			if (isV5editor|| isV6editor) {
				var container = $j(editor.getContainer());
				var currentHeight = parseInt(container.css('height'), 10) || container.height();
				editor.theme.ui.resizeBy({ left: 0, top: value - currentHeight });
			} else
				editor.theme.resizeTo(null, value);
		} else {
			var container = (isV5editor|| isV6editor) ? editor.getContainer() : editor.getContentAreaContainer().querySelector('iframe');
			$j(container).height(value);
		}
	}
}
function handleMaxMinHeights(element, height){
	if (!element || !height)
		return;
	var $element = $(element),
		maxHeight = parseInt($element.getStyle('maxHeight'), 10),
		minHeight = parseInt($element.getStyle('minHeight'), 10),
		id = getAttributeValue($element, 'id');
	if ( height >= maxHeight ){
		if ( $('sizer_plus_' + id) )
		$('sizer_plus_' + id).addClassName('disabled');
		$('sizer_plus_' + id).setAttribute('aria-disabled', "true");
		$element.setStyle({
			overflowY: 'auto'
		});
		return;
	}
	if ( height <= minHeight ) {
		if ( $('sizer_minus_' + id) )
		$('sizer_minus_' + id).addClassName('disabled');
		$('sizer_minus_' + id).setAttribute('aria-disabled', "true");
		return;
	}
	$('sizer_plus_' + id).removeClassName('disabled');
	$('sizer_minus_' + id).removeClassName('disabled');
	$('sizer_plus_' + id).removeAttribute('aria-disabled');
	$('sizer_minus_' + id).removeAttribute('aria-disabled');
}
function resizeTextAreaIframe() {
	var args = Array.prototype.slice.call(arguments, 0),
		tf = $("textarea_iframe." + id),
		doctype = args[0],
		id = args[1],
		height,
		oldRows,
		rows;
		if (doctype){
			height = args[2];
		} else {
			rows = args[2];
			oldRows = args[3];
		}
	if (!tf){
		var skipAdd60 = args[4];
		var adder = skipAdd60 ? 0 : 60;
		tf = $(id + '_ifr');
		if (!tf)
tf = $('textarea_iframe.' + id);
if (tf){
var tbl = $(id + '_tbl');
			var readOnlyDiv = $(id + '_readOnlyDiv');
			if (doctype){
				tf.style.height = (height + adder) + "px";
				if ( tbl ){
tbl.style.height = (height + adder) + "px";
				}
if ( readOnlyDiv ) {
					readOnlyDiv.style.height = (height + adder) + "px";
				}
				var tfDoc = tf.contentDocument || tf.contentWindow.document;
				var editor = getTinyEditor(id);
				var isReadonly = editor && editor.readonly;
				if (tfDoc && isReadonly) {
					function setHeightToScrollHeight() {
						if (tfDoc.documentElement.scrollHeight !== parseInt(tf.style.height, 10)) {
							tf.style.height = tfDoc.documentElement.scrollHeight + "px";
						}
					}
					setHeightToScrollHeight();
					window.onresize = setHeightToScrollHeight;
					CustomEventManager.on('tab.activated', function(){
						setHeightToScrollHeight();
					})
				}
			} else {
var elHeight = parseInt(tf.clientHeight);
if (elHeight == 0 && readOnlyDiv)
					elHeight = parseInt(readOnlyDiv.style.height);
var pixelsPerRow = 12;
				var newHeight = elHeight + (rows - oldRows) * pixelsPerRow;
				tf.style.height = newHeight + "px";
				if (tbl){
					tbl.style.height = (parseInt(tbl.style.height) + (newHeight-elHeight)) + "px";
				}
if (readOnlyDiv){
					readOnlyDiv.style.height = newHeight + "px";
				}
			}
		}
	}
	if (!tf)
		return;
	if (!tf.parentNode)
		return;
	if (!tf.parentNode.nextSibling)
		return;
	var nid = tf.parentNode.nextSibling.id;
	if (nid != id)
		return;
	var elHeight = tf.clientHeight;
var pixelsPerRow = Math.round(elHeight / oldRows);
	tf.style.height = rows * pixelsPerRow + "px";
}
function toggleQuestionRows(thisclass, display, fl) {
	forcelabels = false;
	if (fl == true)
		forcelabels = true;
	var rows = $(document.body).select('.' + thisclass);
	for (i = 0; i < rows.length; i++) {
	  var element = rows[i];
	  var id = element.id;
	  if ('CATEGORY_LABEL' != id || forcelabels)
		  element.style.display = display;
	}
	var openStyle='none';
	var closedStyle='none';
	if ('none' == display) 
		openStyle = '';
	else
		closedStyle = '';
	var s = $(thisclass+'CLOSED');
	s.style.display=closedStyle;
	s = $(thisclass+'OPEN');				
	s.style.display=openStyle;	
}
function toggleWorkflow(id, expandPref) {
	var map = getMessages(['Expand', 'Collapse']);
	var table = $("workflow." + id);
	var spans = table.getElementsByTagName("span");
	for (var i = 0; i != spans.length; i++) {
		var span = spans[i];
		if (!span.getAttribute("stage"))
			continue;
		var spanImage = $(span.id + '.image');
		var spanText = $(span.id + '.text');
		if (span.getAttribute("selected") == 'true')
			spanText.style.color = "RGB(var(--now-button--secondary--color,var(--now-color--neutral-18,22,27,28)))";
		var filterImg = $('filterimg.' + id);
		var linkTag = document.querySelector('a[aria-controls="' + id + '"]');
		if (expandPref == "false") {
			span.style.display = "";
			spanText.style.display = "none";
filterImg.src = "images/filter_hide16.gifx";
			filterImg.title = map["Expand"];
			filterImg.alt = map["Expand"];
			filterImg.setAttribute("data-original-title", map["Expand"]);
			span.setAttribute("aria-expanded", "false");
			linkTag.title = map["Expand"];
			linkTag.alt = map["Expand"];
			linkTag.setAttribute("data-original-title", map["Expand"]);
		} else {
			span.style.display = "block";
			spanText.style.display = "";
			span.setAttribute("aria-expanded", "true");
filterImg.src = "images/filter_reveal16.gifx";
			filterImg.title = map["Collapse"];
			filterImg.alt = map["Collapse"];
			filterImg.setAttribute("data-original-title", map["Collapse"]);
			linkTag.title = map["Collapse"];
			linkTag.alt = map["Collapse"];
			linkTag.setAttribute("data-original-title", map["Collapse"]);
		}
	}
	_frameChanged();
}
function toggleItemsEventHandler(event, id) {
	var e  = event || window.event;
	var code =  e.which || e.keyCode;
	
	if (code === 32 || code === 13) {
	    e.preventDefault();
	    
	    toggleItems(id);
	}
}
function togglePreference(id) {
	toggleItems(id);
}
function toggleItems(id, force) {
	var tables = $$("table");
	for (var i = 0; i < tables.length; i++) {
		var tableId = tables[i].id;
		if (tableId.indexOf("workflow.") == -1) 
			continue;
		
		var idParts = tables[i].id.split(".");
		if (id && tableId != "workflow." + id) 
			continue;
		
		var pref = getPref(idParts[1]);
		if (force != pref)
			toggleWorkflow(idParts[1], pref);
		
		if (id)
			break;				
	}
}
function getPref(id) {
	var filterImgSrc = $('filterimg.' + id).src
	if (filterImgSrc.indexOf('filter_hide') != -1) 
		return "true";
	 
	return "false";
}
document.addEventListener('keyup', checkForClientKeystroke) ;
function checkForClientKeystroke(evt) {
	if (evt.keyCode == 27 && window.g_popup_manager) {
		g_popup_manager.destroypopDiv();
		return;
	}
	if (evt.shiftKey && evt.ctrlKey && evt.keyCode == 74) {
		var gWindow = new GlideDialogWindow("client_js");
		gWindow.setTitle("JavaScript Executor");
		gWindow.setPreference('table', 'javascript_executor');
		gWindow.render();
		Event.stop(evt);
		return;
	}
	
	try {
		if (typeof parent.navVisible == "function") {
			if (evt.ctrlKey && evt.keyCode == 190 && !evt.shiftKey && !evt.altKey) {
				Event.stop(evt);
				if (parent.navVisible()) {
					parent.hideNav();
					parent.hide("banner_top_left");
					parent.hide("banner_top_right");
				} else {
					parent.showNav();
					parent.show("banner_top_left");
					parent.show("banner_top_right");
				}
			}
		}
	} catch (e) { }
}
function toggleHelp(name) {
   var wrapper = $('help_' + name + '_wrapper');
   var image = $('img.help_' + name + '_wrapper');
   if (wrapper.style.display=="block") {
	   wrapper.style.display = "none";
image.src = "images/filter_hide16.gifx";
   } else {
	   wrapper.style.display = "block"; 
image.src = "images/filter_reveal16.gifx";
   }
image.alt = getMessage("Display / Hide");
   _frameChanged();
}
function validateHex(field) {
  var num = field.value;
  var valid = isHex(num);
  if (!valid) {
    var sName = '';
    if (field.name != null)
       sName = ' of '+field.name+' ';
    alert("The entered value "+sName+"is not hex.  Please correct.");  
  }
}
function isHex(num) {
  var str = num.replace(new RegExp('[0-9a-fA-F]','g'),'');
  if (str.length > 0) 
    return false;
    
  return true;
}
function setLightWeightLink(name) {
	var v = $(name);
	if (!v)
	    return;
var link = $(name + "LINK");
var replace = $(name + "LINKreplace")
	if (!link && !replace)
	    return;
	var vis = "hidden";
	if (v.value != '')
	    vis = "";
	setLightWeightLinkDisplay(link, vis);
	setLightWeightLinkDisplay(replace, vis);
}
function setLightWeightLinkDisplay(el, vis) {
	if (!el)
		return;
	el.style.visibility = vis;
	el.style.display = vis == 'hidden' ? 'none' : '';
}
function toggleDebug(id) {
	id = id.split('.')[1];
	for (var i =0; i < 1000; i++) {
	    var widgetName = 'debug.' + id + '.' + i;
	    var w = $(widgetName);
	    if (!w)
	    	return; 	
	    	
	    w.toggle();
	}
}
function enterSubmitsForm(e, enter_submits_form) {
if (e.keyCode != 13)
		return true;
		
if (e.ctrlKey == true)
		return false;
var source = Event.element(e);
	var $source = $j(source);
	if (source.getAttribute("data-type")  && e.keyCode == 13 && source.getAttribute("data-type") == 'ac_reference_input')
	    return false;
	
if (source && source.type=="textarea")
		return true;
	if (source.getAttribute("contenteditable") === "true" && $source.is('.multiLinePill'))
		return true;
	if ($source.is('.delete_pill.remove-pill'))
		return true;
	if ($source.is('.dot_walk_btn'))
		return true;
if (source && source.type == "submit" || source.type == "button") {
if (source.disabled == false && source.onclick) {
source.onclick();
return false;
		}
	}
if (enter_submits_form == 'false')
		return false;
	var submitHeaderElements = $(document.body).select(".header").filter(function (el) {
		return el.type === 'submit' && !el.disabled;
});
	if (!submitHeaderElements.length)
		return false;
	var submitButton = submitHeaderElements.find(function(el) {
		return (el.value === 'sysverb_insert'
			|| el.value === 'sysverb_insert_and_stay'
			|| el.value === 'sysverb_update'
			|| el.value === 'sysverb_update_and_stay'
			|| el.value === 'sysverb_save'
			|| el.value === 'sys_security_acl_insert_with_roles');
	}) || submitHeaderElements[0];
source.blur();
	setTimeout(function(){
		submitButton.onclick();
	}, 0);
return false;
}
function gsftPrompt(title, question, onPromptComplete, onPromptCancel) {
		var dialog = new GlideDialogWindow('glide_prompt', false);
		dialog.setTitle(title);
		dialog.setPreference('title', question);    	
		dialog.setPreference('onPromptComplete', onPromptComplete);
		dialog.setPreference('onPromptCancel', onPromptCancel);		
		dialog.render();
}
function gsftConfirm(title, question, onPromptSave, onPromptCancel, onPromptDiscard) {
	var width, dialogClass = GlideDialogWindow;
	if (window.GlideModal) {
		dialogClass = GlideModal;
		width = 400;
	}
	var dialog = new dialogClass('glide_confirm', false, width);
	dialog.setTitle(title);
	dialog.setPreference('title', question);
	dialog.setPreference('onPromptSave', onPromptSave);
	dialog.setPreference('onPromptCancel', onPromptCancel);
	dialog.setPreference('onPromptDiscard', onPromptDiscard);
	dialog.render();
}
function tsIndexCreatorPopup(tableName){
	var gDialog = new GlideDialogWindow("dialog_text_index_creator");
	gDialog.setSize(400, 250);
	gDialog.setPreference("table_name", tableName);
	if (tableName != "")
		gDialog.setTitle('Generate Text Index');
	else
		gDialog.setTitle('Regenerate All Text Indexes');
	
	gDialog.render();
}
function isTextDirectionRTL(){
	return g_text_direction == 'rtl' ? true : false;
}
function simpleRemoveOption(sourceSelect) {
	var sourceOptions = sourceSelect.options;
	var selectedIds = [];
	var index = 0;
	for (var i = 0; i < sourceSelect.length; i++) {
		option = sourceOptions[i];
		if (option.selected) {
			selectedIds[index] = i;
			index++;
		}
	}
	for (var i = selectedIds.length - 1; i > -1; i--) 
		sourceSelect.remove(selectedIds[i]);
	sourceSelect.disabled = true;
	sourceSelect.disabled = false;
}
function saveAllSelected(fromSelectArray, toArray, delim, escape, emptyLabel, doEscape) {
	var translatedEmptyLabel = getMessage(emptyLabel);
	for (var i = 0; i < fromSelectArray.length; i++) {
		if (typeof fromSelectArray[i] == 'undefined') {
			toArray[i].value = '';
			continue;
		}
		var toValue = "";
		for (var j = 0; j < fromSelectArray[i].length; j++) {
			if (!(fromSelectArray[i].length == 1 && fromSelectArray[i].options[0].value == translatedEmptyLabel)) {
				var val = fromSelectArray[i].options[j].value;
				if (doEscape)
					val = encodeURIComponent(val);
				toValue += val.replace(new RegExp(delim, "g"), escape + delim);
			}
			if (j + 1 < fromSelectArray[i].length) 
				toValue += delim;
		}
		toArray[i].value = toValue;
	}
}
function sortSelect (obj) {
	var maxSort = obj.getAttribute("max_sort");
	if (!maxSort || maxSort == 0) 
		maxSort = 500; 
	if (obj.length > maxSort && isMSIE && !isMSIE9) { return; }
    if (!sortSupported(obj)) { return; }
	if (!hasOptions(obj)) { return; }
	
	var o = [];
	var o2 = [];
	var o3 = [];
	for (var i=0; i<obj.options.length; i++) {
		var newOption = new Option( obj.options[i].text, obj.options[i].value, obj.options[i].defaultSelected, obj.options[i].selected);
		copyAttributes(obj.options[i], newOption);
		if (newOption.value.indexOf('split') > 0)
			o2[o2.length] = newOption;
		else if (newOption.value && newOption.value.substr(0,2) !=="u_" && (newOption.value.indexOf('formatter') > 0 || newOption.value.indexOf('component') > 0 || 
			    newOption.value.indexOf('annotation') > 0 || newOption.value.indexOf('chart') > 0))
			o3[o3.length] = newOption;
		else
		    o[o.length] = newOption;
	}
	
	if (o.length == 0)
		return;
	
	o = o.sort(
			function(a,b) { 
				if ((a.text.toLowerCase()+"") < (b.text.toLowerCase()+"")) { return -1; }
				if ((a.text.toLowerCase()+"") > (b.text.toLowerCase()+"")) { return 1; }
				return 0;
			} 
		);
	
	o3 = o3.sort(
			function(a,b) { 
				if ((a.text.toLowerCase()+"") < (b.text.toLowerCase()+"")) { return -1; }
				if ((a.text.toLowerCase()+"") > (b.text.toLowerCase()+"")) { return 1; }
				return 0;
			} 
		);
 
	for (var i = 0; i < o.length; i++) {
		var newOption = new Option(o[i].text, o[i].value, o[i].defaultSelected, o[i].selected);
		copyAttributes(o[i], newOption);
		obj.options[i] = newOption;
	}
	
	var counter = 0;
	for (var i = o.length; i < (o.length + o2.length); i++) {
		var newOption = new Option(o2[counter].text, o2[counter].value, o2[counter].defaultSelected, o2[counter].selected);
		copyAttributes(o2[counter], newOption);
		obj.options[i] = newOption;
		counter++;
	}
	
	var counter = 0;
	for (var i = (o.length + o2.length); i < (o.length + o2.length + o3.length); i++) {
		var newOption = new Option(o3[counter].text, o3[counter].value, o3[counter].defaultSelected, o3[counter].selected);
		copyAttributes(o3[counter], newOption);
		obj.options[i] = newOption;
		counter++;
	}
}
function copyAttributes(from, to) {
	var attributes = from.attributes;
	for (var n = 0; n < attributes.length; n++) {
		var attr = attributes[n];
		var aname = attr.nodeName;
		var avalue = attr.nodeValue;
		to.setAttribute(aname, avalue);
	}
	if (from.style.cssText)
		to.style.cssText = from.style.cssText;
}
function hasOptions(obj) {
	if (obj != null && obj.options != null)
		return true;
		
	return false;
}
function sortSupported(obj) {
	if (obj == null) 
		return false;
	
    var noSort = obj.no_sort || obj.getAttribute('no_sort');
    if (noSort) {
        return false;
    }
	return true;
}
;
/*! RESOURCE: /scripts/scoped_object_generators.js */
function ScopedGlideAjaxGenerator(scope) {
	var ScopedGlideAjax = function() {
		ScopedGlideAjax.prototype.initialize.apply(this, arguments);
	};
	ScopedGlideAjax.prototype = classExtendForScope({}, window.GlideAjax.prototype, {
		scope: scope,
        initialize: function(endpoint, url) {
            GlideAjax.prototype.initialize.call(this, endpoint, url);
            this.setScope(this.scope);
        },
        getXMLWait: function() {
    		var err_options = {
    	    		text: "Access to getXMLWait is not available in scoped applications.",
    	    		type: "system",
    	    		attributes: { type: "error" }
    	    };
			notifyFromWrappedScopedObject(err_options);
        },
        setScope: function(newScope) {
            if (newScope != this.scope && newScope !== "global") {
                var err_options = {
                    text: "Scoped applications cannot impersonate other scopes.",
                    type: "system",
                    attributes: { type: "error" }
                };
				notifyFromWrappedScopedObject(err_options);
                return;
            }
            return GlideAjax.prototype.setScope.call(this, scope);
        },
        addParam: function(param, value) {
            if (param == "sysparm_scope" && value != this.scope && value != "global") {
                var err_options = {
                    text: "Scoped applications cannot impersonate other scopes.",
                    type: "system",
                    attributes: { type: "error" }
                };
				notifyFromWrappedScopedObject(err_options);
                return;
            }
            return window.GlideAjax.prototype.addParam.call(this, param, value);
        }
    })
    return ScopedGlideAjax;
}
function ScopedGFormGenerator(scope) {
	var ScopedGForm =  function() {};
	
	if ("undefined" == typeof g_form) {
		return ScopedGForm;
	}
	if ("global" == scope) {
		return g_form;
	}
	ScopedGForm.prototype = g_form;
	var scoped_g_form = new ScopedGForm();
	function inScope(fieldName) {
		try {
			var ge = _getUIElement(fieldName);
			if (ge && scope == ge.getScope())
				return true;
			if(ge && ge.isInherited && (scope == g_form.getScope()))
				return true;
		} catch (e) {
			jslog(e);
		}
		return false;
	}
	function _getUIElement(fieldName) {
		if (g_form.hasVariablesPrefix && g_form.removeVariablesPrefix)
			if (g_form.hasVariablesPrefix(fieldName))
				fieldName = g_form.resolveNameMap(g_form.removeVariablesPrefix(fieldName));
		return g_form.getGlideUIElement(fieldName) || g_form.getGlideUIElement(g_form.resolveNameMap(fieldName));
	};
	function _noCallbackError(displayName, fieldName) {
		var text = displayName + " for " + fieldName + " not allowed: missing callback function as parameter";
		console.error(text);
		jslog(text);
	}
	
	function _showScopeError(displayName, fieldName, value) {
		var text = displayName + " " + value + " not set on field " + fieldName + ": cross-scope access denied.";
		opticsLog(scoped_g_form.getTableName(), fieldName, text);
		if (g_form.isFieldVisible(fieldName))
			console.error(text);
		jslog(text);
	}
	function validField(fieldName) {
		fieldName = g_form.removeCurrentPrefix(fieldName);
		return g_form.hasField(fieldName) || g_form.getPrefixHandler(fieldName);
	}
	
	scoped_g_form.setReadOnly = function(fieldName, disabled) {
		if (!validField(fieldName))
			return;
		
		if (inScope(fieldName))
			return g_form.setReadOnly(fieldName, disabled);
			
		_showScopeError("ReadOnly", fieldName, disabled);
	}
	scoped_g_form.setReadonly = function(fieldName, disabled) {
		if (!validField(fieldName))
			return;
		
		if (inScope(fieldName))
			return g_form.setReadonly(fieldName, disabled);
			
		_showScopeError("ReadOnly", fieldName, disabled);
	}
	
	scoped_g_form.setMandatory = function(fieldName, mandatory) {
		if (!validField(fieldName))
			return;
		
		if (inScope(fieldName))
			return g_form.setMandatory(fieldName, mandatory);
		
		_showScopeError("Mandatory", fieldName, mandatory);
	}
	scoped_g_form.setDisplay = function(fieldName, display) {
		if (!validField(fieldName))
			return;
		
		if (inScope(fieldName))
			return g_form.setDisplay(fieldName, display);
			
		_showScopeError("Display", fieldName, display);
	}
	scoped_g_form.setDisabled = function(fieldName, disabled) {
		if (!validField(fieldName))
			return;
		
		if (inScope(fieldName))
			return g_form.setDisabled(fieldName, disabled);
			
		_showScopeError("Disabled", fieldName, disabled);
	}
	scoped_g_form.getReference = function(fieldName, callBack) {
		if (!validField(fieldName))
			return;
		
		if ('function' == typeof callBack)
			return g_form.getReference(fieldName, callBack);
			
		_noCallbackError("getReference", fieldName, false);
	}
	Object.defineProperty(scoped_g_form, "modified", {
		get: function () {
			return g_form.modified;
		},
		set: function (val) {
			g_form.modified = val;
		},
		enumerable: true,
		configurable: true
	});
	return scoped_g_form;
}
function ScopedGlideDialogWindowGenerator(scope) {
	var extendFrom = window.GlideDialogWindow ? GlideDialogWindow.prototype : GlideModal.prototype;
	var ScopedGlideDialogWindow = function() {
		ScopedGlideDialogWindow.prototype.initialize.apply(this, arguments);
	};
	ScopedGlideDialogWindow.prototype = classExtendForScope({}, extendFrom, {
        scope: scope,
        initialize: function(id, readOnly, width, height) {
            extendFrom.initialize.call(this, id, readOnly, width, height);
            this.setScope(this.scope);
        }
    });
    return ScopedGlideDialogWindow;
}
function classExtendForScope(extended, defaults, options) {
	if (window.jQuery)
		return jQuery.extend(extended, defaults, options);
	var prop;
	for (prop in defaults) {
		extended[prop] = defaults[prop];
	}
	for (prop in options) {
		extended[prop] = options[prop];
	}
	return extended;
}
function notifyFromWrappedScopedObject(msgObject) {
	jslog(msgObject.text);
	if (typeof nowapi !== 'undefined' && nowapi && typeof nowapi.hasOwnProperty('g_notification'))
		nowapi.g_notification.show(msgObject.attributes.type, msgObject.text);
	else if (typeof GlideUI != 'undefined')
		GlideUI.get().display(new GlideUINotification(msgObject));
}
;
/*! RESOURCE: /scripts/functions_reference.js */
function updateAndFlip(select, elementName) {
	var option = setSelectValue(select, elementName);
	onChange(elementName);
	refFlipImage(option, elementName);
}
function setSelectValue(select, elementName) {
	elementName = elementName || '';
	if (elementName.indexOf("sys_select.") === 0)
		elementName = elementName.replace("sys_select.", "");
	var value = '';
	var text = '';
	var option;
	if (select.selectedIndex != -1) {
		  option = select.options[select.selectedIndex];
		  value = option.value;
		  text = option.text;
	}
	  
	var id = gel(elementName);
	id.value = value;
	var idd = gel('sys_display.' + elementName);
	if (value == '')
		idd.value = '';
	else
		idd.value = text;
		 
	return option;
}
function refFlipImage(element, elementName, useText) {
	if (typeof g_form !== 'undefined' && !g_form.isFieldVisible(elementName))
return;
	var viewField = gel("view." + elementName);
	var viewRField = gel("viewr." + elementName);
	var viewHideField = gel("view." + elementName + ".no");
	var refid = gel(elementName);
	var value = element.value;
	
	if (!value) {
		hideObject(viewField);
		hideObject(viewRField);
		showObjectInline(viewHideField);
	} else {
		if(isDoctype()) {
			showObjectInlineBlock(viewField);
			showObjectInlineBlock(viewRField);
		} else {
			showObjectInline(viewField);
			showObjectInline(viewRField);
		}
		hideObject(viewHideField);
	}
}
function refFlipImageDisplay(element, dsp) {
	if (element)
		element.style.display = dsp;
}
function derivedFromChoiceListHasValue(elementName) {
	var parentName = elementName.substring(0, elementName.lastIndexOf('.'));
	if (parentName.indexOf('.') < 0)
		return false;
	var parent = gel(parentName);
	if (!parent || parent.getAttribute('choice') !== '3')
		return false;
	return !!parent.value || derivedFromChoiceListHasValue(parentName);
}
function emptyWithoutNoneRefChoiceListOnLoadHandler(elementName) {
	var element = gel(elementName);
	if (!element || !element.value)
		return;
	if (!derivedFromChoiceListHasValue(elementName)) {
		refFlipImage(element, elementName);
		onSelChange(elementName);
	}
}
function addSetDerivedReadOnlyListener(fieldName, disabled) {
	if (typeof g_form === 'undefined')
		return;
	var eventName = 'derived_waiting_removed.' + fieldName;
	var handler = function() {
		CustomEvent.un(eventName, handler);
		g_form.setReadonly(fieldName, disabled);
	};
	CustomEvent.unAll(eventName);
	CustomEvent.observe(eventName, handler);
}
;
/*! RESOURCE: /scripts/functions_onchange.js */
function onChange(elementName, fromSetTemplateValue, gForm){
	 var g_form = typeof gForm !== "undefined" ? gForm : this.g_form;
	elementName = elementName || '';
	var elementId = elementName;
	if (elementName.indexOf("sys_select.") === 0)
		elementName = elementName.replace("sys_select.", "");
	var eChanged,
		eOriginal,
		eDisplay,
		isMappingField = ifFieldHasElementMappingPrefix(elementName);
	if (isMappingField) {
		elementName = removeMappingPrefix(elementName);
		eChanged = gel(elementName);
		eOriginal = gel("sys_mapping.original." + elementName);
		eDisplay = gel("sys_mapping." + elementName);
	} else {
		eChanged = gel(elementName);
		eOriginal = gel("sys_original." + elementName);
		eDisplay = gel("sys_display." + elementName);
	
		if (eOriginal == null) {
			return;
		}
	}
	
	var vOriginal = eOriginal.value.trim() === '' ? '' : eOriginal.value;
	var vChanged = eChanged.value.trim() === '' ? '' : eChanged.value;
	var vDisplay = eDisplay ? eDisplay.value : null;
	var niElement = gel('ni.'+ elementName);
	if (niElement && niElement.type === 'checkbox') {
		if (vChanged === '')
			vChanged = "false";
	}
	if (isMappingField && !isFilterField(eChanged)) {
		eChanged.changed = (vDisplay != vOriginal);
	} else {
		if (!vChanged)
			eChanged.value = "";
		eChanged.changed = (vOriginal != vChanged);
	}
	if(!elementName.startsWith("IO:") && !elementName.startsWith("ni.VE") && !elementName.startsWith("ni.QS")) {
		onChangeLabelProcess(elementName);
	}
	setMandatoryExplained();
onSelChange(elementId, fromSetTemplateValue);
    
	clientScriptOnChange(elementName, eChanged, vOriginal, vChanged, g_form);
	fieldChanged(elementName, eChanged.changed, g_form);
 	if (eChanged.changed && typeof(g_form) != "undefined" && g_form.triggerOnUserChangeValue)
 		g_form.triggerOnUserChangeValue(elementName, vOriginal, vChanged);
	
	var onChangeData = {id : elementName, value : vChanged, modified : eChanged.changed};
	if(vDisplay)
		onChangeData.displayValue = vDisplay;
	var parentForm = $(elementName).up('form');
	parentForm && parentForm.fire('glideform:onchange', onChangeData);
	CustomEvent.fire("refFieldPreviewButtonChange", elementName, vChanged, vDisplay);
}
function isFilterField(element) {
	if (element && element.nextSibling)
		return element.nextSibling.getAttribute('gsft_template');
	return false;
}
function ifFieldHasElementMappingPrefix(fieldName) {
	if (fieldName === undefined) {
		return false;
	}
	
	return fieldName.indexOf('sys_mapping.') !== -1;
}
function removeMappingPrefix(fieldName) {
	return fieldName.replace("sys_mapping.", "");
}
function onChangeLabelProcess(elementName, value) {
	var el = gel(elementName);
	var statusNode = gel('status.' + elementName);
	onChangeLabelProcessByEl(el, statusNode, value);
}
function onChangeLabelProcessByEl(elementNode, statusLabel, value) {
	if (!elementNode || !statusLabel)
		return;
var mandatory = elementNode.getAttribute("mandatory") + "";
	var readonly = elementNode.disabled || hasClassName(elementNode,'disabled');
if (mandatory == null || mandatory == "null")
		mandatory = statusLabel.getAttribute("mandatory") + "";
	else {
		statusLabel.setAttribute("mandatory", mandatory);
	}
	elementNode.setAttribute("aria-required", mandatory === 'true');
	var displayNode = gel("sys_display." + elementNode.id);
if (displayNode)
		displayNode.setAttribute("aria-required", mandatory === 'true');
		
	var newClassName = statusLabel.getAttribute("oclass");
	var newFieldClassName = "";
var newTitle = statusLabel.getAttribute("title") || "";
	if (value == undefined)
		value = elementNode.value;
	if (mandatory == "true") {
		if (typeof value != 'undefined' && (value == "")) {
			newClassName = "mandatory";
			newFieldClassName = "is-required";
			newTitle = getMessage("Mandatory - must be populated before Submit");
		} else if (elementNode.changed) {
			newClassName = "mandatory changed";
			newFieldClassName = "is-filled";
			newTitle = getMessage("Field value has changed since last update");
		} else if (!readonly) {
			newClassName = "mandatory_populated";
			newFieldClassName = "is-prefilled";
			newTitle = getMessage("Mandatory - preloaded with saved data");
		} else {
			newClassName = "read_only";
			newTitle = getMessage("Read only - cannot be modified");
		}
	} else {
		if (elementNode.changed) {
			newClassName = "changed";
			newTitle = getMessage("Field value has changed since last update");
		} else if (readonly) {
			newClassName = "read_only";
if (newTitle == "" || newTitle == null)
				 newTitle = getMessage("Read only - cannot be modified");
		} else if (newClassName != "read_only" && newClassName != "changed") {
			newClassName = "";
			newTitle = "";
		}
	}
    var slm = gel("section508." + elementNode.id);
    if (slm) {
    	slm.setAttribute("title", statusLabel.getAttribute("title"));
    	slm.setAttribute("alt", statusLabel.getAttribute("title"));
    }
	newClassName += ' label_description';
	if (statusLabel.className == newClassName)
		return;
	var parentElement = gel("element." + elementNode.id);
	if (statusLabel.className.indexOf("required-marker") > -1)
		var previousMandatory = true;
	statusLabel.className = newClassName;
	if (previousMandatory && statusLabel.className.indexOf("required-marker") == -1 && parentElement && parentElement.className.indexOf("is-required") > -1)
		gel("element." + elementNode.id).className = parentElement.className.replace("is-required","");
	if (typeof handleAriaInvalidState === 'function')
	handleAriaInvalidState(elementNode.id, newFieldClassName === 'is-required');
	if (typeof $j !== 'undefined') {
	var tooltipButton = $j(statusLabel).siblings('.icon-help');
		if (tooltipButton && tooltipButton.length) {
		var baseTooltipMessage = tooltipButton.attr('label-title');
			tooltipButton.attr('aria-label', baseTooltipMessage);
			var mandatoryTitle = getMessage("Mandatory - must be populated before Submit");
			if (baseTooltipMessage.indexOf(mandatoryTitle) !== -1) {
				baseTooltipMessage = baseTooltipMessage.replace(mandatoryTitle + '. ', '');
				tooltipButton.attr('label-title', baseTooltipMessage);
				tooltipButton.attr('aria-label', baseTooltipMessage);
			}
		if(!tooltipButton.attr('label-title')) {
			tooltipButton.attr('role', 'presentation');
		}
		var fullTooltipLabel = (newTitle && baseTooltipMessage)
			? newTitle + '. ' + baseTooltipMessage
			: (newTitle || baseTooltipMessage);
			if (fullTooltipLabel) {
				tooltipButton
					.attr('alt', fullTooltipLabel)
					.attr('data-dynamic-title', fullTooltipLabel)
					.show();
				if (mandatory === "true" && g_accessibility_tooltips)
					tooltipButton.attr('aria-hidden', 'false');
			} else
			tooltipButton.hide();
	} else 
		statusLabel.setAttribute("data-dynamic-title", newTitle);
	}
	if (document.documentElement.getAttribute('data-doctype') == 'true') {
		if (mandatory == 'true') {
			statusLabel.className = "required-marker label_description";
		}
		if (newFieldClassName) {
			var formGroup = elementNode.up('.form-group');
			formGroup.removeClassName('is-prefilled');
			formGroup.removeClassName('is-required');
			formGroup.removeClassName('is-filled');
			formGroup.addClassName(newFieldClassName);
		}
		statusLabel.setAttribute('aria-label', newTitle);
	}
    CustomEvent.fire("mandatory.changed", elementNode.id, newClassName);
}
function  clientScriptOnChange(elementName, eChanged, vOriginal, vChanged, gForm) {
   var splitMe = elementName.split('.');
   var tableName = splitMe[0];
   var fieldName = splitMe.slice(1).join('.');
   callChangeHandlers(tableName, fieldName, eChanged, vOriginal, vChanged, gForm);
}
function callChangeHandlers(tableName, fieldName, eChanged, vOriginal, vChanged, gForm) {
	var g_form = typeof gForm != "undefined" ? gForm : this.g_form;
	var widgetName = tableName + "." + fieldName;
	if (typeof (g_form) != "undefined") 
		g_form.hideFieldMsg(fieldName, true);
 	
	var template = eChanged.templateValue == 'true';
		   
	eChanged.templateValue = 'false';
    for (var i = 0; i < g_event_handlers.length; i++) {
        var handler = g_event_handlers[i];
		if (handler.fieldName != widgetName && handler.fieldName != fieldName)
		  continue;
		callChangeHandler(handler, this, eChanged, vOriginal, vChanged, false, template, g_form);
    }
    CustomEvent.fire("change.handlers.run", tableName, fieldName); 
}
function fireAllChangeHandlers() {
    for (var x = 0; x < g_event_handlers.length; x++) {
        var handler = g_event_handlers[x];  
        var elementName = handler.fieldName;
        var theWidget = gel(elementName);
        if (!theWidget)
            continue;
			
        var original = gel("sys_original." + elementName);
		var oldVal = 'unknown';
		if (original)
		    oldVal = original.value;
		var newVal;
		if ($(theWidget).getAttribute("type") == "radio") {
			newVal = oldVal;
			var elems = $$('#'+$(theWidget).getAttribute("id")).each(function(el){
				var checkedValue = el.getAttribute("checked");
				if (checkedValue != null && checkedValue.length > 0)
					newVal = el.value;
			});
		} else
			newVal = theWidget.value;
		callChangeHandler(handler, this, theWidget, oldVal, newVal, true, false);
    }
    CustomEvent.fire("change.handlers.run.all");
}
function callChangeHandler(handler, control, theWidget, oldVal, newVal, loading, template, gForm) {
	var g_form = typeof gForm != "undefined" ? gForm : this.g_form;
	try {
		callChangeHandler0(handler, control, theWidget, oldVal, newVal, loading, template);
	} catch (ex) {
		if (g_user.hasRole('client_script_admin')) {
			g_form.showFieldMsg(theWidget, "onChange script error: " + ex.toString() + "\n" +
				handler.handler.toString(), "error", false);
		} else {
			g_form.showFieldMsg(theWidget,
				"Script error encountered when changing this field - please contact your System Administrator",
				"error", false);
		}
		CustomEvent.fire('glideform:script_error', "onChange script error: " + ex.toString() + "\n" + handler.handler.toString());
	}
}
function callChangeHandler0(handler, control, theWidget, oldVal, newVal, loading, template) {
	CustomEvent.fire('glide_optics_inspect_put_cs_context', handler.handlerName, 'change');
    var startTimer = new Date();
	handler.handler.call(control, theWidget, oldVal, newVal, loading, template);
	var n = g_event_handlers_onChange[handler.handlerName];
	if (n)
	    CustomEvent.fire('page_timing', { name: 'CSOC', child: { description: n, sys_id: g_event_handler_ids[handler.handlerName], source_table: 'sys_script_client'}, startTime: startTimer, win: window });
	CustomEvent.fire('glide_optics_inspect_pop_cs_context', handler.handlerName, 'change');
}
function multiKeyDown(me, gForm) {
	var g_form  = typeof  gForm != "undefined" ? gForm : this.g_form;
	if ($(me.id).getAttribute("isquestionhtml") == "true")
        return;
	
var eOriginal = 'g_' + me.id.replace(/\./g, '_');
	var eOriginalSet = eval("typeof " + eOriginal + " != 'undefined'") && eOriginal !== 'g_slush';
	if (eOriginalSet)
		return;
    var oValue = escape(me.value);
    if (typeof(g_form) != "undefined" && eOriginal !== 'g_slush')
		var oValue = escape(g_form.getValue(me.name));
	eval(eOriginal + '="' + oValue + '";');
}
function multiModified(me, type, currentValue) {
	if ($(me.id).getAttribute("isquestionhtml") == "true") {
		$(me.id).onchange();
        return;
	}
	multiKeyDown(me);
	var form = findParentByTag(me, "form");
	var changeFlag = true;
	if (me.id && form) {
		var elementName = me.id;
var vOriginal = unescape(eval('g_' + me.id.replace(/\./g, '_')));
		if (currentValue === undefined) {
			currentValue = me.value;
			if (!currentValue.trim()) {
				me.value = "";
				currentValue = "";
			}
		}
		if (type == undefined)
			type = 'htmlarea';
		if (currentValue == vOriginal)
			changeFlag = false;
		
	    me.changed = changeFlag;
		onChangeLabelProcess(elementName, currentValue);
		if (type == 'tinymce' || (type.baseURL && type.baseURL.indexOf('tinymce') > -1)){
			clientScriptOnChange(elementName, me, 'unknown', currentValue);
		}else{
if ((typeof me.isFocused) == "boolean")
if (me.isFocused == false)
					clientScriptOnChange(elementName, me, 'unknown', currentValue);
		}
	}
	fieldChanged(elementName, changeFlag);
	var onChangeData = {id : me.id, value : me.value, modified: me.changed};
	$(me.up('form')).fire('glideform:onchange', onChangeData);
}
function formChangeKeepAlive() {
	var AJAX_KEEPALIVE_TIMEOUT = 900;
var nowsecs = parseInt((new Date()).getTime() / 1000);
var secs = parseInt(lastActivity.getTime() / 1000);
	var difference = nowsecs - secs;
	if (difference > AJAX_KEEPALIVE_TIMEOUT) {
		var aj = new GlideAjax("GlideSystemAjax");
		aj.addParam("sysparm_name", "isLoggedIn");
		aj.getXML(doNothing);
		
		lastActivity = new Date();
	}
}
function fieldChanged(elementName, changeFlag, gForm) {
	var g_form = typeof gForm !== "undefined" ? gForm : this.g_form;
	formChangeKeepAlive();
	if (typeof(g_form) != "undefined")
	   g_form.fieldChanged(elementName, changeFlag);
}
function addOnChangeEvent(fields, tableName, callfunc) {
	for (var i = 0; i < fields.length; i++) {
		var field = fields[i];
		
		if (typeof field == "string") {
			if (tableName)
				field = tableName + "." + field;
			field = gel(field);
		}
		
		if (field && field.tagName)
			Event.observe(field, 'change', callfunc);
	}
}
function setColorSwatch(fieldName, gForm) {
	var g_form = typeof gForm !== "undefined" ? gForm : this.g_form;
	var colorValue = $(fieldName).value;
	var colorDisplay = $("color_swatch." + fieldName);
	
	try {
		colorDisplay.style.backgroundColor = colorValue;
	} catch (ex) {
		g_form.showErrorBox(fieldName, getMessage("Invalid color") + ":" + colorValue);
		$(fieldName).value = "";
		colorDisplay.style.backgroundColor = "";
	}
}
;
/*! RESOURCE: /scripts/functions_fontsizer.js */
function setPreferredFontSize(increment) {
	var ruleStart = "BODY, TABLE, INPUT, SELECT, BUTTON, INPUT.TEXT, TEXTAREA, INPUT.button {font-size: "
	var ruleEnd = "}";
			
	var t = g_fontSize;
	if (g_fontSizePreference) 
	  t = g_fontSizePreference;
	
	var  t = t.split('p')[0];
	t = parseInt(t) + increment; 
	if (6 > t || t > 18)
		return;
	t += "pt";
	if (g_fontSizePreference != t) {
		g_fontSizePreference = t;
		setPreference('font-size', g_fontSizePreference);  
	    var al = getFontWindowList();
	    for (var i =0; i != al.length; i++) {
	       var w = al[i];
	       if (typeof w.deleteStyleSheet == 'function') {
	    	   w.deleteStyleSheet("font_size");
	    	   w.createStyleSheet(ruleStart + t + ruleEnd, "font_size");
	       }
		}
	}	
   	
	deleteStyleSheet("font_size");	
	createStyleSheet(ruleStart + t + ruleEnd, "font_size");
if (increment) {
	  var e = $("font_pref_text");
	  if (e)
		  e.innerHTML = "(" + g_fontSizePreference + ")";
	}
	
	CustomEvent.fireAll("fontsize.change");
}
		
function getFontWindowList() {
	var answer = new Array();
	var m = getMainWindow();
	if (m)
		answer.push(m);
	
	var m = getMainFormWindow();
	if (m)
		answer.push(m);
	
	var m = getNavWindow();
	if (m)
		answer.push(m);
	
	return answer;
}
				
function deleteStyleSheet(id) {
	var sheet = document.getElementById(id);
	if (sheet) {
		var head = document.getElementsByTagName("head")[0];
		head.removeChild(sheet);
	}
}			
		
function createStyleSheet(cssText, id) {
   var head = document.getElementsByTagName("head")[0];
   var rules = document.createElement("style");
rules.setAttribute("type", "text/css");
   if(id)
       rules.setAttribute("id", id);
   if (navigator.userAgent.toLowerCase().indexOf("msie") >= 0) {
           head.appendChild(rules);
           var ss = rules.styleSheet;
           ss.cssText = cssText;
       } else {
           try{
                rules.appendChild(document.createTextNode(cssText));
           }catch(e){
               rules.cssText = cssText; 
           }
           head.appendChild(rules);
      }
}		
		
function setPreferredFont() { 
  var t = getPreference('font-size');
  if (!t) 
	return; 
  g_fontSizePreference = t;
  setPreferredFontSize(0); 
}		
;
/*! RESOURCE: /scripts/functions_attachments.js */
function addEllipsisStyle(fileNameAnchor) {
	fileNameAnchor.style.display = 'inline-block';
	fileNameAnchor.style.textOverflow = 'ellipsis';
	fileNameAnchor.style.whiteSpace = 'nowrap';
	fileNameAnchor.style.overflow = 'hidden';
	fileNameAnchor.style.verticalAlign = 'middle';
	fileNameAnchor.setAttribute('data-use-ellipsis',"true")
}
function addAttachmentNameToForm(sysid, name, hoverText, image, showRename, showView, showPopup) {
	name = convertDoubleQuoteToUTF8(name);
	var modified = $("attachments_modified");
	if (modified)
		modified.value = "true";
	showObjectInline($("header_attachment_list_label"));
	var line = $("header_attachment_line");
	if (line)
		line.setStyle({visibility: 'visible', display: ''});
	var span = $(cel('span'));
	span.id = "attachment_" + sysid;
	var thisURL = getCurrentPageURL();
span.innerHTML = '<a href="sys_attachment.do?sys_id=' + sysid  + '&sysparm_this_url=' + thisURL + '" title="' + hoverText + '" style="margin-right:4px;" tabindex="-1"><img src="' + image + '" alt="" /></a>';
	var txt = $(cel('a'));
	if ('innerText' in txt)
		txt.innerText = name;
	else
		txt.textContent = name;
	txt.href='#';
	txt.onkeydown = function(event){return allowInPlaceEditModification(txt, event);};
	getMessage("Download {0}", function(msg) {
		txt.setAttribute("aria-label", new GwtMessage().format(msg, name));
	});
	txt.href='sys_attachment.do?sys_id=' + sysid + '&sysparm_this_url=' + thisURL;
	txt.setAttribute('data-id', sysid);
	txt.style.display = 'inline';
	txt.inPlaceEdit({
		selectOnStart: true,
		turnClickEditingOff: true,
		onBeforeEdit: function() {
			txt.lastAriaLabel = txt.getAttribute("aria-label");
			txt.removeAttribute("aria-label");
			txt.setAttribute("role", "textbox");
		},
		onEditCancelled: function() {
			txt.removeAttribute("role");
			if (txt.lastAriaLabel) {
				txt.setAttribute("aria-label", txt.lastAriaLabel);
			}
		},
		onAfterEdit: function(newName) {
			var oldName = this.oldValue;
            var ga = new GlideAjax('AttachmentAjax');
            ga.addParam('sysparm_type', 'initialRename');
            ga.addParam('sysparm_value', sysid);
            ga.addParam('sysparm_name', newName);
            ga.getXML(function(response) {
                var answer = response.responseXML.documentElement.getAttribute("answer");
     	         if (answer !== '0')
                    alert(new GwtMessage().getMessage("Renaming attachment {0} to new name {1} is not allowed", oldName, newName));
     	        $$('a[data-id="' + sysid + '"]').each(function(elem){
     	        	if ('innerText' in elem)
     	        		elem.innerText = (answer === '0') ? newName : oldName;
     	        	else
     	        		elem.textContent = (answer === '0') ? newName : oldName;
                });
				updateAriaLabels(sysid, newName);
            });
            txt.removeAttribute("role");
		}
	});
	txt.style.marginRight = "5px";
	var attachList = $("header_attachment_list");
	if (attachList && attachList.hasClassName("with-ellipsis"))
		addEllipsisStyle(txt);
	span.appendChild(txt);
	if (showRename == 'true') {
		var renameAttachment = $(cel('a'));
		renameAttachment.className = 'attachment rename_' + sysid;
		renameAttachment.href="#";
		renameAttachment.setAttribute("role", "button");
		getMessage("Rename {0}", function(msg) {
			renameAttachment.setAttribute("aria-label", new GwtMessage().format(msg, name));
		});
		renameAttachment.onclick = function() {
	        txt.beginEdit();
	    };
		renameAttachment.innerHTML = getMessage('[rename]');
		renameAttachment.setAttribute('data-now-ux-metrics-event', "Apply Attachment Action");
		renameAttachment.setAttribute('data-now-ux-metrics-fileName', name);
		renameAttachment.setAttribute('data-now-ux-metrics-attachmentId', sysid);
		renameAttachment.setAttribute('data-now-ux-metrics-action', 'Rename');
		span.appendChild(renameAttachment);
	}
	if (showView == "true") {
        var blank = document.createTextNode(" ");
        span.appendChild(blank);
        var view = cel("a");
        view.href="#";
		var setAriaLabel = function(msg) {
			view.setAttribute("aria-label", new GwtMessage().format(msg, name));
		};
		var downloadAttachment = NOW && NOW.g_forceDownloadAttachments;
		if (downloadAttachment)
			getMessage("Download {0}", setAriaLabel);
		else
			getMessage("View {0}", setAriaLabel);
		var newText = document.createTextNode(downloadAttachment ? getMessage("[download]") : getMessage("[view]"));
		view.setAttribute('data-now-ux-metrics-event', "Apply Attachment Action");
		view.setAttribute('data-now-ux-metrics-fileName', name);
		view.setAttribute('data-now-ux-metrics-attachmentId', sysid);
		view.setAttribute('data-now-ux-metrics-action', downloadAttachment ? 'Download' : 'View');
        view.appendChild(newText);
        view.className = "attachment view_" + sysid;
        if (showPopup == "false")
            view.href = "sys_attachment.do?sys_id=" + sysid + "&view=true";
        else
            view.onclick = function() {
                tearOffAttachment(sysid)
            };
        span.appendChild(view);
        span.appendChild(blank);
	}
	var storage = cel('li');
	storage.className = 'attachment_list_items';
	storage.appendChild(span);
	if (attachList)
		attachList.appendChild(storage);
    var header_attachment = $('header_attachment');
    if (header_attachment) {
    	_frameChanged();
    }
    var ga = new GlideAjax('AttachmentAjax');
    ga.addParam('sysparm_type', 'attachmentParentSysId');
    ga.addParam('sysparm_value', sysid);
    ga.getXMLAnswer(changeCount, null, 'increase');
	addEllipsesToAttachments();
	adjustAttachmentsVisibility();
}
function getCurrentPageURL() {
	return encodeURIComponent(window.location.pathname.substr(1) + window.location.search);
}
function updateAriaLabels(sysid, newName) {
	getMessage(["Download {0}", "View {0}", "Rename {0}"], function(msg) {
		var newDownloadText = new GwtMessage().format(msg["Download {0}"], newName);
		var newViewText = new GwtMessage().format(msg["View {0}"], newName);
		var newRenameText = new GwtMessage().format(msg["Rename {0}"], newName);
		$$('a[data-id="' + sysid + '"]').each(function(elem) {
			elem.setAttribute("aria-label", newDownloadText);
		})
		$$('.view_' + sysid).each(function(elem) {
			elem.setAttribute("aria-label", newViewText);
		})
		$$('.rename_' + sysid).each(function(elem) {
			elem.setAttribute("aria-label", newRenameText);
		})
	});
}
function addEllipsesToAttachments() {
	var list = document.getElementById('header_attachment_list');
	if (!list)
		return;
	var more = document.getElementById('more_attachments');
	if (more) {
		if (list.scrollHeight > list.clientHeight * 2)
			setElementStyle(more, 'display:block');
		else
			setElementStyle(more, 'display:none');
	}
}
function setElementStyle(elm, rules) {
	window.requestAnimationFrame(function() {
		elm.style.cssText = rules;
	});
}
function addAttachmentNameToDialog(id, fileName, canDelete, createdBy, createdOn, contentType, iconPath) {
	if ($('attachment') == null)
		return;
	var encryptCheck = gel("encrypt_checkbox");
	if (encryptCheck) {
		encryptCheck.checked = false;
		$('sysparm_encryption_context').value = "";
	}
	gel("please_wait").style.display = "none";
	if (typeof id == "undefined")
		return;
	var noAttachments = gel("no_attachments");
	if (noAttachments.style.display == "block")
		noAttachments.style.display = "none";
	  var table = gel("attachment_table_body");
	  var tr = cel("tr");
	  var td = cel("td");
	  td.style.whiteSpace = "nowrap";
	  td.colspan = "2";
	  if (canDelete) {
	     var input = cel("input");
	     var checkId = "sys_id_" + id;
	     input.name = checkId;
	     input.id = checkId;
	     input.type = "checkbox";
	     input.onclick = function() {setRemoveButton(gel(checkId));};
	     td.appendChild(input);
	     gel("delete_button_span").style.display = "inline";
	     var text = document.createTextNode(" ");
	     td.appendChild(text);
	     input = cel("input");
	     input.type = "hidden";
	     input.name = "Name";
	     input.value = "false";
	     td.appendChild(input);
	  }
	  var anchor = cel("a");
	  anchor.style.marginRight = "4px";
	  var thisURL = getCurrentPageURL();
	  anchor.href = "sys_attachment.do?sys_id=" + id + "&sysparm_this_url=" + thisURL;
	  anchor.title = " " + createdBy + "  " + createdOn;
	  var imgSrc = iconPath;
	  var img = cel("img");
	  img.src = imgSrc;
	  img.alt = anchor.title;
	  anchor.appendChild(img);
	  var text = $(cel('a'));
	  text.style.display = "inline";
	  getMessage("Download {0}", function(msg) {
		  text.setAttribute("aria-label", new GwtMessage().format(msg, fileName));
	  });
	  text.href='#';
	  text.href = "sys_attachment.do?sys_id=" + id + "&sysparm_this_url=" + thisURL;
	  text.onkeydown = function(event){return allowInPlaceEditModification(text, event);};
	  text.style.marginRight = "5px";
	  text.style.maxWidth = "75%";
	  text.style.display = "inline-block";
	  text.style.overflow = "hidden";
	  text.style.verticalAlign = "middle";
	  if ('innerText' in text)
	      text.innerText = fileName;
	  else
	      text.textContent = fileName;
	  text.setAttribute("data-id", id);
	  text.inPlaceEdit({
	      selectOnStart: true,
	      turnClickEditingOff: true,
		  onBeforeEdit: function() {
			  text.lastAriaLabel = text.getAttribute("aria-label");
			  text.removeAttribute("aria-label");
			  text.setAttribute("role", "textbox");
		  },
		  onEditCancelled: function() {
			  text.removeAttribute("role");
			  if (text.lastAriaLabel) {
				  text.setAttribute("aria-label", txt.lastAriaLabel);
			  }
		  },
		  onAfterEdit: function(newName) {
	          var ga = new GlideAjax('AttachmentAjax');
	          ga.addParam('sysparm_type', 'rename');
	          ga.addParam('sysparm_value', id);
	          ga.addParam('sysparm_name', newName);
	          ga.getXML();
	          $$('a[data-id="' + id + '"]').each(function(elem){
	              if ('innerText' in elem)
	                  elem.innerText = newName;
	              else
	                  elem.textContent = newName;
	          });
	          $$('span[data-id="' + id + '"]').each(function(el){
	              if ('innerText' in el)
	                  el.innerText = newName;
	              else
	                  el.textContent = newName;
	          });
	          updateAriaLabels(id, newName);
			  text.removeAttribute("role");
	      }
	  });
if (contentType == "text/html")
	     anchor.target = "_blank";
	  td.appendChild(anchor);
	  td.appendChild(text);
	  if ($('ni.show_rename_link').value) {
		  var renameAttachment = $(cel('a'));
		  renameAttachment.className = 'attachment';
		  renameAttachment.href = '#';
		  renameAttachment.setAttribute("role", "button");
		  getMessage("Rename {0}", function(msg) {
			  renameAttachment.setAttribute("aria-label", new GwtMessage().format(msg, fileName));
		  });
		  renameAttachment.onclick = function() {
		    text.beginEdit();
		  };
		  renameAttachment.innerHTML = getMessage('[rename]');
		  td.appendChild(renameAttachment);
	  }
	  var showView = gel("ni.show_attachment_view").value;
	  if (showView == "true") {
	      var blank = document.createTextNode(" ");
	      tr.appendChild(blank);
	      var view = cel("a");
	      href="#";
	      var setAriaLabel = function(msg) {
	    	  	view.setAttribute("aria-label", new GwtMessage().format(msg, name));
	      };
		  var downloadAttachment = NOW && NOW.g_forceDownloadAttachments;
		  if (downloadAttachment)
			getMessage("Download {0}", setAriaLabel);
	      else
			getMessage("View {0}", setAriaLabel);
		  var newText = document.createTextNode(downloadAttachment ? getMessage("[download]") : getMessage("[view]"));
	      view.appendChild(newText);
	      view.className = "attachment";
	      if (showPopup == "false")
	          view.href = "sys_attachment.do?sys_id=" + id + "&view=true";
	      else
	          view.onclick = function() {
	              tearOffAttachment(id)
	          };
	      td.appendChild(blank);
	      td.appendChild(view);
	  }
	  var showPopup = gel("ni.show_attachment_popup").value;
	  tr.appendChild(td);
	  table.appendChild(tr);
	  var alert508 = "$[GlideAccessibility.isEnabled()]";
	  if (alert508 == 'true')
	    alert(fileName + " " + anchor.title);
}
function computeAttachmentWidth() {
	var temp = $('header_attachment_list').select('li');
	var totalWidth = 0;
	for (var i = 0; i < temp.length; i++) {
		totalWidth += temp[i].getWidth();
	}
	return totalWidth;
}
function updateAttachmentCount(sysid) {
	var ga = new GlideAjax('AttachmentAjax');
    ga.addParam('sysparm_type', 'attachmentCount');
    ga.addParam('sysparm_value', sysid);
ga.getXMLAnswer(numberOfAttachments, null, sysid);
}
function numberOfAttachments(answer, sysid) {
	var number = parseInt(answer);
	var buttons = $$('.attachmentNumber_' + sysid);
	if (buttons[0] == undefined)
		$('header_attachment_list_label').down().innerHTML = number;
	else {
		for (var i = 0; i < buttons.length; i++) {
			buttons[i].innerHTML = number;
		}
	}
}
function getCurrentAttachmentNumber(sysid) {
	if ($$('.attachmentNumber_' + sysid)[0] == undefined) {
		if ($('header_attachment_list_label') == undefined)
			return undefined;
		else
			return $('header_attachment_list_label').down().innerHTML;
	}
	return $$('.attachmentNumber_' + sysid)[0].innerHTML;
}
function updateAttachmentCount2(number, sysid) {
	var buttons = $$('.attachmentNumber_' + sysid);
	if (buttons[0] == undefined)
		$('header_attachment_list_label').down().innerHTML = number;
	else {
		for (var i = 0; i < buttons.length; i++) {
			buttons[i].innerHTML = number;
		}
	}
	showHidePlusMore(number);
}
function getVisibleAttachmentsLimit() {
	return window.NOW.attachment.overflow_limit || 3;
}
function getPlusMoreAttachmentList() {
	var attachList = $("header_attachment_list");
	return !attachList || !attachList.hasClassName("with-plus-more") ? false : attachList;
}
function showHidePlusMore(number) {
	var header_attachment = $('header_attachment');
	if (!header_attachment)
		return;
	var plusMore = header_attachment.down('.plus_more');
	var limit = getVisibleAttachmentsLimit();
	plusMore.down('.badge').innerHTML = "+" + (number - limit);
	if (number <= limit)
		plusMore.addClassName("hidden");
	else
		plusMore.removeClassName("hidden");
	adjustAttachmentsVisibility();
}
function adjustAttachmentsVisibility() {
	var attachList = getPlusMoreAttachmentList();
	if (!attachList)
		return;
	var attachmentsFound = 0;
	var limit = getVisibleAttachmentsLimit();
	attachList.select('.attachment_list_items').each(function(elem) {
		var attachment = elem.down('span');
		if (attachment && attachment.innerHTML)
			attachmentsFound++;
		if (attachmentsFound <= limit)
			elem.removeClassName('hidden');
		else
			elem.addClassName('hidden');
	});
}
function changeCount(sysid, type) {
	var number = getCurrentAttachmentNumber(sysid);
	if (number != undefined) {
		if (type == 'increase')
			number++;
		else
			number--;
		updateAttachmentCount2(number, sysid);
	}
}
function deleteAttachment(sysid) {
	var gr = new GlideRecord('sys_attachment');
	var parentRecord = recordAttachmentBelongsTo(sysid);
	gr.addQuery('sys_id', sysid);
	gr.query();
	if (gr.next()) {
		if (confirmDeletion(gr.file_name, sysid)) {
			var ol = GlideOverlay.get('attachment_manager_overlay');
			alert(ol._box.select('div[data-id="' + sysid + '"]')[0].up().up().inspect());
			ol._box.select('div[data-id="' + sysid + '"]')[0].up().up().remove();
			ol.autoDimension();
			$("attachment_" + sysid).remove();
			if (numberOfAttachments(gr.table_sys_id) == 1) {
			    hideObject($("header_attachment_list_label"));
			    var line = $("header_attachment_line");
			    if (line) {
			    	line.setStyle({
			    		visibility: "hidden",
			    		display: "none"
			    	});
			    }
			    $("header_attachment").style.height = "auto";
			   ol.close();
			}
			gr.deleteRecord();
			updateAttachmentCount(parentRecord);
		}
	}
}
function saveAttachment(tableName, sys_id, allowAttachment) {
	var g_dialog = new GlideModal('attachment', false, 500);
    g_dialog.setTitle(getMessage('Attachments'));
	g_dialog.setPreference('target_table', tableName);
	g_dialog.setPreference('target_sys_id', sys_id);
	g_dialog.setPreference('focusTrap', true);
	if (allowAttachment)
		g_dialog.setPreference('sc_override', 'true');
	g_dialog.setPreference('attachment_disabled',
			(window["AttachmentUploader"] ?  AttachmentUploader.isAttachmentDisabled() : "false"));
	g_dialog.setPreference('focusTrap', true);
	g_dialog.on("closeconfirm", _saveAttachmentConfirm);
    g_dialog.render();
}
function _saveAttachmentConfirm(dialog) {
	var attachmentRows = $$('.attachmentRow');
	var value = '';
	for (var i = 0; i < attachmentRows.length; i++) {
		if (isMSIE) {
			var files = attachmentRows[i].select('input')[0].getValue();
			if (!files.empty())
				value += files + "\n";
		} else {
			var files = attachmentRows[i].select('input')[0].files;
			for (var j = 0; j < files.length; j++) {
				if (files[j] != null) {
					value += files[j].name + "\n";
				}
			}
		}
	}
	if (!value.empty())
		if (!confirm(getMessage("Close before uploading attachments?") + "\n" + value.substring(0, value.length - 1)))
			return false;
	_saveAttachmentClose();
	return true;
}
function _saveAttachmentClose() {
	var modified = $("attachments_modified");
	if (modified) {
		var attachmentsModified = modified.value;
		if (attachmentsModified != "true")
			return;
	}
if (typeof g_form == "undefined")
		return;
	if (g_form.newRecord) {
g_form.modified = true;
		CustomEvent.fireAll('form.isModified', {uniqueValue: g_form.getUniqueValue(), isModified: g_form.modified, iframeElId: window.frameElement ? window.frameElement.id : null});
	}
	if (typeof GlideLists2 == "undefined")
		return;
    for (var id in GlideLists2) {
        var list = GlideLists2[id];
        if (list.getTableName() === 'sys_attachment')
            list.refresh();
    }
}
function allowInPlaceEditModification(elem, event) {
	var length = (elem.textContent != null) ? elem.textContent.length : elem.innerText.length;
	var max_length = maximumCharacterLimit();
	if (length >= max_length) {
		var keyCode = (event) ? event.keyCode : window.event.keyCode;
		switch (keyCode) {
		 case Event.KEY_LEFT:
		 case Event.KEY_RIGHT:
		 case Event.KEY_UP:
		 case Event.KEY_DOWN:
		 case Event.KEY_BACKSPACE:
		 case Event.KEY_DELETE:
			return true;
		 default:
			var key = "Filename has reached the character limit of {0}";
			var gMessage = new GwtMessage();
			gMessage.fetch([key], function(msgs) {
				var msg = gMessage.format(msgs[key], max_length);
				alert(msg);
			});
			return false;
		}
	}
	return true;
}
function maximumCharacterLimit() {
	   var f = $('header_attachment_list');
	   if (f)
		   return f.getAttribute('data-max-filename-length');
	   return 100;
}
function confirmDeletion(file_name, sysid) {
	var r = confirm("Are you sure you want to delete "
			+ file_name
			+ "?");
	return r;
}
function saveFileAttachment(tableName, gotourl) {
	var form = document.forms[tableName+'.do'];
	var viewwidget = form['sysparm_view'];
	if (viewwidget)
		gotourl += '&sysparm_view=' + viewwidget.value;
	form.sys_action.value = 'sysverb_check_save';
	addInput(form, 'HIDDEN', 'sysparm_goto_url', gotourl);
	var okToSubmit = true;
	var mandatoryAttachmentElements = g_form.elements.filter(function(element) {
		return (element.getType() === 'file_attachment' || element.getType() === 'user_image') && element.isMandatory();
	});
	mandatoryAttachmentElements.forEach(function(element) {
		element.setMandatory(false);
	});
	if (typeof form.onsubmit == "function")
		okToSubmit = form.onsubmit();
	mandatoryAttachmentElements.forEach(function(element) {
		element.setMandatory(true);
	});
	if (okToSubmit) {
		g_form.enableUIPolicyFields();
		CustomEvent.fireTop("glide:form_submitted");
		form.submit();
	}
	return false;
}
function deleteFileAttachment(attachment_id, table_name, source_field, source_id) {
	var field_input_id = table_name.concat('.',source_field);
    var ajax = new GlideAjax("AttachmentAjax");
	ajax.addParam("sysparm_value", attachment_id);
	ajax.addParam("sysparm_table_name", table_name);
	ajax.addParam("sysparm_source_field", source_field);
	ajax.addParam("sysparm_source_id", source_id);
	ajax.addParam("sysparm_type", "delete");
	ajax.getXML(doNothing);
	var attachmentspan = $(attachment_id + "_attachment");
	if (attachmentspan)
		attachmentspan.parentNode.removeChild(attachmentspan);
	if (field_input_id) {
		var editdiv = gel('edit.' + field_input_id);
		if (editdiv)
			editdiv.parentNode.removeChild(editdiv);
		var noattachmentspan = $(field_input_id + "_noattachment");
		if (noattachmentspan)
			noattachmentspan.style.visibility = "visible";
		var input = gel(field_input_id);
		if (input && input.value) {
			input.value = '';
			onChangeLabelProcess(field_input_id);
		}
	}
	return false;
}
function pushNotAvailableMessage(attachmentName) {
g_form.addErrorMessage(new GwtMessage().getMessage("The file <b> {0} </b> did not pass security scan and cannot be downloaded", attachmentName.escapeHTML()));
}
function validateSizeAndExt(field) {
	var form = $('attach_new_file');
	var maxSize = (form.max_size && form.max_size.value) ? form.max_size.value : 0;
	var fileTypes = (form.file_types && form.file_types.value) ? form.file_types.value : "";
	var file = field.files[0];
	var gMessage = new GwtMessage();
	var allowedSize = maxSize * 1048576;
	var warningMessages = [];
	if (file.size === 0)
		warningMessages.push(gMessage.getMessage("Attachment is empty."));
	if (file.size > allowedSize && allowedSize !== 0)
		warningMessages.push(gMessage.getMessage("{0} is {1}. The maximum file size is {2}.", file.name, getDisplaySize(file.size), getDisplaySize(allowedSize)));
	var fileExtension = file.name.split(".").length > 1 ? file.name.split(".").pop() : "";
	var allowedExtensions = fileTypes.length === 0 ? [] : fileTypes.split(",");
	var allowedExtensionsLength = allowedExtensions.length;
	var validExtension = allowedExtensionsLength === 0;
	for (var i=0; i < allowedExtensionsLength; i++) {
		if (fileExtension.toLowerCase() === allowedExtensions[i].trim().toLowerCase()) {
			validExtension = true;
			break;
		}
	}
	if (!validExtension)
		warningMessages.push(gMessage.getMessage("{0} has a prohibited file extension.", file.name));
	if (warningMessages.length > 0) {
		alert(warningMessages.join("\n"));
		field.clear();
	}
}
;
/*! RESOURCE: /scripts/functions_calendar.js */
function nextCalendarAction(duration, year, month, day, calendarID, styleField, event) {
  	var form = document.getElementsByName('dash_form')[0];
  	if (form) {
	  	var name = form.dashboard_name.value;
	  	var url = "sys_dashboard_template.do?";
	  	url += "sysparm_query=name=" + name;
	  	url += "&sysparm_calview="+duration;
	  	url += "&sysparm_year="+year;
	  	url += "&sysparm_month="+month;
	  	url += "&sysparm_day="+day;
		var viewwidget = form['sysparm_view'];
		if (viewwidget)
			url += '&sysparm_view=' + viewwidget.value;
	  	window.location = url; 
  	} else {
	  	form = document.getElementsByName('calendarform')[0];
	  	if (form == null) {
	  		if (typeof $j != "undefined" && calendarID != null && calendarID.length) {
		  		var element = event.srcElement;
				if (!element)
					element = event.target;
				var content = $j(element).closest(".report_content");
				if (content.length) {
					var cstyle = null;
	                media = document.getElementsByName('sysparm_calstyle_choice');
	                if (media != null) {
	                    for (var i = 0; i < media.length; i++) {
	                        var r = media[i];
	                        if (r.checked) {
	                            cstyle = r.value;
	                            break;
	                        }
	                    }
	                }
	                if (!cstyle) {
	                	media = $("sysparm_calstyle" + calendarID);
	                	if (media != null)
	                		cstyle = media.value;
	                }
					
					var params = "sysparm_calview=" + duration;
					params += "&sysparm_year=" + year;
					params += "&sysparm_month=" + month;
					params += "&sysparm_day=" + day;
					params += "&sysparm_calstyle=" + cstyle;
	           		drillReport(content.parent(), calendarID, "", params);
					return;
				}
		  	}
	  	    form = document.getElementsByName('reportform_control')[0];
	  	}
	  	if (form == null) {	  	    
	  	    form = document.getElementsByName('history')[0];
	  	    if (form != null) {	      
		    	addInput(form, 'HIDDEN', 'sysparm_stack', "no");
		    }
	  	}
	  	
	  	if (form != null) {
		  	addInput(form, 'HIDDEN', 'sysparm_calview', duration);
		  	addInput(form, 'HIDDEN', 'sysparm_year', year);
		  	addInput(form, 'HIDDEN', 'sysparm_month', month);
		  	addInput(form, 'HIDDEN', 'sysparm_day', day);
		  	var media = $('sysparm_media');
		  	if (media != null) {
		     	addInput(form, 'HIDDEN', 'sysparm_media', media.value);
		  	}
		  	media = $('sysparm_view');
		  	if (media != null) {
		     	addInput(form, 'HIDDEN', 'sysparm_view', media.value);
		  	}
		    media = document.getElementsByName('sysparm_calstyle_choice');
		    if (media != null) {
		       for (var i = 0; i < media.length; i++) {
		          var r = media[i];
		          if (r.checked) {
		             addInput(form, 'HIDDEN', 'sysparm_calstyle', r.value);
		             break;
		          }
		  	   }
		  	}
		  	media = $('sysparm_calstyle');
		  	if (media != null) {
		     	addInput(form, 'HIDDEN', 'sysparm_calstyle', media.value);
		  	}
	  	    if (typeof form.onsubmit == "function")
		  	   form.onsubmit();
	  		form.submit();
	  	} else {
	  	    var url = "calendar_view.do?";
	    	url += "sysparm_calview="+duration;
	    	url += "&sysparm_year="+year;
	    	url += "&sysparm_month="+month;
	    	url += "&sysparm_day="+day;
	    	if (styleField)
	    	   url += "&sysparm_calstyle="+styleField;
	  		window.location = url; 
	  	}
    }
}
;
/*! RESOURCE: /scripts/functions_email.js */
function sendEmail() {
    var form = document.forms['emailclient'];
	addInput(form, 'HIDDEN', 'EMAIL-CLIENT', 'send');
    if (typeof form.onsubmit == "function") {
      form.onsubmit();  
    }
    form.submit();
}
function mailTo(field) {
	var nameField = $(field);
	
	if (nameField && nameField.value) {
		window.top.location = "mailto:" + nameField.value;
	}
}
function setCannedText(selectBox) {
	var theOption = selectBox.options[selectBox.selectedIndex];
	var messageText = theOption.value;
	var body = $('message.text');
	if (tiny_html_editor && typeof tinymce != "undefined") {
		tinymce.EditorManager.activeEditor.setContent(messageText);
	} else {
		body.value = messageText;
		if (body.htmlArea)
			body.htmlArea._doc.body.innerHTML = messageText;
	}
}
function appendCannedText(selectBox) {
	var theOption = selectBox.options[selectBox.selectedIndex];
	var messageText = theOption.value;
	if (!tiny_html_editor || typeof tinymce == "undefined") {
		return;
	}
	tinymce.EditorManager.activeEditor.execCommand('mceInsertContent', false, messageText);
	jQuery(selectBox).select2("val",'');
}
function isEmailValid(value){
	var problemMsg = isEmailValidWithReason(value);
	if (problemMsg != "") {
		jslog("isEmailValid: " + problemMsg);
		return false;
	}
	return true;
}
function isEmailValidWithReason(value) {
var localPartChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%*/?|^{}`~&'+-=_.";
	var domainChars =    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.";
	var blackListedLocalCharctersString = "(),:;<>@[] ";
var blackListedDomainCharctersString = "(),:;<>@[]!#$%*/?|^{}`~&'+= ";
	var ifRFC6530Enabled = isRFC6530Enabled();
	if (value.indexOf("@") == -1)
		return "missing @ sign";
	var s = value.split("@");
	if (s.length != 2)
		return "too many at signs";
	var doesLocalPartContainsInvalidChars = ifRFC6530Enabled?containsAnyCharacter(blackListedLocalCharctersString, s[0]) : !containsOnlyChars(localPartChars, s[0]);
	if (doesLocalPartContainsInvalidChars)
		return "invalid character before the at sign";
	if (s[0].length < 1)
		return "at least one character must be before the at sign";
	if (s[0].substr(0,1) == ".")
		return "period cannot be the first character";
	if (s[0].substr(s[0].length-1,1) == ".")
		return "period cannot be the last character before the at sign";
	var localPeriods = s[0].split(".");
	for(var i=0;i<localPeriods.length;i++){
		if(!localPeriods[i].length>0){
			return "local address contains dot-dot";
		}
	}
	var doesDomainPartContainsInvalidChars = ifRFC6530Enabled?containsAnyCharacter(blackListedDomainCharctersString, s[1]) : !containsOnlyChars(domainChars, s[1]);
	if (doesDomainPartContainsInvalidChars)
		return "invalid character after the at sign";
	var periodIndex = s[1].indexOf(".");
	if (periodIndex == -1)
		return "missing period after the at sign";
	if (periodIndex == 0)
		return "period cannot be the first character after the at sign";
	var periods = s[1].split(".");
	for(var i=0;i<periods.length;i++){
		if(!periods[i].length>0){
			return "domain contains dot-dot";
		}
	}
	var lastPeriod = periods[periods.length-1];
	if (lastPeriod.length < 1)
		return "must be at least 1 character after the last period";
	if (!isAlphaNum(s[1].substr(0,1)) && !ifRFC6530Enabled)
		return "the first character after the at sign must be alphanumeric";
	if (!isAlphaNum(s[1].substr(s[1].length-1,1)) && !ifRFC6530Enabled)
		return "the last character must be alphanumeric";
return "";
}
function isRFC6530Enabled() {
	if (!window.rfc6530Enabled) {
		var ga = new GlideAjax('AJAXEmailAddressValidator');
		ga.addParam('sysparm_name', 'checkIfRFC6530IsEnabled');
		ga.getXMLWait();
		return window.rfc6530Enabled = ga.getAnswer() === 'true';
	}
	return window.rfc6530Enabled;
}
function containsAnyCharacter(blacklistedCharacterString, charcterString){
	for (let char of charcterString) {
		if (blacklistedCharacterString.includes(char)) {
			return true;
		}
	}
	return false;
}
;
/*! RESOURCE: /scripts/functions_user_image.js */
function saveUserImage(tableName, gotourl) {
	var sysparmRecordScope = g_form.getValue("sysparm_record_scope");
	gotourl = gotourl.replace("$sysparm_record_scope", sysparmRecordScope);
	var sysparmTransactionUpdateset = g_form.getValue("sysparm_transaction_update_set");
	gotourl = gotourl.replace("$sysparm_transaction_update_set", sysparmTransactionUpdateset);
	var form = document.forms[tableName+'.do'];
	var viewwidget = form['sysparm_view'];
	if (viewwidget)
		gotourl += '&sysparm_view=' + viewwidget.value;
	form.sys_action.value = 'sysverb_check_save';
	addInput(form, 'HIDDEN', 'sysparm_goto_url', gotourl);
	var okToSubmit = true;
	if (typeof form.onsubmit == "function") {
		var mandatoryAttachmentElements = g_form.elements.filter(function(element) {
			return (element.getType() === 'file_attachment' || element.getType() === 'user_image') && element.isMandatory();
		});
		mandatoryAttachmentElements.forEach(function(element) {
			element.setMandatory(false);
		});
		okToSubmit = form.onsubmit();
		mandatoryAttachmentElements.forEach(function(element) {
			element.setMandatory(true);
		});
	}
	  
	if (okToSubmit)
		form.submit();
	return false;
}
function validateVideoFile(fileExtensions) {
	var file = getAttachedFile();
	var isValid = validateWithExtensions(file.value, fileExtensions);
	if (!isValid) {
		alert(file.value + " isn't a recognized video format");
		file.clear();
		return false;
	}
	isValid = validateSize(file);
	return isValid;
}
function validateAudioFile(fileExtensions) {
	var file = getAttachedFile();
	var isValid = validateWithExtensions(file.value, fileExtensions);
	if (!isValid) {
		alert(file.value + " isn't a recognized audio format");
		file.clear();
		return false;
	}
	isValid = validateSize(file);
	return isValid;
}
function getAttachedFile() {
	var widget = $("attachFile");
	if (!widget)
		return false;
	return widget;
}
function validateWithExtensions(fileName, fileExtensions) {
	var action = $('sys_action');
	if ('sysverb_cancel' == action.value)
		return true;
	return endsWithVideoExtension(fileName, fileExtensions);
}
function endsWithVideoExtension(fileName, fileExtensions) {
	var extensionArray = fileExtensions.split(",");
	var dot = fileName.lastIndexOf('.')+1;
	var suffix = fileName.substring(dot);
	suffix = suffix.toLowerCase();
	for (var i = 0; i < extensionArray.length; i++) {
	  var element = extensionArray[i];
	  if (element == suffix)
	  	return true;
	}
	return false;	
}
function validateImageFile() {
	var action = $('sys_action');
	if ('sysverb_cancel' == action.value)
		return true;
	var file = getAttachedFile();
	var isValid = endsWithImageExtension(file.value);
	if (!isValid) {
		alert(file.value + " isn't a recognized image file format");
		file.clear();
		return false;
	}
	var hasValidSize = validateSize(file);
	$('fileNamePlaceholder').innerText = getFileName(file.value);
	return hasValidSize;
}
var VALID_IMAGE_SUFFIX = ["jpg", "jpeg", "png", "bmp", "gif", "ico", "svg"];
function endsWithImageExtension(filename) {
	var dot = filename.lastIndexOf('.')+1;
	var suffix = filename.substring(dot);
	suffix = suffix.toLowerCase();
	for (var i = 0; i < VALID_IMAGE_SUFFIX.length; i++) {
	  var element = VALID_IMAGE_SUFFIX[i];
	  element = element.toLowerCase();
	  if (element == suffix)
	  	return true;
	}
	return false;	
}
function getFileName(filePath) {
return filePath.replace(/^.*[\\\/]/, '');
}
function getDisplaySize(sizeInBytes) {
var kilobytes = Math.round(sizeInBytes / 1024);
	if (kilobytes < 1)
		kilobytes = 1;
	var reportSize = kilobytes + "K";
	if (kilobytes > 1024)
reportSize = Math.round(kilobytes / 1024) + "MB";
	return reportSize;
}
function validateSize(input){
	var form = $('attach_new_file');
	var maxSize = (form.max_size && form.max_size.value) ? form.max_size.value : 1024;
	var file = input.files[0];
	var allowedSize = maxSize * 1048576;
	var warningString = "";
	if (file.size == 0){
		warningString += "Attachment is empty";
	}
	if (file.size > allowedSize){
		warningString += file.name + " is " + getDisplaySize(file.size) + ". The maximum file size is " + getDisplaySize(allowedSize) + ".\n";
	}
	if (warningString != "") {
		alert(warningString);
		input.clear();
		return false;
	}
	return true;
}
function deleteUserImage(image_id, table_name, source_field, source_id) {
    var ajax = new GlideAjax("AttachmentAjax");
	ajax.addParam("sysparm_value", image_id);
	ajax.addParam("sysparm_table_name", table_name);
	ajax.addParam("sysparm_source_field", source_field);
	ajax.addParam("sysparm_source_id", source_id);
	ajax.addParam("sysparm_type", "delete");
	ajax.getXML(doNothing);
		
	var image = $(image_id);	
	if (image) {
image.src = "images/s.gif";
		image.alt = "";
	}
	var delspan = $(image_id+"_delete");
	if (delspan)
		delspan.innerHTML = '';	
	
	var addanchor = $(image_id+"_update");
	if (addanchor)
		addanchor.innerHTML = "";
	
	var imagespan = $(image_id+"_image");
	if (imagespan)
		imagespan.style.visibiity = "hidden";
	
	var noimagespan = $(image_id+"_noimage");
	if (noimagespan)
		noimagespan.style.visibility = "";
	
	return false;
}
;
/*! RESOURCE: /scripts/formatting.js */
function formatPhone(field) {
	field.value = trim(field.value);
	var ov = field.value;
	var v = "";
	var x = -1;
if (0 < ov.length && '+' != ov.charAt(0)) {
		var n = 0;
		if ('1' == ov.charAt(0))
ov = ov.substring(1, ov.length);
		for (var i = 0; i < ov.length; i++) {
			var ch = ov.charAt(i);
			if (ch >= '0' && ch <= '9') {
				if (n == 0)
					v += "(";
				else if (n == 3)
					v += ") ";
				else if (n == 6)
					v += "-";
				v += ch;
				n++;
			}
			if (! (ch >= '0' && ch <= '9') && ch != ' ' && ch != '-' && ch != '.' && ch != '(' && ch != ')') {
				x = i;
				break;
			}
		}
		if (x >= 0)
			v += " " + ov.substring(x, ov.length);
		if (n == 10 && v.length <= 40)
			field.value = v;
	}
	return true;
}
function formatClean(num) {
	var sVal = '';
	var nVal = num.length;
	var sChar = '';
	var nChar = '';
	try {
		for (var i = 0; i < nVal; i++) {
			sChar = num.charAt(i);
			nChar = sChar.charCodeAt(0);
			if (sChar == '-' || sChar == getDecimalSeparator() || ((nChar >= 48) && (nChar <= 57)))
				sVal += num.charAt(i);
		}
	}
	catch (exception) {
		alertError("formatClean", exception);
	}
	return sVal;
}
function formatCurrency(num) {
	var sVal = '';
	var minus = '';
	if (num.lastIndexOf("-") == 0)
		minus = '-';
	if (num.lastIndexOf(".") < 0)
		num = num + '00';
	num = formatClean(num);
	sVal = minus + formatDollar(num, getGroupingSeparator()) + getDecimalSeparator() + formatCents(num);
	return sVal;
}
function formatNumber(num) {
	if (num.length == 0)
		return num;
	num = num + "";
	var sVal = '';
	var minus = '';
	var samount = '';
	try {
		if (num.lastIndexOf("-") == 0)
			minus = '-';
		num = formatClean(num);
		if (num.indexOf("-") == 0)
num = num.substring(1);
		num = "0" + num;
		var fraction = parseFraction(num + "");
		num = parseInt(num, 10);
		samount = num + "";
for (var i = 0; i < Math.floor((samount.length - (1 + i)) / 3); i++)
			samount = samount.substring(0, samount.length - (4 * i + 3)) + getGroupingSeparator() + samount.substring(samount.length - (4 * i + 3));
		if (fraction.length > 0) {
			fraction = getDecimalSeparator() + fraction;
			samount += fraction;
		}
	} catch (exception) {
		alertError("Format Number", exception);
	}
return minus + samount;
}
function parseFraction(num) {
	var index = num.indexOf(getDecimalSeparator());
	if (index == -1)
		return "";
	return num.substring(index + 1);
}
function formatCents(amount) {
	var cents = '';
	try {
		amount = parseInt(amount, 10);
		var samount = amount + "";
		if (samount.length == 0)
			return '00';
		if (samount.length == 1)
			return '0' + samount;
		if (samount.length == 2)
			return samount;
		cents = samount.substring(samount.length - 2, samount.length);
	}
	catch (exception) {
		alertError("Format Cents", e);
	}
	return cents;
}
function formatDollar(amount) {
	var samount = "";
	try {
		amount = parseInt(amount, 10);
		samount = amount + "";
		if (samount.length < 3)
			return 0;
		samount = samount.substring(0, samount.length - 2);
for (var i = 0; i < Math.floor((samount.length - (1 + i)) / 3); i++)
			samount = samount.substring(0, samount.length - (4 * i + 3)) + getGroupingSeparator() + samount.substring(samount.length - (4 * i + 3));
	}
	catch (exception) {
		alertError("Format Dollar", e);
	}
	return samount;
}
function padLeft(value, width, fill) {
	value = value + '';
	while (value.length < width)
		value = fill + value;
	return value;
}
function getDecimalSeparator() {
	if (g_user_decimal_separator)
		return g_user_decimal_separator;
	return ".";
}
function getGroupingSeparator() {
	if (g_user_grouping_separator)
		return g_user_grouping_separator;
	return ",";
}
function alertError(MethodName, e) {
	let gwt = new GwtMessage();
	if (e.description == null)
		alert(gwt.getMessage("{0} Exception: {1}", MethodName, e.message));
	else
		alert(gwt.getMessage("{0} Exception: {1}", MethodName, e.description));
}
function getFraction(num) {
	if (!num) return num;
num = formatClean(num);
	return parseFraction(num);
}
function getWholePart(num) {
	if (!num) return num;
	num = formatClean(num);
	let index = num.indexOf(getDecimalSeparator());
	if (index > -1)
		num = num.substring(0, index);
	return !num || num === '-' ? '0' : num;
}
;
/*! RESOURCE: /scripts/doctype/utils14.js */
function doNothing() {
}
function valueExistsInArray(val, array) {
	for (var i = 0; i < array.length; i++) {
		if (val == array[i])
			return true;
	}
	return false;
}
function doubleDigitFormat(num) {
	return padLeft(num, 2, "0");
}
function tripleDigitFormat(num) {
	return padLeft(num, 3, "0");
}
function sGetHours(totalSecs) {
return parseInt(totalSecs / (60 * 60), 10);
}
function sGetMinutes(totalSecs) {
	totalSecs -= (60*60)*sGetHours(totalSecs);
return parseInt(totalSecs / 60, 10);
}
function sGetSeconds(totalSecs) {
	totalSecs -= (60*60)*sGetHours(totalSecs);
	totalSecs -= (60)*sGetMinutes(totalSecs);
	return parseInt(totalSecs, 10);
}
function isNumber(test) {
	if (!test)
		return false;
	
	test = new String(test);
	var _numer = test.search("[^0-9]");
	return _numer == -1;
}
function isAlphaNum(thchar) {
	return isAlpha(thchar) || isDigit(thchar);
}
function isAlpha(thchar){
	return (thchar >= 'a' && thchar <= 'z\uffff')
			|| (thchar >= 'A' && thchar <= 'Z\uffff') || thchar == '_';
}
function isDigit(thchar) {
	return (thchar >= '0' && thchar <= '9');
}
function containsOnlyChars(validChars, sText) {
	if (!sText)
		return true;
	for (var i = 0; i < sText.length; i++) {
		var c = sText.charAt(i);
if (validChars.indexOf(c) == -1)
			return false;
	}
	return true;
}
function getAttributeValue(element, attrName) {
	return element.getAttribute(attrName);
}
function setAttributeValue(element, attrName, value) {
	element.setAttribute(attrName, value);
}
function toggleDivDisplayAndReturn(divName) {
	if (!divName) 
		return;
	
	var div = $(divName);
	if (!div)
		return;
	
	if (div.style.display == "none")
		showObject(div);
	else
		hideObject(div);
	
	return div;
}
function toggleDivDisplay(divName) {
	toggleDivDisplayAndReturn(divName);
}
function toggleDivDisplayClass(id) {
	if (!id)
		return;
	var div = $(id);
	if (!div)
		return;
	if (div.classList.contains("hide")) {
		div.classList.remove("hide", "invisible");
		div.classList.add("visibility", "show");
	} else {
		div.classList.remove("show", "visibility");
		div.classList.add("hide", "invisible");
	}
	_frameChanged();
	return div;
}
function toggleAttributeValue(element, attribute) {
	if (element) {
		var value = (element.getAttribute(attribute) === 'true');
		element.setAttribute(attribute, (!value).toString());
	}
}
function findParentByTag(element, tag) {
	var ret;
	while (element && element.parentNode && element.parentNode.tagName) {
		element = element.parentNode;
		if (element.tagName.toLowerCase() == tag.toLowerCase())
			return element;
	}
	
	return ret;
}
function replaceAll(str, from, to) {
  var idx = str.indexOf( from );
  while ( idx > -1 ) {
   str = str.replace( from, to ); 
   idx = str.indexOf( from );
  }
  
  return str;    
}
function useAnimation() {
	if (isTouchDevice)
		return false;
	
	return true;
} 
function expandEffect(el, duration, steps, stepCallback, completionCallback) {
	if (!useAnimation()) {
		showObject(el);
		if (completionCallback)
			completionCallback(el);
			
		return;
	}
	
	var h;
	if (el.originalHeight) 
		h = el.originalHeight;
	else {
		h = getHeight(el);
if (h == 0) {
			showObject(el);
			return;
		}
		el.originalHeight = h;
	}
	if (!duration)
		duration = 70;
	if (!steps)
		steps = 14;
		
	el.style.overflow = "hidden";
	el.style.height = "1px";
	el.style.display = "block";
	el.style.visibility = "visible";
	expandAnimationEffect(el, h, duration, steps, stepCallback,
			completionCallback);
	return h;
}
function expandAnimationEffect(el, height, duration, steps, stepCallback,
		completionCallback) {
	new Rico.Effect.Size( el.id, null, height, duration, steps, {
		step: function() {
			if (stepCallback)
				stepCallback(el);
		},
		complete: function() {
			_expandComplete(el, completionCallback);
		}
	});
}
function _expandComplete(el, completionCallback) {
	el.style.overflow = "";
	el.style.height = "auto";
	
	if (completionCallback)
		completionCallback(el);
				
	_frameChanged();
}
function collapseEffect(el, duration, steps) {
	if (!useAnimation()) {
		hideObject(el);
		return;
	}
	var h;
	if (el.originalHeight) 
		h = el.originalHeight;
	else {
		h = el.offsetHeight;
		el.originalHeight = h;
	}
	if (!duration)
		duration = 70;
	if (!steps)
		steps = 14;
	
	if (!h)
		h = el.offsetHeight;
		
	el.style.overflow = "hidden";
	collapseAnimationEffect(el, h, duration, steps);
}
function collapseAnimationEffect(el, height, duration, steps) {
	new Rico.Effect.Size( el.id, null, 1, duration, steps, {
		complete: function() {
			_collapseComplete(el, height);
		}
	});
}
function _collapseComplete(el, height) {
	el.style.display = "none";
	el.style.overflow = "";
	el.style.height = height;
	_frameChanged();
}
function getHeight(el) {
	var item;
	try {
item = el.cloneNode(true);
	} catch (e) {
		jslog("getHeight blew up... we caught the error and returned 0")
		return 0;
	}
	var height = 0;
	item.style.visibility = "hidden";
	item.style.display = "block";
	item.style.position = "absolute";
	item.style.top = 0;
	item.style.left = 0;
	document.body.appendChild(item);
	height = item.offsetHeight;
	document.body.removeChild(item);
	
	return height;
}
function getWidth(el) {
	var item = el.cloneNode(true);
	var width = 0;
	item.style.visibility = "hidden";
	item.style.display = "block";
	item.style.position = "absolute";
	item.style.top = 0;
	item.style.left = 0;
	document.body.appendChild(item);
	width = item.offsetWidth;
	document.body.removeChild(item);
	
	return width;
}
function grabOffsetLeft(item) {
	return getOffset(item,"offsetLeft")
}
function grabOffsetTop(item) {
	return getOffset(item, "offsetTop")
}
function getOffset(item, attr) {
	var parentElement = getFormContentParent();
	var wb=0;
	while(item) {
		wb += item[attr];
		item = item.offsetParent;
		if (item == parentElement)
			break;
	}
	
	return wb;
}
function grabScrollLeft(item) {
	return getScrollOffset(item, "scrollLeft")
}
function grabScrollTop(item) {
	return getScrollOffset(item, "scrollTop")
}
function getScrollOffset(item, attr) {
	var parentElement = getFormContentParent();
		
	var wb=0;
	while (item && item.tagName && item != parentElement) {
		wb += item[attr];
		if (isMSIE)
			item = item.offsetParent;
		else
			item = item.parentNode;
	}
	return wb;
}
function getValue(evt) {
	var elem = evt.target;
	if (!elem)
		return null;
	try {
		return elem.options[elem.selectedIndex].value;
	} catch (e) {
		var msg = (typeof e == "string") ? e : ((e.message) ? e.message
				: "Unknown Error");
		alert("Unable to get data:\n" + msg);
	}
	return null;
}
function getEvent(event) {
	return event;
}
function getEventCoords(e) {
	var fudge = getFormContentParent();
	var answer = Event.pointer(e);
	answer = new Point(answer.x, answer.y);
	if (fudge == document.body)
		return answer;
	answer.x += fudge.scrollLeft;
	answer.y += fudge.scrollTop;
	var fudgeTop = fudge.getStyle('top');
	var fudgePos = fudge.getStyle('position');
	if (fudgePos == 'absolute' && fudgeTop && fudgeTop.indexOf('px'))
		answer.y -= parseInt(fudgeTop.replace('px',''));
	
	return answer;
}
function getRelativeTop() {
	var port = document.viewport;
	var topLeft = new Point(port.getScrollOffsets().left, port
			.getScrollOffsets().top)
	var fudge = getFormContentParent();
	if (fudge != document.body) {
		topLeft.x += fudge.scrollLeft;
		topLeft.y += fudge.scrollTop;
	}
	return topLeft;
}
function getRealEvent(e) {
	if (isTouchDevice && isTouchEvent(e)) {
		e = e.changedTouches[0];
	}
	
	return e;
}
function isTouchEvent(e) {
	if (typeof e == 'undefined' || typeof e.changedTouches == 'undefined')
		return false;
	return true;
}
function isTouchRightClick(e) {
	if (!isTouchEvent(e))
		return false;
	var hasTwoFingers = e.changedTouches.length > 1;
	return hasTwoFingers;
}
function getTextValue(node) {
	if (node.textContent)
		return node.textContent;
	var firstNode = node.childNodes[0];
	if (!firstNode)
		return null;
	if (firstNode.data)
		return firstNode.data;
	return firstNode.nodeValue;
}
function getScrollX() {
	return window.pageXOffset;
}
function getScrollY() {
	return window.pageYOffset;
}
function getSrcElement(evt) {
	return evt.target;
}
function addForm() {
	var form = cel('form');
	document.body.appendChild(form);
	if (window.g_ck)
		addHidden(form, "sysparm_ck", g_ck);
	return form;
}
function addHidden(form, name, value) {
	addInput(form, 'HIDDEN', name, value);
}
function addInput(form, type, name, value) {
	var inputs = Form.getInputs(form, '', name);
	if (inputs.length > 0) {
		inputs[0].value = value;
		return;
	}
	var opt = document.createElement('input');
	opt.type = type;
	opt.name = name;
	opt.id = name;
	opt.value = value;
	form.appendChild(opt);
}
function getHiddenInputValuesMap(parent) {
	var valuesMap = {}
	var inputs = parent.getElementsByTagName('input');
	for (var i = 0; i < inputs.length; i++) {
		var input = inputs[i];
		if (input.type.toLowerCase() != "hidden")
			continue;
		valuesMap[input.id] = input.value;
	}
	return valuesMap;
}
function appendSelectOption(select, value, label, index) {
	var opt = document.createElement("option");
	opt.value = value;
	opt.appendChild(label);
	if (index >= 0 && index != select.length)
		select.insertBefore(opt, select.children[index]);
	else
		select.appendChild(opt);
	return opt;
}
function copySelectOptionToIndex(select, opt, index) {
	var label = opt.text;
opt.innerHTML = "";
	opt.appendChild(document.createTextNode(label));
	if (index >= 0 && index != select.length)
		select.insertBefore(opt, select.children[index]);
	else
		select.appendChild(opt);
	return opt;
}
function selectMenuItem(id, selectName) {
	var selectMenu = document.getElementById(selectName);
	if (!selectMenu)
		return -1;
	var options = selectMenu.options;
	var selectItem = selectMenu.selectedIndex;
	if (id) {
		for (var i = 0; i < options.length; i++) {
			var option = options[i];
			
			if (option.value == id) {
				selectItem = i;
				break;
			}
		}
	}
	
	if (selectItem > 0) {
		selectMenu.selectedIndex = selectItem;
		if (selectMenu["onchange"]) {
			selectMenu.onchange();
		}
	}
	return selectItem;
}
function menuIsEmpty(selectName) {
	var selectMenu = document.getElementById(selectName);
	if (!selectMenu || selectMenu.selectedIndex <= 0)
		return true;
		
	return false;
}
        
function getBounds(obj, addScroll) {
	var x = grabOffsetLeft(obj);
	var y = grabOffsetTop(obj);
	if (addScroll) {
		x += getScrollX();
		y += getScrollY();
	}
	this.absoluteRect = {
		top : y,
		left : x,
		bottom : y + obj.offsetHeight,
		right : x + obj.offsetWidth,
		height : obj.offsetHeight,
		width : obj.offsetWidth,
middleX : x + (obj.offsetWidth / 2),
middleY : y + (obj.offsetHeight / 2),
		cbottom : y + obj.clientHeight,
		cright : x + obj.clientWidth
	};
	return this.absoluteRect;
}
function guid(l) {
  var l = l || 32, strResult = '';
  while (strResult.length < l)
		strResult += (((1 + Math.random() + new Date().getTime()) * 0x10000) | 0)
				.toString(16).substring(1);
  return strResult.substr(0, l);
}
function stopSelection(e) {
	e.onselectstart = function() {
		return false;
};
e.style.MozUserSelect = "none";
}
function restoreSelection(e) {
	e.onselectstart = null;
	e.style.MozUserSelect = "";
}
function getAttributeValue(element, name) {
	if (!element.attributes)
		return null;
	var v = element.attributes.getNamedItem(name);
	if (v == null)
		return null;
	return v.nodeValue;
}
function createImage(src, title, object, onClick) {
	var img = cel('input');
	img.type = 'image';
	img.src = src;
	img.title = title;
	img.alt = title;
	if (arguments.length == 4)
		img.onclick = onClick.bindAsEventListener(object);
	return img;
}
function createIcon(cls, title, object, onClick) {
	var icn = cel('a');
	icn.addClassName(cls);
	icn.setAttribute('title', title);
	icn.setAttribute('aria-label', title);
	if (arguments.length == 4)
		icn.onclick = onClick.bindAsEventListener(object);
	return icn;
}
function getXMLString(node) {
	var xml = "???";
	if (node.xml) {
		xml = node.xml;
	} else if (window.XMLSerializer) {
		xml = (new XMLSerializer()).serializeToString(node);
	}
	return xml;
}
function isLeftClick(e) {
	return e.button == 0;
}
function formatMessage() {
	if (arguments.length == 1)
		return arguments[0];
			
	var str = arguments[0];
	var args = arguments;
	if (arguments.length == 2 && typeof arguments[1] == 'object'
			&& arguments[1] instanceof Array) {
		args = [''].concat(arguments[1]);
	}
    var i = 0;
	while (++i < args.length) {
		str = str.replace( new RegExp( '\\{'+(i-1)+'\\}', 'g' ), args[i] );
	}
		
	return str;
}
function getFormattedDateAndTime(date) {
	return getFormattedDate(date) + " " + getFormattedTime(date);
}
function getFormattedDate(date) {
	var d = (date? date : new Date());
	var curr_mon = d.getMonth() + 1;
	var curr_day = d.getDate();
	var curr_year = d.getYear() - 100;
return doubleDigitFormat(curr_mon) + "/" + doubleDigitFormat(curr_day)
+ "/" + doubleDigitFormat(curr_year)
}
function getFormattedTime(date) {
	var d = (date? date : new Date());
	var curr_hour = d.getHours();
	var curr_min = d.getMinutes();
	var curr_sec = d.getSeconds();
	var curr_msec = d.getMilliseconds();
	return doubleDigitFormat(curr_hour) + ":" + doubleDigitFormat(curr_min)
			+ ":" + doubleDigitFormat(curr_sec) + " ("
			+ tripleDigitFormat(curr_msec) + ")"
}
function showGoToLine(textAreaID) {
	var e = gel("go_to_" + textAreaID)
	if (e) {
		showObjectInline(e);
		gel("go_to_input_" + textAreaID).focus();
	}
}
function gotoLineKeyPress(evt, textAreaObject, input) {
	if (evt.keyCode == 13) {
		Event.stop(evt);
		gotoLinePopup(textAreaObject, input.value);
		input.value = "";
		hideObject(input.parentNode);
	}
}
function gotoLinePopup(textAreaObject, lineText) {
	if (lineText) {
		lineText = trim(lineText);
		if (lineText) {
			var line = parseInt(lineText, 10);
			g_form._setCaretPositionLineColumn(textAreaObject, line, 1);
		}
	}
}
function getBrowserWindowHeight() {
	return window.innerHeight;
}
function getBrowserWindowWidth() {
	return window.innerWidth;
}
var WindowSize = function() {
	return {
		width: getBrowserWindowWidth(),
		height: getBrowserWindowHeight()
	}
}
function getScrollBarWidthPx() {
	var inner = cel("p");
	inner.style.width = "100%";
	inner.style.height = "200px";
	
	var outer = cel("div");
	outer.style.position = "absolute";
	outer.style.top = "0px";
	outer.style.left = "0px";
	outer.style.visibility = "hidden";
	outer.style.width = "200px";
	outer.style.height = "150px";
	outer.style.overflow = "hidden";
	outer.appendChild(inner);
	document.body.appendChild(outer);
	var w1 = inner.offsetWidth;
	outer.style.overflow = "scroll";
	var w2 = inner.offsetWidth;
	if (w1 == w2)
		w2 = outer.clientWidth;
	document.body.removeChild(outer);
	return (w1 - w2);
}
function showOpticsDebugger() {
	var mainWindow = getMainWindow();
	if (mainWindow)
		mainWindow.CustomEvent.fire('glide_optics_inspect_window_open');
}
function opticsLog(tablename, fieldname, message, oldvalue, newvalue) {
	if (tablename === "ni") {
		tablename = g_form.getUniqueValue();
		fieldname = g_form.resolveNameMap(fieldname) || fieldname;
	}
	var info = {};
	info.table = tablename;
	info.field = fieldname;
	info.message = message;
	info.message_type = "static";
	if (oldvalue && newvalue) {
		info.oldvalue = oldvalue;
		info.newvalue = newvalue;
		info.message_type = "change";
	}
	info.type = 'log';
	info.startTime = new Date();
	if (g_form._pushAction)
		g_form._pushAction(info);
	CustomEvent.fire('glide_optics_inspect_log_message', info);
}
function handleAriaInvalidState(fieldId, fieldIsEmpty) {
	if (!g_form || !fieldId) {
		return;
	}
	var isFormSubmitAttempted = g_form.submitAttemptsCount > 0;
	var visibleControls = g_form._getVisibleControls(fieldId);
	var handleStateUpdate = true;
	var displayNode = gel("sys_display." + fieldId);
	if (displayNode && displayNode.classList.contains('element_reference_input')) {
		var isList = displayNode.getAttribute('islist');
		handleStateUpdate = (isList && isList === 'true');
	}
	if (visibleControls.length > 0 && isFormSubmitAttempted && handleStateUpdate) {
		var ariaInvalid = fieldIsEmpty || false;
		for (var i = 0; i < visibleControls.length; i++) {
			visibleControls[i].setAttribute('aria-invalid', ariaInvalid);
		}
	}
}
;
/*! RESOURCE: /scripts/accessibility_tabindex.js */
addLoadEvent(function() {
	$(document).on('keydown', '*[tabindex]:not(.multiLinePill), .glide_ref_item_link', function(event) {
		if (event.keyCode != Event.KEY_RETURN)
			return;
		var element = event.element();
		if (!element.hasAttribute('tabindex'))
			return;
		if (element instanceof HTMLTextAreaElement)
			return;
		if (element.click) {
			element.click();
			var $parent = $j(element).parent();
			if ($parent.hasClass('open')) {
		    	  var $items = $parent.find('.dropdown-menu li:visible a');
		    	  if ($items.length)
		    		  $items.eq(0).trigger('focus');
		      }
		}
		
		event.stop();
	});
	if (typeof jQuery != 'undefined') {
		var KEY_SPACE = 32;
		var KEY_ENTER = 13;
		jQuery('[click-on-enter],[click-on-space]').on('keydown', function(event) {
			var keyCode = event.keyCode || event.which;
			var $this = jQuery(this);
			if (!((keyCode === KEY_ENTER && $this.is('[click-on-enter]')) || (keyCode === KEY_SPACE && $this.is('[click-on-space]'))))
				return;
			setTimeout(function() {
				$this.trigger('click');
			},200);
			if (keyCode === KEY_SPACE) {
				event.stopPropagation();
				event.preventDefault();
			}
		});
	}
	if (typeof jQuery !== 'undefined') {
		jQuery('[data-native-btn-click="true"]').on('keydown', function (event) {
			var KEY_SPACE = 32;
			var KEY_ENTER = 13;
			var keyCode = event.keyCode || event.which;
			if (keyCode === KEY_ENTER || keyCode === KEY_SPACE) {
				event.stopPropagation();
				event.preventDefault();
				if (this.click)
					this.click();
			}
		})
	}
});
;
/*! RESOURCE: /scripts/accessibility_readonly.js */
addLateLoadEvent(function() {
	document.body.on('click', 'input.disabled', blockValueChange);
	function blockValueChange(evt, element) {
		var type = element.type;
		if (type.match('radio|checkbox')) {
			element.checked = !element.checked;
			evt.stop();
			return false;
		}
	}
});
;
/*! RESOURCE: /scripts/doctype/accessibility/ariaLiveService.js */
(function (window, document) {
    window.NOW = window.NOW || {};
    function ariaLivePolite(text, delay) {
        setTimeout(_ariaLiveMessage, delay || 0, text, false);
    }
    function ariaLiveAssertive(text, delay) {
        setTimeout(_ariaLiveMessage, delay || 0, text, true);
    }
    function _ariaLiveMessage(text, assertive) {
        var ariaLiveId = !!assertive
            ? 'html_page_aria_live_assertive'
            : 'html_page_aria_live_polite';
        var ariaLive = document.getElementById(ariaLiveId);
        if (!ariaLive)
            return;
        if (window.NOW.ariaLiveDisabled)
            return;
        if (ariaLive.children.length > 50 || (ariaLive.children.length > 0 && ariaLive.textContent.length > 10000))
            ariaLive.children[0].remove();
        var newMessage = document.createElement('div');
        newMessage.innerText = text;
        ariaLive.insertAdjacentElement('beforeend', newMessage);
    }
    CustomEvent.observe('global_aria_live_polite', ariaLivePolite);
    CustomEvent.observe('global_aria_live_assertive', ariaLiveAssertive);
    window.NOW.accessibility = window.NOW.accessibility || {};
    window.NOW.accessibility['ariaLivePolite'] = ariaLivePolite;
    window.NOW.accessibility['ariaLiveAssertive'] = ariaLiveAssertive;
})(window, document);
;
/*! RESOURCE: /scripts/doctype/accessibility/focusOutlineUtility.js */
(function (window, document) {
    window.NOW = window.NOW || {};
    function addClassById(target, className) {
        modifyFocusOutline(target, className, true);
    }
    function removeClassById(target, className) {
        modifyFocusOutline(target, className, false);
    }
    function onFocusAddMSHCOutline(target) {
        addClassById(target, 'ms-high-contrast-outline');
    }
    function onBlurRemoveMSHCOutline(target) {
        removeClassById(target, 'ms-high-contrast-outline');
    }
    function modifyFocusOutline(el, className, add) {
        if (typeof el === "string") {
            el = document.getElementById(el);
        }
        if (el) {
            if (add) {
                el.classList.add(className);
            } else {
                el.classList.remove(className);
            }
        }
    }
    function luminance(r, g, b) {
        var a = [r, g, b].map(function (v) {
v /= 255;
            return v <= 0.03928
? v / 12.92
: Math.pow( (v + 0.055) / 1.055, 2.4 );
        });
        return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
    }
    function calculateContrastRatio(rgb1, rgb2) {
        var lum1 = luminance(rgb1[0], rgb1[1], rgb1[2]) + 0.05;
        var lum2 = luminance(rgb2[0], rgb2[1], rgb2[2]) + 0.05;
        return (lum1 > lum2)
? (lum1 / lum2)
: (lum2 / lum1);
    }
    function extractRGB(rgb) {
var re = RegExp(/\d{1,3}/, 'g');
        var match;
        var values = [];
        while ((match = re.exec(rgb)) !== null && values.length < 3) {
            values.push(match[0]);
        }
        return values;
    }
    function getContrastRatio(el) {
        var computedStyle = getComputedStyle(el);
        var color = computedStyle['color'];
        var backgroundColor = computedStyle['background-color'];
        var colorRGB = extractRGB(color);
        var backgroundColorRGB = extractRGB(backgroundColor);
        return calculateContrastRatio(backgroundColorRGB, colorRGB);
    }
    window.NOW.accessibility = window.NOW.accessibility || {};
    window.NOW.accessibility['onFocusAddMSHCOutline'] = onFocusAddMSHCOutline;
    window.NOW.accessibility['onBlurRemoveMSHCOutline'] = onBlurRemoveMSHCOutline;
})(window, document);
;
/*! RESOURCE: /scripts/doctype/accessibility/forms/cleanLabels.js */
(function (document) {
	jQuery(function($j) {
		var doc = $j(document);
		doc.find('label[for]').each(function() {
			var label = $j(this);
			var forId = label.attr('for') || '';
			if (forId === '')
				return;
			var inputElement = document.getElementById(forId);
			if (
				!inputElement ||
				inputElement.hasAttribute('aria-label') ||
				inputElement.hasAttribute('aria-labelledby') ||
				((inputElement.type || '').toLowerCase() === 'hidden')
			)
				return;
			var textElement = label.find('.label-text');
			var text = textElement.length > 0 ? textElement.text() : '';
			if (text !== '')
				inputElement.setAttribute('aria-label', text);
		})
	});
})(document);
;
;
/*! RESOURCE: /scripts/doctype/accessibility/js_includes_doctype_accessibility.js */
/*! RESOURCE: /scripts/classes/ajax/GlideURL.js */
var GlideURL = Class.create({
	
	initialize: function(contextPath) {
		this.contextPath = '';
	    this.params = new Object();
		this.encodedString = '';
		this.encode = true;
		this.setFromString(contextPath ? contextPath : '');
		if(typeof GlideTransactionScope != 'undefined')
			GlideTransactionScope.appendTransactionScope(this.addParam.bind(this));
	},
	
	setFromCurrent: function(decodeParams) {
		this.setFromString(window.location.href, decodeParams);
	},
	_decodeParam: function(value) {
value = value ? value.replace(/\+/g, '%20') : value;
		return decodeURIComponent(value);
	},
	setFromString: function(href, decodeParams) {
		var pos = href.indexOf('?');
		if (pos < 0) {
			this.contextPath = href;
			return;
		}
		this.contextPath = href.slice(0, pos);
		var hashes = href.slice(pos + 1).split('&');
		var i = hashes.length;
		while (i--) {
			var pos = hashes[i].indexOf('=');
			var name = hashes[i].substring(0, pos);
			var value = hashes[i].substring(++pos);
			if (decodeParams) {
				name = this._decodeParam(name);
				value = this._decodeParam(value);
			}
			this.params[name] = value;
	    }
	},
	
	getContexPath: function() {
	    return this.contextPath;
	},
	
	getContextPath: function() {
		return this.contextPath;
	},
	
	setContextPath: function(c) {
	    this.contextPath = c;
	},
	
	getParam: function(p) {
		return this.params[p];
	},
	
	getParams: function() {
	    return this.params;
	},
	addParam: function(name, value) {
	    this.params[name] = value;
		return this;
	},
	
	addToken: function() {
		if (typeof g_ck != 'undefined' && g_ck != "")
			this.addParam('sysparm_ck', g_ck);
		return this;
	},
    deleteParam: function(name) {
        delete this.params[name];
    },
	
	addEncodedString: function(s) {
		if (!s)
			return;
			
		if (s.substr(0, 1) != "&")
			this.encodedString += "&";
			
		this.encodedString += s;
		return this;
	},
    
    getQueryString: function(additionalParams) {
        qs = this._getParamsForURL(this.params);
        qs += this._getParamsForURL(additionalParams);
		qs += this.encodedString;	
		if (qs.length == 0)
			return "";
		return qs.substring(1);
    },
    
    _getParamsForURL: function(params) {
    	if (!params)
    		return '';
    		
        var url = '';
        for (var n in params) {
        	var p = params[n] || '';
        	url += '&' + n + '=' + (this.encode ? this._encodeUriQuery(p + '') : p);
        }
        return url;
    },
	_encodeUriQuery : function(val) {
		return encodeURIComponent(val).
replace(/%40/gi, '@').
replace(/%3A/gi, ':');
	},
    
    getURL: function(additionalParams) {
        var url = this.contextPath;
		var qs = this.getQueryString(additionalParams);
		if (qs)
			url += "?" + qs;
			
        return url || "";
    },
	getRelativeURL: function() {
		var url = this.getURL();
return url.replace(window.location.origin, '').substring(1);
	},
    
    setEncode: function(b) {
        this.encode = b;
    },
    
    toString: function() { return 'GlideURL'; }
});
GlideURL.refresh = function() {
	window.location.replace( window.location.href );
};
;
/*! RESOURCE: /scripts/ga_batch/batchedGlideAjax.js */
window.NOW.batchedGlideAjax = function batchedGlideAjax(toProcess) {
	var batchGA = new GlideAjax("AJAXXMLHttpAggregator");
	batchGA.disableRunInBatch();
	function batchErrorHandler(onCompletionFn) {
		return function(error) {
			console.log("BatchedGlideAjax: Got error", error);
			toProcess.forEach(function(ga) {
				handleChildResponseError({
					status : 500,
					glideAjax : ga,
					error : "Batch failed"
				});
			});
			if (onCompletionFn)
				onCompletionFn([]);
		}
	}
	function batchResponseHandler(onCompletionFn) {
		return function (response) {
			console.log("BatchedGlideAjax: Got response", response);
			if (!response || !response.responseXML) {
				batchErrorHandler(onCompletionFn)(response);
				return;
			}
			var doc = response.responseXML.documentElement;
			if (!doc || !doc.childNodes) {
				batchErrorHandler(onCompletionFn)(response);
				return;
			}
			var unprocessedGas = processIndividualResponses(Array.prototype.slice.apply(doc.childNodes));
			if (onCompletionFn)
				onCompletionFn(unprocessedGas);
		}
	}
	function processIndividualResponses(nodes) {
		var processedIndicies = [];
		nodes.forEach(function (node) {
			var response = responseNode(node);
			try {
				if (response.succeeded)
					handleChildResponseSuccess(response);
				else
					handleChildResponseError(response);
			}
			catch (e) {
				console.warn("BatchedGlideAjax: Error processing child response", response, ":", e);
			}
			finally {
				processedIndicies.push(response.queueIndex);
			}
		});
		return toProcess.filter(function(ga, idx) {
return processedIndicies.indexOf(idx) < 0;
		});
	}
	function responseNode(node) {
		var processorIdx = ~~node.getAttribute("sysparm_processor_index");
		if (processorIdx < 0 || processorIdx >= toProcess.length) {
			console.error("BatchedGlideAjax: Processor index " + processorIdx + " out of bounds for batch queue", toProcess);
			return null;
		}
		var ga = toProcess[processorIdx];
		var status = ~~node.getAttribute("status");
		var error = node.getAttribute("error");
		var answer = node.getAttribute("answer");
		var responseDocument = null;
		return {
			queueIndex : processorIdx,
			status : status,
			error: error,
			answer: answer,
			glideAjax : ga,
			succeeded : status >= 200 && status < 300,
			get responseDocument() {
				if (responseDocument == null) {
					responseDocument = document.implementation.createDocument("", "", null);
					var clonedNode = responseDocument.importNode(node, true);
					responseDocument.appendChild(clonedNode);
				}
				return responseDocument;
			}
		};
	}
	function handleChildResponseError(response) {
		var errorObject = {
			status: response.status,
			statusText: response.error,
			error: response.error,
			description: response.error,
			responseText: response.error
		};
		var ga = response.glideAjax;
		if (ga.errorCallbackFunction)
			setTimeout(function() {
				ga.errorCallbackFunction(errorObject, ga.callbackArgs)
			}, 0);
	}
	function handleChildResponseSuccess(response) {
		var ga = response.glideAjax;
		if (!ga.callbackFunction)
			return;
		if (ga.wantAnswer) {
			var answer = response.answer;
			setTimeout(function () {
				ga.callbackFunction(answer, ga.callbackArgs);
			}, 0);
		} else {
			var requestObject = {
				responseXML: response.responseDocument,
				status: status
			};
			setTimeout(function() {
				ga.callbackFunction(requestObject, ga.callbackArgs)
			}, 0);
		}
	}
	function addParamsToBatch(params, index) {
		var param;
		if (!params)
			return;
		for (param in params) {
			if (!params.hasOwnProperty(param))
				continue;
			batchGA.addParam(index + '.' + param, params[param]);
		}
	}
	function decodeFormURI(value) {
value = value ? value.replace(/\+/g, '%20') : value;
		return decodeURIComponent(value);
	}
	function addCustomQueryStringToBatch(qs, index) {
		if (!qs)
			return;
		if (qs.startsWith('?'))
			qs = qs.substring(1);
		var params = qs.split('&');
		params.forEach(function(param) {
			var i = param.indexOf('=');
			var name = param, value;
			if (i > -1) {
				name = param.substring(0, i);
				value = param.substring(i + 1);
			}
			var decodedName = decodeFormURI(name);
			var decodedValue = decodeFormURI(value);
			batchGA.addParam(index + '.' + decodedName, decodedValue);
		});
	}
	return {
		execute : function(unprocessedCallback) {
			var aggregation_size = 0;
			toProcess.forEach(function(ga, idx) {
				addParamsToBatch(ga.params, idx);
				addParamsToBatch(ga.additionalProcessorParams, idx);
				addCustomQueryStringToBatch(ga.postString, idx);
				aggregation_size++;
			});
			batchGA.addParam("sysparm_aggregation_size", aggregation_size);
			batchGA.setErrorCallback(batchErrorHandler(unprocessedCallback));
			batchGA.getXML(batchResponseHandler(unprocessedCallback));
		}
	}
};
;
/*! RESOURCE: /scripts/ga_batch/glideAjaxBatchQueue.js */
window.NOW.GlideAjaxBatchRequestQueue = (function() {
	var queue = [];
	var startProcessingTimeout;
	var MAX_TIME_IN_QUEUE = window.NOW.batch_glide_ajax_requests_max_time_in_queue || 50;
	if (MAX_TIME_IN_QUEUE < 0)
MAX_TIME_IN_QUEUE = 50;
	function processQueue() {
		clearProcessingTimeout();
		var toProcess = [];
		queue.forEach(function(ga, idx){
			if (!ga.params) {
				console.warn('glideAjaxBatchQueue: GA' + idx + ' has no parameters.');
				return;
			}
			if (!ga.params.sysparm_processor) {
				console.warn('glideAjaxBatchQueue: GA' + idx + ' is missing a processor.');
				return;
			}
			toProcess.push(ga);
		});
		if (toProcess.length == 0)
			return;
		var batchGa = window.NOW.batchedGlideAjax(toProcess);
		batchGa.execute(function requeueUnprocessed(unprocessedGas) {
				queue = unprocessedGas.concat(queue);
				processQueue();
			}
		);
		queue.length = 0;
	}
	function clearProcessingTimeout() {
		if (startProcessingTimeout) {
			clearTimeout(startProcessingTimeout);
			startProcessingTimeout = undefined;
		}
	}
	return {
		enqueue : function(glideAjax) {
			if (!glideAjax.params) {
				console.warn('glideAjaxBatchQueue: GA has no parameters.');
				return;
			}
			if (!glideAjax.params.sysparm_processor) {
				console.warn('glideAjaxBatchQueue: GA is missing processor.');
				return;
			}
			queue.push(glideAjax);
			if (!startProcessingTimeout)
				startProcessingTimeout = setTimeout(processQueue, MAX_TIME_IN_QUEUE);
		},
		processQueue : processQueue
	}
})();
;
;
/*! RESOURCE: /scripts/ga_batch/js_includes_batchedga.js */
/*! RESOURCE: /scripts/classes/ajax/GlideAjax.js */
var GlideAjax = Class.create(GlideURL, {
	URL: "xmlhttp.do",
	initialize: function initialize($super, processor, url) {
		var u = this.URL;
		if (url)
			u = url;
			
		$super(u);
	    this.setProcessor(processor);
		this.callbackFunction;
		this.callbackArgs;
		this.additionalProcessorParams;
		this.errorCallbackFunction;
		this.wantRequestObject = false;
		this.setScope("global");
		this.setWantSessionMessages(true);
		if(typeof GlideTransactionScope != 'undefined')
			GlideTransactionScope.appendTransactionScope(this.addParam.bind(this), true, true);
		this.runRequestInBatch = window.NOW.batch_glide_ajax_requests;
	},
	disableRunInBatch: function() {
		this.runRequestInBatch = false;
	},
	
	getProcessor: function() {
	    return this.processor;
	},
	
	getAnswer: function() {
		if (!(this.requestObject && this.requestObject.responseXML))
			return null;
			
		return this.requestObject.responseXML.documentElement.getAttribute("answer");
	},
	
	setProcessor: function(p) {
	    this.processor = p;
		this.addParam("sysparm_processor", p);
	},
	setQueryString: function(qs) {
		this.queryString = qs;
	},
	
	preventLoadingIcon: function() {
		this._preventLoadingIcon = true;
	},
	
	preventCancelNotification: function() {
		this._suppressCancelNotification = true;
	},
	
    getXMLWait: function(additionalParams) {
    	this.addParam("sysparm_synch", "true");
		this.additionalProcessorParams = additionalParams;
		this.async = false;
		var sw = new StopWatch();
		this._makeRequest();
		var m = "*** WARNING *** GlideAjax.getXMLWait - synchronous function - processor: " + this.processor
		sw.jslog(m);
		if (window.console && window.console.log) 
			console.log("%c " + m, 'background: darkred; color: white;');
		
        if (this.requestObject.status != 200)
        	this._handleError();
        
		return this._responseReceived();
    },
    
    getXML: function(callback, additionalParams, responseParams) {
		this.wantAnswer = false;
		this._getXML0(callback, additionalParams, responseParams);
	},
	getXMLAnswer:function(callback, additionalParams, responseParams) {
		this.wantAnswer = true;
		this._getXML0(callback, additionalParams, responseParams);
	},
	
	_getXML0: function(callback, additionalParams, responseParams) {
		this.callbackFunction = callback;
		this.callbackArgs = responseParams;
		this.additionalProcessorParams = additionalParams;
		
		this.async = true;
		setTimeout(function() {this._makeRequest();}.bind(this), 0); 
	},
	
    _makeRequest: function() {
    	this.requestObject = this._getRequestObject();
    	
    	if (this.requestObject == null) 
    	    return null;
		if (!GlideAjax.want_session_messages)
			this.setWantSessionMessages(false);
    	    
    	var refUrl = this._buildReferringURL();
if (refUrl != "") {
    		this.addParam('ni.nolog.x_referer', 'ignore');
    		this.addParam('x_referer', refUrl);
    	}
    	
    	if (typeof g_autoRequest != 'undefined' && 'true' == g_autoRequest)
    		this.addParam('sysparm_auto_request', g_autoRequest);
    	
    	this.postString = this.getQueryString(this.additionalProcessorParams);
    	if (this.queryString) {
    		if (this.postString)
    			this.postString += "&";
    		this.postString += this.queryString;
		}
		if (this._isEligibleForBatching())
    		this._enqueueBatchRequest();
    	else
    		this._sendRequest();
    	
    	return this.requestObject;
    },
	_isEligibleForBatching : function() {
		return this.async &&
			this.runRequestInBatch &&
			window.NOW.batch_glide_ajax_requests &&
			this.contextPath === this.URL;
 	},
	_enqueueBatchRequest : function() {
		if (window.NOW && window.NOW.GlideAjaxBatchRequestQueue)
			window.NOW.GlideAjaxBatchRequestQueue.enqueue(this);
		else {
			console.warn("GlideAjaxBatchRequestQueue not available, falling back to immediate dispatch");
console.debug("Add scripts/ga_batch/js_includes_batchga.js to your page to enable batching");
			this._sendRequest();
		}
	},
    
    _sendRequest: function() {
    	this._showLoading();
    	if (this.async)
    		this.requestObject.onreadystatechange = this._processReqChange.bind(this);
    	
    	CustomEvent.fireTop("request_start", document);
    			
    	this.requestObject.open("POST", this.contextPath, this.async);
this.requestObject.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
		if (window.transaction_source)
			this.requestObject.setRequestHeader("X-Transaction-Source", window.transaction_source);
    	if (typeof g_ck != 'undefined' && g_ck != "")
        	this.requestObject.setRequestHeader('X-UserToken', g_ck);
    	try {
	    	this.requestObject.send(this.postString);
    	} catch (e) {}
	    	
    	if (!this.async || (this.callbackFunction == null))
    		this._hideLoading();
    },
    
    _processReqChange: function() {
        if (this.requestObject.readyState != 4)
        	return;
        	
    	this.requestObject.onreadystatechange = function() { };
        this._hideLoading();
        if (!this._errorCheck()) {
        	this._responseReceived();
        	return;
        }
        
	 	try { 
	 		this._handleError();
		} catch (e) { 
			jslog("GlideAjax error: " + e);
		}
    },
    
    _errorCheck: function() {
    	this._cancelErrorXML = this._getCancelError();
    	
    	return this._getResponseCode() != 200 || this._wasCanceled();
    },
    
    _handle401Error: function() {
    	if (getTopWindow().loggingOut)
    		return false;
    		
   		var sessionLoggedIn =  this.requestObject.getResponseHeader("X-SessionLoggedIn");
		if ( "true"!=sessionLoggedIn ) {
			if (window.confirm(new GwtMessage().getMessage("ajax_session_timeout_goto_login_confirm"))) {
getTopWindow().location.href = "/navpage.do";
			    return true;
			}
		} else {
	    	var allowResubmit = this.requestObject.getResponseHeader("X-UserToken-AllowResubmit");
	    	if ("true"==allowResubmit) {
	    		var autoResubmit = this.requestObject.getResponseHeader("X-AutoResubmit");
	    		if ("true" == autoResubmit) {
	    			this._sendRequest();
	    		    return true;
	    		}
	    			
                if (window.confirm(new GwtMessage().getMessage("ajax_session_timeout_resubmit_request_confirm"))) {
                	this._sendRequest();
	    		    return true;
                }
	    	} else {
	    	    if ("true" == sessionLoggedIn)
	    	        return false;
	    	    
                var msg = new GwtMessage().getMessage("ajax_session_timeout_refresh_screen");
                if (!msg)
                    msg = "Your session has expired. Click OK to continue.";
                if (window.confirm(msg)) {
getTopWindow().location.href = "/navpage.do";
                    return true;
                }
	    	}
		}    	
		
		return false;
    },
    
    _handleError: function() {
    	var responseCode = this._getResponseCode();
    	if (responseCode == 401) {
	    	var requestedToken = this.requestObject.getResponseHeader("X-UserToken-Request");
	    	var respondedToken = this.requestObject.getResponseHeader("X-UserToken-Response");
	    	
	    	if (requestedToken && respondedToken && requestedToken != respondedToken)
	    		CustomEvent.fireAll("ck_updated", respondedToken);
	    	
 			var handleTimeOut = this.requestObject.getResponseHeader("X-HandleTimeOut");
			if ("true"==handleTimeOut) 
                if (this._handle401Error())
                	return;
			
    	}
    	else if (responseCode == 404 && this._outOfScope()) {
    		var err_options = {
    	    		text: "Access to Script Include " + this.processor +" blocked from scope: " + (this.getParam("sysparm_scope") ? this.getParam("sysparm_scope") : "global"),
    	    		type: "system",
    	    		attributes: { type: "error" }
    	    };
    		
    	    if (typeof GlideUI != 'undefined')
    	        GlideUI.get().fire(new GlideUINotification(err_options));
    	}
    
    	else if (this._wasCanceled() && this.callbackFunction && !this._getSuppressCancelNotification()) {
    		var err_options = {
    				text: this._getCancelErrorText(),
    				type: "system",
    				attributes: { type: "error" }
    		};		
    		
    		if (typeof GlideUI != 'undefined')
    		    GlideUI.get().fire(new GlideUINotification(err_options));
    	}
    	
		if (this.errorCallbackFunction)
			this.errorCallbackFunction(this.requestObject, this.callbackArgs);
    },
    
    _getRequestObject: function() {
        var req = null;
        
        if (window.XMLHttpRequest)
            req = new XMLHttpRequest();
        else if (window.ActiveXObject)
            req = new ActiveXObject("Microsoft.XMLHTTP");
        
    	return req;
    },
    
    _getResponseCode: function() {    	
    	return this.requestObject.status;
    },
    
    _wasCanceled: function() {
    	if (!this._cancelErrorXML)
    		return false;
    	
		var answer = this._cancelErrorXML.getAttribute('transaction_canceled'); 
		return answer == 'true';
    },
    
    _getSuppressCancelNotification: function() {
    	if (this._suppressCancelNotification)
    		return true;
    	
    	if (this._cancelErrorXML) {
    		var suppress = this._cancelErrorXML.getAttribute("suppress_notification"); 
			if (suppress && suppress == 'true')
				return true;
    	}
    	return false;
    },
    
    _getCancelErrorText: function() {
    	if (this._cancelErrorXML) {
    		var cancelMessage = this._cancelErrorXML.getAttribute('cancel_message'); 
			if (cancelMessage)
				return cancelMessage;
    	}
    	
    	return "Information could not be downloaded from the server because the transaction was canceled.";
    },
    
    _getCancelError: function() {
    	var xml = this.requestObject.responseXML;
    	if (!xml) {
	    	var responseText = this.requestObject.responseText;
var errorPattern = /<xml?[^>]*id="transaction_canceled_island"?[^>]*>/;
	    	var matches = responseText.match(errorPattern);
	    	if (!matches)
	    		return false;
	    	xml = loadXML(matches[0]);
    	}
    	return xml.documentElement;
    },
    
    _outOfScope: function() {
    	var callerScope = this.getParam("sysparm_scope") ? this.getParam("sysparm_scope") : "global";
    	var isAppScope = callerScope != "global";
    	return isAppScope && this.requestObject.responseXML.documentElement.getAttribute("error").indexOf("HTTP Processor class not found") == 0;
    },
    
	_responseReceived: function() {
    	lastActivity = new Date();
    	
    	CustomEvent.fireTop("request_complete", document);
    	
    	this._fireUINotifications();
    	this._showSessionNotifications();
    	if (this.callbackFunction) {
    		if (this.wantAnswer)
		    	this.callbackFunction(this.getAnswer(), this.callbackArgs);
		    else
		    	this.callbackFunction(this.requestObject, this.callbackArgs);
    	}
    	if (this.wantRequestObject)
    		return this.requestObject;
		return this.requestObject? this.requestObject.responseXML : null;
	},
    
	_showLoading: function() {
		if (!this._preventLoadingIcon)
			CustomEvent.fireAll("ajax.loading.start", this);
	},
	_hideLoading: function() {
		if (!this._preventLoadingIcon && window.CustomEvent)
			CustomEvent.fireAll("ajax.loading.end", this);
	},
	
	_buildReferringURL: function() {
		var path = location.pathname;
		var args = location.search;
if (path.substring(path.length-1) == '/') {
			if (args)
				return args;
			
			return "";
		}
			
return path.substring(path.lastIndexOf('/') + 1) + args;
	},
	
	_fireUINotifications: function() {
	    if (!this.requestObject || !this.requestObject.responseXML)
	        return;
	    
        var notifications = this.requestObject.responseXML.getElementsByTagName('ui_notifications');
        if (!notifications || notifications.length == 0)
            return;
        
        var spans = notifications[0].childNodes;
        for (var i = 0; i < spans.length; i++) {
            var span = spans[i];
            if (typeof GlideUI != 'undefined')
                GlideUI.get().fire(new GlideUINotification({xml: span}));
        }
        $(document).fire('glide-notification:clear', {spans : spans});	
	},
	
	_showSessionNotifications: function() {
	    if (!this.requestObject || !this.requestObject.responseXML)
	        return;
	    
        var notifications = this.requestObject.responseXML.getElementsByTagName('session_notifications');
        if (!notifications || notifications.length == 0)
            return;
        
        var spans = notifications[0].childNodes;
        for (var i = 0; i < spans.length; i++) {
            var span = spans[i];
            var type = span.getAttribute("data-type");
            if (typeof GlideUI != 'undefined') {
            	if(type !== 'nav')
            		GlideUI.get().addOutputMessage({msg:span.getAttribute("data-text"), type:type});
            }
        }
	},
	
	setScope: function(scope) {
		if(scope) {
			this.addParam('sysparm_scope', scope);			
		}
		return this;
	},
	
	setErrorCallback: function(callback) {
		this.errorCallbackFunction = callback;
	},
	
	setWantRequestObject: function(want) {
		this.wantRequestObject = want;
	},
	
	setWantSessionMessages: function(want) {
		this.addParam('sysparm_want_session_messages', want);
	},
    toString: function() { return "GlideAjax"; }
});
GlideAjax.disableSessionMessages = function() {
	GlideAjax.want_session_messages = false;
};
GlideAjax.enableSessionMessages = function() {
	GlideAjax.want_session_messages = true;
};
GlideAjax.enableSessionMessages();
;
/*! RESOURCE: /scripts/classes/ajax/GlideAjaxForm.js */
var GlideAjaxForm = Class.create(GlideAjax, {
	
	PROCESSOR: 'RenderInfo',
	initialize: function($super, templateName) {
		$super(this.PROCESSOR);
		this._formPreferences = {};
		this._templateName = templateName;
	  
    	this.setPreference('renderer', 'RenderForm');
		this.setPreference('type', 'direct');
		this.setPreference('table', templateName);
		
		this.addParam('sysparm_name', templateName);
		this.addParam('sysparm_value', this.getSysparmValue());
    },
    
    getRenderedBodyText: function(callback) {
    	this._renderedBodyCallback = callback;
    	this.getXML(this._parseTemplate.bind(this));
    },
    
    _parseTemplate: function(response) {
		s = response.responseText;
		
		s = s.substring(s.indexOf('<rendered_body>') + 15);
s = s.substring(0, s.indexOf('</rendered_body>'));
		
s = s.replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&").replace(/&apos;/g, "'");
		this._renderedBodyCallback(s);
    },
    
    
    setPreference: function(k, v) {
    	this._formPreferences[k] = v;
    },
    
    getPreferences: function() {
    	return this._formPreferences;
    },
    
    getSysparmValue: function() {
    	var gxml = document.createElement('gxml');
    	var sec = document.createElement('section');
    	sec.setAttribute('name', this._templateName);
    	gxml.appendChild(sec);
    	for (var i in this._formPreferences) {
    		var e = document.createElement('preference');
    		e.setAttribute('name', i);
    		e.setAttribute('value', this._formPreferences[i]);
    		sec.appendChild(e);
    	}
    	return gxml.innerHTML;
    },
    
    
    toString: function() { return 'GlideAjaxForm'; }
});
;
/*! RESOURCE: /scripts/calendar.js */
var MONTH_NAMES = new Array('January','February','March','April','May','June','July','August','September','October','November','December','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec');
var DAY_NAMES = new Array('Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sun','Mon','Tue','Wed','Thu','Fri','Sat');
function LZ(x) {return(x<0||x>9?"":"0")+x}
function isDate(val,format) {
	var date=getDateFromFormat(val,format);
	if (date==0) { return false; }
	return true;
}
function compareDates(date1,dateformat1,date2,dateformat2) {
	var d1=getDateFromFormat(date1,dateformat1);
	var d2=getDateFromFormat(date2,dateformat2);
	if (d1==0 || d2==0) {
		return -1;
		}
	else if (d1 > d2) {
		return 1;
		}
	return 0;
}
function formatDateServer(date, format) {
	var ga = new GlideAjax("DateTimeUtils");
	ga.addParam("sysparm_name", "formatCalendarDate");
	var browserOffset = date.getTimezoneOffset() * 60000;
	 var utcTime = date.getTime() - browserOffset;
	 var userDateTime = utcTime - g_tz_offset;
	ga.addParam("sysparm_value", userDateTime);
	ga.getXMLWait();
	return ga.getAnswer();
}
function formatDate(date,format) {
	if (format.indexOf("z") > 0) 
		return formatDateServer(date, format);
		
	format=format+"";
	var result="";
	var i_format=0;
	var c="";
	var token="";
	var y=date.getFullYear()+"";
	var M=date.getMonth()+1;
	var d=date.getDate();
	var E=date.getDay();
	var H=date.getHours();
	var m=date.getMinutes();
	var s=date.getSeconds();
	var yyyy,yy,MMM,MM,dd,hh,h,mm,ss,ampm,HH,H,KK,K,kk,k;
	var value=new Object();
	
	value["M"]=M;
	value["MM"]=LZ(M);
	value["MMM"]=MONTH_NAMES[M+11];
	value["NNN"]=MONTH_NAMES[M+11];
	value["MMMM"]=MONTH_NAMES[M-1];
	value["d"]=d;
	value["dd"]=LZ(d);
	value["E"]=DAY_NAMES[E+7];
	value["EE"]=DAY_NAMES[E];
	value["H"]=H;
	value["HH"]=LZ(H);
	
	if (format.indexOf('w') != -1) {
		var wk = date.getWeek();
		if (wk >= 52 && M == 1) {
			y = date.getFullYear();
			y--;
			y = y + "";
		}
		if (wk == 1 && M == 12) {
			y = date.getFullYear();
			y++;
			y = y + "";
		}
		value["w"] = wk;
		value["ww"] = LZ(wk);
	}
	var dayOfWeek = (7 + (E + 1) - (g_first_day_of_week - 1)) % 7;
	if (dayOfWeek == 0)
		dayOfWeek = 7;
	
	value["D"] = dayOfWeek;
	
	if (y.length < 4) {
		y=""+(y-0+1900);
	}
	value["y"]=""+y;
	value["yyyy"]=y;
	value["yy"]=y.substring(2,4);
	
	if (H==0) {
		value["h"]=12;
	} else if (H>12){
		value["h"]=H-12;
	} else {
		value["h"]=H;
	}
	value["hh"]=LZ(value["h"]);
	
	if (H>11) {
		value["K"]=H-12;
	} else {
		
		value["K"]=H;
	}
	value["k"]=H+1;
	value["KK"]=LZ(value["K"]);
	value["kk"]=LZ(value["k"]);
	
	if (H > 11) { 
		value["a"]="PM"; 
	} else { 
		value["a"]="AM"; 
	}
	value["m"]=m;
	value["mm"]=LZ(m);
	value["s"]=s;
	value["ss"]=LZ(s);
	
	while (i_format < format.length) {
		c=format.charAt(i_format);
		token="";
		while ((format.charAt(i_format)==c) && (i_format < format.length)) {
			token += format.charAt(i_format++);
			}
		if (value[token] != null) { result=result + value[token]; }
		else { result=result + token; }
		}
	return result;
}
function _isInteger(val) {
var digits="1234567890";
for (var i=0; i < val.length; i++) {
	if (digits.indexOf(val.charAt(i))==-1) { return false; }
	}
return true;
}
function _getInt(str,i,minlength,maxlength) {
for (var x=maxlength; x>=minlength; x--) {
	var token=str.substring(i,i+x);
	if (token.length < minlength) { return null; }
	if (_isInteger(token)) { return token; }
	}
return null;
}
Date.prototype.getWeek = function() {
var newYear = new Date(this.getFullYear(),0,1);
var day = newYear.getDay() - (g_first_day_of_week - 1);
day = (day >= 0 ? day : day + 7);
var dayNum = Math.floor((this.getTime() - newYear.getTime() - (this.getTimezoneOffset()-newYear.getTimezoneOffset())*60000)/86400000) + 1;
var weekNum;
if (day < 4) {
weekNum = Math.floor((dayNum+day-1)/7) +1;
	if (weekNum > 52)
		weekNum = this._checkNextYear(weekNum);
	
	return weekNum;
}
weekNum = Math.floor((dayNum+day-1)/7);
if (weekNum < 1)
	weekNum = this._lastWeekOfYear();
else if (weekNum > 52) 
	weekNum = this._checkNextYear(weekNum);
return weekNum;	
}
Date.prototype._lastWeekOfYear = function() {
var newYear = new Date(this.getFullYear() - 1,0,1);
var endOfYear = new Date(this.getFullYear() - 1,11,31);
var day = newYear.getDay() - (g_first_day_of_week - 1);
var dayNum = Math.floor((endOfYear.getTime() - newYear.getTime() - (endOfYear.getTimezoneOffset()-newYear.getTimezoneOffset())*60000)/86400000) + 1;
return day < 4 ? Math.floor((dayNum+day-1)/7) + 1 : Math.floor((dayNum+day-1)/7);
}
Date.prototype._checkNextYear = function() {
var nYear = new Date(this.getFullYear() + 1,0,1);
var nDay = nYear.getDay() - (g_first_day_of_week-1);
nDay = nDay >= 0 ? nDay : nDay + 7;
return nDay < 4 ? 1 : 53;
}
Date.prototype.setWeek = function(weekNum) {
weekNum--;
var startOfYear = new Date(this.getFullYear(), 0, 1);
var day = startOfYear.getDay() - (g_first_day_of_week - 1);
if (day > 0 && day < 4) { 
	this.setFullYear(startOfYear.getFullYear() - 1);
	this.setDate(31 - day + 1);
	this.setMonth(11);
} else if (day > 3)
this.setDate(startOfYear.getDate() + (7-day));
this.setDate(this.getDate() + (7 * weekNum));
}
function getDateFromFormat(val,format) {
val=val+"";
format=format+"";
var i_val=0;
var i_format=0;
var c="";
var token="";
var token2="";
var x,y;
var now=new Date();
var year=now.getYear();
var month=now.getMonth()+1;
var date=0;
var hh=now.getHours();
var mm=now.getMinutes();
var ss=now.getSeconds();
var ampm="";
var week = false;
while (i_format < format.length) {
	c=format.charAt(i_format);
	token="";
	while ((format.charAt(i_format)==c) && (i_format < format.length)) {
		token += format.charAt(i_format++);
		}
	if (token=="yyyy" || token=="yy" || token=="y") {
		if (token=="yyyy") { x=4;y=4; }
		if (token=="yy")   { x=2;y=2; }
		if (token=="y")    { x=2;y=4; }
		year=_getInt(val,i_val,x,y);
		if (year==null) { return 0; }
		i_val += year.length;
		if (year.length==2) {
			if (year > 70) { year=1900+(year-0); }
			else { year=2000+(year-0); }
			}
		}
	else if (token=="MMM"||token=="NNN"){
		month=0;
		for (var i=0; i<MONTH_NAMES.length; i++) {
			var month_name=MONTH_NAMES[i];
			if (val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()) {
				if (token=="MMM"||(token=="NNN"&&i>11)) {
					month=i+1;
					if (month>12) { month -= 12; }
					i_val += month_name.length;
					break;
					}
				}
			}
		if ((month < 1)||(month>12)){return 0;}
		}
	else if (token=="EE"||token=="E") {
		for (var i=0; i<DAY_NAMES.length; i++) {
			var day_name=DAY_NAMES[i];
			if (val.substring(i_val,i_val+day_name.length).toLowerCase()==day_name.toLowerCase()) {
				if (week) {
if (i==0 || i == 7)
						date+=6;
else if (i== 2 || i == 9)
						date+=1;
else if (i== 3 || i == 10)
						date+=2;
else if (i == 4 || i == 11)
						date+=3;
else if (i == 5 || i == 12)
						date +=4;
else if (i == 6 || i== 13)
						date+=5;
				}					
				i_val += day_name.length;
				break;
				}
			}
		}
	else if (token=="MM"||token=="M") {
		month=_getInt(val,i_val,token.length,2);
		if(month==null||(month<1)||(month>12)){return 0;}
		i_val+=month.length;}
	else if (token=="dd"||token=="d") {
		date=_getInt(val,i_val,token.length,2);
		if(date==null||(date<1)||(date>31)){return 0;}
		i_val+=date.length;}
	else if (token=="hh"||token=="h") {
		hh=_getInt(val,i_val,token.length,2);
		if(hh==null||(hh<1)||(hh>12)){return 0;}
		i_val+=hh.length;}
	else if (token=="HH"||token=="H") {
		hh=_getInt(val,i_val,token.length,2);
		if(hh==null||(hh<0)||(hh>23)){return 0;}
		i_val+=hh.length;}
	else if (token=="KK"||token=="K") {
		hh=_getInt(val,i_val,token.length,2);
		if(hh==null||(hh<0)||(hh>11)){return 0;}
		i_val+=hh.length;}
	else if (token=="kk"||token=="k") {
		hh=_getInt(val,i_val,token.length,2);
		if(hh==null||(hh<1)||(hh>24)){return 0;}
		i_val+=hh.length;hh--;}
	else if (token=="mm"||token=="m") {
		mm=_getInt(val,i_val,token.length,2);
		if(mm==null||(mm<0)||(mm>59)){return 0;}
		i_val+=mm.length;}
	else if (token=="ss"||token=="s") {
		ss=_getInt(val,i_val,token.length,2);
		if(ss==null||(ss<0)||(ss>59)){return 0;}
		i_val+=ss.length;}
	else if (token=="a") {
		if (val.substring(i_val,i_val+2).toLowerCase()=="am") {ampm="AM";}
		else if (val.substring(i_val,i_val+2).toLowerCase()=="pm") {ampm="PM";}
		else {return 0;}
		i_val+=2;}		
else if (token == "w" || token == "ww") {
		var weekNum = _getInt(val,i_val,token.length, 2);		
		week = true;
		if (weekNum != null) {
			var temp = new Date(year, 0, 1, 0, 0, 0);
		    temp.setWeek(parseInt(weekNum, 10));
			year = temp.getFullYear();
			month = temp.getMonth()+1;				
			date = temp.getDate();	
		}
		weekNum += "";
		i_val += weekNum.length;
	}
	else if (token=="D") {
		if (week) {
			var day = _getInt(val,i_val,token.length, 1);
			if ((day == null) || (day <= 0) || (day > 7))
				return 0;
			var temp = new Date(year, month-1, date, hh, mm, ss);
			var dayOfWeek = temp.getDay();
			
			day = parseInt(day, 10);
			day = (day + g_first_day_of_week - 1) % 7;
			if (day == 0)
				day = 7;
			day--;
			
			if (day < dayOfWeek)
				day = 7 - (dayOfWeek - day);
			else
				day -= dayOfWeek;
			if (day > 0) {
				temp.setDate(temp.getDate() + day);
				
				year = temp.getFullYear();
				month = temp.getMonth() + 1;
				date = temp.getDate();
			}
			i_val++;
		}	
	} else if (token =="z")
		i_val+=3;
	else {
		if (val.substring(i_val,i_val+token.length)!=token) {return 0;}
		else {i_val+=token.length;}
		}
	}
	
if (format.indexOf('z') == -1 && i_val != val.length){ return 0; }
	else if (val.length < i_val || val.length > i_val+2){ return 0; }
if (month==2) {
if ( ( (year%4==0)&&(year%100 != 0) ) || (year%400==0) ) {
		if (date > 29){ return 0; }
		}
	else { if (date > 28) { return 0; } }
	}
if ((month==4)||(month==6)||(month==9)||(month==11)) {
	if (date > 30) { return 0; }
	}
if (hh<12 && ampm=="PM") { hh=hh-0+12; }
else if (hh>11 && ampm=="AM") { hh-=12; }	
var newdate=new Date(year,month-1,date,hh,mm,ss);	
return newdate.getTime();
}
function parseDate(val) {
	var preferEuro=(arguments.length==2)?arguments[1]:false;
	generalFormats=new Array('y-M-d','MMM d, y','MMM d,y','y-MMM-d','d-MMM-y','MMM d');
monthFirst=new Array('M/d/y','M-d-y','M.d.y','MMM-d','M/d','M-d');
dateFirst =new Array('d/M/y','d-M-y','d.M.y','d-MMM','d/M','d-M');
	yearFirst =new Array( 'yyyyw.F', 'yyw.F');
	var checkList=new Array('generalFormats',preferEuro?'dateFirst':'monthFirst',preferEuro?'monthFirst':'dateFirst', 'yearFirst');
	var d=null;
	for (var i=0; i<checkList.length; i++) {
		var l=window[checkList[i]];		
		for (var j=0; j<l.length; j++) {
			d=getDateFromFormat(val,l[j]);
			if (d!=0) { return new Date(d); }
			}
		}
	return null;
}
function getDurationString(ms) {
var sec = Math.floor(ms / 1000), s = '', days = Math.floor(sec/86400);
	if (days >= 1) {
	s += days + ' day' + (days > 1 ? 's' : '');
	 sec -= days * 86400;
	}
	
var hours = Math.floor(sec/3600);
	if (hours >= 1) {
		s += (days > 0 ? ' ' : '') + hours + ' hour' + (hours > 1 ? 's' : '');
		sec -= hours * 3600;
	}
	
var min = Math.floor(sec/60);
	if (days == 0) {
	if (min >= 1) {
	 s += (hours > 0 ? ' ' : '') + min + ' minute' + (min > 1 ? 's' : '');
	 if (hours < 1) {
		sec -= min * 60;
		if (sec > 0 && min <= 10)
		  s += ' ' + sec + ' second' + (sec > 1 ? 's' : ''); 
	 }
	} else if (hours == 0 && sec > 0)
	 s += sec + ' second' + (sec > 1 ? 's' : '');
	}
	return s;
}
function getUserDateTime() {
	var browserDate = new Date();
	var browserOffset = browserDate.getTimezoneOffset() * 60000;
	var utcTime = browserDate.getTime() + browserOffset;
	var userDateTime = utcTime + g_tz_offset;
	return new Date(userDateTime);
}
function convertUtcTimeToUserTimeMs(utcTimeMs) {
	var d = new Date();
	return parseInt(utcTimeMs) + (d.getTimezoneOffset() * 60000) + g_tz_offset;
}
function convertUserTimeToUtcTimeMs(userTimeMs) {
	var d = new Date();	
	return parseInt(userTimeMs) - (d.getTimezoneOffset() * 60000) - g_tz_offset;
}
;
/*! RESOURCE: /scripts/functions_clipboard.js */
window.NOW = window.NOW || {};
window.NOW.g_clipboard = {};
(function(exports) {
	var browserReturnsErroneousStatus = navigator.userAgent.indexOf('MSIE 9') != -1
		|| navigator.userAgent.indexOf('MSIE 10') != -1
		|| navigator.userAgent.indexOf('rv:11') != -1;
	exports.copyToClipboardAsync = function(string, callback) {
		if (navigator.clipboard.writeText) {
			navigator.clipboard.writeText(string).then(() => {
				fireCopiedMessage();
				if (callback)
					callback();
			});
		} else {
			legacyClipboardCopy(string);
		}
	};
	exports.copyToClipboard = function(str, messageMethod) {
		if (document.execCommand && isCapableMessageMethod(messageMethod)) {
			var v = document.createElement('textarea');
			v.innerHTML = str;
			v.className = "sr-only";
			document.body.appendChild(v);
			v.select();
			var result = true;
			try {
				result = document.execCommand('copy');
				if (result && browserReturnsErroneousStatus) {
					var checkDiv = document.createElement('textarea');
					checkDiv.className = "sr-only";
					document.body.appendChild(checkDiv);
					checkDiv.select();
					try {
						document.execCommand('paste');
						result = checkDiv.value == str;
					} finally {
						document.body.removeChild(checkDiv);
					}
				}
			} catch (e) {
				result = false;
				if (window.jslog)
					jslog("Couldn't access clipboard " + e);
			} finally {
				document.body.removeChild(v);
			}
			if (result) {
				fireCopiedMessage(messageMethod);
				return true;
			}
		}
		legacyClipboardCopy(str);
		return false;
	}
	function isCapableMessageMethod(messageMethod) {
		if (messageMethod == 'custom')
			return true;
		return 'GlideUI' in window;
	}
	function fireCopiedMessage(messageMethod) {
		if (typeof getMessage == 'function')
			getMessage('Copied to clipboard', showCopiedMessage.bind(null, messageMethod));
		else
			showCopiedMessage(messageMethod, 'Copied to clipboard');
	}
	
	function showCopiedMessage(messageMethod, msg) {
		if (!messageMethod || messageMethod == 'GlideUI') {
			var options = {
				text: msg,
				type: 'info',
				closeDelay: '2500',
				styles: {
					position: 'fixed',
					width: '60%'
				}
			};
			GlideUIDefault.display(options);
		}
	}
	function legacyClipboardCopy(meintext) {
		prompt("Because of a browser limitation the URL can not be placed directly in the clipboard. " +
			"Please use Ctrl-C to copy the data and escape to dismiss this dialog", meintext);
	}
})(window.NOW.g_clipboard);
;
/*! RESOURCE: /scripts/context_actions.js */
function switchView(type, tableName, viewName) {
	
ScriptLoader.getScripts('scripts/classes/GlideViewManager.js', function() {
		if (type == 'list')
			new GlideViewManager(tableName, viewName).refreshList();
		else
			new GlideViewManager(tableName, viewName).refreshDetail();
	})
}
function copyRowToClipboard(base, ref, sysId, view) {
	var url = base + "nav_to.do?uri=" + ref + ".do?sys_id=" + sysId;
	if (view)
		url += "%26sysparm_view=" + view;
	copyToClipboard(url);
}
function doUpdate(scope) {
	var name = gActiveContext.getTableName();
	var temp = name + '_update.do';
	var form = getControlForm(name);
	var msg = [ 'There are no rows selected', 'Update the entire list?', 'records' ];
	var answer = getMessages(msg);
	if (scope == 'selected' && getChecked(form) == '') {
		alert(answer['There are no rows selected']);
		return;
	}
	form.action = temp;
	addInput(form, 'HIDDEN', 'sys_action', 'sysverb_multiple_update');
	addInput(form, 'HIDDEN', 'sysparm_multiple', 'true');
	addInput(form, 'HIDDEN', 'sysparm_nostack', 'yes');
	if (scope == 'selected')
		populateParmQuery(form, 'sys_idIN', 'NULL');
	else {
		if (!confirm(answer['Update the entire list?'] + " ("
				+ form.sysparm_total_rows.value + " " + answer['records'] + ")")) {
			return;
		}
	}
	form.submit();
}
function contextAction(tableName, actionName) {
	var form = getControlForm(tableName);
	addInput(form, 'HIDDEN', 'sys_action', actionName);
    form.submit();
}
function contextConfirm(tableName, actionName) {
    var sysparm_rows = gel('sysparm_total_rows').value;
    var num_rows = parseInt(sysparm_rows);
    var sysparm_query = gel('sysparm_query');    
    if (sysparm_query)
        sysparm_query = sysparm_query.value;
    else
        sysparm_query = '';
        
    var sysparm_view = getView(tableName);
        
    if (num_rows < g_export_warn_threshold) {
        var dialog = new GwtPollDialog(tableName, sysparm_query, sysparm_rows, sysparm_view, actionName);
        dialog.execute();	 	
        return;
    }
    var dialog = new GwtExportScheduleDialog(tableName, sysparm_query, sysparm_rows, sysparm_view, actionName);
    dialog.execute();	 	
}
function executeRecentSearch(searchTerm, url) {
	parent.document.getElementById('sysparm_search').value = decodeURIComponent(searchTerm);
	window.open(url,'gsft_main');
	CustomEvent.fire('adjustsearch');
}
function getView(tableName) {
	var sysparm_view = '';
	if (isReport()) {
		var form = getControlForm(tableName);
		if (form) {
			var temp = form['sysparm_view'];
			if (temp)
				sysparm_view = temp.value;
		}
	}
	if (sysparm_view != '')
		return sysparm_view;
	var sp = gel('sysparm_view');
	if (sp)
		sysparm_view = sp.value;
	return sysparm_view;
	function isReport() {
		var list = gel('reportform_control');
		if (list)
			return true;
		return false;
	}
}
var copyToClipboard = typeof window.NOW.g_clipboard !== 'undefined' ? window.NOW.g_clipboard.copyToClipboard : null;
var copyToClipboardAsync = typeof window.NOW.g_clipboard !== 'undefined' ? window.NOW.g_clipboard.copyToClipboardAsync : null;
function showQuickForm(id, action, width, height) {
	var form;
	var tableName;
	var srcElement;
	var keyset;
	
	if (window.lastEvent) {
		srcElement = getSrcElement(window.lastEvent);
		form = srcElement.form;
		
		if (srcElement.tagName == "SELECT") {
			var o = srcElement.options[srcElement.selectedIndex];
			tableName = o.getAttribute("table");
		} else  
			tableName = srcElement.getAttribute("table");
		
		if ((action == undefined || action == '') && srcElement.value)
	    	action = srcElement.value;
		if (!form)
			keyset = g_list.getChecked();
		else
			keyset = getChecked(form);
			
window.lastEvent = null;
	}	
	
	if (tableName == undefined) {
		
		if (typeof(gcm) == 'undefined')
			gcm = crumbMenu;
		tableName = gcm.getTableName();
		form = getFormForList(tableName);
		if (typeof(rowSysId) != 'undefined') 
keyset = rowSysId;
		else 
keyset = getChecked(form);
gcm.setFiringObject();
	}  
		
	if ( (!form && !tableName) || (!tableName && g_list))
		return;
	if (!keyset || keyset == '') {
		alert("No records selected");
		return;
	}
	
	var gForm = new GlideDialogForm("", tableName+"_update");
	
	if (width && height)
		gForm.setDialogSize(width, height);
	
    gForm.addParm('sysparm_view', id);
    gForm.setMultiple(form);
    gForm.addParm('sysparm_checked_items', "sys_idIN" + keyset);
	if (action && action != '')
	   gForm.addParm('sysparm_action_name', action);
    gForm.render();
}
function personalizeResponses(id) {
	var parts = id.split('.');
	var mytable = parts[0];
	var myfield = parts[1];	
	var myreferurl = document.getElementById('sysparm_this_url_enc');
	var url = "response_list.do?sysparm_name=" + mytable +
				"&sysparm_element=" + myfield +
				"&sysparm_target=" + id +
				"&sysparm_view=sys_response_tailor";
			  
	if (myreferurl)
		url += "&sysparm_referring_url=" + myreferurl.value;
			  	
	self.location = url;
}
function personalizeChoices(id) {
	var mytable = id.split('.')[0];
	var mydependent = document.getElementById('ni.dependent_reverse.' + id);
	
	var url = new GlideURL("slushbucket_choice.do");
	url.addParam('sysparm_ref', id);
	url.addParam('sysparm_form', 'sys_choice');
	url.addParam('sysparm_dependent', (mydependent? mydependent.value : ""));
	url.addParam('sysparm_stack', 'no');
			  
	if (mydependent != null) {
		var el = document.getElementsByName(mytable + "." + mydependent.value)[0];
		if (el != null) {
			var selectValue;
				if (el.options) 
					selectValue = el.options[el.selectedIndex].value;
				else
					selectValue = el.value;
				url.addParam('sysparm_dependent_value', selectValue);
		}
	}
	
	self.location = url.getURL();
}
function personalizeControl(strIdent, id, query) {
    var url = 'sys_ui_list_control.do?sys_id=' + id;
    if (query && query != '')
       url += "&sysparm_query=" + query;
    window.location = url;
}
function personalizer(strIdent, strForm, strSysId) {
	if (strIdent == 'auto' && window.$j) {
		strIdent = $j('[data-section-id]').first().attr('data-section-id');
	}
	var parentForm = getControlForm(strIdent);
    var form = document.forms['sys_personalize'];
   
	if (parentForm && parentForm['sysparm_collection_relationship'])
		addInput(form, 'HIDDEN', 'sysparm_collection_relationship', parentForm['sysparm_collection_relationship'].value);
	else
		addInput(form, 'HIDDEN', 'sysparm_collection_relationship', '');
	
    addInput(form, 'HIDDEN', 'sysparm_list', strIdent);
    addInput(form, 'HIDDEN', 'sysparm_form', strForm);
    addInput(form, 'HIDDEN', 'sysparm_sys_id', strSysId);
    
    if (parentForm && parentForm['sysparm_collection'])
		addInput(form, 'HIDDEN', 'sysparm_collection', parentForm['sysparm_collection'].value);
    var scopeElement = gel('sysparm_domain_scope');
    if (scopeElement && scopeElement.value) {
        addInput(form, 'HIDDEN', 'sysparm_domain_scope', scopeElement.value);
    }
    
	if(typeof GlideTransactionScope != 'undefined') {
		GlideTransactionScope.appendTransactionScope(function(name, value) {
			addInput(form, 'HIDDEN', name, value);
		});
	}
    
    form.submit();
}
function personalizeList(listId, tableName) {
	var parentForm = getFormForList(listId);
    var form = document.forms['sys_personalize'];
   
	if (parentForm && parentForm['sysparm_collection_relationship'])
		addInput(form, 'HIDDEN', 'sysparm_collection_relationship', parentForm['sysparm_collection_relationship'].value);
	else
		addInput(form, 'HIDDEN', 'sysparm_collection_relationship', '');
	
    addInput(form, 'HIDDEN', 'sysparm_list', tableName);
    addInput(form, 'HIDDEN', 'sysparm_form', 'list');
    
    if (parentForm && parentForm['sysparm_collection'])
		addInput(form, 'HIDDEN', 'sysparm_collection', parentForm['sysparm_collection'].value);
	else
		addInput(form, 'HIDDEN', 'sysparm_collection', '');
	if (typeof GlideTransactionScope !== 'undefined') {
		GlideTransactionScope.appendTransactionScope(function(name, value) {
			addInput(form, 'HIDDEN', name, value);
		});
	}
	form.submit();
}
function personalizeField(identifier, formName) {
    var form = document.forms['sys_personalize'];
    var fields = 'name.element.language';
    if (formName && formName.indexOf('sys_dictionary') == 0)
       fields = 'name.element';
       
    addQueryFilter(form, fields, identifier, '', formName);
   	form.action = formName;
    form.submit();
}
function personalizeFields(identifier, formName) {
    var form = document.forms['sys_personalize'];
    addQueryFilter(form, 'name', identifier);
   	form.action = formName;
    form.submit();
}
function personalizeSecurity(identifier, field_name) {
    var a = field_name.split('.');
    var g_dialog = new GlideDialogWindow('security_mechanic');
    g_dialog.setPreference('table_name', a[0]);
    g_dialog.setPreference('field_name', a[1]);
	g_dialog.setSize(600, '');
    g_dialog.setTitle('Security Mechanic');
    g_dialog.render();
}
function showDictionary(identifier, field_id) {
    var a = field_id.split('.');
    var g_dialog = new GlideDialogWindow('dictionary_viewer');
    g_dialog.setPreference('table_name', a[0]);
    g_dialog.setPreference('field_name', a[1]);
    g_dialog.setTitle('Dictionary Info: ' + field_id);
    g_dialog.render();
}
function listSecurity(identifier, field_name) {
	var form = document.forms['sys_personalize'];
	addQueryFilter(form, 'CALCULATED:SecurityQueryCalculator', field_name);
	form.action = "sys_security_acl_list.do";
    form.submit();
}
function listCollection(coll_table, coll_field, of_table, view_name) {
	var form = document.forms['sys_personalize'];
	addQueryFilter(form, 'CALCULATED:CollectionQueryCalculator', of_table + ',' + coll_field + ',' + view_name);
    addInput(form, 'HIDDEN', 'sysparm_domain_restore', 'false');
	form.action = coll_table + "_list.do";
    form.submit();
}
function exportToPDF(table, sys_id, isLandscape, sysparm_view, sysparm_domain){
	
	var relatedListFilters = "";
	if (window.g_tabs2List && g_tabs2List.tabIDs) {
		var relatedLists = g_tabs2List.tabIDs;
		var relatedListCount = relatedLists.length;
		if (relatedListCount > 0) {
			for (var i = 0; i < relatedListCount; i++) {
				var relatedListName = relatedLists[i].substring(0, relatedLists[i].lastIndexOf("_list"));
				var filter = getFilter(relatedListName);
				if(!filter) {
					filter = getFilterViaTableDiv(relatedListName+"_table")
				}
				if (filter && filter.length > 0) {
					if (i == relatedListCount - 1)
						relatedListFilters += relatedListName + "=" + encodeURIComponent(encodeURIComponent(filter));
					else
						relatedListFilters += relatedListName + "=" + encodeURIComponent(encodeURIComponent(filter)) + "^";
				}
			}
		}
	}
	
	var url = table + ".do?sys_id=" + sys_id + "&PDF" + "&sysparm_view=" + sysparm_view + "&related_list_filter=" + relatedListFilters + "&sysparm_domain=" + sysparm_domain;
	
	if (isLandscape)
		url += "&landscape=true";
	
	window.location = url;
	
}
function showList(tableName, fields, ids) {
	if (!ids)
		ids = gActiveContext.getTableName();
	
	self.location = tableName + "_list.do?sysparm_query=" + addQueryFilter('', fields, ids, tableName, null, true);	
}
function showItem(tableName, fields, ids, view) {
	if (!ids)
		ids = gActiveContext.getTableName();
    var url = tableName + ".do?sysparm_query=" + addQueryFilter('', fields, ids, tableName);
    if (typeof(view) != "undefined") {
    	url += "&sysparm_view=" + view;
    }
    self.location = url;
}
function addQueryFilter(form, names, values, table, formName, useBaseTable) {
	var tableName = table;
    if ((names == '' || names == null) || (values == '' || values == null))
        return;
    if (names.indexOf("CALCULATED") == 0) {
    	var ec = "";
    	if (names.indexOf("CollectionQueryCalculator") > 0)
    		ec = collectionQueryCalculator(values);
    	else
    	    ec = securityQueryCalculator(values);
    	addInput(form, "HIDDEN", "sysparm_query", ec);
    	addInput(form, "HIDDEN", "sysparm_query_encoced", ec);
        return;
    } 
    var vNames = names.split(".");
    var vValues = values.split(".");
    if (names.indexOf("name.element") == 0) {
        if (vValues.length > 2) {
            var tableElement = TableElement.get(values);
            if (tableElement.type == 'glide_var') {
                vValues[0] = vValues[2];
                vValues[1] = vValues[3];
            } else {
                vValues[0] = tableElement.getTableName();
                vValues[1] = tableElement.getName();
            }
        } else {
            var tableR = new Table(vValues[0]);
            var element = tableR.getElement(vValues[1]);
            var label = '';
            if (formName && formName.indexOf("sys_documentation") == 0)
                 label = getTableLabel(tableR.getName(), element.getName());
                 
            if (label == '' && element != null)
                vValues[0] = useBaseTable === true ? element.getBaseTableName() : element.getTableName();
        }
    } 
    
    if (names.indexOf("name.element.language") == 0) {   
    	vValues[2] = g_lang;
    }
    var query = new Array();
    for (var i = 0; i < vNames.length; i++) {
    	if ("sys_choice" == tableName && "name" == vNames[i]) {
    		query.push("nameINjavascript:getTableExtensions('" + vValues[i] +"')");
    	}
    	else if ("sys_ui_style" == tableName && "name" == vNames[i]) {
    		query.push(buildQueryClause(values.split(".")[0], "name"));
    	}
    	else
    		query.push(vNames[i] + "=" + vValues[i]);
    }
    
    if(tableName)
    	return query.join('^');
    
    addInput(form, "HIDDEN", "sysparm_query", query.join('^'));
    addInput(form, "HIDDEN", "sysparm_query_encoded", query.join('^'));
	setStack(form);
}
function getTableLabel(tabel, element) {
	var ajax = new GlideAjax('ContextActionsAjax');
	ajax.addParam("sysparm_name", "getLabel");
	ajax.addParam("sysparm_type", tabel);
	ajax.addParam("sysparm_value", element);
	ajax.getXMLWait();
	return ajax.getAnswer();
}
function collectionQueryCalculator(args) {
	var sa = args.split(",");
	var tableName = sa[0];
	var collField = sa[1];
	return buildQueryClause(tableName, collField);
}
function buildQueryClause(tableName, collField) {
	var tableDef = Table.get(tableName);
	var tables = tableDef.getTables();
	var result = new Array();
	
    result.push(collField);
	result.push("=");
	result.push(tableName);
	
	result.push("^OR");
    result.push(collField);
	result.push("IN");
	result.push(tables.join());
	return result.join("");
}
function securityQueryCalculator(values) {
    var sa = values.split(".");
    var fieldName = null;
    var element = null;
    var tableName = sa[0];
    if (sa.length > 1)
        fieldName = sa[1];
    var allTables = new Array();
    var table = new Table(tableName);
    if (fieldName == null)
        allTables = table.getTables();
    else {
        allTables.push(tableName);
        element = table.getElement(fieldName);
        if (element != null && element.getTableName() != tableName)
            allTables.push(element.getTableName());
        
        allTables.push("*");
    }
    var rc = getRules(allTables, fieldName);
    return rc;
}
function getRules(allTables, fieldName) {
    var rules = null;
    if (fieldName == null) {
        rules = "name=*^ORnameSTARTSWITH*.";
        for ( var i = 0; i < allTables.length; i++)
            rules += "^ORname=" + allTables[i] + "^ORnameSTARTSWITH" + allTables[i] + ".";
        return rules;
    }
    var rc = new Array();
    for ( var x = 0; x < allTables.length; x++) {
        var tableName = allTables[x];
        rc.push(tableName);
        rc.push(tableName + ".*");
        if (fieldName != null)
            rc.push(tableName + "." + fieldName);
    }
    rules = "nameIN" + rc.join();
    
    return rules;
}
function setWatchField(id) {
	var ajax = new GlideAjax('ContextActionsAjax');
	ajax.addParam("sysparm_name", "setWatchField");
	ajax.addParam("sysparm_id", id);
	ajax.getXML(function() {CustomEvent.fire('glide_optics_inspect_watchfield', id)});
}
function showWatchField(id) {
    var ajax = new GlideAjax('ContextActionsAjax');
    ajax.addParam("sysparm_name", "setWatchField");
    ajax.addParam("sysparm_id", id);
    ajax.getXML(function() {CustomEvent.fire('glide_optics_inspect_show_watchfield', id)});
}
function clearWatchField(id) {
	var ajax = new GlideAjax('ContextActionsAjax');
	ajax.addParam("sysparm_name", "clearWatchField");
	ajax.getXML();
	ajax.getXML(function() {CustomEvent.fire('glide_optics_inspect_clear_watchfield', id)});
}
function setStack(form) {
	var url = new GlideURL(window.location.href);
	var stack = url.getParam('sysparm_nameofstack');
	if (stack)
		addInput(form, 'HIDDEN', 'sysparm_nameofstack', stack);
}
;
/*! RESOURCE: /scripts/depends.js */
function getNameFromElement(elementName) {
	var names = elementName.split(".");
	names = names.slice(1);
	return names.join(".");
}
function loadFilterColumns(fname, dependent) {
	var value = resolveDependentValue(fname, dependent);
    var names = fname.split(".");	
	serverRequest("xmlhttp.do?sysparm_include_sysid=true&sysparm_processor=SysMeta&sysparm_table_name=false&sysparm_type=column&sysparm_nomax=true&sysparm_value=" + names[0], getFilterColumnsResponse, [fname, dependent]);
	CustomEvent.fire('conditions:dependent_change');
}
function getFilterColumnsResponse(evt, args) {
	var fname = args[0];
	var dep = args[1];
	var hinput = document.getElementById(fname);
 	filterExpanded = true;
	var table = resolveDependentValue(fname, dep);
	var xfilter = unescape(hinput.value);
	var form = findParentByTag(hinput, "FORM");
	if (table) {
		firstTable = table;
		createCondFilter(table + "." + fname, xfilter, fname);
	}
}	
function gotTemplateResponseWithRef(fn, name) {
	if(typeof name !== 'string' || name.length === 0)
		return fn;
	return function() {
		var args = Array.prototype.slice.call(arguments);
		args.push(name);
		fn.apply(null, args);
	}
}
function onSelChange(elementName, fromSetTemplateValue) {
	var elementId = elementName;
	var includesSysSelect = elementName.indexOf("sys_select.") === 0;
	if (includesSysSelect)
		elementId = elementName.replace("sys_select.", "");
	var df = new DerivedFields(elementId, gel(elementName).value);
	df.clearRelated();
	df.updateRelated();
	var vName = "ni.dependent." + getNameFromElement(elementId);
	var eDeps = document.getElementsByName(vName);
	jslog("*************---->" + eDeps.length);
	for (var i = 0; i < eDeps.length; i++) {
		var eDep = eDeps[i];
		if (eDep == null)
			continue;
	      
		var f = eDep.attributes.getNamedItem('onDependentChange');
		if (f) {
			eval(f.nodeValue);
			continue;
		}
		if (df.isDerivedWaitingClearValue() && eDep.hasAttribute('data-ref-qual'))
			continue;
		var name = eDep.value;
	
		var eChanged = gel(elementName);
		var value;
		if (eChanged.options) {
			var selected = eChanged.selectedIndex;
			value = eChanged.options[selected].value;
		} else
			value = eChanged.value;
		var retFunc = selResponseHelper(includesSysSelect || isReferenceType(name), fromSetTemplateValue);
		var ajax = new GlideAjax("set_from_attributes");
		var argCnt = 0;
		for (var ac = 0; ac < eDep.attributes.length; ac++) {
			var itemName = eDep.attributes[ac].name;
	
			if (itemName.substring(0, 7).toLowerCase() == "sysparm") {
				var pvalue = eDep.attributes[ac].value;
				ajax.addParam(itemName, pvalue);
				argCnt++;
			} else if (itemName == "function") {
				var fdef = eDep.attributes[ac].value;
				var index = fdef.indexOf("(");
				if (index == -1) {
					retFunc = eval(eDep.attributes[ac].value);
					retFunc = gotTemplateResponseWithRef(retFunc, eDep.dataset.ref);
				}
				else
					retFunc = fdef;
			}
		}
	
		if (argCnt == 0)
			continue;
		ajax.addParam("sysparm_value", value);
		ajax.addParam("sysparm_name", name);
		ajax.addParam("sysparm_chars", "*");
		ajax.addParam("sysparm_nomax", "true");
		if ('true' == eDep.getAttribute('data-ref-qual') && typeof g_form !== 'undefined') {
			if (g_form.isNewRecord() || _hasEmptyAncestor(g_form._removeTableName(name)))
				ajax.addEncodedString(g_form.serialize());
			else  {
				var encoded = g_form.serializeChangedAll();
if (!gel(elementId).changed)
					encoded += g_form._serializeElement(elementId);
				ajax.addEncodedString(encoded);
			}
		}
		
		var scopeElement = gel('sysparm_domain_scope');
		if (scopeElement && scopeElement.value) {
			ajax.addParam("sysparm_domain_scope", scopeElement.value);
		}
	    
		var domainElement = gel('sysparm_domain');
		if (domainElement && domainElement.value) {
			ajax.addParam("sysparm_domain", domainElement.value);
		}
		if ( fromSetTemplateValue ) {
			ajax.setWantRequestObject(true);
			var responseObject = ajax.getXMLWait();
			if (responseObject.responseXML)
				retFunc(responseObject, eChanged);
		} else {
			ajax.getXML(retFunc, null, eChanged);
		}
	}
}
function _hasEmptyAncestor(v) {
	var name = v.substring(0, v.lastIndexOf('.'));
	return !!name && (g_form.getValue(name) == '' || _hasEmptyAncestor(name));
}
function isReferenceType(name) {
	return getDataType(name) =='glide_element_reference_choice';
}
function getDataType(name) {
	var input = gel(name);
	return input && input.getAttribute('data-type') || '';
}
function getDefaultOption(name, e) {
	if (e.getAttribute("sysparm_processor") !== "PickList")
		return null;
	var defaultOption = e.getAttribute("default_option");
	if (defaultOption)
		return defaultOption;
	if ("glide_element_reference_choice_without_none" !== getDataType(name))
		return getMessage('-- None --');
	return null;
}
function selResponse(request, containsSysSelect, fromSetTemplateValue) {
	if (!request || !request.responseXML)
		return;
		
    var e = request.responseXML.documentElement;
	var elementName = e.getAttribute("sysparm_name");
	if (containsSysSelect && gel('sys_display.original.' + elementName))
		elementName = "sys_select." + elementName;
	var selectedItem = e.getAttribute("select_option");
	var select = gel(elementName);
	var currentValue = select.value;
	var isSelect2 = select.className.indexOf('select2') > -1;
	
	try {	
select.options.length = 0;
	} catch (e) {
	}
	var defaultOption = getDefaultOption(elementName, e);
	if (defaultOption)
		appendSelectOption(select, "", document.createTextNode(defaultOption));
	var items = request.responseXML.getElementsByTagName("item");
	for (var i = 0; i < items.length; i++) {
		var item = items[i];
		var t = item.getAttribute("value");
		var label = item.getAttribute("label");
		var hint = item.getAttribute("hint");
		if (defaultOption == null || label !== defaultOption) {
			if (isSelect2){
				var newOption = new Option(label, t);
				$j(select).append(newOption);
			} else 
				var opt = appendSelectOption(select, t, document.createTextNode(label));
			if (hint != '' && opt)
				opt.title = hint;
			if (selectedItem && label == selectedItem)
				if (isSelect2)
					$j(select).val(t);
				else
				opt.selected = true;
			else if (currentValue && t == currentValue) {
				if(isSelect2)
					$j(select).val(currentValue);
				else
					opt.selected = true;
				currentValue = '';
			}
		}
	}
	if (select['onchange'])
		select.onchange.call(select, null, fromSetTemplateValue);
	if (!select.value && typeof g_form != 'undefined')
		g_form._setEmptyMandatoryFieldsVisible(elementName);
	
}
function selResponseHelper(hasSysSelect, fromSetTemplateValue) {
	return function (request) {
		selResponse(request, hasSysSelect, fromSetTemplateValue);
	}
}
function hasDepends(elementName) {
    var vName = "ni.dependent." + getNameFromElement(elementName);
    var eDep = document.getElementsByName(vName)[0];
    return eDep;
}
function resolveDependentValue(id, depname, deptable) {
	var systable = id.split(".")[0];
 	var table = null;
 	var dep = document.getElementById(systable + '.' + depname);
 	if (dep != null) {
   		if (dep.tagName == 'SELECT')
	  		table = dep.options[dep.selectedIndex].value
   		else
      		table = dep.value;
   		table = table.split(".")[0];
 	} else {
   		table = deptable;
 	}
 	if (table == '*' || table == '' || table == 'null')
		table = null;
	return table;
}
function loadFields(fname, dependent, types, script_types, ref_types, script_ref_types, script_ref_types_dependent, field_choices_script, show_field_name_on_label, access_table) {
	var depValue = resolveDependentValue(fname, dependent, dependent);
	loadFieldsWithValue(fname, depValue, types, script_types, ref_types, script_ref_types, script_ref_types_dependent, field_choices_script, show_field_name_on_label, access_table, dependent);
}
function loadFieldsWithValue(fname, table, types, script_types, ref_types, script_ref_types, script_ref_types_dependent, field_choices_script, show_field_name_on_label, access_table, dependent) {
	var script_ref_types_dependent_value = "";
	if (script_ref_types_dependent) {
		var systable = fname.split(".")[0];
		var s_dep = gel(systable + '.' + script_ref_types_dependent);
		if (s_dep != null) {
			 if (s_dep.tagName == 'SELECT')
				 script_ref_types_dependent_value = s_dep.options[s_dep.selectedIndex].value;
			 else
				 script_ref_types_dependent_value = s_dep.value;
		}
	}
	if (table)
		getTableColumns(table, fname, types, script_types, ref_types, script_ref_types, script_ref_types_dependent_value, field_choices_script, show_field_name_on_label, access_table);
	else if(dependent)
		clearDropdownOptions(fname);
}
function clearDropdownOptions(fieldNameId) {
	var fieldNameElement = gel(fieldNameId);
	if (fieldNameElement) {
		fieldNameElement.innerHTML = '';
		fieldNameElement.options = [];
		fieldNameElement.options[0] = new Option(getMessage('-- None --'), '');
	}
}
function getTableColumns(table, ref, types, script_types, ref_types, script_ref_types, script_ref_types_dependent_value, field_choices_script, show_field_name_on_label, access_table) {
	
    if (!types)
  	   types = "";
    if (!script_types)
        script_types = "";
	if (!ref_types)
		ref_types = "";
	if (!script_ref_types)
		script_ref_types = "";
	if (!script_ref_types_dependent_value)
		script_ref_types_dependent_value = "";
	
	var serverRequestString = "xmlhttp.do?sysparm_include_sysid=true&sysparm_processor=SysMeta&sysparm_table_name=false&sysparm_type=column&sysparm_nomax=true" +
      "&sysparm_value=" + table + 
	  "&sysparm_types=" + types + 
	  "&sysparm_script_types=" + script_types +
	  "&sysparm_script_ref_types_dependent_value=" + script_ref_types_dependent_value +
	  "&sysparm_script_ref_types=" + script_ref_types +
	  "&sysparm_ref_types=" + ref_types + 
      "&sysparm_containing_table=" + $('sys_target').value;
	
  	if (field_choices_script && field_choices_script != "") 
		serverRequestString += "&sysparm_field_choices_script=" + field_choices_script;
	if (show_field_name_on_label && show_field_name_on_label != "") 
		serverRequestString += "&sysparm_show_field_name_on_label=" + show_field_name_on_label;
	if (access_table)
		serverRequestString += "&sysparm_access_table=" + access_table;
	serverRequestString += "&sysparm_ref_field=" + encodeURIComponent(ref);
	field_choices_script = field_choices_script ? field_choices_script : undefined;
	show_field_name_on_label = show_field_name_on_label ? show_field_name_on_label : undefined;
	access_table = access_table ? access_table : undefined;
	var cacheObjItem = getDependantCacheObj(table, types, script_types, ref_types, script_ref_types, script_ref_types_dependent_value, field_choices_script, show_field_name_on_label, access_table);
	var field_name = ref.split(".").pop();
	var field_has_server_value = !!g_form.getValue(field_name);
	if (!cacheObjItem || field_has_server_value) {
		var tmpObj = {};
		tmpObj.table = table;
		tmpObj.types = types;
		tmpObj.scriptTypes = script_types;
		tmpObj.refTypes = ref_types;
		tmpObj.scriptRefTypes = script_ref_types;
		tmpObj.scriptRefTypesDependentValue = script_ref_types_dependent_value;
		tmpObj.choicesScript = field_choices_script;
		tmpObj.nameOnLabel = show_field_name_on_label;
		tmpObj.accessTable = access_table;
		tmpObj.fields = [];
		tmpObj.fields.push(ref);
		tmpObj.data = "";
		dependantCacheObjArray.push(tmpObj);
		serverRequest(serverRequestString, getTableColumnsResponse, ref);
	} else if(cacheObjItem && cacheObjItem.data === "")
		cacheObjItem.fields.push(ref);
	else if (cacheObjItem && cacheObjItem.data !== "")
		getTableColumnsResponse(cacheObjItem.data, ref)
}
var dependantCacheObjArray = [];
function getDependantCacheObj(table, types, scriptTypes, refTypes, scriptRefTypes, scriptRefTypesDependentValue, choicesScript, nameOnLabel, accessTable) {
	return dependantCacheObjArray.filter(function(co) {
		return co.table === table && 
				co.types === types && 
				co.scriptTypes === scriptTypes && 
				co.refTypes === refTypes && 
				co.scriptRefTypes === scriptRefTypes && 
				co.scriptRefTypesDependentValue === scriptRefTypesDependentValue && 
				co.choicesScript === choicesScript && 
				co.nameOnLabel === nameOnLabel && 
				co.accessTable === accessTable;
	})[0];
}
function getTableColumnsResponse(request, ref) {
	var reqUrl = request.responseURL;
	if (reqUrl) {
		var params = reqUrl.split("?")[1].split("&");
		var table;
		var types;
		var script_types;
		var ref_types;
		var script_ref_types;
		var script_ref_types_dependent_value;
		var field_choices_script;
		var show_field_name_on_label;
		var access_table;
		for (var i = 0; i < params.length; i++) {
			var parts = params[i].split("=");
			switch(parts[0]) {
				case 'sysparm_value':
					table = parts[1];
					break;
				case 'sysparm_types':
					types = parts[1];
					break;
				case 'sysparm_script_types':
					script_types = parts[1];
					break;
				case 'sysparm_ref_types':
					ref_types = parts[1];
					break;
				case 'sysparm_script_ref_types':
					script_ref_types = parts[1];
					break;
				case 'sysparm_script_ref_types_dependent_value':
					script_ref_types_dependent_value = parts[1];
					break;
				case 'sysparm_field_choices_script':
					field_choices_script = parts[1];
					break;
				case 'sysparm_show_field_name_on_label':
					show_field_name_on_label = parts[1];
					break;
				case 'sysparm_access_table':
					access_table = parts[1];
					break;
			}
		}
		var cacheObjItem = getDependantCacheObj(table, types, script_types, ref_types, script_ref_types, script_ref_types_dependent_value, field_choices_script, show_field_name_on_label, access_table);
		if (cacheObjItem && cacheObjItem.data === "") {
			cacheObjItem.data = request;
			var fields = cacheObjItem.fields;
			for (var i = 0; i < fields.length; i++)
				getTableColumnsResponse(request, fields[i]);
		}
	}
    var fname = ref;
	var tcols = request.responseXML;
    var scols = gel(fname);
    var currentvis = scols.style.visibility;
    scols.style.visibility = "hidden";
	var cfield = gel('sys_original.' + fname);
	cValue = cfield.value;
	if (typeof g_form != 'undefined')
		cValue = g_form.getValue(fname);
	if (typeof scols.options === 'undefined')
		scols.options = [];
	else
		scols.options.length = 0;
var includeNone = scols.attributes.getNamedItem('include_none');
	if (includeNone && includeNone.nodeValue === 'true')
		scols.options[scols.options.length] = new Option(getMessage('-- None --'), '');
	else
		scols.options[0] = new Option(getMessage('-- None --'), '');
	var items = tcols.getElementsByTagName("item");
	var selectedIndex = 0;
	var defaultValue = tcols.documentElement.getAttribute('default_value');
	for (var i = 0; i != items.length; i++) {
		var item = items[i];
		var value = item.getAttribute("value");
		var label = item.getAttribute("label");
		scols.options[scols.options.length] = new Option(label, value);
		if (cValue == value || (access_table && defaultValue && defaultValue === value))
			selectedIndex = scols.options.length - 1;
	}
	scols.selectedIndex = selectedIndex;
    scols.style.visibility = currentvis;
	CustomEvent.fire('getTableColumnsResponse.received');
	fireSetValueEvent();
}
function fireSetValueEvent() {
    if(typeof g_form != 'undefined') {
		var form = g_form.getFormElement();
		if(typeof form != 'undefined')
			$(form).fire('glideform:setvalue');
	}
}
;
/*! RESOURCE: /scripts/email_activity.js */
function setEmailBody(id) {
	var iframeID = id + ".body";
	var iframe = gel(iframeID);
	if (iframe) 
		return;
	
	iframe = cel("iframe");
	iframe.id = iframeID;
	iframe.width="100%";
	iframe.frameBorder = "0";
	Event.observe(iframe, "load", emailResizeObserved.bind(iframe), true);
	iframe.src = "email_display.do?email_id=" + id;
	iframe.email_id = id;
	
	var cellID = id + ".mail_cell";
	var td = gel(cellID);
	if (!td) {
		alert("email_activity.js: TD missing for '" + cellID + "'");
		return;
	}
	
	td.appendChild(iframe);
}
function emailResizeObserved() {
	adjustEmailHeight(this);
}
function adjustEmailHeight(frame) {
	frame.style.height = frame.contentWindow.document.body.scrollHeight + 'px';
}
;
/*! RESOURCE: /scripts/doctype/condition_global_variables14.js */
var MAIN_LAYER = "filterdiv";
var TEXTQUERY = "123TEXTQUERY321";
var PLACEHOLDER = "123PLACEHOLDER321";
var PLACEHOLDERFIELD = '-- choose field --';
var DEFAULT_NAME = "report";
var DEFAULT_WIDTH = "10px";
var DEFAULT_BORDER = 0;
var JS_GS = 'javascript:gs.';
var useTextareas = false;
var noConditionals = false;
var noOps = false;
var noSort = false;
var gotShowRelated = false;
var gotoPart = false;
var calendars = 0;
var refcount = 0;
var sortIndex = 0;
var queryNumber = 0;
var calendarPopups = [];
var filter;
var orderBy;
var columns = null;
var currentTable = '';
var firstTable = '';
var oldStatus = '';
var showRelated = '';
var filterExpanded = false;
var queueTables = new Array();
var queueFilters = new Array();
var queueColumns = new Array();
var operators = [
	"BETWEEN",
	"!=",
	">=",
	"<=",
	"=",
	">",
	"<",
	"NOT IN",
	"IN",
	"NOT LIKE",
	"LIKE",
	"ON",
	"NOTON",
	"DATEPART",
	"RELATIVE",
	"STARTSWITH",
	"ENDSWITH",
	"EMPTYSTRING",
	"ISEMPTY",
	"ISNOTEMPTY",
	"INSTANCEOF",
	"ANYTHING",
	"VALCHANGES",
	"CHANGESFROM",
	"CHANGESTO",
	"MATCH_PAT",
	"MATCH_RGX",
	"SAMEAS",
	"NSAMEAS",
	"MORETHAN",
	"LESSTHAN",
	"DYNAMIC",
	"GT_FIELD",
	"LT_FIELD",
	"GT_OR_EQUALS_FIELD",
	"LT_OR_EQUALS_FIELD",
	"HASVARIABLE" ,
	"HASITEMVARIABLE",
	"HASQUESTION",
	"HASLABEL",
	"DISTANCE_SPHERE_WITHIN"
];
var fieldComparisonOperators = ["SAMEAS", "NSAMEAS", "MORETHAN","LESSTHAN", "GT_FIELD", "LT_FIELD", "GT_OR_EQUALS_FIELD", "LT_OR_EQUALS_FIELD" ];
var dateTypes = new Array();
	dateTypes['glide_date_time'] = 1;
	dateTypes['glide_date'] = 1;
	dateTypes['date'] = 1;
	dateTypes['datetime'] = 1;
	dateTypes['due_date'] = 1;
	
var dateOnlyTypes = new Object();
	dateOnlyTypes['glide_date'] = 1;
	dateOnlyTypes['date'] = 1;
	
var dateTimeTypes = new Object();
	dateTimeTypes['glide_date_time'] = 1;
	dateTimeTypes['datetime'] = 1;
	dateTimeTypes['due_date'] = 1;
	
var numericTypes = new Array();
    numericTypes['integer'] = 1;
    numericTypes['decimal'] = 1;
    numericTypes['numeric'] = 1;
    numericTypes['float'] = 1;
    numericTypes['domain_number'] = 1;
    numericTypes['auto_increment'] = 1;
    numericTypes['percent_complete'] = 1;
var opersNS = {};
opersNS.opdef = {
    'af'  : [ '>',          'after'              ],
    'ataf': [ '>=',         'at or after'        ],
    'any' : [ 'ANYTHING',   'is anything'        ],
    'are' : [ '=',          'are'                ],
    'asc' : [ 'ascending',  'a to z'             ],
    'avg' : [ 'avg',        'average'            ],
    'bf'  : [ '<',          'before'             ],
    'atbf': [ '<=',          'at or before'      ],
    'btw' : [ 'BETWEEN',    'between'            ],
    'dsc' : [ 'descending', 'z to a'             ],
    'dsw' : [ 'DISTANCE_SPHERE_WITHIN', 'distance within'],
    'dtpt': [ 'DATEPART',   'trend'              ],
    'em'  : [ 'ISEMPTY',    'is empty'           ],
    'es'  : [ 'EMPTYSTRING',   'is empty string' ],
    'enwt': [ 'ENDSWITH',   'ends with'          ],
    'eq'  : [ '=',          'is'                 ],
    'eqd' : [ 'DYNAMIC',    'is (dynamic)'       ],
    'fvc' : [ 'VALCHANGES', 'changes'            ],
    'fvf' : [ 'CHANGESFROM', 'changes from'      ],
    'fvt' : [ 'CHANGESTO',  'changes to'         ],
    'gt'  : [ '>',          'greater than'       ],
    'gteq': [ '>=',         'greater than or is' ],
    'inna': [ 'IN',         'is one of'          ],
    'inst': [ 'INSTANCEOF', 'is a'               ],
    'lk'  : [ 'LIKE',       'contains'           ],
    'lt'  : [ '<',          'less than'          ],
    'lteq': [ '<=',         'less than or is'    ],
    'max' : [ 'max',        'maximum'            ],
    'min' : [ 'min',        'minimum'            ],
    'mpat': [ 'MATCH_PAT',  'matches pattern'    ],
    'mreg': [ 'MATCH_RGX',  'matches regex'      ],
    'ntem': [ 'ISNOTEMPTY', 'is not empty'       ],
    'nteq': [ '!=',         'is not'             ],
    'ntin': [ 'NOT IN',     'is not one of'      ],
    'ntlk': [ 'NOT LIKE',   'does not contain'   ],
    'nton': [ 'NOTON',      'not on'             ],
    'on'  : [ 'ON',         'on'                 ],
    'oper': [ '-- oper --', '-- oper --'         ],
    'rltv': [ 'RELATIVE',   'relative'           ],
    'saas': [ 'SAMEAS',     'is same'            ],
    'nsas': [ 'NSAMEAS',    'is different'       ],
    'snc' : [ 'SINCE',      'since baseline'     ],
    'stwt': [ 'STARTSWITH', 'starts with'        ],
    'sum' : [ 'sum',        'Total'              ],
    'date_more': [ 'MORETHAN',   'is more than'  ],
    'date_less': [ 'LESSTHAN',   'is less than'  ],
	'gtfd': [ 'GT_FIELD',   'greater than field' ],
	'ltfd': [ 'LT_FIELD',   'less than field'    ],
	'gteqfd' : [ 'GT_OR_EQUALS_FIELD', 'greater than or is field' ],
	'lteqfd' : [ 'LT_OR_EQUALS_FIELD', 'less than or is field' ]
};
opersNS.opdef_template = {
	'eq'  : [ '=',          'To'                 ],
	'saas': [ 'SAMEAS',     'Same as'            ],
	'eqd' : [ 'DYNAMIC',    'To (dynamic)'       ]
}
opersNS.compile = function(ops_input, opsdef) {
    for (var fieldType in ops_input) {
        var proto = ops_input[fieldType];
        if (proto.charAt(0) == '=')
            continue;
        var opers = proto.split(",");
        var opArray = [];
        for (var i = 0; i < opers.length; i++) {
            var oper = opers[i];
            if (oper)
                opArray.push(opsdef[oper]);
        }
        ops_input[fieldType] = opArray;
    }
    
    for (var fieldType in ops_input) {
        var proto = ops_input[fieldType];
        if (typeof proto != 'string')
            continue;
        ops_input[fieldType] = ops_input[proto.substring(1)];
    }
}
var edge_order_Types = {
			'string'  : 'eq,nteq,em,ntem,lt,gt,lteq,gteq',
			'calendar': 'eq,nteq,em,ntem,bf,af,atbf,ataf'
};
var edge_equality_Types = {
			'string'  : 'eq,nteq,em,ntem',
			'calendar': 'eq,nteq,em,ntem'
};
var sysopers = {
	'auto_increment'	  : '=integer',
    'aggspec'             : 'sum,avg,min,max,any,fvc,fvf,fvt',
    'boolean'             : 'eq,nteq,em,ntem,any,fvc,fvf,fvt,saas,nsas',
    'calendar'            : 'on,nton,bf,atbf,af,ataf,btw,dtpt,rltv,snc,em,ntem,any,fvc,saas,nsas,date_more,date_less',
    'choice'              : 'eq,nteq,inna,ntin,lk,stwt,enwt,ntlk,any,fvc,fvf,fvt,saas,nsas',
    'referencechoice'     : 'eq,nteq,inna,ntin,lk,stwt,enwt,ntlk,any',
    'composite_field'     : 'stwt,lk,ntlk,any',
    'composite_name'      : '=string',
    'conditions'          : '=string',
    'condition_string'    : '=string',
    'css'				  : '=html',
    'decimal'             : '=integer',
    'currency'			  : 'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw',
    'currency2'			  : 'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw',
    'default'             : 'eq,nteq,any,fvc,fvf,fvt',
    'email'               : '=string',
    'email_script'        : '=string',
    'field_name'          : '=string',
    'geo_point'           : 'eq,nteq,dsw',
    'glide_duration'      : 'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw,any,fvc',
    'glide_encrypted'     : 'eq,nteq,em,ntem',
    'glide_list'          : 'lk,ntlk,em,ntem,fvc,fvf,fvt,eqd',
    'GUID'                : '=string',
    'html'                : 'lk,ntlk,em,ntem,any,fvc,fvf,fvt',
    'html_script'         : '=string',
    'html_template'       : '=script',
    'ip_addr'             : '=string',
    'integer'             : 'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw,any,fvc,fvf,fvt,saas,nsas,gtfd,ltfd,gteqfd,lteqfd',
    'integer_choice'      : 'eq,nteq,inna,ntin,em,ntem,lt,gt,lteq,gteq,btw,any,fvc,fvf,fvt,saas,nsas',
    'journal'             : 'fvc',
    'journal_input'       : '=journal',
    'keyword'             : 'are',
    'long'                : '=integer',
    'longint'             : '=integer',
    'multi_two_lines'     : '=string',
    'percent_complete'    : '=integer',
    'ph_number'           : '=string',
    'phone_number_e164'   : '=string',
    'placeholder'         : 'oper',
    'price'				  : 'eq,nteq,em,ntem,lt,gt,lteq,gteq,btw',
    'reference'           : 'eq,nteq,em,ntem,stwt,enwt,lk,ntlk,any,saas,nsas,es,eqd,fvc,fvf,fvt',
    'referencevariable'   : 'eq,nteq,em,ntem',
    'replication_payload' : '=string',
    'script'              : 'lk,ntlk,ntem,any,fvc,fvf,fvt',
    'script_plain'        : '=script',
    'script_server'       : '=script',
    'sortspec'            : 'asc,dsc,fvc,fvf,fvt',
    'string'              : 'stwt,enwt,lk,ntlk,eq,nteq,em,ntem,mpat,mreg,any,inna,es,fvc,fvf,fvt,lteq,gteq,btw,saas,nsas',
    'string_choice'       : '=choice',
    'string_clob'         : 'lk,ntlk,stwt,enwt,em,ntem,any,fvc,fvf,fvt',
    'string_full_utf8'    : '=string',
    'string_numeric'      : 'eq,nteq,lk,ntlk,stwt,enwt,btw,any,fvc,fvf,fvt,saas,nsas',
    'sys_class_name'      : 'eq,nteq,inst,any,fvc,fvf,fvt',
    'sysevent_name'       : '=string',
    'table_name'          : '=string',
    'timer'               : '=integer',
    'translated_field'    : '=string',
    'translated_html'     : '=html',
    'translated_text'     : '=string',
    'translated_basic'    : 'eq,nteq,em,ntem',
    'url'                 : '=string',
    'workflow'            : '=choice',
    'xml'                 : '=html',
	'domain_path'         : '=string',
	'tree_code'           : '=string',
	'tree_path'           : '=string',
	'source_id' 	      : '=string',
	'source_name'  	      : '=string',
	'source_table' 	      : '=string',
	'sc_attachment'       : 'em,ntem',
	'related_tags'        : 'eq,nteq,em,ntem,stwt,lk'
};
var sysopers_template = {
		'default'             : 'eq,saas,eqd'
}
opersNS.compile(sysopers, opersNS.opdef);
opersNS.compile(edge_order_Types, opersNS.opdef);
opersNS.compile(edge_equality_Types, opersNS.opdef);
opersNS.compile(sysopers_template, opersNS.opdef_template);
var extopers = {};
    extopers['MATCH_PAT'] = true;
    extopers['MATCH_RGX'] = true;
    extopers['VALCHANGES'] = true;
    extopers['CHANGESTO'] = true;
    extopers['CHANGESFROM'] = true;
var sysvalues = {};
	sysvalues['boolean']         = [[ "true", "true" ], [ "false",  "false" ]];
	sysvalues['catalog_boolean'] = [[ "Yes", "Yes" ], [ "No",  "No" ]];
	sysvalues['string_boolean']  = [[ "1", "true" ], [ "0",  "false" ]];
var MESSAGES_CONDITION_RELATED_FILES = ['lowercase_fields','Keywords','Show Related Fields','Remove Related Fields', '-- choose field --', '-- value --', '-- None --'];
var g_current_table = '';
var g_filter_extension_map = {};
var calendarPromise = $j.Deferred();
(function() {
	function populateCalendar(legacyModel) {
		var calendar = legacyModel.timeAgoDates;
		calendar.DATEPART = legacyModel.datePart;
		calendar.BETWEEN = legacyModel.between;
		calendar.RELATIVE = legacyModel.relative;
		calendar.TRENDVALUES = legacyModel.trendValues;
		calendar.WHEN = legacyModel.when;
		calendar.TRENDVALUES_WITH_FIELDS_PLURAL = legacyModel.trendValuesWithFieldsPlural;
		calendar.TRENDVALUES_WITH_FIELDS = legacyModel.trendValuesWithFields;
		calendar.WHEN_WITH_FIELDS = legacyModel.whenWithFields;
		sysvalues['calendar'] = calendar;
		calendarPromise.resolve(calendar);
	}
	if (typeof g_cached_legacy_calendar_model === "object") {
		populateCalendar(g_cached_legacy_calendar_model);
		return;
	}
	var req = new XMLHttpRequest();
req.open("GET", "/api/now/ui/date_time/legacy", true);
req.setRequestHeader('Accept', 'application/json');
	req.setRequestHeader('X-Transaction-Source', window.transaction_source);
	if (typeof g_ck != 'undefined' && g_ck != "") {
		req.setRequestHeader('X-UserToken', g_ck);
	}
	function responseFunction (request) {
		var result = JSON.parse(request.response).result;
        populateCalendar(result);
	}
	req.onreadystatechange = function() { processReqChange(req, responseFunction); };
	req.send(null);
}());
;
/*! RESOURCE: /scripts/doctype/GlidePopupInterface.js */
(function(exports) {
    function isApiLoaded(m) {
        return exports.nowapi && exports.nowapi.g_popup_manager && exports.nowapi.g_popup_manager[m];
    }
    function popListDiv(evt, target, sys_id, view, width, showOpenButton, trapFocus) {
        var onReady = function() {
            nowapi.g_popup_manager.popListDiv(
                evt,
                target,
                sys_id,
                view,
                width,
                showOpenButton,
                trapFocus
            );
        };
        if (isApiLoaded("popListDiv"))
            onReady();
        else
ScriptLoader.getScripts("scripts/classes/nowapi/ui/GlidePopup.js", onReady);
    }
    function popReferenceDiv(evt, inputId, view, form, refKey) {
        var onReady = function() {
            nowapi.g_popup_manager.popReferenceDiv(
                evt,
                inputId,
                view,
                form,
                refKey,
                true
            );
        };
        if (isApiLoaded("popReferenceDiv"))
            onReady();
        else
ScriptLoader.getScripts("scripts/classes/nowapi/ui/GlidePopup.js", onReady);
    }
    function popForm(evt, target, sys_id, view, width) {
        ScriptLoader.getScripts(
"scripts/classes/nowapi/ui/GlidePopup.js",
            function() {
                nowapi.g_popup_manager.popForm(
                    evt,
                    target,
                    sys_id,
                    view,
                    width
                );
            }
        );
    }
    function popDiv(evt, catalogparams) {
        ScriptLoader.getScripts(
"scripts/classes/nowapi/ui/GlidePopup.js",
            function() {
            	var validSysId = "^[a-fA-F0-9]{32}$";
            	if (catalogparams.match(validSysId))
            		nowapi.g_popup_manager.popDiv(evt, catalogparams);
            	else {
            		var params;
            		try {
            			params = JSON.parse(catalogparams);
            			if (typeof params == "object")
            				nowapi.g_popup_manager.popDiv(evt, params);	
            		}
            		catch(err) {
            			console.log(err);
            		}
            	}
        	});
    }
    function popCatDiv(evt, sys_id) {
        ScriptLoader.getScripts(
"scripts/classes/nowapi/ui/GlidePopup.js",
            function() {
                nowapi.g_popup_manager.popCatDiv(evt, sys_id);
            }
        );
    }
    function popKnowledgeDiv(evt, sys_id) {
        ScriptLoader.getScripts(
"scripts/classes/nowapi/ui/GlidePopup.js",
            function() {
                nowapi.g_popup_manager.popKnowledgeDiv(evt, sys_id);
            }
        );
    }
    function popRecordDiv(evt, table, sys_id, view, width) {
        var onReady = function() {
            nowapi.g_popup_manager.popRecordDiv(
                evt,
                table,
                sys_id,
                view,
                width
            );
        };
        if (isApiLoaded("popRecordDiv"))
            onReady();
        else
ScriptLoader.getScripts("scripts/classes/nowapi/ui/GlidePopup.js", onReady);
    }
    function popLightWeightReferenceDiv(evt, inputid, hideOpenButton) {
        ScriptLoader.getScripts(
"scripts/classes/nowapi/ui/GlidePopup.js",
            function() {
                nowapi.g_popup_manager.popLightWeightReferenceDiv(evt, inputid, hideOpenButton);
            }
        );
    }
    function popIssueDiv(evt, issues) {
        ScriptLoader.getScripts(
"scripts/classes/nowapi/ui/GlidePopup.js",
            function() {
                nowapi.g_popup_manager.popIssueDiv(evt, issues);
            }
        );
    }
    function popReportInfoDiv(evt, sys_id) {
        ScriptLoader.getScripts(
"scripts/classes/nowapi/ui/GlidePopup.js",
            function() {
                nowapi.g_popup_manager.popReportInfoDiv(evt, sys_id);
            }
        );
    }
    function popHistoryDiv(evt, table, sys_id, checkpoint, internalCP) {
        ScriptLoader.getScripts(
"scripts/classes/nowapi/ui/GlidePopup.js",
            function() {
                nowapi.g_popup_manager.popHistoryDiv(
                    evt,
                    table,
                    sys_id,
                    checkpoint,
                    internalCP
                );
            }
        );
    }
    function lockPopup(e) {
        nowapi.g_popup_manager.destroypopDiv(e);
    }
    function lockPopupID(e, sys_id) {}
    exports.popListDiv = popListDiv;
    exports.popReferenceDiv = popReferenceDiv;
    exports.popForm = popForm;
    exports.popHistoryDiv = popHistoryDiv;
    exports.lockPopup = lockPopup;
    exports.lockPopupID = lockPopupID;
    exports.popDiv = popDiv;
    exports.popCatDiv = popCatDiv;
    exports.popKnowledgeDiv = popKnowledgeDiv;
    exports.popReportInfoDiv = popReportInfoDiv;
    exports.popRecordDiv = popRecordDiv;
    exports.popIssueDiv = popIssueDiv;
    exports.popLightWeightReferenceDiv = popLightWeightReferenceDiv;
})(window);
;
/*! RESOURCE: /scripts/doctype/navigator_menu.js */
$j(function($) {
	$('#perspective_switcher').click(function(e) {
		if (gActiveContext) {
			contextHide();
			return;
		}
		
		var saveFavoriteLabel = function(){
			var label = getMessage('Automatically Add Favorites');
			if (window.autoSaveFavoritePreference)
label += ' <span class="icon-check" style="padding-left: 10px;"></span>';
			return label;
		}();
		var gcm = new GwtContextMenu("context_perspectives_menu");
		gcm.clear();
		$('a[parent_id=perspectives]').each(function (index, item) {
			var name = item.innerHTML;
			if (item.href.split("=")[1] == "All")
				gcm.addHref(name, "window.location = '" + item.href + "'");
			else
				gcm.addHref(name, "window.location = '" + item.href + "'");
		});
		gcm.addLine();
		gcm.addHref(saveFavoriteLabel, '$j(window).trigger("toggle_auto_favorite")');
		gcm.addHref(getMessage('Refresh Navigator Title'), 'window.location = "navigator_change.do"');
		gcm.addHref(getMessage('Collapse all applications'), '$j(window).trigger("collapse_all")');
		gcm.addHref(getMessage('Expand all applications'), '$j(window).trigger("expand_all")');
		contextShow(e, gcm.getID(), -1, 0, 0);
		e.stopPropagation();
	})
	if (document.hasBodyClickedTrigger !== 'true') {
		document.addEventListener('click', function (event) {
			CustomEvent.fireAll('body_clicked', event);
		});
	}
	CustomEvent.observe("body_clicked", contextMenuHide);
})
;
/*! RESOURCE: /scripts/scrollable.js */
var HOME_SCROLL_SPEED = 1;
var HOME_PAUSE_SPEED = 0;
var HOME_RESUME_SPEED = 1;
function scroller(divName) {            
	  var target = gel(divName);
	  if (!target)
	     return;
	     
	  var wrapper = gel(divName+"_wrap");
      var wrapperHeight = wrapper.offsetHeight;
      var containerHeight = target.offsetHeight;
      var actualheight = wrapperHeight
      if (wrapperHeight < containerHeight)
          actualheight = containerHeight;
      
      var currentScroll = parseInt(target.style.top) - HOME_SCROLL_SPEED;
      var bottom = actualheight + parseInt(target.style.top);
      
	  if (bottom < 20) 
         currentScroll = wrapperHeight;
      
	  target.style.top=currentScroll + "px";            
}
;
/*! RESOURCE: /scripts/classes/util/StopWatch.js */
var StopWatch = Class.create({
    MILLIS_IN_SECOND: 1000,
    MILLIS_IN_MINUTE: 60 * 1000,
    MILLIS_IN_HOUR: 60 * 60 * 1000,
		
    initialize: function(started) {
        this.started = started || new Date();
    },
    
	getTime: function() {
    	var now = new Date();
    	return now.getTime() - this.started.getTime();
	},
	
    restart: function() {
    	this.initialize();
    },
    
	jslog: function(msg, src, date) {
		if (window.jslog) {
			jslog('[' + this.toString() + '] ' + msg, src, date);
			return;
		}
		if (window.console && window.console.log)
			console.log('[' + this.toString() + '] ' + msg);
	},
	
    toString : function() {
		return this.formatISO(this.getTime());
    },
	
	formatISO: function(millis) {
		var hours = 0, minutes = 0, seconds = 0, milliseconds = 0;
		
		if (millis >= this.MILLIS_IN_HOUR) {
hours = parseInt(millis / this.MILLIS_IN_HOUR);
	        millis = millis - (hours * this.MILLIS_IN_HOUR);
		}
		
		if (millis >= this.MILLIS_IN_MINUTE) {
minutes = parseInt(millis / this.MILLIS_IN_MINUTE);
	        millis = millis - (minutes * this.MILLIS_IN_MINUTE);
		}
		
		if (millis >= this.MILLIS_IN_SECOND) {
seconds = parseInt(millis / this.MILLIS_IN_SECOND);
	        millis = millis - (seconds * this.MILLIS_IN_SECOND);
		}
		
        milliseconds = parseInt(millis);
        return doubleDigitFormat(hours) + ":" + doubleDigitFormat(minutes) + ":" + doubleDigitFormat(seconds) +
			"." + tripleDigitFormat(milliseconds);
    },
	
	type: "StopWatch"
});
;
/*! RESOURCE: /scripts/classes/Table.js */
var Table = Class.create({
	REF_ELEMENT_PREFIX: 'ref_',
	REFERENCE: "reference",
	
    initialize: function(tableName, parentTable, cols, callback, accessTable, isTemplate, loadExtensions, applyTemplateAcls, tableOptions) {
        this.tableName = tableName;
        this.parentTable = parentTable;
        this.label = tableName;
        this.callback = callback;
        this.accessTable = accessTable;
        this.columns = null;
        this.elements = {};
        this.elementsArray = [];
        this.extensions = {};
        this.extensionsArray = [];
        this.choiceExtensions = {};
        this.choiceExtensionsArray = [];
        this.tablesArray = [];
        this.sys_id = null;
        this.set_id = null;
        this.vars_id = null;
        this.glide_var = null;
		this.isTemplate = isTemplate;
		this.applyTemplateAcls = applyTemplateAcls;
		this.loadExtensions = loadExtensions;
		this.tableOptions = tableOptions || {};
		this.excludeTableOperators = ""
        Table.setCachable(this);
        if (cols && this.cacheable)
        	this.readResponse(cols);
        else
        	this.readColumns();	    
        this.textIndex = null;
    },
      
    readColumns: function() {
        var ajax = new GlideAjax("SysMeta");
        ajax.addParam("sysparm_type", "column");
        ajax.addParam("sysparm_include_sysid", "true");
        ajax.addParam("sysparm_table_name", "false");
		ajax.addParam("sysparm_is_template", this.isTemplate ? 'true' : 'false');
		ajax.addParam("sysparm_apply_template_acls", this.applyTemplateAcls ? 'true' : 'false');
        ajax.addParam("sysparm_value", this.tableName);
        ajax.addParam("sysparm_is_excluded_role", 'false');
        if (this.sys_id) 
             ajax.addParam("sysparm_sys_id", this.sys_id);
        if (this.set_id) 
            ajax.addParam("sysparm_set_id", this.set_id);
        
        if (this.vars_id) 
            ajax.addParam("sysparm_vars_id", this.vars_id);
             
        if (this.parentTable)
            ajax.addParam("sysparm_parent_table", this.parentTable);
        
        if (this.accessTable)
        	ajax.addParam("sysparm_access_table", this.accessTable);
		if (this.loadExtensions)
			ajax.addParam("sysparm_load_extended_fields", this.loadExtensions);
		if (typeof this.tableOptions.onBeforeReadColumns === 'function')
			this.tableOptions.onBeforeReadColumns.call(null, ajax);
        if (this.callback)
        	ajax.getXML(this.readColumnsResponse.bind(this));
        else {
        	var xml = ajax.getXMLWait();
            this.readResponse(xml);
        }
    },
    
    readColumnsResponse: function(response) {
    	if (!response || !response.responseXML)
    		return;
    	
    	var xml = response.responseXML;
    	this.readResponse(xml);
    	this.callback(this);
    },
	
   	readResponse: function(xml) {
   	    this.columns = xml;
		var root = this.columns.getElementsByTagName("xml");
		if (root == null || root.length == 0)
			root = this.columns;
		if (root != null && root.length == 1) {
	   		root = root[0];
	   		this.textIndex = root.getAttribute("textIndex");
	   		this.label = root.getAttribute("label");
	   	}
	   	if (root != null) {
        		var excludeTableOperatorsValue = root.getAttribute("excludeTableOperators");
        		this.setExcludeTableOperators(excludeTableOperatorsValue);
        	}
		var childNodes = root.childNodes;
      	this.elements = {};
      	this.elementsArray = [];
		for (var i = 0; i < childNodes.length; i++) {
			if (childNodes[i].tagName == 'extensions')
				this.setExtensions(childNodes[i]);
			if (childNodes[i].tagName == 'tables')
				this.setTables(childNodes[i]);
			if (childNodes[i].tagName == 'sys_choice_extensions')
				this.setChoiceExtensions(childNodes[i]);
			if (childNodes[i].tagName != 'item')
				continue;
	    	var item = childNodes[i];
	    	var t = item.getAttribute("value");
	    	var label = item.getAttribute("label");
	    	var e = new TableElement(t, label);
	    	e.setClearLabel(item.getAttribute("cl"));
	    	e.setType(item.getAttribute("type"));
	    	e.setReference(item.getAttribute("reference"));
			e.setDynamicCreation(item.getAttribute("dynamic_creation") == "true");
			e.setRefQual(item.getAttribute("reference_qual"));
			e.setRefKey(item.getAttribute("reference_key"));
	    	e.setArray(item.getAttribute("array"));
	    	e.setChoice(item.getAttribute("choice"));
	    	e.setMulti(item.getAttribute("multitext"));
	    	e.setDependent(item.getAttribute("dependent"));
			e.setMaxLength(item.getAttribute("max_length"));
			e.setDisplayChars(item.getAttribute("display_chars"));
			e.setNamedAttributes(item.getAttribute("attributes"));
			e.setTableName(item.getAttribute("table"));
	    	e.setTable(this);
	    	if (e.isReference()) {
	    	   	e.setRefLabel(item.getAttribute("reflabel"));
	    	   	e.setRefDisplay(item.getAttribute("refdisplay"));
		       	e.setRefRotated(item.getAttribute("reference_rotated"));
			}
	    	this.elements[t] = e;
	    	this.elementsArray[this.elementsArray.length] = e;
	    	
	    	var attrs = item.attributes;
	    	for (var x = 0; x < attrs.length; x++)
	    		e.addAttribute(attrs[x].nodeName,attrs[x].nodeValue);
		}
		this.setDependencies();
   	}, 
   	
   	setExtensions: function(extensions) {
   		var items = extensions.childNodes;
		if (this.loadExtensions) {
			Table.getCache().ensureMaxEntries(items.length);
		}
		this.extensionsArray = [];
		for (var i = 0; i < items.length; i++) {
			var item = items[i];
			var t = item.getAttribute("name");
			var label = item.getAttribute("label");
			var e = new TableExtension(t, label);
			e.setTable(this);
			if (item.getElementsByTagName('item') && this.loadExtensions) {
				Table.setColumns(t, null, item);
			}
			this.extensions[t] = e;
			this.extensionsArray[this.extensionsArray.length] = e;
		}
   	},
   setExcludeTableOperators: function(excludeTableOperatorsValue) {
        this.excludeTableOperators = excludeTableOperatorsValue;
   },
   	setChoiceExtensions: function(choices) {
		items = choices.childNodes;
		this.choiceExtensionsArray = [];
		for (var i = 0; i < items.length; i++) {
			var item = items[i];
			var t = item.getAttribute("name");
			var label = item.getAttribute("label");
			var e = new TableExtension(t, label);
			e.setTable(this);
			this.choiceExtensions[t] = e;
			this.choiceExtensionsArray[this.choiceExtensionsArray.length] = e;
		}
   	},
	
	setDependencies: function() {
		for (var i = 0; i < this.elementsArray.length; i++) {
			var element = this.elementsArray[i];
			if (element.isDependent()) {
				var parent = this.getElement(element.getDependent());
				if (parent)
					parent.addDependentChild(element.getName())
			}
		}
	},
	setTables: function(tables) {
	 	var tableList = tables.getAttribute("table_list");
      	this.tablesArray = [];
      	this.tablesArray = tableList.split(',');
	},
   
   	getColumns: function() {
   		return this.columns;
   	},
   	
   	getElements: function() {
   		return this.elementsArray;
   	},
   	getExcludeTableOperators: function() {
   	    return this.excludeTableOperators;
   	},
   	
   	getTableElements: function(tableName) {
   	    jslog("Getting fields for table " + tableName);
  		   
  		var elements = [];
	    var items = this.getElements();
	    for (var i = 0; i < items.length; i++) {
           var item = items[i];
           if (item.getTableName() != tableName)
              continue;
          
           elements.push(item);
        }
        return elements;
   	},
   	
   	getElement: function(elementName) {
   	    if (this.elements[elementName])
   		    return this.elements[elementName];
   		    
   		if (this._nameIsExtension(elementName))
   		    return this._genExtensionElement(elementName);
   		    
   		return null;
   	},   
   	
   	_genExtensionElement: function(name) {
   	    name = name.substring(this.REF_ELEMENT_PREFIX.length);
   	    var ext = this.extensions[name];
	    var e = new TableElement(ext.getExtName(), ext.getLabel());
	    e.setType(this.REFERENCE);
	    e.setReference(ext.getName());
	    e.setRefLabel(ext.getLabel());
	    e.setExtensionElement(true);
	    return e;
   	},
   	
   	_nameIsExtension: function(name) {
   	    if (name.indexOf(this.REF_ELEMENT_PREFIX) != 0)
   	       return false;
   	       
   	    name = name.substring(this.REF_ELEMENT_PREFIX.length);
		return this.extensions[name];
	},
   	 	
   	getExtensions: function() {
   	    return this.extensionsArray;
   	},
   	
   	getChoiceExtensions: function() {
   	    return this.choiceExtensionsArray;
   	},
   	
   	getTables: function() {
   		return this.tablesArray;
   	},
   	
   	getName: function() {
   		return this.tableName;
   	},	
   	
   	getLabel: function() {
   		return this.label;
   	},
   	
   	getDisplayName: function(column) {
   		return this.getElement(column).getRefDisplay();
   	},
   	
   	getSysId: function() {
   	    return this.sys_id;
   	},
   	
   	setSysId: function() {
  	    return this.sys_id;
  	},	
   
   	type : function() {
		return "Table";
	}
});
Table.get = function(tableName, parentTable, isTemplate, loadExtensions, callback, applyTemplateAcls, tableOptions) {
	var topWindow = getTopWindow();
	return (topWindow.Table || Table).getInTopWindow(tableName, parentTable, isTemplate, loadExtensions, callback, applyTemplateAcls, tableOptions);
};
Table.setColumns = function(tableName, parentTable, xmlString) {
  		var cachedName = Table.getCacheKey(tableName, parentTable);
  		var parentCache = Table.getCache();
  		if (parentCache) {
			var table = parentCache.get(cachedName);
			if (table) 
				return table;
		}
		var xml = typeof xmlString == 'string' ? loadXML(xmlString) : xmlString;
		var answer = new Table(tableName, parentTable, xml);
  		if (parentCache && answer.cacheable)
			parentCache.put(cachedName, answer);
};
Table.isCached = function(tableName, parentTable, isTemplate) {
	var cachedName = Table.getCacheKey(tableName, parentTable, isTemplate);
  	var parentCache = Table.getCache();
  	if (parentCache) {
		var table = parentCache.get(cachedName);
		if (table) 
			return true;
	}
	return false;
};
Table.getInTopWindow = function(tableName, parentTable, isTemplate, loadExtensions, callback, applyTemplateAcls, tableOptions) {
	var t = {};
	Table.setCachable(t);
	if (t.cacheable) {
		var cachedName = Table.getCacheKey(tableName, parentTable, isTemplate, loadExtensions);
		var parentCache = Table.getCache();
		if (parentCache) {
			var table = parentCache.get(cachedName);
			if (table) {
				try {
					table.getName();
					if (callback)
						callback(table);
					return table;
				} catch (error) {
					console.warn("An error occurred with the Table object or the callback applied to the Table object. "
						+ "Due to limitations in IE11 this is expected when the form is inside the frameset and is "
						+ "refreshed (saved, updated,  etc) and should not affect functionality.", error);
				}
			}
		}
	}
	var answer = new Table(tableName, parentTable, null, callback, null, isTemplate, loadExtensions, applyTemplateAcls, tableOptions);
	if (parentCache && answer.cacheable)
		parentCache.put(cachedName, answer);
	return answer;
};
Table.setCachable = function(t) {
	t.cacheable = true;
	if (typeof g_table_sys_id != 'undefined') {
        t.sys_id = getTopWindow().g_table_sys_id;
        t.cacheable = false;
    }
    
    if (typeof g_table_set_id != 'undefined') {
        t.set_id = getTopWindow().g_table_set_id;
        t.cacheable = false;
    }
    
    if (typeof g_table_vars_id != 'undefined') {
        t.vars_id = getTopWindow().g_table_vars_id;
        t.cacheable = false;
    }
    
    if (typeof g_table_glide_var != 'undefined') {
        t.glide_var = getTopWindow().g_table_glide_var;
        t.cacheable = false;
    }
};
Table.getCacheKey = function(tableName, parentTable, isTemplate) {
	return (parentTable ? parentTable + "." : "") + tableName + "." + !!isTemplate;
};
Table.getCache = function() {
	var cache = getTopWindow().g_cache_td;
	if (cache)
		return cache;
	
	if (!window.g_cache_td)
		window.g_cache_td = new GlideClientCache(400);
	
	return window.g_cache_td;
};
;
/*! RESOURCE: /scripts/classes/TableElement.js */
var TableElement = Class.create({
	REF_ELEMENT_PREFIX: 'ref_',
    initialize: function(elementName, elementLabel) {
        this.name = elementName;
        this.label = elementLabel;
        this.clearLabel = ''; 
        this.tableName = '';
        this.type = 'string';
        this.isRef = false;
        this.refLabel = null;
        this.refDisplay = null;
        this.refQual = null;
        this.reference = null;
        this.refKey = null;
        this.refRotated = false;
        this.array = null;
        this.canread = 'unknown';
        this.canwrite = 'unknown';
        this.saveastemplate = 'unknown';
        this.choice = '';
        this.multi = false;
        this.active = 'unknown';
        this.table = null;
        this.dependent = null;
		this.maxLength = null;
		this.displayChars = "-1";
        this.attributes = {};
		this.dependentChildren = {};
		this.namedAttributes = {};
		this.extensionElement = false;
		this.dynamicCreation = false; 
    },   
  	
  	addAttribute: function(name, value) {
  		this.attributes[name] = value;
  	},
  	
  	getAttribute: function(name) {
  		return this.attributes[name];
  	},
  	
  	getBooleanAttribute: function(name, defaultValue) {
  		var v = this.getAttribute(name);
if (v == null)
  			return (typeof defaultValue !== 'undefined') ? defaultValue : true; 
  		
  		if (v == 'false' || v == 'no')
  			return false;
  			
  		return true;
  	},
	
  	isDependent: function() {
  		return this.dependent != null;
  	},
  	
	hasDependentChildren: function() {
		for (var key in this.dependentChildren)
			return true;
		
		return false;
	},
	
	getDependentChildren: function() {
		return this.dependentChildren;
	},
  	
  	setTable: function(t) {
  		this.table = t;
  	},
  	
  	setType: function(type) {
  		this.type = type;
  		if (type == 'glide_list')
  		   this.isRef = false;
  		
  		if (type == 'glide_var')
  			this.isRef = true;
  	},
  	
  	setReference: function(reference) {  		
  		if (reference && reference != '')
  			this.reference = reference;
		this.isRef = false;
		switch (this.type){
			case 'glide_list':
				if (this.reference)
					this.isRef = true;
				break;
			case 'reference':
			case 'domain_id':
			case 'glide_var':
			case 'currency2':
				this.isRef = true;
				break;
		}
  	},
  	
  	setRefRotated: function(rotated) {
  		if ('yes' == rotated)
  		   this.refRotated = true;
  		else
  		   this.refRotated = false;
  	},
  	
  	setCanWrite: function(ra) {
  	    if ('no' == ra)
  	       this.canwrite = false;
  	    else
  	       this.canwrite = true;
  	},
  	
  	setSaveAsTemplate: function(ra) {
  	    if ('no' == ra)
   	       this.saveastemplate = false;
   	    else
   	       this.saveastemplate = true;
  		
  	},
        
  	setCanRead: function(ra) {
  	    if ('no' == ra)
  	       this.canread = false;
  	    else
  	       this.canread = true;
  	},
  	
  	setActive: function(active) {
  	    if ('no' == active)
  	       this.active = false;
  	    else
  	       this.active = true;
  		
  	},
  	setRefQual: function(refQual) {
  		this.refQual = refQual;
  	},
	setRefKey: function(refKey) {
		this.refKey = refKey;
	},
	setRefLabel: function(label) {
  		this.refLabel = label;
  	},
  	
  	setRefDisplay: function(display) {
  		this.refDisplay = display;
  	},
  	
  	setArray: function(array) {
  		this.array = array;
  	},
  	
  	setClearLabel: function(cl) {
  	    this.clearLabel = cl;
  	},
  	
  	setChoice: function(choice) {
  		this.choice = choice;
  	},
  	
  	setMulti: function(multi) {
  		this.multi = multi;
  	},
  	
  	setExtensionElement: function(b) {
  	    this.extensionElement = b;
  	},
  	
  	setDependent: function(dep) {
  		if (dep && dep != '')
  			this.dependent = dep;
  	},
	
	addDependentChild: function(name) {
		if (name)
			this.dependentChildren[name] = true;
	},
	
	setMaxLength: function(maxLength) {
		this.maxLength = maxLength;
	},
  	
	setDisplayChars: function(displayChars) {
		this.displayChars = displayChars;
	},
  	
	setNamedAttributes: function(attrs) {
		if (!attrs)
			return;
			
		var pairs = attrs.split(',');
		for (var i = 0; i < pairs.length; i++) {
			var parts = pairs[i].split('=');
			if (parts.length == 2)
				this.namedAttributes[parts[0]] = parts[1];
		}
	},
	setDynamicCreation: function(dynamic) {
		this.dynamicCreation = dynamic;
	},
	
  	isReference: function() {
  		return this.isRef;
  	},  
  	
  	isRefRotated: function() {
  		return this.refRotated;
  	},
  	
  	isExtensionElement: function() {
  	    return this.extensionElement;
  	},	
    
    isDate: function() {
       return dateTypes[this.type];   
    }, 
	
    isDateOnly: function() {
		if (dateOnlyTypes[this.type])
			return true;
		else
			return false;  
    }, 
	
    isDateTime: function() {
		if (dateTimeTypes[this.type])
			return true;
		else
			return false;  
    },
  	
  	getName: function() {
  		return this.name;
  	},
  	
  	getLabel: function() {
  		return this.label;
  	},
  	
  	getClearLabel: function() {
  	    return this.clearLabel;
  	},
  	
  	getReference: function() {
  		return this.reference;
  	},
  	
  	getMulti: function() {
  		return this.multi;
  	},
  	
  	isMulti: function() {
  		return this.getMulti() == 'yes';
  	},
  	
  	getDependent: function() {
  		return this.dependent;
  	},
  	getRefQual: function() {
  		return this.refQual;
  	},
	getRefKey: function() {
		return this.refKey;
	},
	getRefLabel: function() {
  		return this.refLabel;
  	},
  	
  	getRefDisplay: function() {
  		return this.refDisplay;
  	},
  	
  	getType: function() {
  		return this.type;
  	},
  	
  	getChoice: function() {
  		return this.choice;
  	},
  	
  	getTable: function() {
  		return this.table;
  	},
  	
  	getTableName: function() {
  	    return this.tableName;
	},
	getBaseTableName: function() {
		var table = this.getTable();
		if (!table || !table.tablesArray)
			return "";
		if (table.tablesArray.length === 0)
			return this.getTableName();
		return table.tablesArray.slice().pop();
	},
  	
  	setTableName: function(t) {
  	    this.tableName = t;
  	}, 
  	
  	isChoice: function() {
  		  return (this.choice == 1 || 
  		          this.choice == 3 || 
  		          this.type == "day_of_week" ||
  				  this.type == "week_of_month" || 
  				  this.type == "month_of_year");
  	},
	
	getMaxLength: function() {
		return this.maxLength;
	},
  	
	getDisplayChars: function() {
		return this.displayChars;
	},
  	
  	canRead: function() {
  		if (this.canread == 'unknown')
  			return this.getBooleanAttribute("canread");
  			
  		return this.canread;
  	},
  	
  	canSaveAsTemplate: function() {
  		if (this.saveastemplate == 'unknown')
  			return this.getBooleanAttribute("save_as_template");
  			
  		return this.saveastemplate;
  		
  	},
    
    canWrite: function() {
    	if (this.canwrite == 'unknown')
  			return this.getBooleanAttribute("canwrite");
  			
  		return this.canwrite;
  	},
  	
  	canMatch: function() {
  			return this.getBooleanAttribute("canmatch");
  	},
  	
  	isEdgeEncrypted: function() {
  		    return this.getBooleanAttribute("edge_encrypted", false);
  	},
  	isAdpEncrypted: function() {
  		    return this.getBooleanAttribute("adp_encrypted", false);
  	},
  	
  	isActive: function() {
  		if (this.active == 'unknown')
  		    return this.getBooleanAttribute("active");
		return this.active;
  	},
  	
  	isNumber: function() {
  		return this.type == 'integer' ||
  		       this.type == 'decimal' ||
  		       this.type == 'numeric' ||
  		       this.type == 'float' ||
  		       this.type == 'percent_complete';
  	},
  	
  	isArray: function() {
  		if (this.array && this.array == 'yes')
  			return true;
  		return false;
  	},
  	
  	canSort: function() {
  		if (!this.getBooleanAttribute("cansort"))
  			return false;
  			
  		if (this.name.indexOf("password") > -1) 
    		return false;
    		
  		if (this.name == 'sys_id')
    		return false;
    		
  		if (this.type == "journal" || this.type == "journal_input") 
    		return false; 
    		
  		if (this.isArray()) 
    		return false; 
  		return true;
  	},
	canSortI18N: function() {
		return this.getBooleanAttribute("cansorti18n");
	},
  	
  	canGroup: function() {
  		if (this.getNamedAttribute("can_group") == "true")
  			return true;
  		
  		if (this.isEdgeEncrypted() && this.canMatch())
  			return true;
  		
  		if (!this.canSort())
  			return false;
  			
  		if (this.isMulti())
  			return false;
    
  		if (this.name.indexOf(".") > -1 && this.name.indexOf(this.REF_ELEMENT_PREFIX) > -1)
    		return false;  
    
  		if (this.type == "glide_duration") 
    		return true; 
    		
    	if (this.type == 'glide_date_time' ||
    	    this.type == 'glide_date' ||
    	    this.type == 'glide_time' ||
    	    this.type == 'due_date')
    		return false;
    
  		return true;
  		
  	},
  	getAttributes: function() {
  		return this.attributes['attributes'];
  	},
  	
	getNamedAttribute: function(name) {
		if (this.namedAttributes[name])
			return this.namedAttributes[name];
		else
			return null;	
	},
	
	type : function() {
		return "TableElement";
	},
	isDynamicCreation: function() {
		return this.dynamicCreation;
	},
	isEncrypted: function() {
		return this.getBooleanAttribute("glide_encrypted", false) || this.getType() == "glide_encrypted";
	}
});
TableElement.get = function(name) {
    var names = name.split('.');
    var table = names[0];
    var tableDef = Table.get(table);
    var e;
    for (var i = 1; i < names.length; i++) {
        e = tableDef.getElement(names[i]);
        if (i === names.length - 1)
            break;
        if (e.type === "glide_var" || !e.isReference())
            break;
        
        tableDef = Table.get(e.getReference());
    }
    return e;
}
;
/*! RESOURCE: /scripts/classes/TableExtension.js */
var TableExtension = Class.create({
	REF_ELEMENT_PREFIX: 'ref_',
	
    initialize: function(elementName, elementLabel) {
        this.name = elementName;
        this.label = elementLabel;
        this.table = null;
        this.fields = null;
    },   
  	
  	getName: function() {
  		return this.name;
  	},
  	
  	getExtName: function() {
  	    return this.REF_ELEMENT_PREFIX + this.getName();
  	},
  	
  	getLabel: function() {
  		return this.label;
  	},
  	
  	setTable: function(t) {
  		this.table = t;
  	},
  	
  	addOption: function(select, namePrefix, labelPrefix) {
        var t = this.getName();
        var ext = this.getExtName();
        if (namePrefix && namePrefix != '') {
           var idx = namePrefix.lastIndexOf(".");
           var s = namePrefix.substring(idx + 1);
           var previousIsExtension = true;
           if (s.indexOf(this.REF_ELEMENT_PREFIX) == 0)
	           ext = namePrefix.substring(0,idx + 1) + ext;
           else {
	           ext = namePrefix + "." + ext;
	           previousIsExtension = false;
           }
        }
        var label = this.getLabel();
        var reflabel = label;
        if (labelPrefix && labelPrefix != '')
           if (previousIsExtension)
           	  reflabel = labelPrefix.substring(0,labelPrefix.lastIndexOf(".")) + "." + reflabel;	
           else
              reflabel = labelPrefix + "." + reflabel;
        tlabel = label + " (+)";
        var opt = appendSelectOption(select, ext, document.createTextNode(tlabel));
        if (labelPrefix != '')
        	opt.innerHTML = "&nbsp;&nbsp;&nbsp;"+tlabel;   
        else
            opt.innerHTML = tlabel;  
     
        opt.cl = reflabel;
        opt.cv = ext;
        opt.tl = reflabel;
        opt.style.color = 'darkred';
        opt.style.cursor = 'pointer';
        opt.title = "Show extended fields from " + label + " table";
        opt.doNotDelete = 'true';
        opt.doNotMove = 'true'
        opt.reference =  t;
        opt.bt = this.table.getName();
        opt.btl = this.table.getLabel();
        opt.headerAttr = 'true';
        opt.tl = reflabel;
  	},
  	
	type : function() {
		return "TableExtension";
	}
});
;
/*! RESOURCE: /scripts/classes/GlideDecoration.js */
var GlideDecoration = Class.create({
EDIT_DECORATION : "images/editor_view_small.gifx",
    initialize: function (node) {
        this.type = node.getAttribute('type');
        this.iconSRC = node.getAttribute('iconSRC');
        var left = node.getAttribute('left');
        if (left == 'true')
            this.left = true;
        else
            this.left = false;
        if (this.type == 'popup') {
            this.onMouseMove = node.getAttribute('onMouseMove');
            this.onMouseExit = node.getAttribute('onMouseOut');
        } else if (this.type == 'expandCollapseDecoration') {
        	this.expandedIcon = node.getAttribute('expandedIcon');
        	this.collapsedIcon = node.getAttribute('collapsedIcon');
        	this.expandedIconAlt = node.getAttribute('expandedIconAlt');
        	this.collapsedIconAlt = node.getAttribute('collapsedIconAlt');
        	this.memory = node.getAttribute('memory');
        	this.expanded = node.getAttribute('expanded');
        	this.altText = node.getAttribute("collapsedText");
        } else if (this.type == 'editDecoration') {
        	this.editLink = node.getAttribute('editLink');
        }
    },
    
    attach: function (window) {
        if (this.type == 'image')
           this.attachImage(window);     
        else if (this.type == 'popup')
           this.attachPopup(window);
        else if (this.type == 'expandCollapseDecoration')
           this.attachExpandCollapse(window);
        else if (this.type == 'editDecoration')
           this.attachEdit(window);
    },
    
    attachImage: function (window) {
        var decoration = cel('img');
        decoration.setAttribute('src', this.iconSRC);
        decoration.setAttribute('alt', '');
        window.addDecoration(decoration, this.left);
    },
    
    attachEdit: function (window) {
    	var an = cel('a');
        var d = cel('img');
        d.src =  this.EDIT_DECORATION;
        d.alt = getMessage('Edit');
        if (this.editLink.indexOf('javascript:') == 0) {
        	var toEval = this.editLink.substring('javascript:'.length);
        	toEval = "var f = function(e) { if (!e) { e = event;}; " + toEval + "}";
        	eval(toEval);
        	an.onclick = f;
        } else
        	an.href = this.editLink;
        an.appendChild(d);
        window.addDecoration(an, this.left);
    },
    
    attachPopup: function (window) {
        var span = cel('span');       
        
        var toEval = this.onMouseMove;
        toEval = "var f = function(e) { if (!e) { e = event;}; " + toEval + "}";
   		eval(toEval);
        span.onmousemove = f;
        toEval = this.onMouseExit;
        toEval = "var f = function(e) { if (!e) { e = event;}; " + toEval + "}";
        eval(toEval);        
        span.onmouseout = f;
        var decoration = cel('img');
        decoration.setAttribute('src', this.iconSRC);
        decoration.setAttribute('alt', '');
        span.appendChild(decoration);
        window.addDecoration(span, this.left);
    },
    
     attachExpandCollapse: function (window) {      
        this.img = cel('img');
        this.img.onclick = this.toggleExpand.bind(this);
        this.img.setAttribute('src', this.iconSRC);
        this.img.setAttribute('alt', getMessage('Collapse'));
        this.img.style.verticalAlign = "top";
        this.gwtWindow = window;
        window.addDecoration(this.img, this.left);
        if (this.expanded == 'false') {
        	this.expanded = true;
        	this.toggleExpand();
        }
    },
    
    toggleExpand : function (e) {
    	this.expanded = !this.expanded;
    	var localExpanded;
    	if (this.expanded) {
    	    this.img.setAttribute('src', this.expandedIcon);
    	    this.img.setAttribute('alt', this.expandedIconAlt)
    	    var span = this.gwtWindow.body;
    	    var temp = span.innerHTML;
    	    span.innerHTML = this.altText;
    	    this.altText = temp;
    	    localExpanded = 'true';
    	} else {
    		this.img.setAttribute('src', this.collapsedIcon);
    		this.img.setAttribute('alt', this.collapsedIconAlt)
    		var span = this.gwtWindow.body;
    		var temp = span.innerHTML;
    		span.innerHTML = this.altText;
    		this.altText = temp;
    		localExpanded = 'false';
    	}
    	if (this.memory != null && this.memory != '')
    		setPreference('render_' + this.memory + '.expanded', localExpanded);
    }
});
;
/*! RESOURCE: /scripts/classes/GwtCellSelector.js */
var GwtCellSelector = Class.create({
	
	
	initialize: function(tableElement) {
		this.tableElement = tableElement;
		
		this.setDisable(false);
		this.setSelectColumnOnly(false);
		this.setSelectNonContiguous(false);
		this.setSelectColor("#DFDFDF");
		this.browserColor = null;
		this.setUnselectColor("#FAFAFA");
		this.setCursor("crosshair");	
		this.setBorderSize("2px solid black");
		this.onSelect = null;
		this.beforeSelect = null;
		this.selectMultipleColumns = false;
		this.selectMiscCells = false;
		this.isMouseDown = false;
				
		this.centerCellColVal = 0;
		this.centerCellRowVal = 0;
		this.atCol = 0;
		this.atRow = 0;
		this.colFrom = 0;
		this.colTo = 0;
		this.rowFrom = 0;
		this.rowTo = 0;
		this.maxCol = 0;
		this.maxRow = 0;
	    this.selectCount = 0;
		this.returnObjects = new Object();
		this.cellBackgroundXref = new Object();
		this.ignoreColumns = new Object();
		this.ignoreRows = new Object();
		this.getGridInfo()
			
		Event.observe(this.tableElement, "mousedown", this._dragStart.bind(this));
		this.mouseUpTableListener = this._dragEnd.bindAsEventListener(this);
		this.mouseOverTableListener = this._dragOver.bindAsEventListener(this);
		this.mouseUpDocListener = this._dragCheck.bindAsEventListener(this);
	},
	
	_draw: function() {
		this._drawSelection(this.colFrom, this.colTo, this.rowFrom, this.rowTo);
	},
	
	_dragStart: function(e) {
		if (Event.isRightClick(e))
			return;
		if ($("cell_edit_cancel") || $("cell_edit_ok"))
			return;
		
		if	(!this.disableGrid) {
			this.getGridInfo();
			if (this.selectNonContiguous) 
				this._contiguousCheck(e);
			if (this.ignoreColumns[Event.element(e).cellIndex] ||
				this.ignoreRows[this._getRowIndex(Event.element(e).parentNode)]) { 
				return;
			}
			if (this.beforeSelect) {
				if (!this.handleBeforeSelect(e)) 
					return;
			}
			if (!this.isSelectColumnOnly) 
				this.selectMultipleColumns = e.shiftKey;
			this.isMouseDown = true;
			document.body.style.cursor = this.cursor;
			stopSelection(document.body);
			this._setEpicenter(e);
			this._selectAndDrawCells(Event.element(e));
			Event.observe(this.tableElement, "mouseup", this.mouseUpTableListener);
			Event.observe(this.tableElement, "mouseover", this.mouseOverTableListener);
			Event.observe(document, "mouseup", this.mouseUpDocListener);
			e.preventDefault();
		}
	},
	
	_dragOver: function(e) {
		if	(this.isMouseDown) {
			this._selectAndDrawCells(Event.element(e)); 
		}
	},
	
	_dragEnd: function(e) {
		this.returnObjects = new Object();
		this.isMouseDown = false;
		document.body.style.cursor = "default";
		this._selectAndDrawCells(Event.element(e));
		if	(this.onSelect) {
			this.handleOnSelect(this.returnObjects);
		}
		restoreSelection(document.body);
		Event.stopObserving(this.tableElement, "mouseup", this.mouseUpTableListener);
		Event.stopObserving(this.tableElement, "mouseover", this.mouseOverTableListener);
		Event.stopObserving(document, "mouseup", this.mouseUpDocListener);
	},
	
	_dragCheck: function(e) {
		if	(this.isMouseDown) {
			try {
				this._dragEnd(e);
			}
			catch (err) {
			}			
		}
	},
	
	_contiguousCheck: function(e) {
		if (e.ctrlKey)
			this.selectMiscCells = e.ctrlKey;
		else if (e.metaKey)
			this.selectMiscCells = e.metaKey;
		else
			this.selectMiscCells = false;
	},
	
	getSelectedObjects: function() {
		return this.returnObjects;		
	},
	
	getColFrom: function() {
		return this.colFrom;
	},
	
	getColTo: function() {
		return this.colTo;		
	},
	
	getRowFrom: function() {
		return this.rowFrom;		
	},
	
	getRowTo: function() {
		return this.rowTo;		
	},
	
	setIgnoreColumn: function(column) {
		this.ignoreColumns[column] = column;	
	},
	
	setIgnoreRow: function(row) {
		this.ignoreRows[row] = row;	
	},
	
	setSelectColor: function(selectColor) {
		this.selectColor = selectColor;	
	},
	
	setUnselectColor: function(unselectColor) {
		this.unselectColor = unselectColor;	
	},
	
	setCursor: function(cursor) {
		this.cursor = cursor;	
	},
	
	setSelectColumnOnly: function(flag) {
		this.isSelectColumnOnly = flag;	
	},
	
	setDisable: function(flag) {
		this.disableGrid = flag;
	},
	
	setSelectNonContiguous: function(flag) {
		this.selectNonContiguous = flag;
	},
	
	setBorderSize: function(size) {
		this.borderSize = size;
	},
	
	_setSelectedCells: function(colFrom, colTo, rowFrom, rowTo) {
		this.colFrom = colFrom;
		this.colTo = colTo;
		this.rowFrom = rowFrom;
		this.rowTo = rowTo;
	},
	
	_selectAndDrawCells: function(e) {
		this._selectCells(e);
		this._drawSelection(this.colFrom, this.colTo, this.rowFrom, this.rowTo);	
	},
	
	_selectCells: function(e) {
		this.atColVal = e.cellIndex;
		this.atRowVal = this._getRowIndex(e.parentNode);
		
		if	(this.atColVal <= 0) 
			return;
		if	(this.atRowVal <= 0) 
			return;
		
		if (this.selectMultipleColumns) {
			if	(this.atColVal < this.centerCellColVal) {
				this.colFrom = this.atColVal;
				this.colTo = this.centerCellColVal;
				this._getRowSelection();
				return;
			}
			if	(this.atColVal > this.centerCellColVal) {
				this.colFrom = this.centerCellColVal;
				this.colTo = this.atColVal;
				this._getRowSelection();
				return;
			}
		}
		if	(this.atColVal == this.centerCellColVal) {
			this.colFrom = this.centerCellColVal;
			this.colTo = this.centerCellColVal;
			this._getRowSelection();
			return;
		}
		if (this.atRowVal < this.centerCellRowVal) {
			this.rowFrom = this.atRowVal;
			this.rowTo = this.centerCellRowVal;
			this._getColSelection();
			return;
		}
		if (this.atRowVal > this.centerCellRowVal) {
			this.rowFrom = this.centerCellRowVal;
			this.rowTo = this.atRowVal;
			this._getColSelection();
			return;
		}
		if	(this.atRowVal == this.centerCellRowVal) {
			this.rowFrom = this.centerCellRowVal;
			this.rowTo = this.centerCellRowVal;
			this._getColSelection();
			return;
		}
	},
	
	_getRowSelection: function() {
		if (this.atRowVal <= this.centerCellRowVal) {
			this.rowFrom = this.atRowVal;
			this.rowTo = this.centerCellRowVal;
		} else {
			this.rowFrom = this.centerCellRowVal;
			this.rowTo = this.atRowVal;
		}
	},
	
	_getColSelection: function() {
		if (this.selectMultipleColumns) {
			if	(this.atColVal < this.centerCellColVal) {
				this.colFrom = this.atColVal;
				this.colTo = this.centerCellColVal;
				return;
			}
			if	(this.atColVal > this.centerCellColVal) {
				this.colFrom = this.centerCellColVal;
				this.colTo = this.atColVal;
				return;
			}
		}
		if	(this.atColVal == this.centerCellColVal) {
			this.colFrom = this.centerCellColVal;
			this.colTo = this.centerCellColVal;
		}
	},
	
	_drawSelection: function(colFrom, colTo, rowFrom, rowTo) {
		this._highlightCells(colFrom, colTo, rowFrom, rowTo);
	},
	
	restoreCellColors: function() {
		for (var key in this.returnObjects) {
			var color = "";
			var cell = key.split(",");
			var e = this.getTableCell(parseInt(cell[1]) - 1, cell[0]);
			removeClassName(e,"list_edit_selected_cell");
		}
		this.returnObjects = new Object();
	},
	
	_highlightCells: function(colFrom, colTo, rowFrom, rowTo) {
		if (!this.selectMiscCells)
			this.restoreCellColors();
			
		for (var x=colFrom; x<=colTo; x++) {
			for (var y=rowFrom; y<=rowTo; y++) {
				try {
					var e = this.tableElement.rows[y].cells[x];
					addClassName(e,"list_edit_selected_cell");
					this.returnObjects[x + "," + y] = e.id;
				}
				catch (err) {
				}
			}
		}
	},
	
	_clearAllCells: function() {
		for (var x=1; x<=this.maxCol; x++) {
			for (var y=1; y<this.maxRow; y++) {
				try {
					var cell = this.getTableCell(y, x);
					cell.style.backgroundColor = "";
					cell.style.border = "0px";
				}
				catch (err) {
				}
			}
		}
	},
	
	clearRanges: function() {
		try{
			if (ie5)
				document.selection.empty();
			else 
				window.getSelection().removeAllRanges();
		}catch (e){
			
		}		
	},
	
	getGridInfo: function() {
		var rows = this.getTableRows();
		this.maxRow = rows.length;
		if (rows.length > 0)
			this.maxCol = rows[0].cells.length;
	},
	
	setMaxRow: function(max) {
		this.maxRow = max;
	},
	
	_setEpicenter: function(e) {
		var element = this.retrieveCellFromNestedDOMElement(Event.element(e), 'DIV');
		this.centerCellColVal = element.cellIndex;
		this.centerCellRowVal = this._getRowIndex(element.parentNode);
	},
	
	handleBeforeSelect: function(e) {
	},
	retrieveCellFromNestedDOMElement: function(element, tagName) {
		if (element.tagName == tagName && element.parentNode.tagName == 'TD')
			return element.parentNode;
		return element;
	},
	
	handleOnSelect: function(selectedCells) {
	},
	
	setBeforeSelect: function(flag) {
		this.beforeSelect = flag;
	},
	
	setOnSelect: function(flag) {
		this.onSelect = flag;
	},
	
	_getRowIndex: function(element) {
		return this.getTableRows().indexOf(element) + 1;
	},
	
	getTableRows: function() {
		var rows = this.tableElement.rows;
		listRows = [];
		for (var i = 0, n = rows.length; i < n; i++) {
			var row = rows[i];
			if (!hasClassName(row, 'list_row'))
				continue; 
			
			listRows.push(row);
		}
		return listRows;
	},
	getTableCell: function(rowNdx, colNdx) {
		var rows = this.getTableRows();
		if (!rows || !rows[rowNdx])
			return null;
		return rows[rowNdx].cells[colNdx];
	},
	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideRecord.js */
var GlideRecord = Class.create({
	AJAX_PROCESSOR : "AJAXGlideRecord",
	initialized : false,
  
	initialize: function(tableName) {
		this.currentRow = -1;
		this.rows = [];
		this.conditions = [];
		this.encodedQuery = "";
		this.orderByFields = [];
		this.orderByDescFields = [];
		this.displayFields = [];
		this.maxQuerySize = -1;
		this._wantSessionMessages = true;
		this._additionalParams = {};
		
		if (tableName)
		    this.setTableName(tableName);
		
		if (this.initialized == false) {
		  	this.ignoreNames = {};
			
			for(var xname in this) {
				this.ignoreNames[xname] = true;
			}
		} else {
			for(var xname in this) {
				if (this.ignoreNames[xname] && this.ignoreNames[xname] == true)
					continue;
					
				delete this[xname];
			}
		}
		
		this.initialized = true;
	},
	addQuery: function() {
		var fName;
		var fOper;
		var fValue;
	
		if (arguments.length == 2) {
			fName = arguments[0];
			fOper = '=';
			fValue = arguments[1];
		} else if (arguments.length == 3) {
			fName = arguments[0];
			fOper = arguments[1];
			fValue = arguments[2];
		}
	
		this.conditions.push({ 'name' : fName, 'oper' : fOper, 'value' : fValue});
	},
	setEncodedQuery: function(queryString) {
		this.encodedQuery = queryString;
	},
	getEncodedQuery: function() {
		var qc = [];
		if (this.encodedQuery) {
			qc.push(this.encodedQuery);
		}
		for (var i = 0; i < this.conditions.length; i++) {
			var q = this.conditions[i];
			qc.push(q.name + q.oper + q.value);
		}
		return qc.join('^');
	},
  
	deleteRecord: function(responseFunction) {
		var ajax = new GlideAjax(this.AJAX_PROCESSOR);
		ajax.addParam("sysparm_type", "delete");
		ajax.addParam("sysparm_name", this.getTableName());
		ajax.addParam("sysparm_chars", this._getXMLSerialized());
		ajax.addParam('sysparm_want_session_messages', this._wantSessionMessages);
		if(typeof responseFunction == 'undefined') {
			var sw = new StopWatch();
			sw.jslog("*** WARNING *** GlideRecord synchronous query for table: " + this.getTableName());
		}
		if (typeof responseFunction != 'function') {
			ajax.getXML();
			return;
		}
		
		ajax.getXML(this._deleteRecord0.bind(this), null, responseFunction);
	},
	
	_deleteRecord0 : function(response, responseFunction) {
		if (!response || !response.responseXML)
			return;
			
		responseFunction(this);
	},
	
	get: function(id) {
		this.initialize();
		this.addQuery('sys_id', id);
		this.query();
		return this.next();
	},
	
	getTableName: function() {
		return this.tableName;
	},
	hasNext: function() {
		return (this.currentRow + 1 < this.rows.length);
	},
	
	insert: function(responseFunction) {
		return this.update(responseFunction);
	},
	
	gotoTop : function() {
		this.currentRow = -1;
	},
	next: function() {
		return this._next();
	},
	_next: function() {
		if (!this.hasNext())
			return false;
	
		this.currentRow++;
		this.loadRow(this.rows[this.currentRow]);
		return true;
	},
	loadRow: function(r) {
		for (var i = 0; i < r.length; i++)  {
			var name = r[i].name;
		    var value = r[i].value;
		    
		    if (this.isDotWalkField(name)) {
		    	var start = this;
var parts = name.split(/-/);
		    	
		    	for(var p = 0; p < parts.length - 1; p++) {
		    		var part = parts[p];
		    		
		    		if (typeof start[part] != 'object')
		    			start[part] = new Object();
		    		
		    		start = start[part];
		    	}
		    	
		    	var fieldName = parts[parts.length - 1];
		    	start[fieldName] = value;
		    } else {
		    	this[name] = value;
		    }
		}
	},
	getValue: function(fieldName) {
		return this[fieldName];
	},
	setValue: function(fieldName, value) {
		this[fieldName] = value;
	},
	isDotWalkField: function(name) {
		for(var i = 0; i < this.displayFields.length; i++) {
			var fieldName = this.displayFields[i];
			if (fieldName.indexOf(".") == -1)
				continue;
			
var encodedFieldName = fieldName.replace(/\./g,"-");
			if (name == encodedFieldName)
				return true;
		}
		
		return false;
	},
	
	addOrderBy: function(f) {
		this.orderByFields.push(f);
	},
	
	orderBy: function(f) {
		this.orderByFields.push(f);
	},
	orderByDesc: function(f) {
		this.orderByDescFields.push(f);
	},
	
	setDisplayFields: function(fields) {
	  	this.displayFields = fields;
	},
  
	query: function() {
		var responseFunction = this._parseArgs(arguments);
		
		if (this._getBaseLine()) {
			var rxml = loadXML(g_filter_description.getBaseLine());
			this._queryResponse(rxml);
			return;
		}
		
		var ajax = new GlideAjax(this.AJAX_PROCESSOR);
		ajax.addParam("sysparm_type", "query");
		ajax.addParam("sysparm_name", this.getTableName());
		ajax.addParam("sysparm_chars", this.getEncodedQuery());
		ajax.addParam('sysparm_want_session_messages', this._wantSessionMessages);
		if(this.getLimit() != -1)
		    ajax.addParam("sysparm_max_query", this.getLimit());
		if (this.orderByFields.length > 0)
			ajax.addParam("sysparm_orderby", this.orderByFields.join(","));
		if (this.orderByDescFields.length > 0)
			ajax.addParam("sysparm_orderby_desc", this.orderByDescFields.join(","));
		if (this.displayFields.length > 0)
			ajax.addParam("sysparm_display_fields", this.displayFields.join(","));        
		for (var key in this._additionalParams) {
			if (typeof key === 'string')
				ajax.addParam(key, this._additionalParams[key]);
		}
		if (!responseFunction)	 {
            var sw = new StopWatch();
			var rxml = ajax.getXMLWait();
            sw.jslog("*** WARNING *** GlideRecord synchronous query for table: " + this.getTableName());
			this._queryResponse(rxml);
			return;
		}
		
		ajax.getXML(this._query0.bind(this), null, responseFunction);
	},
	
	_parseArgs: function(args) {
		var responseFunction = null;
		var i =0;
		while (i < args.length) {
			if (typeof args[i] == 'function') {
				responseFunction = args[i];
				i++;
				continue;
			}
			
			if (i+1 < args.length) {
				this.conditions.push({ 'name' : args[i], 'oper' : '=', 'value' : args[i+1]});
				i+=2;
			} else
				i++;
		}
		return responseFunction;
	},
	
	_query0: function(response, responseFunction) {
		if (!response || !response.responseXML)
			return;
		
		this._queryResponse(response.responseXML);
		responseFunction(this);
	},
	
	
	_queryResponse: function(rxml) {
		var rows = [];
		var items = rxml.getElementsByTagName("item");
		for (var i = 0; i < items.length; i++) {	
			if ((items[i].parentNode.parentNode == rxml)) {
				var grData = items[i];
				var cnodes = grData.childNodes;
				var fields = [];
				for (var z = 0; z < cnodes.length; z++) {
					var field = cnodes[z];
					var name = field.nodeName;
					var value = getTextValue(field);
					if (!value)
						value = "";
					fields.push({ 'name' : name, 'value' : value });
				}
				if (cnodes.length && cnodes.length > 0)
					rows.push(fields);
			}
		}
	
		this.setRows(rows);		
	},
	setRows: function(r) {
		this.rows = r;
	},
	
	setTableName: function(tableName) {
		this.tableName = tableName;
	},
	update: function(responseFunction) {
		var ajax = new GlideAjax(this.AJAX_PROCESSOR);
		ajax.addParam("sysparm_type", "save_list");
		ajax.addParam("sysparm_name", this.getTableName());
		ajax.addParam("sysparm_chars", this._getXMLSerialized());
		ajax.addParam('sysparm_want_session_messages', this._wantSessionMessages);
		if (typeof responseFunction == 'undefined') {
			var sw = new StopWatch();
			sw.jslog("*** WARNING *** GlideRecord synchronous update or insert for table: " + this.getTableName());
			var rxml = ajax.getXMLWait();
			return this._updateResponse(rxml);
		} 
		
		if (typeof responseFunction != 'function') 
			responseFunction = doNothing;
			
		ajax.getXML(this._update0.bind(this), null, responseFunction);
	},
	
   _update0: function(response, responseFunction) {
		if (!response || !response.responseXML)
			return;
		
		var answer = this._updateResponse(response.responseXML);
		responseFunction(this, answer);
	},
	
	_updateResponse: function(rxml) {
		var items = rxml.getElementsByTagName("item");
		if (items && items.length > 0)
			return getTextValue(items[0]);
	},
	
	setLimit: function(maxQuery) {
	    this.maxQuerySize = maxQuery;
	},
	
	getLimit: function() {
	    return this.maxQuerySize;
	},
  
   	_getXMLSerialized: function() {
var xml = loadXML("<record_update/>");
		
		var root = xml.documentElement;
		if(this.sys_id)
			root.setAttribute("id", this.sys_id);
		root.setAttribute('table', this.getTableName());
		var item = xml.createElement(this.getTableName());
		root.appendChild(item);
		
		for(var xname in this) {
			if (this.ignoreNames[xname])
		    	continue;
		
			var f = xml.createElement(xname);
			item.appendChild(f);
			
			var v = this[xname];
			if (!v)
				v = "NULL";
			
		    var t = xml.createTextNode(v);
			f.appendChild(t);
		}
		
		return getXMLString(xml);
	},
	_getBaseLine: function() {
		return window.g_filter_description
			&& typeof g_filter_description.getBaseLine() != 'undefined'
			&& this.getTableName() == 'cmdb_baseline'
			&& this.getEncodedQuery()
			&& this.orderByFields.length < 1
			&& this.displayFields.length < 1;
	},
	setWantSessionMessages: function(want) {
		this._wantSessionMessages = want;
	},
	
	addAdditionalParam: function(key, val) {
		this._additionalParams[key] = val;
	},
	
  	z: null
});
;
/*! RESOURCE: /scripts/classes/GlideWindow.js */
var GlideWindow = Class.create(GwtObservable, {
	
	FORWARD_EVENTS: {
		"mouseover" : true, 
		"mouseout" : true, 
		"mousemove" : true,
		"click" : true,
		"dblclick" : true,
		"keyup" : true,
		"mouseenter" : true,
		"mouseleave" : true
	},
	initialize: function(id, readOnly) {
		if (typeof this.DEFAULT_BODY == 'undefined')
this.DEFAULT_BODY = "<center> "+ getMessage("Loading...") +" <br/><img src='images/ajax-loader.gifx' alt='"+ getMessage("Loading...") +"' /></center>";
		this._dir = $$('html')[0].readAttribute('dir') === "rtl" ? "right" : "left"; 
		this.id = id;
		this.window = null;
		this.windowClass = "drag_section_picker";
		this.zIndex = 3;
		this.position = "absolute";
		this.padding = 3;
		this.container = null;
		this._readOnly = readOnly;
		this.preferences = new Object();
		this.titleHTML = null;
		this.elementToFocus = null;
		this.offsetHorizontal = 0;
		this.offsetTop = 0;
		this.gd = null;
		this.shim = null;
		this.valid = true;
		this.closeDecoration = null;
		this._draw(id);
		this.initDecorations();
		this.headerWrap = false;
		this.setScope("global");
		this.doctype = document.documentElement.getAttribute('data-doctype') == 'true';
		this.nologValue = false;
	},
	addDecoration: function(decorationElement, leftSide) {
		if (leftSide) {
			var ld = this.leftDecorations;
			ld.style.display = "block";
			
			if (ld.hasChildNodes()) {
				ld.insertBefore(decorationElement, ld.childNodes[0].nextSibling);
			} else {
				ld.appendChild(decorationElement);
			}
		} else {
			if	(this.rightDecorations) {
				var rd = this.rightDecorations;
				
				if (rd.hasChildNodes()) {
					rd.insertBefore(decorationElement, rd.childNodes[0]);
				} else {
					rd.appendChild(decorationElement);
				}
			}
			else {
			}
		}
	},
	addFunctionDecoration: function(imgSrc, label, clickHandler, side) {
		var keyPressHandler = function(ev) {
			if (ev.keyCode === 32 || ev.keyCode === 13) {
				ev.preventDefault();
				clickHandler(ev);
			}
		};
		var span = cel('span');
		span.onclick = clickHandler;
		span.onkeypress = keyPressHandler;
		span.gWindow = this;
		span.setAttribute('role', 'button');
		span.setAttribute('tabindex', 0);
		span.setAttribute('aria-label', getMessage(label));
		var img = cel('img', span);
		img.id = 'popup_close_image';
		img.height = '12';
		img.width = '13';
		img.src = imgSrc;
		img.setAttribute('aria-hidden', true);
		this.addDecoration(span, side);
		img = null;
		return span;
	},
	addHelpDecoration: function(func) {
this.addFunctionDecoration('images/help.gif', 'Help', func);
	},
	clearLeftDecorations: function() {
		clearNodes(this.leftDecorations);	
	},
	
	clearRightDecorations: function() {
		clearNodes(this.rightDecorations);	
	},
	
	dragging: function(me, x, y) {
		x = Math.max(x, 0);
		y = Math.max(y, 0);
		this.fireEvent("dragging", this);
		me.draggable.style.left = x + 'px';
		me.draggable.style.top = y + 'px';
		
		this._setShimBounds(x, y, "", "");
	},
	destroy: function() {
		this.fireEvent("beforeclose", this);
		if (this.container) {
			var parent = this.container.parentNode;
			if (parent)
				parent.removeChild(this.container);
		} else {
			var gWindow = this.getWindowDOM();
			var parent = gWindow.parentNode;
			if (parent)
				parent.removeChild(gWindow);
		}
		
		this.setShim(false);
		if (isMSIE)
		  this.container.outerHTML = '';
		this.release();
		this.valid = false;
		this.closeDecoration = null;
	},
	getAbsoluteRect: function(addScroll) {
		return getBounds(this.getWindowDOM(), addScroll);
	},
	getBody: function() {
		return this.body;
	},
	getContainer: function() {
		var obj;
		if (this.container) {
			obj = this.container;
		} else {
			obj = this.getWindowDOM();
		}
		
		return obj;
	},
	getClassName: function() {
		return this.getWindowDOM().className;
	},
	getDecorations: function(left) {
		if (left)
			return this.leftDecorations;
		return this.rightDecorations;
	},
	
	getDescribingXML : function() {
		var section = document.createElement("section");
		section.setAttribute("name", this.getID());
	
		var preferences = this.getPreferences();
		for(var name in preferences) {
			var p = document.createElement("preference");
			var v = preferences[name];
			p.setAttribute("name", name);
			
			if (v != null && typeof v == 'object') {
				if (typeof v.join == "function") {
					v = v.join(",");
				} else if (typeof v.toString == "function") {
					v = v.toString();
				}
			}
			if (v && typeof v.escapeHTML === "function")
				v = v.escapeHTML();
			if (v)
				p.setAttribute("value", v);
			section.appendChild(p);
		}
		
		return section;
	},
	getDescribingText : function() {
		var gxml = document.createElement("gxml");
		var x = this.getDescribingXML();
		gxml.appendChild(x);
		return gxml.innerHTML;
	},
	getHeader: function() {
		return this.header;
	},
	getID: function() {
		return this.id;
	},
	getPosition: function() {
		return this.position;
	},
	getPreferences : function() {
		return this.preferences;
	},
	getPreference : function(id) {
		return this.preferences[id];
	},
	
	getTitle: function() {
		return this.title;
	},
	
	locate: function(domElement) {
		while (domElement.parentNode) {
			domElement = domElement.parentNode;
			if (domElement.gWindow) 
				return domElement.gWindow;
			if (window.$j && $j(domElement).data('gWindow')) {
				return $j(domElement).data('gWindow');
			}
		}	
		alert('GlideWindow.locate: window not found');
		return null;
	}, 
	
	get: function(id) {
		if (!id || !gel('window.' + id))
			return this;
			
		return gel('window.' + id).gWindow;
	},
	
	getWindowDOM: function() {
		return this.window;
	},
	getZIndex: function() {
		return this.zIndex;
	},
	
	initDecorations: function() {
		if (!this.isReadOnly()) {
this.closeDecoration = this.addFunctionDecoration("images/x.gifx", 'Close', this._onCloseClicked.bind(this));
		}
	},
	removeCloseDecoration: function() {
		if (this.closeDecoration)
			this.closeDecoration.parentNode.removeChild(this.closeDecoration);
			
		this.closeDecoration = null;
	},
	
	showCloseOnMouseOver: function() {
		Event.observe(this.window, "mouseover", this.showCloseButton.bind(this));
		Event.observe(this.window, "mouseout", this.hideCloseButton.bind(this));
		this.hideCloseButton();
	},
	
	showCloseButton: function() {
		if (this.closeDecoration)
			this.closeDecoration.style.visibility="visible";
	},
	
	hideCloseButton: function() {
		if (this.closeDecoration)
			this.closeDecoration.style.visibility="hidden";
	},
	
	insert: function(element, beforeElement, invisible) {
		var id = this.getID();
        element = $(element);
		var div = $(id);
		if (!div) {		    
			var div = cel("div");
			div.name = div.id = id;
			div.gWindow = this;
			div.setAttribute("dragpart", id);
			div.setAttribute("aria-labelledby", id + "_header_contents")
			div.setAttribute("sn-atf-area", id);
			div.setAttribute("sn-atf-whitelist", "true");
			div.className += " drag_section_part";
			div.style.position = this.getPosition();
			div.style.zIndex = this.getZIndex();
		    div.style[this._dir] = this.offsetHorizontal + "px";
		    div.style.top = this.offsetTop + "px";
		    div.appendChild(this.getWindowDOM());
			if (invisible)
				div.style.visibility = "hidden";
				
		    if (beforeElement)
		    	element.insertBefore(div, beforeElement);
		    else
		    	element.appendChild(div);
		}
		this.container = div;
	    this._enableDragging(div);
	},
	isActive: function() {
		return this.active;
	},
	
	isReadOnly: function() {
		return this._readOnly;
	},
	
	isValid: function() {
		return this.valid;
	},
	moveTo: function(x, y) {
		var o = this.getContainer();
		
		o.style[this._dir] = x + 'px';
		o.style.top = y + 'px';
		this._setShimBounds(x, y, "", "");
	},
	release: function() {
		this.window.gWindow = null;
		this.window = null;
		this.container = null;
		this.body = null;
		if (this.gd)
			this.gd.destroy();
		this.title = null;
		this.titleContents = null;
		this.header = null;
		this.shim = null;
		this.rightDecorations = null;
		this.leftDecorations = null;
	},
	removePreference: function(name, value) {
		delete this.preferences[name];
	},
	render: function() {
		var id = this.getID();
		var description = this.getDescribingText();
		var ajax = new GlideAjax("RenderInfo");
		if (this.getPreference("sysparm_scope"))
			ajax.setScope(this.getPreference("sysparm_scope"))
		if (this.nologValue)
			ajax.addParam("ni.nolog.sysparm_value", true);
		ajax.addParam("sysparm_value", description);
		ajax.addParam("sysparm_name", id);
		ajax.getXML(this._bodyRendered.bind(this));
	},
	invisible: function() {
		var e = this.getContainer();
		e.style.visibility = "hidden";
	},
	
	visible: function() {
		var e = this.getContainer();
		e.style.visibility = "visible";
	},
	
	setAlt: function(alt) {
		this.window.title = alt;
	},
	
	setEscapedBody: function(body) {
		if (!body)
		   return;
		   
body = body.replace(/\t/g, "");
body = body.replace(/\r/g, "");
body = body.replace(/\n+/g, "\n");
body = body.replace(/%27/g, "'");
body = body.replace(/%3c/g, "<");
body = body.replace(/%3e/g, ">");
body = body.replace(/&amp;/g, "&");
		this.setBody(body, true);
	},
	setBody: function(html, noEvaluate, setAlt) {
		this.body.innerHTML = "";
		
		if (typeof html == 'string') {
            
            var showBody = true;
            if (html.length == 0)
              showBody = false;
            this.showBody(showBody);   
            
			html = this._substituteGet(html);
			html = this._fixBrowserTags(html);
			this.body.innerHTML = html;
	
			if (setAlt)
				this.setBodyAlt(html);
			
			if (!noEvaluate)
				this._evalScripts(html);
		} else {
			 this.body.appendChild(html);
		}
		var prefs = this.body.getElementsByTagName("renderpreference");
		if (prefs.length > 0) {
			for(var i = 0; i < prefs.length; i++) {
				var pref = prefs[i];
				var name = pref.getAttribute("name");
				var valu = pref.getAttribute("value");
				if (name == "render_time") {
					this.debugTD.innerHTML = valu;
					this.debugTD.style.display = "table-cell";
					continue;
				}
				
				this.setPreference(name, valu);
				if (name == "title") {
					this.setTitle(sanitizeHtml(valu));
					var titleChildren = this.title.children;
					if (titleChildren.length > 0) {
						var titleNode = titleChildren[0];
						var titlePref = this.getPreference('title')  || '';
						if (titleNode.tagName === 'A' && this.getPreference('fromHome') &&
							titlePref.indexOf('onmousedown') !== -1 && !titleNode.hasAttribute('onmousedown')
						   ) {
							titleNode.onmousedown=function(event){Event.stop(event); return false;}
						}
					}
				}
				if (name == "render_title" && valu == "false")
					this.header.style.display = "none";
				if (name == "hide_close_decoration" && valu == "true")
					this.removeCloseDecoration();
			}
		}
		
		var decorations = this.body.getElementsByTagName("decoration");
		if (decorations.length > 0) {
			for (var x = 0; x < decorations.length; x++) {
			    var thisDecoration = new GlideDecoration(decorations[x]);
			    thisDecoration.attach(this);
			}
		}
		
		if (this.elementToFocus) {
			if (gel(this.elementToFocus)) {
				self.focus();
			    gel(this.elementToFocus).focus();
			}
		}
		
		this._shimResize();
	},
    
    showBody: function(show) {
    	if (this.divMode)
    		var tr = this.body;
    	else
        	var tr = this.body.parentNode.parentNode;
        	
        if (show)
			tr.style.display = "";
		else
			tr.style.display = "none";
    },
	setBodyAlt: function(alt) {
		this.body.title = alt;
	},
	
	setClassName: function(className) {
		this.windowClass = className;
		
		if (this.getWindowDOM())
			this.getWindowDOM().className = className;
	},
	setColor: function(color) {
		this.windowBackground = color;
		
		if (this.getBody())
			this.getBody().parentNode.style.backgroundColor = color;
	},
	setFocus: function(id) {
		this.elementToFocus = id;
	},
	
	setFont: function(family, size, fontUnit, weight) {
        this.setFontSize(size, fontUnit);
        this.setStyle("fontFamily", family);
        this.setFontWeight(weight);
	},
    
    setFontSize: function(size, fontUnit) {
		if (!fontUnit)
			fontUnit = "pt";
        this.setStyle("fontSize", size + fontUnit);
   },
   
   setFontWeight: function(weight) {
        this.setStyle("fontWeight", weight);      
   },
   
   setStyle: function(name, value) {
       if (!value)
         return; 
         
       this.getTitle().style[name] = value;    
       this.getBody().style[name] = value;        
   },
    
	setHeaderClassName: function(className) {
		this.getHeader().className = className;
	},
	
	setHeaderColor: function(background) {
		this.header.style.backgroundColor = background;
	},
	
	setHeaderColors: function(color, background) {
		this.setHeaderColor(background);
		this.title.style.color = color;
	},
	
    setOpacity: function(opacity) {
    	if (this.divMode) {
			var element = this.getBody().parentNode; 
	        element.style.filter = "alpha(opacity=" + (opacity * 100) + ")";
	       	element.style.MozOpacity = opacity + "";
	        element.style.opacity = opacity + "";
	        element.style.opacity = opacity;
    	}
    },
    
	setPreferences : function(preferences) {
		this.preferences = preferences;
	},
	setPreference: function(name, value) {
		this.preferences[name] = value;
	},
	setPosition: function (name) {
		if (this.getContainer() != this.getWindowDOM())
			this.getContainer().style.position = name;
		this.position = name;
	},
	setReadOnly: function(r) {
		this._readOnly = r;
	},
    
    setWidth: function(width) {
      this.setSize(width, "");  
    },
	
	getWidth: function() {
		if (this.window)
			return this.window.clientWidth;
		else 
			return;
	},
	
	setHeight: function(height) {
		this.definedHeight = height;
		this.setSize("", height);  
	},
	
	removeHeight: function() {
		this.definedHeight = null;
		var obj = this.getContainer();
		obj.style.height = "";
		this.window.style.height = "";
		var bo = this.getBody();
		bo.style.height = "";
	},
 	getHeight: function() {
		if (this.window)
			return this.window.clientHeight;
	},
	setSize: function(w, h) {
		var obj = this.getContainer();
		var bo = this.getBody();
		
		var setWidth = w;
		if (setWidth && !isNaN(setWidth)) 
			setWidth = setWidth + 'px';
		bo.style.width = setWidth;
		obj.style.width = setWidth;
		
		if (obj != this.window)
			this.window.style.width = setWidth;
		
        var setHeight = h;
        if (h && !isNaN(setHeight)) {
            setHeight = setHeight + 'px';
            obj.style.height = setHeight;
        }
       
		this._setShimBounds("", "", w, h);
	},
	adjustBodySize: function() {
		var obj = this.getContainer();
		var bo = this.getBody();
		var h = obj.clientHeight;
		if ((h - this.header.clientHeight) > 0) {
			var headerClientHeight = h - this.header.clientHeight;
			bo.style.height = headerClientHeight + 'px';
		} else if (!(isMSIE9 && getTopWindow().document.doctype))
			bo.style.height = 0;
		this.window.style.height = obj.style.height;
	},
	
    removeBody: function() {
        var element = this.getBody();
element = element.parentNode;
element = element.parentNode;
        var tbody = element.parentNode;
        tbody.removeChild(element);
    },
	clearSpacing: function() {
		this.window.style.padding = "0px";
		this.body.style.padding = "0px";
		if (!this.divMode) {
			this.window.cellSpacing = 0;
			this.window.cellPadding = 0;
		}
	},
	
	setWindowActive: function() {
		this.setHeaderClassName("drag_section_header_active");
		this.active = true;
		addClassName(this.getContainer(), "selected");
	},
	
	setWindowInactive: function() {
		this.setHeaderClassName("drag_section_header");
		this.active = false;
		removeClassName(this.getContainer(), "selected");
	},
	
	toggleActive: function() {
		if (this.active)
			this.setWindowInactive();
		else
			this.setWindowActive();	
	},
	
	setHeaderWrap: function(wrap) {
		this.headerWrap = wrap;
		if (wrap)
			this.title.style.whiteSpace = "normal";
		else
			this.title.style.whiteSpace = "nowrap";
	},
	
	isHeaderWrap: function() {
		return this.headerWrap;
	},
	setShim: function(b) {
		if (!ie5)
			return;
		if (b == false) {
			if (this.shim) {
				var parent = this.shim.parentNode;
				parent.removeChild(this.shim);
			}
		} else { 
			var iframeShim = cel("iframe");
			iframeShim.id = iframeShim.name = "iframeDragShim_" + this.id;
			iframeShim.src = "blank.do";
			iframeShim.style.position = "absolute";
			iframeShim.style.top = 0;
			iframeShim.style.left = 0;
			iframeShim.style.width = 0;
			iframeShim.style.height = 0;
			iframeShim.frameBorder = 0;
			this.container.parentNode.appendChild(iframeShim);
			this.shim = iframeShim;
			
			var win = this.getWindowDOM();
			Event.observe(win, 'resize', this._shimResize.bind(this));
		}
	},
	setAriaModal: function(isModal) {
		var container = this.getContainer();
		container.setAttribute('aria-modal', isModal);
	},
	setTitle: function(html) {
		this.titleValue = html;
		var titleNode = this.titleContents && !this.divMode ? 'titleContents' : 'title';
		if (typeof html == 'string'){
			var scrollToMsg = gel("ni.escape_gwindow_message");
			if (scrollToMsg && scrollToMsg.value === 'true')
				this[titleNode].innerHTML = sanitizeHtml(html);
			else
				this[titleNode].innerHTML = html;
		} else {
			this[titleNode].innerHTML = "";
			this[titleNode].appendChild(html || "");
		}
	},
	
	setTitleAlign: function(align) {
		this.title.style.textAlign = align;
		var children = this.title.children;
		for (var i = 0; i < children.length; i++) {
			children[0].style.textAlign = align;
		}
	},
	
	setTitleSize: function(size) {
		this.title.style.fontSize = size;
		var children = this.title.children;
		for (var i = 0; i < children.length; i++) {
			children[0].style.fontSize = size;
		}
	},
	
	setTitleFont: function(font) {
		this.title.style.fontFamily = font;
		var children = this.title.children;
		for (var i = 0; i < children.length; i++) {
			children[0].style.fontFamily = font;
		}
	},
	
	setTitleColor: function(color) {
		this.title.style.color = color;
		var children = this.title.children;
		for (var i = 0; i < children.length; i++) {
			children[0].style.color = color;
		}
	},
	
	setBorderVisibility: function(visible) {
		var window = this.getWindowDOM();
		if (visible !== "false" && visible) {
			window.style.border = "";
			window.style.boxShadow = "";
		} else {
			window.style.border = "none";
			window.style.boxShadow = "none";
		}
	},
	
	setBorderWidth: function(width) {
		this.getWindowDOM().style.borderWidth = width;
	},
	
	setBorderColor: function(color) {
		this.getWindowDOM().style.borderColor = color;
	},
	
	setHeaderBorderVisibility: function(visible) {
		if (visible !== "false" && visible)
			this.header.style.border = "solid";
		else
			this.header.style.border = "none";
	},
	
	setHeaderBorderWidth: function(width) {
		this.header.style.borderWidth = width;
	},
	
	setHeaderBorderColor: function(color) {
		this.header.style.borderColor = color;
	},
	
	setHeaderBackgroundColor: function(color) {
		this.header.style.backgroundColor = color;
	},
	
	setTitleVisibility: function(visible) {
		if (visible !== "false" && visible)
			this.setTitle(this.titleValue);
		else
			this.title.innerHTML = "";
	},
	
	setZIndex: function(i) {
		if (this.getContainer() != this.getWindowDOM())
			this.getContainer().style.zIndex = i;
		this.zIndex = i;
	},
	setNologValue: function(nolog) {
		this.nologValue = !!nolog;
	},
	on: function(name, func) {
		if (this.FORWARD_EVENTS[name])
			this.forward(name, this.window, func);
		else
			GwtObservable.prototype.on.call(this, name, func);
			
		if (name == "dblclick") {
    		if (isMSIE)
			  this.window.style.cursor = "hand";
			else
			  this.window.style.cursor = "pointer";
		}
	},
	
	_bodyRendered: function(request) {
	    var xml = request.responseXML;
		var uid = xml.documentElement.getAttribute("sysparm_name");
		var newBody = xml.getElementsByTagName("html")[0];
		if (!this.body)
			return;
		if (newBody.xml) {
			xml = newBody.xml;
		} else if (window.XMLSerializer) {
			xml = (new XMLSerializer()).serializeToString(newBody);
		}
		if (!xml) 
		  return;
		  
		this.setEscapedBody(xml);
		this._evalScripts(xml);
		this.fireEvent("bodyrendered", this);
		_frameChanged();
	},
	_centerOnScreen: function(width, height) {
		var bounds = this.getAbsoluteRect();
		var viewport = new WindowSize();
		var w = viewport.width;
		var h = viewport.height;
		var windowWidth = (width? width : bounds.width);
		var windowHeight = (height? height: bounds.height);
		var scrollX = getScrollX();
		if (typeof scrollX == "undefined")
			scrollX = 0;
		var scrollY = this._getScrollTop();
		
var leftX = parseInt((w / 2) - (windowWidth / 2)) + scrollX;
var topY = parseInt((h / 2) - (windowHeight / 2)) + scrollY;
		var topWindow = getTopWindow();
		var browserHeight = topWindow.innerHeight || topWindow.document.documentElement.clientHeight || topWindow.document.body.clientHeight;
		var topWindowBody = $(topWindow.document.body);
		if (topWindowBody && topWindowBody.select && topWindowBody.select('table.navpage').length == 0) {
			var currentIframe = this._findCurrentIframe(window);
			if (currentIframe && currentIframe.getBoundingClientRect) {
				var rectTop = parseInt(currentIframe.getBoundingClientRect().top);
				var d = h + rectTop;
				topY = scrollY;
				if (rectTop < 0) {
					if (d > browserHeight)
topY += parseInt((browserHeight - windowHeight) / 2) - rectTop;
					else
topY += parseInt((d - windowHeight) / 2) - rectTop;
				} else {
					if (d > browserHeight)
topY += parseInt((browserHeight - rectTop - windowHeight) / 2);
					else {
topY += parseInt((h - windowHeight) / 2);
						if (scrollY == 0 && (isMSIE6 || isMSIE7 || isMSIE8))
							topY += window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
					}
				}
			} else {
				if (this.container) {
					var containerParentHeight = this.container.parentNode.scrollHeight;
					if (containerParentHeight < browserHeight)
topY = parseInt((containerParentHeight - windowHeight) / 2);
					else {
						if (scrollY == 0 && (isMSIE6 || isMSIE7 || isMSIE8))
							topY += topWindow.pageYOffset || topWindow.document.documentElement.scrollTop || topWindow.document.body.scrollTop;							
					}
				}
			}
		}
		
		if (topY < 0)
			topY = 0;
			
		if (leftX < 0)
			leftX = 0;
		
		if (this.container) {
			var headerSpacer = $(this.container.parentNode).select(".section_header_spacer");
			if (headerSpacer.length > 0) {
				headerSpacer = headerSpacer[0];
				if (topY < headerSpacer.offsetHeight)
					topY = headerSpacer.offsetHeight;
			}
		}
			
		this.moveTo(leftX, topY);
	},
	_findCurrentIframe: function(win) {
		try {
			if (win && win.parent) {
				var e = win.parent.document.getElementsByTagName('iframe');
				for (var i =0; i < e.length; i++) {
					if (e[i].contentWindow == win)
						return e[i];
				}
			}
		} catch(e) {}
		
		return null;
	},
	
	_getScrollTop: function() {
		if (this.container.parentNode != document.body)
			return this.container.parentNode.scrollTop;
			
		return getScrollY();
	},
	_draw: function(id) {
		var e;
		if (this.divMode) {
			e = cel("DIV");
			e.style.overflow = "hidden";
			e.appendChild(this._drawTitle(id));
			e.appendChild(this._drawBody(id));
		} else {
			e = cel("TABLE");
			e.setAttribute('role', 'presentation');
			var dragTableBody = cel("TBODY");
			dragTableBody.appendChild(this._drawTitle(id));
			dragTableBody.appendChild(this._drawBody(id));
			e.appendChild(dragTableBody);
		}
		
		e.id = "window." + id;
		this.window = e;
		this.window.className = this.windowClass;
		this.window.gWindow = this;
	},
	_drawTitle: function(id) {
		if (!this.divMode) { 
			var baseTR = cel("TR");
			baseTR.style.verticalAlign = "top";
			var baseTD = cel("TD");
		}
	
		var dragTableHeader = cel("TABLE");
		var dragTableHeaderBody = cel("TBODY");
		dragTableHeader.className = "drag_section_header";
		dragTableHeader.setAttribute('role', 'presentation');
		dragTableHeader.style.width = "100%";
		this.header = dragTableHeader;
		var dragTableHeaderTR = cel("TR");
		
		var leftDecorations = cel("TD");
		leftDecorations.style.display = "none";
		leftDecorations.style.top = "0px";
		leftDecorations.style.left = "0px";
		leftDecorations.style.verticalAlign = "top";	
		leftDecorations.style.whiteSpace = "nowrap";
		this.leftDecorations = leftDecorations;
		dragTableHeaderTR.appendChild(leftDecorations);
		var dragTableHeaderTD = cel("TD");
		dragTableHeaderTD.className = "drag_section_movearea";
		dragTableHeaderTD.style.verticalAlign = "top";
		dragTableHeaderTD.id = id + "_header";
		this.title = dragTableHeaderTD;
		dragTableHeaderTR.appendChild(dragTableHeaderTD);
		var titleContents = cel("h1");
		titleContents.id = id + "_header_contents";
		if (id == 'GwtDateTimePicker')
			titleContents.setAttribute('role', 'presentation')
		this.titleContents = titleContents;
		dragTableHeaderTD.appendChild(titleContents);
		var headerDebugTD = cel("TD");
		headerDebugTD.className = "drag_section_debug";
		headerDebugTD.id = id + "_debug";
		this.debugTD = headerDebugTD;
		dragTableHeaderTR.appendChild(headerDebugTD);
		
		var rightDecorations = cel("TD");
		rightDecorations.style.top = "0px";
		rightDecorations.style.right = "0px";
		rightDecorations.style.verticalAlign = "top";	
		rightDecorations.style.whiteSpace = "nowrap";	
		rightDecorations.style.textAlign = "right";	
		this.rightDecorations = rightDecorations;
		dragTableHeaderTR.appendChild(rightDecorations);
		
		dragTableHeaderBody.appendChild(dragTableHeaderTR);
		dragTableHeader.appendChild(dragTableHeaderBody);
		
		if (!this.divMode) {
			baseTD.appendChild(dragTableHeader);
			baseTR.appendChild(baseTD);
		}
		
		dragTableHeaderTD = null;
		dragTableHeaderTR = null;
		dragTableHeaderBody = null;
		dragTableHeader = null;
		leftDecorations = null;
		rightDecorations = null;
		
		if (!this.divMode)
			return baseTR;
		else		
			return this.header;
	},
	
	_drawBody: function(id) {
		var e;
		if (this.divMode) {
			e = cel("DIV");
			this.body = e;
		} else {
			e = cel("TR");
			e.style.height = "100%";
			e.style.verticalAlign = "top";
			var dragTableTD = cel("TD");
			this.body = cel("SPAN");
			dragTableTD.appendChild(this.body);
			e.appendChild(dragTableTD);
		}
		
		this.body.id = "body_" + id;
		this.body.className = "widget_body";
		this.body.style.overflow = "auto";
		this.body.innerHTML = this.DEFAULT_BODY;
		this.body.gWindow = this;
		return e;
	},
	
	_drawIndicator: function(classNames,id,altText) {
		
			var dragTableTD = cel("TD");
		dragTableTD.className = 'widget-indicator';
		dragTableTD.style.display = 'none';
		
		this.filterIndicator = cel("SPAN");
		this.filterIndicator.className = classNames;
		
		if (altText)
			this.filterIndicator.title = getMessage(altText);
		
		dragTableTD.id = id;
		dragTableTD.gWindow = this;
		dragTableTD.appendChild(this.filterIndicator);
		
		return dragTableTD;
	},
	_toggleIndicator : function (indicator){
		var $parentEl;
		var preference;
		
		if (indicator === 'real-time')
			preference = 'real_time';
		if (indicator === 'filter')		
			preference = 'filter_indicator';
		
		$parentEl = $(indicator+'-indicator-'+this.id);
		if ($parentEl) {
			if (this.preferences[preference] === 'true')
				$parentEl.addClassName('active');
			else
				$parentEl.removeClassName('active');
		}
	},
	_enableDragging: function(element) {
		var id = element.getAttribute("dragpart");
		if (!id || this.isReadOnly() || this.getPreference('pinned'))
			return;
			
		var titlebar = gel(id + "_header");
		
		this.gd = new GwtDraggable(titlebar, element);
		if (typeof this.dragStart == "function")
			this.gd.setStart(this.dragStart.bind(this));
		if (typeof this.dragEnd == "function")
			this.gd.setEnd(this.dragEnd.bind(this));
		if (typeof this.dragging == "function")
			this.gd.setDrag(this.dragging.bind(this));
			
		titlebar = null;
	},
	_evalScripts: function(html) {
		
		
		html = this._substituteGet(html);
		
var x = loadXML("<xml>" + html + "</xml>");
		if (x) {
			var scripts = x.getElementsByTagName("script");
		    for(var i = 0; i < scripts.length; i++)	{
		        var script = scripts[i];
				var s = "";
				
if (script.getAttribute("type") == "application/xml")
					continue;
if (script.getAttribute("type") == "text/ng-template")
					continue;
				
				if (script.getAttribute("src")) {
					var url = script.getAttribute("src");
					var req = serverRequestWait(url);
					s = req.responseText;
				} else {
			        s = getTextValue(script);
			        if (!s)
			        	s = script.innerHTML;
		        }
				
				if (s)
					evalScript(s, true);
		     }
		}
		if (!window.G_vmlCanvasManager)
			return;
		
		window.G_vmlCanvasManager.init_(document)
	},
	_fixBrowserTags: function(html) {
	    if (!html)
	      return html;
		 
	    var tags = [ "script", "a ", "div", "span", "select", "button", "i" ];
	    
	    for(var i = 0; i < tags.length; i++) {
	    	var tag = tags[i];
html = html.replace(new RegExp('<' + tag + '([^>]*?)/>', 'img'), '<' + tag + '$1></' + tag + '>');
	    }
	    
		return html;
	},
	
	_onCloseClicked: function() {
		if (!this.fireEvent("closeconfirm", this))
			return false;
		if (this.window){
			var gWindow = $(this.window.gWindow);
			if (gWindow)
				gWindow.destroy();
		}
	},
	
	_setShimBounds: function(x, y, w, h) {
		if (x !== "")
			this.cacheX = parseInt(x);
		if (y !== "")
			this.cacheY = parseInt(y);
		if (w != "" && !isNaN(w))
			this.cacheWidth = parseInt(w);
		if (h != "" && !isNaN(h))
			this.cacheHeight = parseInt(h);
		
		if (!this.shim)
			return;
			
		if (x !== "")
			this.shim.style.left = x + 'px';
		if (y !== "")
			this.shim.style.top = y + 'px';
		
		if (w != "") {
			if (!isNaN(w))
			this.shim.style.width = w + 'px';
			else
				this.shim.style.width = w;
		}
		if (h != "") {
			if (!isNaN(h))
			this.shim.style.height = h + 'px';
			else
				this.shim.style.height = h;
		}
	},
	_shimResize: function() {
		if (!this.shim)
			return;
			
		var bounds = this.getAbsoluteRect();
		this._setShimBounds(bounds.left, bounds.top, bounds.width, bounds.height);
	},
	_substituteGet: function(html) {
		if (!html)
			return html;
			
		var substitutions = [this.type(), 'GlideDialogWindow', 'GlideDialogForm'];
		for (var i = 0; i < substitutions.length; i++) {
			var reg = new RegExp(substitutions[i] + ".get\\(", "g");
			html = html.replace(reg, this.type() + ".prototype.get('" + this.getID() + "'");
		}
		return html;
	},
	getLowerSpacing : function() {
		return "6px";
	},
	
	type : function() {
		return "GlideWindow";
	},
	addClass: function(className) {
		var domEl = this.getWindowDOM();
		if (domEl) {
			var classes = domEl.className;
			if (classes.indexOf(className) < 0) {
				domEl.className += " " + className;
			}
		}
	},
	removeClass: function(className) {
		var domEl = this.getWindowDOM();
		if (domEl) {
			var classes = domEl.className;
			domEl.className = classes.replace(className, "");
		}
	},
	
	setScope: function(scope) {
		if(scope) {
			this.setPreference('sysparm_scope', scope);			
		}
		return this;
	}
});
;
/*! RESOURCE: /scripts/classes/GlideDialogWindow.js */
var GlideDialogWindow = Class.create(GlideWindow, {
	BACKGROUND_COLOR: "#DDDDDD",
	DEFAULT_RENDERER: "RenderForm",
	WINDOW_INVISIBLE: 1,
ZINDEX: 1050,
	
	initialize: function(id, readOnly, width, height) {
		GlideWindow.prototype.initialize.call(this, id, readOnly);
        if (width) {
           this.setSize(width, height);
           this.adjustBodySize();
        }
		this.grayBackground = null;
		this.setTitle("Dialog");
    	this.setDialog(id);
		this.parentElement = getFormContentParent();
    	this.insert(this.parentElement);
    	this._initDefaults();
    	this.setShim(true);
		this.focusTrap = null;
	},
	destroy: function() {
		var self = this;
		this.disableFocusTrap();
		window.setTimeout(function(){
			Event.stopObserving(self.getWindowDOM(), 'resize', self.resizeFunc);
			self._hideBackground();
			self.parentElement = null;
			GlideWindow.prototype.destroy.call(self);
			if (isMSIE10 || isMSIE11)
				document.body.focus();
		}, 0);
	},
	insert: function(element) {
		this.setZIndex(this._determineZIndex());
		this._showBackground();
		GlideWindow.prototype.insert.call(this, element, '', this.WINDOW_INVISIBLE);
		this.container.setAttribute('role', 'dialog');
		this.container.setAttribute('tabindex', -1);
		this.onResize();
		this.visible();
	},
	enableFocusTrap : function () {
		if (window.focusTrap && this.container)
			this.focusTrap = window.focusTrap(this.container, {escapeDeactivates: false});
		if (this.focusTrap)
			this.focusTrap.activate();
	},
	disableFocusTrap : function () {
		if (!this.focusTrap)
			return;
		this.focusTrap.deactivate({returnFocus: true});
		this.focusTrap = null;
	},
	setBody: function(html, noEvaluate, setAlt) {
		GlideWindow.prototype.setBody.call(this, html, noEvaluate, setAlt);
		if (typeof this.elementToFocus != 'undefined' && !this.elementToFocus) {
		    self.focus();
            this.getWindowDOM().focus();
		}
		if (this.getPreference('focusTrap'))
			this.enableFocusTrap();
		this.onResize();
	},
	
	setDialog: function(dialogName) {
		this.setPreference('table', dialogName);
	},
	setAriaLabel: function(label) {
		if (this.container) {
			this.container.setAttribute('aria-label', label);
		}
	},
	setAriaLabelledBy: function(labelId) {
		if (this.container) {
			this.container.setAttribute('aria-labelledby', labelId);
		}
	},
    onResize: function() {
	  this._centerOnScreen();	
	},
	
	_eventKeyUp: function(e) {
		e = getEvent(e);
		
		if (e.keyCode == 27)
			this.destroy();
	},
	
	hideBackground: function() {
		return this._hideBackground();
	},
	
	_hideBackground: function() {
		if (this.grayBackground)
			this.parentElement.removeChild(this.grayBackground);
			
		this.grayBackground = null;
	},
	_initDefaults: function() {
    	this.setPreference('renderer', this.DEFAULT_RENDERER);
		this.setPreference('type', 'direct');
		
		if (!this.isReadOnly())
			Event.observe(this.getWindowDOM(), 'keyup', this._eventKeyUp.bind(this));
		
		this.resizeFunc = this.onResize.bind(this);
		Event.observe(this.getWindowDOM(), 'resize', this.resizeFunc);
	},
	_showBackground: function() {		
		var parent = document.viewport;
		if (document.compatMode == 'BackCompat' && this.parentElement != document.body)
			parent = this.parentElement;
		
		if (!gel('grayBackground')) {
			var gb = cel("div");
			gb.id = gb.name = "grayBackground";
			gb.style.top = gb.style.left = 0;
			gb.style.width = "100%";
			var hgt = this._getOverlayHeight();
			gb.style.height =  hgt + "px";
		    gb.style.position = "absolute";
			gb.style.display = "block";
			gb.style.zIndex = this.ZINDEX - 1;
			gb.style.zIndex = this.getZIndex() - 1;
			gb.style.backgroundColor = this.BACKGROUND_COLOR;
			gb.style.opacity = 0.33;
			gb.style.filter = "alpha(opacity=33)";
			this.parentElement.appendChild(gb);			
			this.grayBackground = gb;
		}
	},
	
	_getOverlayHeight: function() {
		var elements = $$('body > div.section_header_content_no_scroll'); 
	    if (elements && elements.length > 0)
	    	return elements[0].scrollHeight;
	    elements = $$('body div.form_document');
	    if (elements && elements.length > 0) 
	        return elements[0].scrollHeight;
	    
	    if (document.body.scrollHeight)
	        return document.body.scrollHeight;
	    return document.body.offsetHeight;
	},
	_determineZIndex: function() {
		if (!window.$j)
			return this.ZINDEX;
		var zIndex = this.ZINDEX;
		$j('.modal:visible').each(function(index, el) {
			var elZindex = $j(el).css("z-index");
			if (elZindex >= zIndex)
				zIndex = elZindex + 2;
		})
		return zIndex;
	},
	type : function() {
		return "GlideDialogWindow";
	}
});
;
/*! RESOURCE: /scripts/classes/GlideDialogForm.js */
var GlideDialogForm = Class.create(GlideDialogWindow, {
	REFRESH_ID: "refresh_frame",
	CALLBACK_TARGET_FIELD: "glide_dialog_form_target",
	DIALOG_FORM: "glide_dialog_form",
	DELETE_FROM_CONF_DLG: "delete_from_confirm_dialog_ui_page",
	ZINDEX: 1001,
	
	initialize: function(title, tableName, onCompletionCallback, readOnly) {
        this.parms = {};
        this.fieldIDSet = false;
		this.positionSet = false;
		this.dialogWidth = "";
		this.dialogHeight = "";
		this.additionalWidth = 17;
		this.additionalHeight = 17;
		this.centerOnResize = true;
				
		GlideDialogWindow.prototype.initialize.call(this, "FormDialog", readOnly);
		if (title) 
			this.setTitle(title);
			
        this.setPreference('renderer', 'RenderForm');
        this.setPreference('table', this.DIALOG_FORM);
this.setPreference('sysparm_nameofstack', 'formDialog');
        this.on("bodyrendered", this._onLoaded.bind(this));
        this.tableName = tableName;
        
        if (onCompletionCallback)
        	this.setCompletionCallback(onCompletionCallback);
	},
	
	destroy: function() {
		this.un("bodyrendered");
		
		if (this.callbackField) {
            this.callbackField.onchange = null;
    		rel(this.CALLBACK_TARGET_FIELD + "_" + this.tableName);
		}
	
	    if (this.refreshField) {
			this.refreshField.onchange = null; 
			rel(this.REFRESH_ID);
		}	
			
		GlideDialogWindow.prototype.destroy.call(this);
		this.fireEvent("dialogclosed");
	},
	
	_onLoaded: function() {
		if (this.tableName && (this.tableName.includes('.') || this.tableName.includes(':')))
			return;
		var f = gel("dialog_form_poster");
		f.action = this.tableName + '.do';
		addHidden(f, 'sysparm_nameofstack', 'formDialog');
		addHidden(f, 'sysparm_titleless', 'true');
		addHidden(f, 'sysparm_is_dialog_form', 'true');
		var sysId = this.getPreference('sys_id');
		if (!sysId)
			sysId = '';
		var targetField = '';
		if (this.fieldIDSet)
			targetField = this.getPreference('sysparm_target_field');
			
		addHidden(f, 'sys_id', sysId);
		addHidden(f, 'sysparm_sys_id', sysId);
		addHidden(f, 'sysparm_goto_url', this.DIALOG_FORM + '.do?sysparm_pass2=true&sysparm_skipmsgs=true&sysparm_nameofstack=formDialog&sysparm_returned_sysid=$action:$sys_id:$display_value&sysparm_target_field=' + targetField);
        this.isLoaded = true; 
		for (id in this.parms)
			addHidden(f, id, this.parms[id]);
		f.submit();
	},
	
	setLoadCallback: function(func) {
		this.loadCallback = func;
	},
	setX: function(x) {
		this.x = x;
		this.positionSet = true;
	},
	
	setY: function(y) {
		this.y = y;
		this.positionSet = true;
	},
	
	onResize: function() {
		this._centerOrPosition();
	},
	
	setDialogTitle: function(title) {
	    this.setTitle(title);
	},
	
	setSysID: function(id) {
		this.setPreference('sys_id', id);
	},
	
	setFieldID: function(fid) {
		this.fieldIDSet = true;
        this.setPreference('sysparm_target_field', fid);
	},
	
	setType: function(type) {
		this.setPreference('type', type);
	},
	
	setMultiple: function(form) {
		this.setPreference('sys_id', '-2');
		this.addParm('sysparm_multiple_update', 'true');
		this.addParm('sys_action', 'sysverb_multiple_update')
		this.form = form;
	},
	
	setDialogSize: function(w, h) {
		this.setDialogWidth(w);
		this.setDialogHeight(h);
	},
	
	setDialogWidth: function(w) {
		this.dialogWidth = w;
	},
	
	setDialogHeight: function(h) {
		this.dialogHeight = h;
	},
	
	setDialogHeightMax: function(h) {
		this.dialogHeightMax = h;
	},
	
	setCenterOnResize: function(flag) {
		this.centerOnResize = flag;
	},
	
	addParm: function(parm, value) {
		this.parms[parm] = value;
	},
	
	render: function() {
		if (this.fieldIDSet == false)
			this.setRefresh();
			
		GlideDialogWindow.prototype.render.call(this);
	},
	
	setRefresh: function() {
		var r = gel(this.REFRESH_ID)
		if (r == null)
			this.initRefresh();
			
        this.setFieldID(this.REFRESH_ID);
	},
	
	setForm: function(form) {
		this.form = form
	},
	
	initRefresh: function() {
        this.refreshField = cel("input");
        this.refreshField.type = "hidden";
        this.refreshField.id = this.REFRESH_ID;
        this.refreshField.onchange = this.doRefresh.bind(this);
        document.body.appendChild(this.refreshField);
        return this.refreshField;
	},
	
	doRefresh: function() {
		var search = self.location.href;
		if (search.indexOf("sysparm_refresh") == -1) {
		    if (search.indexOf("?") == -1)
			   search += "?";
			else
			   search += "&";
			
			search += "sysparm_refresh=refresh";
		}
		self.location.href = search;
	},
	
	setCompletionCallback: function(func) {
		this.onCompletionFunc = func;
        this.callbackField = cel("input");
        this.callbackField.type = "hidden";
        this.callbackField.id = this.CALLBACK_TARGET_FIELD + "_" + this.tableName;
        this.callbackField.onchange = this._completionCallback.bind(this);
        document.body.appendChild(this.callbackField);
        this.setFieldID(this.callbackField.id);
	},
	
	frameLoaded: function() {
		this._hideLoading();		
		
		if (!this.isLoaded)
		  return;
		  
    	this._resizeDialog();
		if (this.loadCallback)
			this.loadCallback(this._getIframeDocument());
	},
	_centerOrPosition: function() {
		if (!this.positionSet) {
			this._centerOnScreen();
			return; 
		}
		
		this.moveTo(this.x, this.y);
	},
		
	_completionCallback: function() {
		var e = gel(this.CALLBACK_TARGET_FIELD + "_" + this.tableName);
		if (e) {
			var sysId;
			var action;
			var displayValue;
			var info = e.value.split(":");
			
			var action = info[0];
			if (info.length > 1)
				sysId = info[1];
			
			if (info.length > 2) {
					displayValue = info[2].unescapeHTML();
			}
					
			this.onCompletionFunc(info[0], info[1], this.tableName, displayValue);
		}
	},
	_resizeDialog: function() {
		var doc = this._getIframeDocument();
		if (!doc)
			return;
		
		var scrollable = this._getScrollable(doc.body);
		
		if (!this.dialogWidth)
			this.dialogWidth = scrollable.scrollWidth + this.additionalWidth;
		if (!this.dialogHeight)
			this.dialogHeight = scrollable.scrollHeight + this.additionalHeight;
		if (this.dialogHeightMax)
			this.dialogHeight = Math.min(this.dialogHeightMax, this.dialogHeight);
		var e = gel('dialog_frame');
		e.style.height = this.dialogHeight + "px";
	    e.style.width = this.dialogWidth + "px";
	    
		this._centerOrPosition();
	},
	
	_getScrollable: function(body) {
		var elements = $(body).select('.section_header_content_no_scroll');
		if (elements && elements.length > 0 ) {
			return elements[0];
		}
		
		return body;
	},
	_hideLoading: function() {
	    var l = gel('loadingSpan');
	    if (l)
	        l.style.display = 'none';
	},
	
	_getIframeDocument: function() {
		var e = gel('dialog_frame');
		if (e) 
			if (e.contentDocument)
				return e.contentDocument;
        return document.frames['dialog_frame'].document;
	},
	type : function() {
		return "GlideDialogForm";
	}
});
function closeDialogForm(id) {
	var w = parent.	gel('window.FormDialog');
	if (w) {
		w.gWindow.destroy();
		return;
	}
	if (!id)
		return;
	w = parent.$j('#' + id).data('gWindow');
	if (w)
		w.destroy();
}
;
/*! RESOURCE: /scripts/classes/GlidePaneForm.js */
var GlidePaneForm = Class.create(GlideDialogForm, {
WINDOW_BORDER: 2,
INSET_SPACING : 20,
	DIALOG_FORM: "glide_pane_form",
	initialize: function(title, tableName, element, onCompletionCallback) {
		this.divMode = true;
		GlideDialogForm.prototype.initialize.call(this, title, tableName, onCompletionCallback, true);
		this.setClassName("glide_pane");
		this.setHeaderClassName("glide_pane_header");
		this.setColor("white");
		this.paneSize = this._getPaneSize();
		this.setSize(this.paneSize.width, this.paneSize.height);
		this.adjustBodySize();
		this.moveTo(this.paneSize.left, this.paneSize.top);
		this._createCloseButton();
		this.getBody().style.overflow = "hidden";
	},
	onResize: function() {
		return;
	},
	
	_getPaneSize: function(e) {
		var o = new WindowSize();
		var paneSize = {};
		paneSize.height = o.height - ((this.WINDOW_BORDER + this.INSET_SPACING) * 2);
		paneSize.width = o.width - ((this.WINDOW_BORDER + this.INSET_SPACING) * 2);
		if (paneSize.height < this.INSET_SPACING) {
			paneSize.height = o.height;
			paneSize.top = 0;
		} else {
			paneSize.top = this.INSET_SPACING + document.body.scrollTop; 
		}
		
		if (paneSize.width < 0) {
			paneSize.width = o.width;
			paneSize.left = 0;
		} else {
			paneSize.left = this.INSET_SPACING + document.body.scrollLeft; 
		}
		
		paneSize.headerHeight = this.getHeader().clientHeight;
		return paneSize;
	},
	_createCloseButton: function() {
		var img = cel("img");
img.src = "images/x.gifx";
		img.alt = getMessage("Close");
		img.style.height = "12px";
		img.style.width = "13px";
		img.style.cursor = 'pointer';
		img.setAttribute("tabindex", "0");
		img.setAttribute("role", "button");
		img.setAttribute("aria-label", getMessage("Close"));
		var destroy = this.destroy.bind(this);
		Event.observe(img, "click", destroy);
		Event.observe(img, "keypress", function(event) {
			var keyCode = event.which || event.keyCode;
			if (keyCode === $j.ui.keyCode.SPACE)
				destroy();
		});
		this.addDecoration(img);
	},
	_resizeDialog: function() {
		var h = this.paneSize.height - this.paneSize.headerHeight;
		var w =  this.paneSize.width;
   		if (isMSIE) {
			h -= (this.WINDOW_BORDER * 2);
			w -= (this.WINDOW_BORDER * 2);
		}
   		var e = $('dialog_frame');
		e.style.height = h + "px";
		e.style.width = w + "px";
	},
		
	type : function() {
		return "GlidePaneForm";
	}
});
;
/*! RESOURCE: /scripts/classes/GlidePane.js */
var GlidePane = Class.create(GlidePaneForm, {
	DIALOG_FORM: "glide_pane",
	initialize: function(title, tableName, element, onCompletionCallback) {
		GlidePaneForm.prototype.initialize.call(this, title, tableName, element, onCompletionCallback);
	},
	
	_onLoaded: function() {
		var f = gel("dialog_form_poster");
		f.action = this.tableName + '.do';
		addHidden(f, 'sysparm_clear_stack', 'true');
		addHidden(f, 'sysparm_nameofstack', 'formDialog');
		addHidden(f, 'sysparm_titleless', 'true');
		addHidden(f, 'sysparm_is_dialog_form', 'true');
		var sysId = this.getPreference('sys_id');
		if (!sysId)
			sysId = '';
		addHidden(f, 'sys_id', sysId);
		addHidden(f, 'sysparm_sys_id', sysId);
        this.isLoaded = true; 
		for (id in this.parms)
			addHidden(f, id, this.parms[id]);
		f.submit();
	},
	
	
	type : function() {
		return "GlidePane";
	}
});
;
/*! RESOURCE: /scripts/classes/GwtDraggable.js */
var GwtDraggable = Class.create(GwtObservable, {
	
    initialize : function(header, itemDragged) {
    	this.header = $(header);
		if (!itemDragged)
			itemDragged = this.header;
			
		this.parentElement = getFormContentParent();
    	this.setDraggable($(itemDragged));
		this.setCursor("move");
    	this.setStart(this.genericStart.bind(this));
    	this.setDrag(this.genericDrag.bind(this));
    	this.setEnd(this.genericEnd.bind(this));
		this.scroll = false;
		this.differenceX = 0;
		this.differenceY = 0;
		this.shiftKey = false;
		this.fDrag = this.drag.bind(this);
		this.fEnd = this.end.bind(this);
		
		this.enable();
    },
    
    enable: function() {
		this.header.onmousedown = this.start.bind(this);
		this.header.ontouchstart = this.start.bind(this);
    },
    
    disable: function() {
    	this.header.onmousedown = null;
		this.header.ontouchstart = null;
    },
    start: function(e) {
        e = getRealEvent(e);
        
        var ex, ey;
		if (e.type == 'touchstart') {
			ex = e.touches[0].pageX;
			ey = e.touches[0].pageY;
		} else {
			ex = e.clientX;
			ey = e.clientY;
		}
		if (this.getScroll()) {
			ex += getScrollX();
			ey += getScrollY();
		}
		this.differenceX = ex - grabOffsetLeft(this.draggable) + grabScrollLeft(this.draggable);
		this.differenceY = ey - grabOffsetTop(this.draggable) + grabScrollTop(this.draggable);
		this.shiftKey = e.shiftKey;
		Event.observe(this.parentElement, "mousemove", this.fDrag);
		Event.observe(this.parentElement, "mouseup", this.fEnd);
		Event.observe(this.parentElement, "touchmove", this.fDrag);
		Event.observe(this.parentElement, "touchend", this.fEnd);
		
		this.active = false;
		this._stopSelection(e);
		this.draggable.dragging_active = true;
        var ret = this.onDragStart(this, ex, ey, e);
        this.fireEvent("beforedrag", this, ex, ey, e);
        return ret;
    },
    destroy: function() {
		if (this.header) {
    		this.header.onmousedown = null;
    		this.header.ontouchstart = null;
		}
		
    	this.header = null;
    	this.draggable = null;
    	this.parentElement = null;
    },
	drag : function(e) {
		if (!this.active) {
			createPageShim(this.parentElement);
			this.active = true;
		}
		
		this._stopSelection(e);
		e = getRealEvent(e);
		
		var ex, ey;
		if (e.type == 'touchmove') {
			ex = e.touches[0].pageX;
			ey = e.touches[0].pageY;
		} else {
			ex = e.clientX;
			ey = e.clientY;
		}
		if (this.getScroll()) {
			ex += getScrollX();
			ey += getScrollY();
		}
		var posX = parseInt(ex - this.differenceX);
		var posY = parseInt(ey - this.differenceY);
		var ret = this.onDrag(this, posX, posY, e);
		this.fireEvent("dragging", this, posX, posY, e);
		return ret;
	},
	end : function(e) {
		e = getRealEvent(e);
		Event.stopObserving(this.parentElement, "mousemove", this.fDrag);
		Event.stopObserving(this.parentElement, "mouseup", this.fEnd);
		
		Event.stopObserving(this.parentElement, "touchmove", this.fDrag);
		Event.stopObserving(this.parentElement, "touchend", this.fEnd);
		this.shiftKey = e.shiftKey;
		removePageShim(this.parentElement);
		this._restoreSelection();
		this.draggable.dragging_active = false;
		var ret = this.onDragEnd(this, e);
		if (!this.active)
			return;
			
		this.active = false;
		this.fireEvent("dragged", this, e);
		this.resetDraggable();
		return ret;
	},
	getDraggable: function() {
		return this.draggable;
	},
	getYDifference: function() {
		return this.differenceY;
	},
	getXDifference: function() {
		return this.differenceX;
	},
	getScroll: function() {
		return this.scroll;
	},
	setDraggable: function(e) {
		this.draggable = e;
	},
	setStart: function(f) {
        this.onDragStart = f;
	},
	setDrag: function(f) {
		this.onDrag = f;
	},
	setEnd: function(f) {
		this.onDragEnd = f;
	},
	setCursor: function(c) {
		if (this.header.style) {
    		this.header.style.cursor = c;
		}
	},
	setScroll: function(s) {
		this.scroll = s;
	},
	saveAndSetDraggable: function(e) {
		this.origDraggable = this.draggable;
		this.setDraggable(e);
	},
	
	resetDraggable: function() {
		if (this.origDraggable) {
			this.draggable = this.origDraggable;
			this.origDraggable = null;
		}
	},
	
	genericStart: function(x, y) {
		return true;
	},
	genericEnd: function() {
		return true;
	},
	genericDrag: function(me, x, y) {
		me.draggable.style.left = x;
		me.draggable.style.top = y;
		return true;
	},
	_stopSelection: function(ev) {
		stopSelection(this.parentElement);
		if (ie5) {
			ev.cancelBubble = true;
			ev.returnValue = false;
		} else {
			if (typeof ev.preventDefault != 'undefined')
				ev.preventDefault();
			
			if (typeof ev.stopPropagation != 'undefined')
				ev.stopPropagation();
		}
	},
	_restoreSelection: function() {
		if (this.parentElement)
			restoreSelection(this.parentElement);
	},
    z: function() {
    }
});
function createPageShim(parentElement) {
	if (!parentElement)
		return;
	var w = (parentElement.scrollWidth? parentElement.scrollWidth : parentElement.clientWidth);
	var h = (parentElement.scrollHeight? parentElement.scrollHeight : parentElement.clientHeight);
	var pageShim = cel("div");
	pageShim.id = pageShim.name = "pageshim";
	pageShim.style.top = 0;
	pageShim.style.left = 0;
	pageShim.style.width = w + "px";
	pageShim.style.height = h + "px";
	pageShim.style.position = "absolute";
	pageShim.style.display = "block";
	pageShim.style.zIndex = "500";
	pageShim.style.backgroundColor = "red";
	pageShim.style.opacity=0;
	pageShim.style.filter="alpha(opacity=0)";
	parentElement.appendChild(pageShim);
}
function removePageShim(parentElement) {
	var pageShim = gel("pageshim");
	if (pageShim)
		parentElement.removeChild(pageShim);
}
;
/*! RESOURCE: /scripts/classes/ui/GlideDraggable.js */
var GlideDraggable = Class.create({
	
	V_SCROLL_REFRESH_FREQ_MS: 70,
	H_SCROLL_REFRESH_FREQ_MS: 50,
	IGNORED_DRAG_ELEMENTS: ['A', 'BUTTON', 'INPUT'],
		
    initialize: function(hoverElem, dragElem) {
    	this.setHoverElem(hoverElem);	 	
		if (this.hoverElem == null)
			return;
		
		this.setDragElm(dragElem || this.hoverElem);
		this.boundElem = document.body;
		this.setDragFunction(this.genericDrag);
		this.onScroll = {};
		this.allowedClasses = [];
	},
	
	destroy: function() {
		this.reset();
		
		this.hoverElem = null;
		this.dragElem = null;
		this.boundElem = null;
		
		this.onStart = null;
		this.onDrag = null;
		this.onScroll = null;
		this.onEnd = null;
	},
	
	reset: function() {
		clearInterval(this.leftScrollId);
		clearInterval(this.rightScrollId);
		clearInterval(this.topScrollId);
		clearInterval(this.bottomScrollId);
		this.leftScrollId = null;
		this.rightScrollId = null;
		this.topScrollId = null;
		this.bottomScrollId = null;
		
		delete this._origDragElmCoords;
		delete this._origPageCoords;
		delete this._shift;
		delete this._pageCoords;
		delete this._dragElmCoords;
	},
	
	genericDrag: function(e, dragElem, pageCoords, shift, dragCoords) {
		dragElem.style.left = dragCoords.x + 'px';
		dragElem.style.top = dragCoords.y + 'px';
	},
	
	
	setHoverCursor: function(c) {
		this.hoverCursor = c;
		this.hoverElem.style.cursor = c;
	},
	
	setHoverElem: function(obj) {
		this.hoverElem = $(obj);
		if (this.hoverElem) {
this.hoverElem.style.MozUserSelect = '-moz-none';
this.hoverElem.onselectstart = function() { return false; };
		}
	},
	
	getHoverElem: function() {
		return this.hoverElem;
	},
	
	setDragCursor: function(c) {
		this.dragCursor = c;
		if (this.pageShim)
			this.pageShim.style.cursor = this.dragCursor;
	},
	
	setDragElm: function(obj) {
		this.dragElem = $(obj);
this.dragElem.style.MozUserSelect = '-moz-none';
	},
	
	setStartFunction: function(f) {
		if (this._fDraggableStart)
			document.stopObserving('mousedown', this._fDraggableStart);
		
		this._fDraggableStart = this._draggableStart.bind(this);
		this.hoverElem.observe('mousedown', this._fDraggableStart);
		this.onStart = f;
	},
	
	setDragFunction: function(f) {
		this.onDrag = f;	
	},
	
	setEndFunction: function(f) {
		this.onEnd = f;
	},
	
	setAutoScrollLeft: function(f, x) {
		this.onScroll.LEFT = f;
this.onScroll.LEFTX = x;
	},
	
	setAutoScrollRight: function(f, x) {
		this.onScroll.RIGHT = f;
this.onScroll.RIGHTX = x;
	},
	
	setAutoScrollTop: function(f, y) {
		this.onScroll.TOP = f;
this.onScroll.TOPX = y;
	},
	
	setAutoScrollBottom: function(f, y) {
		this.onScroll.BOTTOM = f;
this.onScroll.BOTTOMX = y;
	},
	
	addAllowedTargetClass: function(className) {
		this.allowedClasses.push(className);
	}, 
	
	start: function(event) {
		this._getCoords(event);
		
		if (window.GlideContextMenu && typeof GlideContextMenu.closeAllMenus == 'function' && event.target && !$(event.target).up('.cm_menuwrapper')) {
			GlideContextMenu.closeAllMenus();
		}
			
		this._fDraggableMove = this._draggableMove.bind(this);
		this._fdraggableEnd = this._draggableEnd.bind(this);
		
		document.observe('mousemove', this._fDraggableMove);
		document.observe('mouseup', this._fdraggableEnd);
		if (this.dragCursor)
			this.dragElem.style.cursor = this.dragCursor;
		
		document.body.focus();
		document.onselectstart = function () { return false; };
	},
	
	
	_createPageShim: function() {
		this.pageShim = document.createElement('div');
		this.boundElem.appendChild(this.pageShim);
		this.pageShim.style.top = 0;
		this.pageShim.style.left = 0;
		this.pageShim.style.width = '100%';
		this.pageShim.style.height = '100%';
		this.pageShim.style.position = 'absolute';
		this.pageShim.style.display = 'block';
		this.pageShim.style.zIndex = '9999';
		this.pageShim.style.backgroundColor = Prototype.Browser.IE ? '#ccc' : 'transparent';
		this.pageShim.style.opacity = '0';
		this.pageShim.style.filter = 'alpha(opacity=0)';
		if (this.dragCursor) {
			this.pageShim.style.cursor = this.dragCursor;
			this.dragElem.style.cursor = this.dragCursor;
		}
	},
	_removePageShim: function() {
		if (this.pageShim)
			this.pageShim.parentNode.removeChild(this.pageShim);
		this.pageShim = null;
	},
	
	_getCoords: function(event) {
		event = event || window.event;
		if (!event.pageX) {
			event.pageX = event.clientX;
			event.pageY = event.clientY;	
		}
		
		if (!this._origPageCoords)
			this._origPageCoords = {x:event.pageX, y:event.pageY};
		if (!this._origDragElmCoords) {
			var cumulativeOffset = this.dragElem.cumulativeOffset();
			if (this.dragElem.style.right) {
				this.dragElem.style.left = (this.dragElem.up().getWidth() - this.dragElem.getWidth() - parseInt(this.dragElem.style.right, 10)) + 'px';
				this.dragElem.setStyle({right: ''});
			}
			this._origDragElmCoords = {
				x: parseInt(this.dragElem.style.left, 10) || cumulativeOffset.left,
				y: parseInt(this.dragElem.style.top, 10) || cumulativeOffset.top
			};
		}
		this._shift = !this._pageCoords ? {x:0,y:0} : {x:(event.pageX - this._pageCoords.x), y:(event.pageY - this._pageCoords.y)};
		this._pageCoords = {x:event.pageX, y:event.pageY};
		this._dragElmCoords = {x:this._origDragElmCoords.x + (this._pageCoords.x - this._origPageCoords.x),
						       y:this._origDragElmCoords.y + (this._pageCoords.y - this._origPageCoords.y)};
	},
	
	_draggableStart: function(event) {
		var node = event.target;
		while(node && !node.classList.contains('glide_box')){
			if(this.IGNORED_DRAG_ELEMENTS.indexOf(node.nodeName) !== -1) return;
			node = node.parentElement;
		}
		var l = this.allowedClasses.length;
		if (l > 0) {
			var boolCanStart = false;
			for (var i = 0; i < l; i++) {
				if (event.target.className == this.allowedClasses[i]) {
					boolCanStart = true;
					break;
				}
			}
			if (!boolCanStart)
				return true;
		}
		this.start(event);
		return this.onStart(event, this.dragElem, this._pageCoords, this._shift, this._dragElmCoords, this); 
	},
	
	_draggableMove: function(event) {
		this._getCoords(event);
		if (!this.pageShim) {
			this._createPageShim();
			
			if (Prototype.Browser.IE)
				this.dragElem.up().onselectstart = function() { return false; };
		}
			
		if (this._shift.x == 0 && this._shift.y == 0)
			return;
		if (this.onScroll.LEFT && this._pageCoords.x < this.onScroll.LEFTX) {
			if (!this.leftScrollId)
				this.leftScrollId = setInterval(this._autoXScrollerInterceptor.bind(this, this.onScroll.LEFT, this.onScroll.LEFTX), this.H_SCROLL_REFRESH_FREQ_MS);
			if (this._shift.y == 0)
				return;
		} else if (this.onScroll.LEFT && this.leftScrollId && this._pageCoords.x >= this.onScroll.LEFTX) {
			clearInterval(this.leftScrollId);
			this.leftScrollId = null;
		}
		
		if (this.onScroll.RIGHT && this._pageCoords.x > this.onScroll.RIGHTX) {
			if (!this.rightScrollId)
				this.rightScrollId = setInterval(this._autoXScrollerInterceptor.bind(this, this.onScroll.RIGHT, this.onScroll.RIGHTX), this.H_SCROLL_REFRESH_FREQ_MS);
			if (this._shift.y == 0)
				return;
		} else if (this.onScroll.RIGHT && this.rightScrollId && this._pageCoords.x <= this.onScroll.RIGHTX) {
			clearInterval(this.rightScrollId);
			this.rightScrollId = null;
		}
		if (this.onScroll.TOP && this._pageCoords.y < this.onScroll.TOPX) {
			if (!this.topScrollId)
				this.topScrollId = setInterval(this._autoYScrollerInterceptor.bind(this, this.onScroll.TOP, this.onScroll.TOPX), this.V_SCROLL_REFRESH_FREQ_MS);
			if (this._shift.x == 0)
				return;
		} else if (this.onScroll.TOP && this.topScrollId && this._pageCoords.y >= this.onScroll.TOPX) {
			clearInterval(this.topScrollId);
			this.topScrollId = null;
		}
		if (this.onScroll.BOTTOM && this._pageCoords.y > this.onScroll.BOTTOMX) {
			if (!this.bottomScrollId)
				this.bottomScrollId = setInterval(this._autoYScrollerInterceptor.bind(this, this.onScroll.BOTTOM, this.onScroll.BOTTOMX), this.V_SCROLL_REFRESH_FREQ_MS);
			if (this._shift.x == 0)
				return;
		} else if (this.onScroll.BOTTOM && this.bottomScrollId && this._pageCoords.y <= this.onScroll.BOTTOMX) {
			clearInterval(this.bottomScrollId);
			this.bottomScrollId = null;
		}
		
		this.onDrag(event, this.dragElem, this._pageCoords, this._shift, this._dragElmCoords, this);
return false;
	},
	
	_autoXScrollerInterceptor: function(f, boundaryX) {
		f(this.dragElem, this._pageCoords.x - boundaryX, this._pageCoords);
	},
	
	_autoYScrollerInterceptor: function(f, boundaryY) {
		f(this.dragElem, this._pageCoords.y - boundaryY, this._pageCoords);
	},
	
	_draggableEnd: function(event) {
		this._removePageShim();
		
		document.onselectstart = null;
		if (Prototype.Browser.IE)
			this.dragElem.up().onselectstart = null;
		
		if (this.hoverCursor)
			this.hoverElem.style.cursor = this.hoverCursor;
		
		document.stopObserving('mousemove', this._fDraggableMove);
		document.stopObserving('mouseup', this._fdraggableEnd);
		event.stopPropagation();
		
		this._getCoords(event);
		var boolReturn = this.onEnd ? this.onEnd(event, this.dragElem, this._pageCoords, this._shift, this._dragElmCoords, this) : true;
		
		this.reset();
		return boolReturn;
	},
	
	toString: function() { return 'GlideDraggable'; }
});
;
/*! RESOURCE: /scripts/classes/GwtDraggableSnap.js */
var debugId = 0;
var GwtDraggableSnap = Class.create(GwtDraggable, {
	
    initialize : function(header, itemDragged) {
    	GwtDraggable.prototype.initialize.call(this, header, itemDragged);
		this.snapTable = null;
		this.dropZoneList = [];
		this.initDropZones = null;
		this.boundDirection = null;
		this.boundElement = null;
    	this.setStart(this.snapStart.bind(this));
    	this.setDrag(this.snapDrag.bind(this));
    	this.setEnd(this.snapEnd.bind(this));
    	this.setCreateFloat(this._createFloat.bind(this));
    	this.setFloatClassName("drag_float_visible");
    },
    destroy: function() {
    	this.snapTable = null;
    	this.dropZoneList = null;
    	this.onInitDropZones = null;
    	this.boundElement = null;
    	GwtDraggable.prototype.destroy.call(this);
    },
	setCreateFloat: function(f) {
		this.onCreateFloat = f;
		if (!f)
			this.onCreateFloat = this._createFloat.bind(this);
	},
	
	setFloatClassName: function(n) {
		this.floatClassName = n;
	},
	setSnapTable: function(table) {
		this.snapTable = table;
		this.dropZoneList = [];
	},
	
	setInitDropZones: function(f) {
		this.onInitDropZones = f;
		this.snapTable = null;
		this.dropZoneList = [];
	},
	setBoundLeftRight: function() {
		this.boundDirection = "l-r";
	},
	
	setBoundUpDown: function() {
		this.boundDirection = "u-d";
	},
	
	setBoundElement: function(element) {
		this.boundElement = element;
	},
	
	addDropZone: function(element) {
		this.dropZoneList.push(element);	
	},
	
	removeDropZone: function(element) {
		for (var i = 0; i < this.dropZoneList.length; i++) {
			if (element.id == this.dropZoneList[i].id) {
				this.dropZoneList.remove(i);
				break;
			}
		}
	},
	
	clearDropZones: function() {
		this.dropZoneList = [];
	},
	
	
	snapStart: function(dragObj, x, y, e) {
		x -= this.differenceX;
		y -= this.differenceY;
		
		if (dragObj.draggable.style.position == "absolute")
			this.snapMode = "absolute";
		else
			this.snapMode = "relative";
		this.currentDropZone = null;
		this.snapElement = null;
		this.dragFloat = null;
		this._initDropZones(dragObj, x, y);
		
		this._initDragBounds(x, y);
		return true;
	},
	snapDrag: function(dragObj, x, y, e) {
		var pos = this._boundDragging(x, y);	
		x = pos[0];
		y = pos[1];
		
		if (!this.dragFloat)
			this.dragFloat = this.onCreateFloat(dragObj, x, y);
		if (this.dragFloat) {
			this.dragFloat.style.left = x;
			this.dragFloat.style.top = y;
		}
		this._findDropZoneAndMove(dragObj, x + this.differenceX, y + this.differenceY);
		return true;		
	},
	snapEnd: function(dragObj, x, y, e) {
		this.dropZones = [];
		if (this.dragFloat)
			this.floatIntv = this._floatBackAndDelete(this, 150, 15);
			
		return true;
	},
	
	hasSnapMoved: function() {
		return this.originalDropZone != this.currentDropZone;
	},
	_createFloat: function(dragObj, x, y) {
		var dfloat = cel("div");
		dfloat.id = "floater";
		dfloat.className = this.floatClassName;		
		dfloat.style.position = "absolute";
		dfloat.style.width = dragObj.draggable.offsetWidth - (!isMSIE ? 2 : 0);
		dfloat.style.height = dragObj.draggable.offsetHeight - (!isMSIE ? 2 : 0);
		
		document.body.appendChild(dfloat);
		return dfloat;
	},
	
	_boundDragging: function(x, y) {
		if (this.boundDirection == "l-r")
			y = this.origY;
		else if (this.boundDirection == "u-d")
			x = this.origX;
		if (this.boundElement) {
			if (y < this.boundTop)
				y = this.boundTop;
				
			if (y > this.boundBottom)
				y = this.boundBottom;
				
			if (x < this.boundLeft)
				x = this.boundLeft;
				
			if (x > this.boundRight)
				x = this.boundRight;
		}
		return [x, y];
	},
	_findDropZoneAndMove: function(dragObj, x, y) {
		if (this.snapMode == "absolute") {
			if (this.currentDropZone && this._overlaps(this.currentDropZone, x, y))
				return false;
				
			var dz = this._findDropZoneAbsolute(dragObj, x, y);
			if (dz && dz != this.currentDropZone) {
				this.currentDropZone = dz;
				this.snapElement = dz.element;
				
				if (!this.fireEvent("beforedrop", dragObj, dz.element, dz.element, x, y))
					return false;
				dragObj.draggable.style.left = this.currentDropZone.left;
				dragObj.draggable.style.top = this.currentDropZone.top;
				return true;
			}
		} else {
			var dz = this._findDropZoneRelative(dragObj, x, y);
			if (dz && dragObj.draggable.nextSibling != dz.element) {
				this.currentDropZone = dz;
				this.snapElement = dz.element.parentNode;
				if (!this.fireEvent("beforedrop", dragObj, dz.element.parentNode, dz.element, x, y))
					return false;
				
				dz.element.parentNode.insertBefore(dragObj.draggable, dz.element);
				dragObj.draggable.parentNode.style.display = "none";
				dragObj.draggable.parentNode.style.display = "";
				return true;
			}
		}
		return false;
	},
	
	_findDropZoneAbsolute: function(dragObj, x, y) {
		var dz = null;
		for (var i = 0; i < this.dropZones.length; i++) {
			if (this._overlaps(this.dropZones[i], x, y)) {
				dz = this.dropZones[i];
				break;
			}
		}
		return dz;
	},
	_findDropZoneRelative: function(dragObj, x, y) {
		var draggable = dragObj.getDraggable();
		var cCell = null;
		var aLargeNumber = 100000000;
		for (var z = 0; z < this.dropZones.length; z++) {
			var dz = this.dropZones[z];
				
			if (draggable == dz) 
				continue;
			
			var ai = Math.sqrt(Math.pow(x - dz.left, 2) + Math.pow(y - dz.top, 2));
			if (isNaN(ai))
				continue;
			if (ai < aLargeNumber){
				aLargeNumber = ai;
				cCell = dz;
			}
		}
		return cCell;
	},
	_initDragBounds: function(x, y) {
		this.origX = x;
		this.origY = y;
		if (this.boundElement) {
			this.boundLeft = grabOffsetLeft(this.boundElement) - grabScrollLeft(this.boundElement);
			this.boundTop = grabOffsetTop(this.boundElement) - grabScrollTop(this.boundElement);
			this.boundRight = this.boundLeft + this.boundElement.offsetWidth - this.draggable.offsetWidth;
			this.boundBottom = this.boundTop + this.boundElement.offsetHeight - this.draggable.offsetHeight;
			
			this.boundLeft -= 4;
			this.boundTop -= 4;
			this.boundRight += 4;
			this.boundBottom += 4;
		}
	},
	
	_initDropZones: function(dragObj, x, y) {
		this.dropZones = [];
		var zones = [];
		if (this.onInitDropZones) {
			zones = this.onInitDropZones(this, x, y);
		} else if (this.snapTable) {
			zones = this._initDropZonesFromTable(this.snapTable);
		} else {
			for (var i = 0; i < this.dropZoneList.length; i++)
				zones.push(this.dropZoneList[i]);
		}
			
		for (var i = 0; i < zones.length; i++) {
			var zone = zones[i];
			if (this.snapMode == "absolute") {
				this._addDropZone(zone);
			} else {
				this._initDropZonesRelative(dragObj, zone);
			}
		}
		
		if (this.snapMode == "absolute") {
			this.originalDropZone = this._findDropZoneAbsolute(dragObj, x, y);
		} else {
			var nextSibling = dragObj.draggable.nextSibling;
			for (var i = 0; i < this.dropZones.length; i++) {
				if (this.dropZones[i].element == nextSibling) {
					this.originalDropZone = this.dropZones[i];
					break;
				}
			}
		}
	},
	_initDropZonesFromTable: function(t) {
		var zones = [];
		var rowCnt = t.rows.length;
		var colCnt = t.rows[0].cells.length;
		for (var row = 0; row < rowCnt; row++) {
			for (var col = 0; col < colCnt; col++) {
				var cell = t.rows[row].cells[col];
				if (getAttributeValue(cell, "dropzone") == "true" || cell.dropzone == "true")
					zones.push(cell);
			}
		}
		return zones;
	},
	
	_initDropZonesRelative: function(dragObj, zone) {	
		var myHeight = 0;
		var lastDivExists = false;
		for (var i = 0; i < zone.childNodes.length; i++) {
			var node = zone.childNodes[i];
			if (getAttributeValue(node, "dragpart") 
					|| node.dragpart == "true"
					|| getAttributeValue(node, "dropzone")
					|| node.dropzone == "true") {
				if ((node.id == "lastdiv") || (node.name == "lastdiv"))
					lastDivExists = true;
					
				if (node == dragObj.draggable) {
					myHeight = dragObj.draggable.offsetHeight;
				}
				
				if (this._isInScrollRegion(node, zone)) {
					this._addDropZone(node, myHeight);
				}
			}
		}
		
		if (!lastDivExists) {
			var lastDiv = cel("DIV");
			lastDiv.name = "lastdiv";
			lastDiv.dropzone = "true";
			lastDiv.style.width = "100%";
			lastDiv.style.height = "0";
			zone.appendChild(lastDiv);							
			this._addDropZone(lastDiv, myHeight);
		}
	},
	_addDropZone: function(element, topOffset) {
		if (!topOffset)
			topOffset = 0;
			
		var dropZone = {};
		dropZone.element = element;
		dropZone.left = grabOffsetLeft(element) - grabScrollLeft(element);
		dropZone.top = grabOffsetTop(element) - topOffset - grabScrollTop(element);
		dropZone.right = dropZone.left + element.offsetWidth;
		dropZone.bottom = dropZone.top + element.offsetHeight;
		this.dropZones.push(dropZone);
	},
	
	_isInScrollRegion: function(element, region) {
		var left = element.offsetLeft;
		var top = element.offsetTop;
		if (left < 0)
			left = 0;
			
		if (top < 0)
			top = 0;
			
		return (left >= region.scrollLeft) 
			&& (top  >= region.scrollTop)
			&& (left <= (region.scrollLeft + region.offsetWidth))
			&& (top  <= (region.scrollTop + region.offsetHeight));
	},
	
	_overlaps: function(dz, x, y) {
		return ((dz.left < x) && (x < dz.right) && (dz.top < y) && (y < dz.bottom));
	},
	_floatBackAndDelete: function(gd, tTime, tMoves) {
		var baseObj = gd.getDraggable();
		var movenObj = gd.dragFloat;
		var currentX = parseInt(movenObj.style.left);
		var currentY = parseInt(movenObj.style.top);
var backX = (currentX - grabOffsetLeft(baseObj) - grabScrollLeft(baseObj)) / tMoves;
var backY = (currentY - grabOffsetTop(baseObj) - grabScrollTop(baseObj)) / tMoves;
		return setInterval(
			function(){
				if (tMoves < 1) {
					clearInterval(gd.floatIntv);
					gd.dragFloat.parentNode.removeChild(gd.dragFloat);
					gd.dragFloat = null;
					return;
				}
				tMoves--;
				currentX -= backX;
				currentY -= backY;
				movenObj.style.left = parseInt(currentX) + "px";
				movenObj.style.top = parseInt(currentY) + "px"
}, tTime / tMoves)
	},
	
    z: null
});
;
/*! RESOURCE: /scripts/classes/GwtExportOnCancelDialog.js */
var GwtExportOnCancelDialog = Class.create(GlideDialogWindow, {
	initialize: function (tableName, query, view, query_no_domain) {
		GlideDialogWindow.prototype.initialize.call(this, 'export_on_cancel_dialog');
		this.exportConfigs = [
			{
				"value": "excel",
				"sysparm_export": "unload_excel_xlsx",
"processor_name": "/sys_confirm_excel.do"
			},
			{
				"value" : "csv",
				"sysparm_export": "unload_csv",
"processor_name": "/sys_confirm_csv.do"
			},
			{
				"value" : "json",
				"sysparm_export": "unload_json",
"processor_name": "/sys_confirm_json.do"
			},
			{
				"value" : "pdf",
				"secondary_choice" : {
					"name" : "orientation",
					"values" : [
						{
							"value" : "landscape",
							"sysparm_export": "unload_pdflandscape",
"processor_name": "/sys_confirm_pdflandscape.do"
						},
						{
							"value" : "portrait",
							"sysparm_export": "unload_pdf",
"processor_name": "/sys_confirm_pdf.do"
						}
					]
				}
			}
		];
		var keys = ["Please Confirm", "Please specify an address", "Export will be emailed to"];
		this.msgs = getMessages(keys);
		this.tableName = tableName;
		this.query = query;
		this.view = view;
		this.query_no_domain = query_no_domain;
		this.setPreference('table', 'export_on_cancel');
		this.setPreference('sysparm_query', this.query);
		this.setPreference('sysparm_target', this.tableName);
		this.setPreference('sys_action', 'email');
		this.setPreference('sysparm_view', this.view);
		this.setPreference('sysparm_query_no_domain', this.query_no_domain);
		this.setTitle(this.msgs["Please Confirm"]);
		g_export_on_cancel_dialog = this;
	},
	changeFileType: function() {
		var fileTypeOption = gel('file_type');
		for (var i = 0; i < this.exportConfigs.length; ++i) {
			var config = this.exportConfigs[i];
			if (fileTypeOption.value != config.value)
				continue;
			if (!config.secondary_choice) {
				gel('row_orientation').style.display = 'none';
				return;
			}
			var secondaryOption = gel('row_' + config.secondary_choice.name);
			secondaryOption.style.display = null;
		}
	},
	execute : function() {
		this.render();
	},
	close : function() {
		g_export_on_cancel_dialog = null;
		this.destroy();		
	},
	doExport : function() {
		var addressInput = gel('display_email_address');
		if (!addressInput)
			return;
		if (addressInput.value  == '') {
			alert(this.msgs["Please specify an address"]);
			return;
		}
		var emailAddress = gel('email_address');
		emailAddress.value = addressInput.value;
		var exportConfig = this._searchExportConfig();
		if (!exportConfig)
			return;
		var exportType = gel('sysparm_export');
		exportType.value = exportConfig.sysparm_export;
		var form = gel('sys_confirm.do');
		form.setAttribute('action', exportConfig.processor_name);
		var serial = Form.serialize(form);
		var args = this.msgs["Export will be emailed to"] + ' ' + emailAddress.value;
		serverRequestPost(exportConfig.processor_name,  serial, this.ack, args);
		this.close();
	},
	ack : function(request, message) {
		alert(message);
	},
	_searchExportConfig: function() {
		var fileTypeOption = gel('file_type');
		for (var i = 0; i < this.exportConfigs.length; ++i) {
			var config = this.exportConfigs[i];
			if (fileTypeOption.value != config.value)
				continue;
			if (!config.secondary_choice)
				return config;
			var secondaryOption = gel(config.secondary_choice.name);
			for (var j = 0 ; j < config.secondary_choice.values.length; ++j) {
				var secondaryConfig = config.secondary_choice.values[j];
				if (secondaryOption.value == secondaryConfig.value)
					return secondaryConfig;
			}
			return null;
		}
		return null;
	}
});
;
/*! RESOURCE: /scripts/classes/AutoComplete.js */
var AutoComplete = Class.create({ 
   
    initialize: function() {
    	this.processor = "AutoComplete";
    	this.table = null;
    	this.column = null;
    	this.query = null;
    	this.typedChars = "";
    	this.input = null;
    	this.select = null;
		this.timeout = null;
		this.keyDelay = 500;
    },
    
    setTable: function(name) {
    	this.table = name; 
    },      
    
    setColumn: function(name) {
    	this.column = name; 
    },  
        
    setQuery: function(query) {
    	this.query = query;
    },
    
    setSelect: function(o) {
this.select = gel(o);
    },    
    
    setInput: function(o) {
    	this.input = gel(o); 
    },
    
    onKeyUp: function(event) {
		if (this.timeout)
			clearTimeout(this.timeout);
			
		this.timeout = setTimeout(this._onKeyUp.bind(this), this.keyDelay);
	},
	
	_onKeyUp: function() {
		this.timeout = null;
    	this.typedChars = this.input.value;
    	this.ajaxRequest();
    },
    
    ajaxRequest: function(urlParameters) {
    	var ajax = new GlideAjax(this.processor);
    	ajax.addParam("sysparm_chars", this.typedChars);
    	ajax.addParam("sysparm_name", this.table + "." + this.column);
    	if (this.query)
    		ajax.addParam("sysparm_query", this.query);
        ajax.getXML(this.ajaxResponse.bind(this));    	
    },
    ajaxResponse: function(request) {
      if (!request.responseXML.documentElement)
        return; 
        
      this.populateSelect(request.responseXML.documentElement);
    },
    
    populateSelect: function(xml) {
      this.select.options.length = 0;
	  var items = xml.getElementsByTagName("item");
	  for (var i = 0; i < items.length; i++ ) {
		var item = items[i];
		var o = new Option(item.getAttribute('label'), item.getAttribute('sys_id'));
		this.select.options[this.select.options.length] = o;
	  }
    }
});
;
/*! RESOURCE: /scripts/classes/SlushBucket.js */
var SlushBucket = Class.create({
	initialize: function(id) {
		this.id = id;
		this.leftSelectJustify = "";
		this.rightSelectJustify = "";
		this.rightValues = "";
		this.evenOddColoring = false;
		this.isTemplating = false;
		this.ignoreDuplicates = false;
	},
    getLeftSelectJustify: function() {
        return this.leftSelectJustify;
    },
    setLeftSelectJustify: function(justify) {
        this.leftSelectJustify = justify;
        this.getLeftSelect().style.textAlign = justify;
    },
    
    getRightSelectJustify: function() {
        return this.rightSelectJustify;
    },
    
    setRightSelectJustify: function(justify) {
        this.rightSelectJustify = justify;
        this.getRightSelect().style.textAlign = justify;
    },
    
    getEvenOddColoring: function() {
        return this.evenOddColoring;
    },
    setEvenOddColoring: function(evenOdd) {
        this.evenOddColoring = evenOdd;
    },
    
	addLeftChoice: function(value, text) {
	   var opt = cel("option");
	   opt.value = value;
	   opt.text = text;
	   this.getLeftSelect().options.add(opt);
    },
    
    addRightChoice: function(value, text) {
 	   var opt = cel("option");
 	   opt.value = value;
 	   opt.text = text;
 	   this.getRightSelect().options.add(opt);
     },
    
    clear: function() {
    	this.clearSelect(this.getLeftSelect());
    	this.clearSelect(this.getRightSelect());
    },
    
    clearSelect: function(selectBox) {
    	selectBox.options.length = 0;
    },
    
    getValues: function(selectBox) {
		var values = new Array();
	    var options = selectBox.options;
	    for (var i = 0; i < options.length; i++) {
	    	values[i] = options[i].value;
	    }
		return values;    	
    },
    
    saveRightValues: function(values) {
       this.rightValues = values;
    },
    
    getRightValues: function() {
    	return this.rightValues;
    },
    
	getSelected : function(selectBox) {
		var selectedIds = [];
		var sourceOptions = selectBox.options;
		for (var i = 0; i < sourceOptions.length; i++) {
			option = sourceOptions[i];
			if (!option.selected) 
				continue;
			
			selectedIds.push(i);
		}
		return selectedIds;
	},
    
    getRightSelect: function() {
    	return gel(this.id + "_right");
    },    
    
    getLeftSelect: function() {
    	return gel(this.id + "_left");
    },
	onKeyMoveLeftToRight: function(evt) {
		var desiredKeyCode = this._isRTL() ? 37 : 39;
		if (evt.keyCode != desiredKeyCode)
			return;
		this.moveOptions(this.getLeftSelect(), this.getRightSelect());
	},
	onKeyMoveRightToLeft: function(evt) {
		var desiredKeyCode = this._isRTL() ? 39 : 37;
		if (evt.keyCode != desiredKeyCode)
			return;
		this.moveOptions(this.getRightSelect(), this.getLeftSelect());
	},
	onKeyUpMoveUpDown: function(evt, select) {
		for (var i = 0; i < select.options.length; i++) {
			select.options[i].setAttribute('aria-selected', select.options[i].selected);
		}
	},
	onKeyMoveUpDown: function(evt, select) {
		if (evt.keyCode !== 38 && evt.keyCode !== 40)
			return;
		var selectedOption;
		var options = select.options;
		for (var i = 0; i < options.length; i++) {
			var option = options[i];
			if (!option.selected || (typeof selectedOption != 'undefined' && option.value === selectedOption.value))
				continue;
			option.selected = false;
			option.setAttribute("aria-selected", false);
			if (option.value !== lastFocusedOption)
				continue;
			if (evt.keyCode === 38)
				selectedOption = options[i - 1];
			if (evt.keyCode === 40)
				selectedOption = options[i + 1];
			selectedOption.selected = true;
			selectedOption.setAttribute("aria-selected", true);
			lastFocusedOption = selectedOption.value;
		}
	},
	onOptionSelected: function(evt, select) {
		lastFocusedOption = evt.target.value;
		var sourceOptions = select.options;
		for (var i = 0; i < select.length; i++) {
			var option = sourceOptions[i];
			option.setAttribute("aria-selected", option.selected);
		}
	},
    
    moveLeftToRight: function() {
    	this.moveOptions(this.getLeftSelect(), this.getRightSelect());
    },
	keydownMoveLeftToRight: function(evt) {
		if (evt.keyCode === 13 || evt.keyCode === 32) {
			evt.preventDefault();
			this.moveLeftToRight();
		}
	},
    
    moveRightToLeft: function() {
		this.moveOptions(this.getRightSelect(), this.getLeftSelect());    	
    },
	keydownMoveRightToLeft: function(evt) {
		if (evt.keyCode === 13 || evt.keyCode === 32) {
			evt.preventDefault();
			this.moveRightToLeft();
		}
	},
	
    copyLeftToRight: function() {
    	this.moveOptions(this.getLeftSelect(), this.getRightSelect(), true);
    },
	_isRTL: function() {
		return document.documentElement.getAttribute('dir') == 'rtl';
	},
	moveOptions : function(sourceSelect, targetSelect, copyFlag) {
		var selectedIds = this.getSelected(sourceSelect);
		if (selectedIds.length < 1)
			return;
		var sourceOptions = sourceSelect.options;
		var targetOptions = targetSelect.options;
		targetSelect.selectedIndex = -1;
		for (var i = 0; i < selectedIds.length; i++) {
			var soption = sourceOptions[selectedIds[i]];
			var label = soption.text;
			if ((this.ignoreDuplicates) && (this._isDuplicate(targetOptions, soption.value)))
				continue;
			option = new Option(label, sourceOptions[selectedIds[i]].value);
			option.cl = label;
			option.className = sourceOptions[selectedIds[i]].className;
			option.title = sourceOptions[selectedIds[i]].title;
			targetOptions[targetOptions.length] = option;
			targetOptions[targetOptions.length - 1].selected = true;
		}
		if (!copyFlag) {
		   for (var i = selectedIds.length - 1; i > -1; i--)
			  sourceSelect.remove(selectedIds[i]);
		}
		this.evenOddColorize();
		if (targetSelect["onchange"])
			targetSelect.onchange();
		if (sourceSelect["onchange"])
			sourceSelect.onchange();
			sourceSelect.disabled = true;
			sourceSelect.disabled = false;
			if (selectedIds.length > 0 && !this.isTemplating){
				targetSelect.focus();
			}
		var rightElem = [gel(this.id + "_right").options];
		if(rightElem[0].length > 0){
			var e = gel(this.id);
			var newVal = new Array;
			var rightElementOptions = rightElem[0];
			for(var i = 0 ; i < rightElementOptions.length; i++) 
			    newVal[i] = rightElementOptions[i].value;
			var newVal = newVal.join(',');
			var oldValue = e.value;
			if (oldValue != newVal) {
				e.value = newVal;
				multiModified(e);
			}
		} else{
			gel(this.id).value = "";
		}
	},
	moveUp : function() {
		sourceSelect = this.getRightSelect();
		var selectedIds = this.getSelected(sourceSelect);
		var options = sourceSelect.options;
		for (var i = 0; i < selectedIds.length; i++) {
			var selId = selectedIds[i];
			if (selId == 0)
				break;
			
if (window['privateMoveUp'])
				privateMoveUp(options, selId);
			else
				this.swap(options[selId], options[selId - 1]);
			options[selId].selected = false;
			options[selId - 1].selected = true;
		}
		this.evenOddColorize();
		sourceSelect.focus();
		if (sourceSelect["onLocalMoveUp"])
			sourceSelect.onLocalMoveUp();
		function resetFields(){
			sourceSelect.removeAttribute("multiple");
			setTimeout(function(){sourceSelect.setAttribute("multiple", "multiple"); $(sourceSelect).stopObserving('click', resetFields);});
		}
		
		if (isMSIE8 || isMSIE9 || isMSIE10 || isMSIE11)
			$(sourceSelect).observe('click', resetFields);
	},
	moveDown : function() {
		var sourceSelect = this.getRightSelect();
		var selectedIds = this.getSelected(sourceSelect);
		selectedIds.reverse();
		var options = sourceSelect.options;
		for (var i = 0; i < selectedIds.length; i++) {
			var selId = selectedIds[i];
			if (selId + 1 == options.length)
				break; 
			
if (window['privateMoveDown'])
				privateMoveDown(options, selId);
			else
				this.swap(options[selId], options[selId + 1]);
			options[selId].selected = false;
			options[selId + 1].selected = true;
		}
		this.evenOddColorize();
		sourceSelect.focus();
		if (sourceSelect["onLocalMoveDown"])
			sourceSelect.onLocalMoveDown();
		function resetFields(){
			sourceSelect.removeAttribute("multiple");
			setTimeout(function(){sourceSelect.setAttribute("multiple", "multiple"); $(sourceSelect).stopObserving('click', resetFields);});
		}
		
		if (isMSIE8 || isMSIE9 || isMSIE10 || isMSIE11)
			$(sourceSelect).observe('click', resetFields);
		
	},
	swap: function(option1, option2) {
		if (!option2)
			return; 
		
		var t = $j(option1).clone();
		t = t[0];
t.text = option1.text;
		option1.value = option2.value;
		option1.text = option2.text;
		option1.title = option2.title;
		option2.value = t.value;
		option2.text = t.text;
		option2.title = t.title;
	},
	evenOddColorize: function() {
		if (!this.evenOddColoring)
			return;
		rightSelect = this.getRightSelect();
		if (rightSelect.length < 1)
			return;
		var options = rightSelect.options;
		for (var i = 0; i < rightSelect.length; i++) {
			if ((i % 2) == 0)
				rightSelect.options[i].style.background = "white";
			else
				rightSelect.options[i].style.background = "#dddddd";
		}
	},
	
	_isDuplicate : function(options, value) {
		for (var i = 0; i < options.length; i++) {
			if (options[i].value == value)
				return true;
		}
		return false;
	},
	
	getClassName : function() {
		return "SlushBucket";
	},
	type: "Slushbucket"
});
;
/*! RESOURCE: /scripts/classes/ajax/AJAXCompleter.js */
var AJAXCompleter = Class.create({ 
  KEY_BACKSPACE: 8,
  KEY_TAB:       9,
  KEY_RETURN:   13,
  KEY_ESC:      27,
  KEY_LEFT:     37,
  KEY_UP:       38,
  KEY_RIGHT:    39,
  KEY_DOWN:     40,
  KEY_DELETE:   46,
  KEY_HOME:     36,
  KEY_END:      35,
  KEY_PAGEUP:   33,
  KEY_PAGEDOWN: 34,
  TAB: "Tab",
  ARROW_LEFT:"ArrowLeft",
  ARROW_RIGHT:"ArrowRight",
   
    initialize: function(name, elementName) {
    	this.guid = guid();
    	this.className = "AJAXCompleter";
		this.name = name;
		this.elementName = elementName;
		this.field = null;
		this.menuBorderSize = 1;
	    this.resetSelected();
		this.ieIFrameAdjust = 4;
		this.initDropDown();
		this.initIFrame();
    },
	
	initDropDown: function() {
		var dd = gel(this.name);
		if (!dd) {
			dd = cel("div");
			dd.id = this.name;
			dd.className = "ac_dropdown";
			dd.setAttribute('aria-live', 'polite');
			dd.setAttribute('role', 'listbox');
			var style = dd.style;
			if (window.NOW && window.NOW.isUsingPolaris) {
				style.borderWidth = this.menuBorderSize;
			} else {
				style.border = "black " + this.menuBorderSize + "px solid";
				style.backgroundColor = "white";
				style.zIndex = 20000;
			}
			this._setCommonStyles(style);
		}
		this.dropDown = $(dd);
		addChild(dd);
		this.clearDropDown();
		this.currentMenuItems = [];
		this.currentMenuCount = this.currentMenuItems.length;
	},
	
	initIFrame: function() {
		var iFrame = gel(this.name + "_shim");
		if (!iFrame) {
var title = this.name.replace(/\./g, ' ');
			iFrame = cel("iframe");
			iFrame.name = this.name + "_shim";
			iFrame.scrolling = "no";
			iFrame.frameborder = "no";
			iFrame.src = "javascript:false;";
			iFrame.id = this.name + "_shim";
			iFrame.title = new GwtMessage().getMessage(title);
			var style = iFrame.style;
			style.height = 0;
			this._setCommonStyles(style);
			style.zIndex = this.dropDown.style.zIndex - 1;
			addChild(iFrame);
		}
		this.iFrame = $(iFrame);
	},
	
	_setCommonStyles: function(style) {
		style.padding = 1;
		style.visibility = "hidden";
		style.display = "none";
		style.position = "absolute";		
	},
	 
	setWidth: function(w) {
		this.dropDown.style.width = w + "px";
		this.iFrame.style.width = w + "px";	
	},
	
	setHeight: function(height) {
		this.dropDown.height = height;
		if (g_isInternetExplorer)
height += this.ieIFrameAdjust;
			
		this._setIframeHeight(height);
	},
	
	_setIframeHeight: function(height) {
		this.iFrame.style.height = height;
	},
	
	resetSelected: function() {
		this.selectedItemObj = null;
		this.selectedItemNum = -1;		
	},
		
	clearDropDown: function() {
		this.hideDropDown();
		var dropDown = this.dropDown;
	    while(dropDown.childNodes.length > 0)
		  dropDown.removeChild(dropDown.childNodes[0]);
	   this.currentMenuItems = [];
	   this.currentMenuCount = this.currentMenuItems.length;
	   this._setInactive();
	},
	
	_setActive: function() {
		window.g_active_ac = this;
	},
	
	_setInactive: function() {
		window.g_active_ac = null;
	},
			
	hideDropDown: function() {
		if (this.dropDown.style.visibility == "hidden")
		  return;	
		  
		this._showHide("hidden", "none");
		this.element.removeAttribute('aria-activedescendant');
		this.element.setAttribute('aria-expanded', 'false');
		this.resetSelected();
	},	
	
	onDisplayDropDown: function() {
	},
	
	showDropDown: function() {
		if (this.dropDown.style.visibility == "visible")
		  return;
		
		this._showHide("visible", "inline");
		this.element.setAttribute('aria-expanded', 'true');
		this.onDisplayDropDown();
	},
	
	_showHide: function(type, display) {
		this.dropDown.style.visibility = type;
		this.iFrame.style.visibility = type;		
		this.dropDown.style.display = display;
		this.iFrame.style.display = display;
	},
	
	isVisible: function() {
		return this.dropDown.style.visibility == "visible";
	},
	
	appendElement: function(element) {
		this.getDropDown().appendChild(element);
	},
		
	appendItem: function(item) {
		this.appendElement(item);
		if (this.currentMenuItems == null)
		  this.currentMenuItems = [];
		  
		item.acItemNumber = this.currentMenuItems.length;
		this.currentMenuItems.push(item);
	    this.currentMenuCount = this.currentMenuItems.length;
	},
	
	selectNext: function() {
		var itemNumber = this.selectedItemNum;
		if (this.selectedItemNum < this.getMenuCount() - 1)
			itemNumber++;
			
		this.setSelection(itemNumber);
	},
	
	selectPrevious: function() {
		var itemNumber = this.selectedItemNum;
		if (this.selectedItemNum <= 0)
		  return false; 
		  
		itemNumber--;
		this.setSelection(itemNumber);
		return true; 
	},
	
	unsetSelection: function()  {
		if (this.selectedItemNum == -1)
		   return;
		   
	    this.setNonSelectedStyle(this.selectedItemObj);
		this.resetSelected();
	},
	
	setSelection: function(itemNumber) {
        this.unsetSelection();
		this.selectItem(itemNumber);
		this.setSelectedStyle(this.selectedItemObj);
	},
	
	selectItem: function(itemNumber) {
		this.selectedItemNum = itemNumber;
		this.selectedItemObj = this.currentMenuItems[itemNumber];
	},
	
	getMenuItems: function() {
		return this.currentMenuItems;
	},
	
	getObject: function(itemNumber) {
		return this.currentMenuItems[itemNumber];
	},
	
	getSelectedObject: function() {
		return this.getObject(this.selectedItemNum);
	},
	
	setSelectedStyle: function(element) {
		$(element).addClassName("ac_highlight");
		element.setAttribute('aria-selected', 'true');
		
		if (typeof element.displaySpan != "undefined") {
			alert("element.displaySpan.style.color");
			element.displaySpan.style.color = "white";
		}		
	},
	 
	setNonSelectedStyle: function(element) {
		$(element).removeClassName("ac_highlight");
		element.removeAttribute('aria-selected');
		if (element.displaySpan)
			element.displaySpan.style.color = "green";
	},
	
	setTargetTable: function(targetTable) {
		this.targetTable = targetTable;
	},
	
	getTargetTable: function() {
		return this.targetTable;
	},
	
	isPopulated: function() {
		return this.getMenuCount() > 0;
	},
	log: function(msg) {
		jslog(this.className + ": " + msg);
	},
	
	getIFrame: function() { return this.iFrame; },	
    getField: function() { return this.field; },
    getDropDown: function() { return this.dropDown; },
	getMenuCount: function() { return this.currentMenuCount; }
	
});
;
/*! RESOURCE: /scripts/classes/ajax/AJAXReferenceControls.js */
var AJAXReferenceControls = Class.create({
	initialize:function (tableElement, id, parentElement, refSysId, rowSysId, refQualTag) {
		this.refName = id;
		this.id = "LIST_EDIT_" + id;
		this.tableElement = tableElement;
		this.dependent = null;
		this.refQual = "";
		this.refImageFocused = false;
		this.refSysId = refSysId;
		this.rowSysId = rowSysId;
		this.createAdditionalValues(refQualTag);
		this.createInput(parentElement);
		this.createLookup(parentElement);
		this.createInputGroup(parentElement);
		this.createDependent(parentElement);
	},
	clearDropDown:function () {
		if (this.ac)
			this.ac.clearDropDown();
	},
	createAdditionalValues:function (refQualTag) {
		this.additionalValues = {};
		this.additionalValues.sys_uniqueValue = this.rowSysId;
		this.additionalValues.sys_target = this.tableElement.getTable().getName();
		this.additionalValues.sysparm_list_edit_ref_qual_tag = refQualTag;
	},
	createInput:function (parentElement) {
		var doctype = document.documentElement.getAttribute('data-doctype');
		this._createHidden(parentElement, this.id, '');
		this.input = cel("input", parentElement);
		input = this.input;
		if (doctype)
			input.className = 'form-control list-edit-input';
		input.id = "sys_display." + this.id;
		input.onfocus = this._onFocus.bind(this);
		input.onkeydown = this._onKeyDown.bindAsEventListener(this);
		input.onkeypress = this._onKeyPress.bindAsEventListener(this);
		input.onkeyup = this._onKeyUp.bindAsEventListener(this);
		input.autocomplete = "off";
		input.ac_columns = "";
		input.ac_order_by = "";
		input.setAttribute("data-ref-dynamic", this.tableElement.isDynamicCreation());
	},
	resolveReference:function () {
		if (this.ac)
			this.ac.onBlur();
	},
	setDisplayValue:function (value) {
		this.input.value = value;
	},
	getInput:function () {
		return this.input;
	},
	getValue:function () {
		return gel(this.id).value;
	},
	getDisplayValue:function () {
		return this.input.value;
	},
	isResolving:function () {
		return (this.ac && this.ac.isResolving());
	},
	isReferenceValid:function () {
		if (this.ac) {
			return this.ac.isReferenceValid();
		}
		return true;
	},
	setResolveCallback:function (f) {
		if (!this.ac)
			return;
		this.ac.setResolveCallback(f);
	},
	setReferenceQual:function (refQual) {
		this.refQual = refQual;
	},
	createLookup:function (parent) {
		var doctype = document.documentElement.getAttribute('data-doctype');
		var title = getMessage("Lookup using list");
var image = $(createImage("images/reference_list.gifx", title));
		if(doctype)
			image = $(createIcon("icon-search", title));
image.width = 18;
		image.height = 16;
		image.id = "ref_list." + this.id;
		image.observe("click", this._refListOpen.bind(this));
		if (window.g_accessibility) {
			image.observe("keydown", function(evt) {
				if (evt && evt.keyCode == Event.KEY_RETURN) {
					evt.stop();
					return this._refListOpen(evt);
				}
			}.bind(this));
		}
		image.style.marginLeft = "5px";
		image.setAttribute("tabindex", 0);
		image.setAttribute("role", "button");
		if(doctype)
			image = image.wrap('span', {'class' : 'input-group-addon', 'id' : 'list-edit-span'});
		parent.appendChild(image);
	},
	createDependent:function (parent) {
        if (!this.tableElement.isDependent())
			return;
		var input = cel("input");
		input.type = "hidden";
		this.dependent = "sys_dependent";
		input.id = this.tableElement.getTable().getName() + "." + this.dependent;
		input.name = input.id;
		parent.appendChild(input);
		this.dependentInput = input;
	},
	createInputGroup:function (parent) {
		if (document.documentElement.getAttribute('data-doctype') != 'true')
			return;
		var divInputGroup = $('sys_display.' + this.id).wrap('div', {'class' : 'input-group', 'style' : 'border-spacing:0'});
		var referenceIcon = $('list-edit-span')
		$('list-edit-span').remove();
		divInputGroup.appendChild(referenceIcon);
	},
	setRecord:function (record) {
		this.record = record;
	},
	_createHidden:function (parent, id, value) {
		var input = cel("input");
		input.type = "hidden";
		input.id = id;
		input.value = value;
		parent.appendChild(input);
		return input;
	},
	_setDependent:function () {
        if (this.dependent == null)
			return;
		var value = this.record.getValue(this.tableElement.getDependent());
        if ('NULL' === value)
			this.dependentInput.value = '';
        else
			this.dependentInput.value = value;
	},
	_onFocus:function (evt) {
        if (this.ac)
			return;
		this._setDependent();
		var dep = '';
		if (this.dependentInput)
			dep = "sys_dependent";
		var referenceValid = true;
		if (this.record && this.record.isReferenceValid)
			referenceValid = this.record.isReferenceValid();
		this.ac = new AJAXTableCompleter(this.input, this.id, dep, null, null, referenceValid);
		this.ac.elementName = this.refName;
		this.ac.setRefQual(this.refQual);
		this.ac.referenceSelect(this.refSysId, this.input.value, !referenceValid);
		this.ac.clearDerivedFields = false;
		for (var n in this.additionalValues)
			this.ac.setAdditionalValue(n, this.additionalValues[n]);
	},
	_onKeyDown:function (evt) {
		acReferenceKeyDown(this.input, evt);
	},
	_onKeyPress:function (evt) {
		acReferenceKeyPress(this.input, evt);
	},
	_onKeyUp:function (evt) {
		acReferenceKeyUp(this.input, evt);
	},
	_refListOpen:function (evt) {
		var te = this.tableElement;
		this._setDependent();
		var url = reflistOpenUrl(this.refName, this.id, te.getName(), te.getReference());
		for (var n in this.additionalValues)
			url += "&" + n + "=" + encodeText(this.additionalValues[n]);
		if (this.dependentInput)
			url += "&sysparm_dependent=" + escape(this.dependentInput.value);
		popupOpenStandard(url, "lookup");
		return false;
	},
	type:function () {
		return "AJAXReferenceControls";
	}
});
;
/*! RESOURCE: /scripts/classes/ajax/AJAXOtherCompleter.js */
var AJAXOtherCompleter = Class.create(AJAXCompleter, { 
   
    initialize: function(element, reference) {
		AJAXCompleter.prototype.initialize.call(this, 'AC.' + reference, reference);
		this.className = "AJAXReferenceCompleter";
		this.dirty = false;
		this.matched = false;
		this.fieldChanged = false;
	    this.ignoreAJAX = false;
		this.type = null;
		this.refField = null;		
		this.textValue = "";
		this.invisibleTextValue = "";
		this.savedTextValue = "";
		this.savedInvisibleTextValue = "";
		this.previousTextValue = ""; 
		this.resultsStorage = new Object();
		this.emptyResults = new Object();	
		this.oldFunctionJunk();
	},
		
	setInvisibleField: function(f) {
		this.iField = f;
		this._setAC(f);
	},
	setField: function(f) {
		this.field = f;	
	    this.field.autocomplete = "off";	
		this._setAC(f);
	},
	
	setUpdateField: function(f) {
		this.updateField = f;
		this._setAC(f);
	},
	
	_setAC: function(field) {
		if (field)
		  field.ac = this;			
	},	
	
	setType: function(type) {
		this.type = type;
	}, 
	
	setSavedText: function(textArray) {
	  if (textArray[0] != null)
		this.savedInvisibleTextValue = textArray[0];
	  this.savedTextValue = textArray[1];		
	},
	
	getMenu: function() { return this.getDropDown(); },
		
	getUpdateField: function() {
		return this.updateField;
	},
		
	oldFunctionJunk: function() {
		this.isOTM = function() { return this.type == ONE_TO_MANY; };
		this.getInvisibleField = function() { return this.iField; };		
	}		
	
});
;
/*! RESOURCE: /scripts/classes/ajax/AJAXReferenceCompleter.js */
function acReferenceKeyDown(element, evt) {
	if (!element.ac || element.getAttribute('readonly'))
	  return true;
    return element.ac.keyDown(evt);
}
function acReferenceKeyPress(element, evt) {
	if (!element.ac || element.getAttribute('readonly'))
	  return true;
	var rv =  element.ac.keyPress(evt);
	if (rv == false)
	  evt.cancelBubble = true;
   	return rv;
}
function acReferenceKeyUp(element, evt) {
	if (!element.ac || element.getAttribute('readonly'))
	  return true;
   return element.ac.keyUp(evt);
}
addRenderEvent(function() {
	var statusEl = document.getElementById('ac.status');
	if (!statusEl) {
		statusEl = document.createElement('span');
		statusEl.id = 'ac.status';
		statusEl.setAttribute('role', 'status');
		statusEl.setAttribute('aria-live', 'polite');
		statusEl.classList.add('sr-only');
		document.body.appendChild(statusEl);
	}
})
var AJAXReferenceCompleter = Class.create(AJAXCompleter, {
	PROCESSOR: "Reference",
    initialize: function(element, reference, dependentReference, refQualElements, targetTable, referenceValid) {
		AJAXCompleter.prototype.initialize.call(this, 'AC.' + reference, reference);
		this.className = "AJAXReferenceCompleter";
	    this.element = $(element);
	    this.keyElement = gel(reference);
		this.setDependent(dependentReference);
		this.setRefQualElements(refQualElements);
		this.setTargetTable(targetTable);
		this.additionalValues = {};
		CustomEvent.observe('domain_scope_changed', this.cacheClear.bind(this));
		
		this._commonSetup();
		this.oneMatchSelects = true;
		this.clearDerivedFields = true;
		this.allowInvalid = this.element.readAttribute('allow_invalid') == 'true';
		this.dynamicCreate = this.element.readAttribute('data-ref-dynamic') == 'true';
		this.isList = this.element.readAttribute('islist') == 'true';
		if (!this.simpleQualifier)
			this.refQual = "";
		this.isFilterUsingContains = this.element.readAttribute('is_filter_using_contains') == 'true';
		this.referenceValid = referenceValid;
    },
	_commonSetup: function() {
		this.element.ac = this;
		Event.observe(this.element, 'blur', this.onBlurEvent.bind(this));
		Event.observe(this.element, 'focus', this.onFocus.bind(this));
		this.saveKeyValue = this.getKeyValue();
		this.currentDisplayValue = this.getDisplayValue();
		this.currentRefValue = this.getKeyValue();
		this.searchChars = "";
		this.rowCount = 0;
		this.ignoreFocusEvent = false;
		this.max = 0;
		this.cacheClear();
		this.hasFocus = true;
		this.isResolvingFlag = false;
		var f = this.element.readAttribute("function");
		if (f)
	        this.selectionCallBack = f;
		addUnloadEvent(this.destroy.bind(this));
		this._setupAccessibility();
		this._setUpDocMouseDown();
	},
	isResolving: function() {
		return this.isResolvingFlag;
	},
	destroy: function() {
		this.element = null;
		this.keyElement = null;
	},
	keyDown: function(evt) {
		var typedChar = getKeyCode(evt);
		if (typedChar == KEY_ARROWUP) {
		  if( !this.selectPrevious())
			this.hideDropDown();
		}  else if (typedChar == KEY_ARROWDOWN) {
			if (!this.isVisible()) {
				if (!this.isPopulated())
					return;
				this.showDropDown();
			}
			this.selectNext();
		} else if (typedChar == KEY_TAB && !window.g_accessibility) {
			if (this.hasDropDown() && this.select())
				this.clearTimeout();
			else
				this.onBlur();
		} else if (typedChar == KEY_TAB && window.g_accessibility) {
			if (this.searchChars && this.searchChars != this.currentDisplayValue)
				this.element.value = '';
			this.clearDropDown();
		} else if (typedChar == KEY_ESC) {
			this.element.value = '';
			this.clearDropDown();
		}
	},
	keyUp: function(evt) {
		var typedChar = getKeyCode(evt);
		if (!this.isDeleteKey(typedChar))
			return;
		this.clearTimeout();
		this.timer = setTimeout(this.ajaxRequest.bind(this), g_acWaitTime || 50);
	},
	setSelection: function(itemNumber) {
		AJAXCompleter.prototype.setSelection.call(this, itemNumber);
		this.element.setAttribute('aria-activedescendant', this.selectedItemObj.id);
		this.setStatus(this.selectedItemObj.innerText);
		this.selectedItemObj.setAttribute('aria-selected', 'true');
	},
	_handleDeleteKey: function() {
	},
	clearTimeout: function() {
		if (this.timer != null)
		  clearTimeout(this.timer);
         this.timer = null;
	},
	keyPress: function(eventArg) {
		var evt = getEvent(eventArg);
		var key = evt.key;
		var typedChar = getKeyCode(evt);
		if (typedChar != KEY_ENTER && typedChar != KEY_RETURN)
			this.clearTimeout();
		if (this.isNavigation(key))
		  return true;
		if (this.isDeleteKey(typedChar))
			return true;
		if (typedChar == KEY_ENTER || typedChar == KEY_RETURN) {
			if (this.hasDropDown() && this.select())
				this.clearTimeout();
			else
				this.onBlur();
			if (this.enterSubmits) {
				this.element.setValue(trim(this.element.getValue()));
				return true;
			}
			return false;
	    }
		if (typedChar == this.KEY_ESC) {
			this.clearDropDown();
			return false;
		}
		this.resetSelected();
		this.timer = setTimeout(this.ajaxRequest.bind(this), g_acWaitTime || 50);
		return true;
	},
	isNavigation: function(key) {
		if (key == this.TAB)
		  return true;
		if (key == this.ARROW_LEFT)
		  return true;
		if (key == this.ARROW_RIGHT)
		  return true;
	},
	isDeleteKey: function(typedChar) {
		if (typedChar == this.KEY_BACKSPACE || typedChar == this.KEY_DELETE)
			return true;
	},
	_getSearchChars: function() {
		if (this._checkDoubleByteEncodedCharacter(this.getDisplayValue()))
			return this._translateDoubleByteIntoSingleByte(this.getDisplayValue());
		else
			return this.getDisplayValue();
	},
	_checkDoubleByteEncodedCharacter: function(s) {
		if (typeof s === 'undefined' || s.length === 0)
			return false;
		var char = s.charCodeAt(0);
		return char === 12288 || (65280 < char && char < 65375);
	},
	_translateDoubleByteIntoSingleByte: function (s) {
		var str = '';
		for (var i = 0, l = s.length, char; i < l; i++) {
			char = s.charCodeAt(i);
			if (char == 12288)
				str += String.fromCharCode(32);
			else if (65280 < char && char < 65375)
				str += String.fromCharCode(char - 65248);
			else
				str += s[i];
		}
		return str;
	},
	ajaxRequest: function() {
		var s = this._getSearchChars();
		if (s.length == 0 && !this.isDoctype()) {
			this.clearDropDown();
			this.searchChars = null;
			return;
		}
		if (s == "*")
			return;
		this.searchChars = s;
		var xml = this.cacheGet(s);
		if (xml) {
			this.processXML(xml);
			return;
		}
		if (this.cacheEmpty()) {
			this.clearDropDown();
			this.hideDropDown();
			return;
		}
        var url = "";
		url += this.addSysParms();
		url += this.addDependentValue();
		url += this.addRefQualValues();
		url += this.addTargetTable();
		url += this.addAdditionalValues();
		url += this.addAttributes("ac_");
		this.callAjax(url);
	},
	callAjax: function(url) {
		this.isResolvingFlag = true;
		var ga = new GlideAjax(this.PROCESSOR);
		ga.setQueryString(url);
		ga.setErrorCallback(this.errorResponse.bind(this));
		ga.getXML(this.ajaxResponse.bind(this), null, null);
	},
	ajaxResponse: function(response) {
        if (!response.responseXML || !response.responseXML.documentElement) {
			this.isResolvingFlag = false;
			return;
		}
		var xml = response.responseXML;
		var e = xml.documentElement;
		var timer = e.getAttribute("sysparm_timer");
		if (timer != this.timer)
			return;
		this.timer = null;
		this.clearDropDown();
		this.cachePut(this.searchChars, xml);
		this.processXML(xml);
		this.isResolvingFlag = false;
		if (this.onResolveCallback)
			this.onResolveCallback();
	},
	errorResponse: function() {
		this.isResolvingFlag = false;
	},
	processXML: function(xml) {
		var e = xml.documentElement;
		this._processDoc(e);
		var values = this._processItems(xml);
		var recents = this._processRecents(xml);
		if (!this.hasFocus) {
			this._processBlurValue(values, recents);
			return;
		}
		this.createDropDown(values, recents);
	},
	_processItems: function(xml) {
		var items = xml.getElementsByTagName("item");
		var values = [];
		for(var i = 0; i < items.length; i++) {
			var item = items[i];
			var array = this.copyAttributes(item);
			array['XML'] = item;
			values[values.length] = array;
		}
		return values;
	},
	_processRecents: function(xml) {
		var recents = [];
		var items = xml.getElementsByTagName("recent");
		for (var i = 0; i < items.length; i++) {
			var rec = this.copyAttributes(items[i]);
			rec.XML = items[i];
			recents.push(rec);
		}
		return recents;
	},
	_processBlurValue: function(values, recents) {
		this.ignoreFocusEvent = false;
		values = values || [];
		recents = recents || [];
		if (values.length + recents.length === 0 && this.searchChars.length > 0) {
			this.setInvalid();
			return;
		}
		if (!this.oneMatchSelects || this.getDisplayValue() === '')
			return;
		var targetLabel, targetValue;
		if (values.length + recents.length == 1) {
			var target = recents.length == 1 ? recents[0] : values[0];
			targetLabel = target.label;
			targetValue = target.name;
		}
		if (recents[0] && recents[0].label == this.getDisplayValue()) {
			var matchesRecent = recents[1] && recents[0].label == recents[1].label;
			var matchesValue = values[0] && recents[0].label == values[0].label;
			if (!matchesRecent && !matchesValue) {
				targetLabel = recents[0].label;
				targetValue = recents[0].name;
			}
		} else if (values[0] && values[0].label == this.getDisplayValue()) {
			var matchesSecondValue = values[1] && values[0].label == values[1].label;
			if (!matchesSecondValue) {
				targetLabel = values[0].label;
				targetValue = values[0].name;
			}
		}
		if (targetLabel)
			this.referenceSelect(targetValue, targetLabel);
	},
	_processDoc: function(doc) {
this.rowCount = doc.getAttribute('row_count');
	    this.max = doc.getAttribute('sysparm_max');
	},
	addSysParms: function() {
		var name = this.elementName;
		if (this.elementName.indexOf('IO:') > -1)
			name = this.elementName.substring(this.elementName.indexOf("IO:"), this.elementName.length);
		var sp = "sysparm_name=" + name +
		    "&sysparm_timer=" + this.timer +
		    "&sysparm_max=" + this.max +
		    "&sysparm_chars=" + encodeText(this.searchChars);
		if (this.guid)
			sp += "&sysparm_completer_id=" + this.guid;
		if (this.ignoreRefQual)
			sp += "&sysparm_ignore_ref_qual=true";
		else if (this.refQual != "" && typeof this.refQual != "undefined")
			sp += "&sysparm_ref_qual=" + this.refQual;
		
		var domain = gel("sysparm_domain");
		if (domain)
			sp += "&sysparm_domain=" + domain.value;
		
		return sp;
	},
	addTargetTable: function() {
		var answer = "";
		if (this.getTargetTable()) {
			answer = "&sysparm_reference_target=" + this.getTargetTable();
		}
		return answer;
	},
	addAdditionalValues: function() {
		var answer = "";
		for (var n in this.additionalValues)
			answer += "&" + n + "=" + encodeText(this.additionalValues[n]);
		return answer;
	},
	addAttributes: function(prefix) {
	  var answer = "";
	  var attributes = this.element.attributes;
	  for (var n = 0; n < attributes.length; n++) {
	  	var attr = attributes[n];
		var name = attr.nodeName;
		if (name.indexOf(prefix) != 0)
		  continue;
		var v = attr.nodeValue;
		answer += "&" + name + "=" + v;
	  }
	  return answer;
	},
	copyAttributes: function(node) {
	  var attributes = new Array();
	  for (var n = 0; n < node.attributes.length; n++) {
	  	var attr = node.attributes[n];
		var name = attr.nodeName;
		var v = attr.nodeValue;
		attributes[name] = v;
	  }
	  return attributes;
	},
    createDropDown: function(foundStrings, foundRecents) {
		this.clearDropDown();
		this.createInnerDropDown();
		if (foundRecents && foundRecents.length > 0) {
			this._showRecents();
			for (var i = 0; i < foundRecents.length; i++) {
				var rec = foundRecents[i];
				var recchild = this.createChild(rec);
				recchild.acItem = rec;
				this.appendItem(recchild);
				this.addMouseListeners(recchild);
			}
		}
		if (foundStrings && foundStrings.length > 0) {
			this._showMax(foundStrings, foundRecents);
			for (var c = 0; c < foundStrings.length; c++) {
				if (this.max > 0 && c >= this.max)
					break;
				
				var x = foundStrings[c];
				var child = this.createChild(x);
				child.acItem = x;
				this.appendItem(child);
				this.addMouseListeners(child);
			}
		}
		if (this.currentMenuCount) {
			this.setDropDownSize();
			this.showDropDown();
			if (isTextDirectionRTL()) {
				var diff = parseInt(this.dropDown.style.width) - this.getWidth();
				if(diff < 0)
					diff = 0;
				var w = 0;
				if (isMSIE8 || isMSIE7 || isMSIE6 || (isMSIE9 && (getPreference('glide.ui11.use') == "false"))) {
					if (typeof g_form != "undefined")
						w =  this.element.offsetParent ? this.element.offsetParent.clientWidth : 0;
				}
				this.dropDown.style.left = (parseInt(this.dropDown.style.left) - diff) + w + "px";
				this.iFrame.style.left = (parseInt(this.iFrame.style.left) - diff) + w + "px";
				if (parseInt(this.dropDown.style.left) < 0) {
					this.dropDown.style.left = 0 + "px";
					this.iFrame.style.left = 0 + "px";
				}
			}
			var height = this.dropDown.clientHeight;
			this.setHeight(height);
			this.firefoxBump();
			var msg = '{0} suggestions. Please use the up and down arrow keys to select a value';
			if (this.currentMenuCount == 1)
				msg = '1 suggestion. Please use the up and down arrow keys to select a value';
			var messageAPI = new GwtMessage();
			messageAPI.fetch([msg], function(msgs) {
				var msgWithValues = messageAPI.format(msgs[msg], this.currentMenuCount);
				this.setStatus(msgWithValues);
			}.bind(this))
		}
		this._setActive();
		_frameChanged();
   },
	createInnerDropDown: function() {
	},
	_showRecents: function() {
		this._addHeaderRow("Recent selections");
	},
	_showMax: function(foundStrings, foundRecents) {
		if (foundRecents && foundRecents.length > 0)
			this._addHeaderRow("Search");
	},
	_addHeaderRow: function(message) {
		var row = cel("div");
		row.className = "ac_header";
		row.setAttribute("width", "100%");
		row.innerHTML = new GwtMessage().getMessage(message);
		this.appendElement(row);
	},
   select: function() {
 		if (this.selectedItemNum < 0)
		  return false;
		var o = this.getSelectedObject().acItem;
		this.referenceSelect(o['name'], o['label']);
		this.clearDropDown();
		return true;
   },
    _setDisplayValue: function(v) {
        var e = this.getDisplayElement();
        if (e.value == v)
            return;
        e.value = v;
    },
    referenceSelectTimeout: function(sys_id, displayValue) {
   		this.selectedID = sys_id;
   		this.selectedDisplayValue = displayValue;
if (typeof reflistModalPick == "function")
   			this._referenceSelectTimeout();
   		else
   			setTimeout(this._referenceSelectTimeout.bind(this), 0);
    },
    _referenceSelectTimeout: function() {
   		this.referenceSelect(this.selectedID, this.selectedDisplayValue);
    },
   referenceSelect: function(sys_id, displayValue, referenceInvalid) {
        this._setDisplayValue(displayValue);
		var e = this.getKeyElement();
		var glideListHasItem = e && e.value && sys_id && 'glide-list' === e.getAttribute('data-type') ? !!e.value.match(new RegExp('(^|,)(' + sys_id + ')(,|$)', 'gm')) : false;
		if (e.value != sys_id && !glideListHasItem) {
			e.value = sys_id;
			callOnChange(e);
		}
		this.searchChars = displayValue;
		this.currentDisplayValue = displayValue;
        this.showViewImage();
		if (!referenceInvalid)
			this.clearInvalid();
        this._clearDerivedFields();
		if (this.selectionCallBack && sys_id) {
			if (!glideListHasItem)
			eval(this.selectionCallBack);
			else if (this.getDisplayElement())
				this.getDisplayElement().value = '';
		}
		if (e["filterCallBack"]) {
		   e.filterCallBack();
		}
   },
   setFilterCallBack: function(f) {
        var e = this.getKeyElement();
        e["filterCallBack"] = f
   },
   isEditingList: function () {
		return this.keyElement && this.keyElement.id && this.keyElement.id.indexOf("LIST_EDIT") === 0;
   },
   _clearDerivedFields: function() {
		if (this.clearDerivedFields && window['DerivedFields'] && !this.isEditingList()) {
			var df = new DerivedFields(this.keyElement.id);
			df.clearRelated();
			df.updateRelated(this.getKeyValue());
		}
   },
   showViewImage: function() {
   	  var element = gel("view." + this.keyElement.id);
   	  var elementR = gel("viewr." + this.keyElement.id);
   	  var noElement = gel("view." + this.keyElement.id + ".no");
	  var sys_id = this.getKeyValue();
	  if (sys_id == "") {
	  	hideObject(element);
	  	hideObject(elementR);
		showObjectInlineBlock(noElement);
	  } else {
	  	showObjectInlineBlock(element);
	  	showObjectInlineBlock(elementR);
		hideObject(noElement);
	  }
	},
	createChild: function(item) {
		return this._createChild(item, item['label']);
	},
	_createChild: function(item, text) {
		var div = cel(TAG_DIV);
		div.ac = this;
		div.acItem = item;
		div.id = 'ac_option_' + item.name;
		div.setAttribute('role', 'option');
		var itemInRow = cel(TAG_SPAN, div);
		itemInRow.innerHTML = (text + '').escapeHTML();
		return div;
	},
    addMouseListeners: function(element) {
  	  element.onmousedown = this.onMouseDown.bind(this, element);
   	  element.onmouseup = this.onMouseUp.bind(this, element);
	  element.onmouseover = this.onMouseOver.bind(this, element);
	  element.onmouseout = this.onMouseOut.bind(this, element);
    },
   onMouseUp: function(element) {
   	  this.select();
   },
   onMouseDown: function(element) {
   	  if (g_isInternetExplorer) {
   	    this.select();
   	    window.event.cancelBubble = true;
	    window.event.returnValue = false;
		setTimeout(this.focus.bind(this), 50);
	  }
   	  return false;
   },
   onMouseOut: function(element) {
   	  this.unsetSelection();
   },
   onMouseOver: function(element) {
   	  this.setSelection(element.acItemNumber);
   },
   focus: function() {
   	this.element.focus();
   },
   setDropDownSize: function() {
	   var e, mLeft, mTop;
	    if (window.$j) {
			e = $j(this.element);
			var offset = e.offset();
			var parent = $j(getFormContentParent());
			var parentOffset = {
					left: 0,
					top: 0
				};
			var parentIsBody = parent.get(0) == document.body;
			var parentScrolltop = (parentIsBody || parent.css('overflow') == 'visible') ? 0 : parent.scrollTop();
			if(!parentIsBody)
				parentOffset = parent.offset();
			var firstChildElement = parent.get(0) && parent.get(0).children[0];
			var form = (firstChildElement && (firstChildElement.tagName === "FORM")) 
						?
						firstChildElement
						:
						null;
			var parentOffsetLeft = (isTextDirectionRTL() && form) ? form.offsetLeft : parentOffset.left;
			mLeft = offset.left - parentOffsetLeft + 1 + 'px';
			mTop = offset.top - parentOffset.top + e.outerHeight() + parentScrolltop + 'px';
	    } else {
			e = this.element;
			mLeft = grabOffsetLeft(e) + "px";
			mTop =  grabOffsetTop(e) + (e.offsetHeight - 1) + "px";
	    }
		var mWidth = this.getWidth();
		var dd = this.dropDown;
		if (dd.offsetWidth > parseInt(mWidth))
			mWidth = dd.offsetWidth;
		this.setTopLeft(dd.style, mTop, mLeft);
		this.setTopLeft(this.iFrame.style, mTop, mLeft);
		this.setWidth(mWidth);
	},
	setTopLeft: function (style, top, left) {
		style.left = left;
		style.top = top;
	},
	getWidth: function () {
		var field = this.element;
		if (g_isInternetExplorer)
		  return field.offsetWidth - (this.menuBorderSize * 2);
	    return field.clientWidth;
	},
	onFocus: function() {
		if (this.ignoreFocusEvent || this.element.getAttribute('readonly'))
		   return;
		this.hasFocus = true;
		this.currentDisplayValue = this.getDisplayValue();
		this.currentRefValue = this.getKeyValue();
		this._setUpDocMouseDown();
		if (this.isDoctype() && this.currentDisplayValue == '')
			this.timer = setTimeout(this.ajaxRequest.bind(this), g_acWaitTime || 50);
	},
	isTablet: function() {
		return !(typeof isTablet == "undefined");
	},
	isDoctype: function() {
		return document.documentElement.getAttribute('data-doctype') == 'true';
	},
	_setupAccessibility: function() {
		this.element.setAttribute('role', 'combobox');
		this.element.setAttribute('aria-autocomplete', 'list');
		this.element.setAttribute('aria-owns', this.getDropDown().id);
		this.element.setAttribute('aria-expanded', 'false');
	},
	_setUpDocMouseDown: function() {
		if (this.isTablet()) {
			this.blurPause = true;
			this._boundOnDocMouseDown = this.onDocMouseDown.bind(this);
			Event.observe(document.body, 'mousedown', this._boundOnDocMouseDown);
		}
	},
	setStatus: function(text) {
		var statusEl = this._getStatusEl();
		if (!statusEl)
			return;
		statusEl.innerText = text;
	},
	_getStatusEl: function() {
		return document.getElementById('ac.status');
	},
	onDocMouseDown: function(evt) {
		if (evt.target == this.element)
			return;
		this.blurPause = false;
	},
	onBlurEvent: function(evt) {
		if (this.element.getAttribute('readonly'))
			return;
		if (this.isTablet() && this.blurPause == true)
			setTimeout(this.onBlur.bind(this), 4000);
		else
			this.onBlur();
	},
	compareRefDisplayValue: function() {
		var refDisplayValue = this.getDisplayValue();
return this.currentDisplayValue === refDisplayValue || (this.currentDisplayValue && this.currentDisplayValue.replace(/[\n\r]/g,'') === refDisplayValue);
	},
	onBlur: function() {
if (this._boundOnDocMousedown) {
			Event.stopObserving(document.body, 'mousedown', this._boundOnDocMouseDown);
			delete this._boundOnDocMouseDown;
		}
 		this.hasFocus = false;
		if (this.getDisplayValue().length == 0) {
			if (this.currentDisplayValue != "") {
if (!this.isList) {
					this.referenceSelect("", "");
				} else {
					this.clearInvalid();
				}
			} else {
				this.clearInvalid();
			}
		} else if (this.selectedItemNum > -1) {
			this.select();
		} else if ((this.getKeyValue() == "") || !this.compareRefDisplayValue()) {
			if (!this.isFilterUsingContains) {
				var refInvalid = true;
				if (this.isExactMatch()) {
					if (this.oneMatchSelects != false) {
						var o = this.getObject(0).acItem;
						this.referenceSelect(o['name'], o['label']);
						refInvalid = false;
					}
				} else if (this.keyElement && this.currentRefValue != this.keyElement.value) {
					if (this.searchChars == this.currentDisplayValue && (this.keyElement.id.indexOf("LIST_EDIT") == -1 || this.currentRefValue != ""))
						refInvalid = false;
				}
				if (refInvalid)
					this.setInvalid();
				if (refInvalid || !this.isPopulated()) {
				    this.clearTimeout();
				    this.searchChars = null;
				    this.ignoreFocusEvent = true;
					this.timer = setTimeout(this.ajaxRequest.bind(this), 0);
				}
			}
		}
		this.clearDropDown();
	},
	isExactMatch: function() {
		if (this.isPopulated()) {
			if (this.getMenuCount() == 1) {
			    var o0 = this.getObject(0).acItem;
			    if ((o0['label'].toUpperCase().startsWith(this.getDisplayValue().toUpperCase())))
					return true;
				return false;
		    }
			var o0 = this.getObject(0).acItem;
			var o1 = this.getObject(1).acItem;
			if ((o0['label'] == this.getDisplayValue()) && (o1['label'] != this.getDisplayValue()))
				return true;
		}
	},
	getDisplayValue: function() {
	    return this.getDisplayElement().value;
	},
	getKeyValue: function() {
		return this.getKeyElement().value;
	},
	clearKeyValue: function() {
		this.referenceSelect("", this.getDisplayValue());
	},
	getKeyElement: function() {
		return this.keyElement;
	},
	getDisplayElement: function() {
		return this.element;
	},
	setResolveCallback: function(f) {
		this.onResolveCallback = f;
	},
	setDependent: function(dependentReference) {
		this.dependentReference = dependentReference;
		var el = this.getDependentElement();
		if (!el)
		  return;
var n = dependentReference.replace(/\./, "_");
		n = this.getTableName() + "_" + n;
		var h = new GlideEventHandler('onChange_' + n, this.onDependentChange.bind(this), dependentReference);
		g_event_handlers.push(h);
	},
	onDependentChange: function() {
		this.cacheClear();
	},
	getDependentElement: function() {
		if (!this.dependentReference || 'null' == this.dependentReference)
		   return null;
		var table = this.getTableName();
		var dparts = this.dependentReference.split(",");
		return gel(table + "." + dparts[0]);
	},
	addDependentValue: function() {
		var el = this.getDependentElement();
		if (!el) {
			if (window.NOW.useHiddenDependent && this.element.hasAttribute('data-dependent-value')) {
				return "&sysparm_value=" + this.element.readAttribute('data-dependent-value');
			} else {
				return "";
			}
		}
		var depValue = "";
		if (el.tagName == "INPUT")
			depValue = el.value;
		else
			depValue = el.options[el.selectedIndex].value;
		return "&sysparm_value=" + depValue;
	},
	setRefQualElements: function(elements) {
		this.simpleQualifier = false;
		if (!elements)
			this.refQualElements = null;
		else {
			if (elements.startsWith("QUERY:")) {
				this.setRefQual(elements.substring(6));
				this.simpleQualifier = true;
				return;
			}
			var tableDot = g_form.getTableName() + '.';
			this.refQualElements = [];
		    var a = elements.split(';');
		    if (a == "*") {
				a = [];
        		var form = gel(tableDot + 'do');
				var elements = Form.getElements(form);
    			for (var i = 0; i < elements.length; i++) {
					if ((elements[i].id != this.keyElement.id) && (elements[i].id.startsWith(tableDot)))
      					a.push(elements[i].id);
    			}
		    }
		    for (var i = 0; i < a.length; i++) {
				var n = a[i];
				var el = gel(n);
				if (!el)
		  			continue;
		    	this.refQualElements.push(n);
var h = new GlideEventHandler('onChange_' + n.replace(/\./, "_"), this.onDependentChange.bind(this), a[i]);
				g_event_handlers.push(h);
		    }
		}
	},
	setRefQual: function(refQual) {
		this.refQual = refQual;
	},
	setIgnoreRefQual: function(ignoreRefQual) {
		this.ignoreRefQual = ignoreRefQual;
	},
	addRefQualValues: function() {
		if (this.refQualElements) {
			return "&" + g_form.serializeChanged();
		} else
			return "";
	},
	setAdditionalValue: function(name, value) {
		this.additionalValues[name] = value;
	},
	getTableName: function() {
		return this.elementName.split('.')[0];
	},
	setInvalid: function() {
		this.messages = new GwtMessage().getMessages(
				["A new record with this value will be created automatically", "Invalid reference"]);
		this.referenceValid = false;
		var message;
		if (this.dynamicCreate) {
			message = this.messages["A new record with this value will be created automatically"];
			this.getDisplayElement().title = message;
			addClassName(this.getDisplayElement(), "ref_dynamic");
		} else {
			message = this.messages["Invalid reference"];
			this.getDisplayElement().title = message;
			addClassName(this.getDisplayElement(), "ref_invalid");
		}
		if (typeof g_form != "undefined" && !this.isEditingList()) {
			var fieldName = this.elementName.substring(this.elementName.indexOf('.') + 1);
			var dynamicCreate = this.dynamicCreate;
			if (g_form.getGlideUIElement) {
				var el = g_form.getGlideUIElement(this.elementName);
				if (el)
					el.isInvalid = true;
			}
			setTimeout(function () {
				g_form.hideFieldMsg(fieldName, false, 'invalid_reference');
				g_form.showFieldMsg(fieldName, message, dynamicCreate ? 'info' : 'error', null, 'invalid_reference');
			});
		}
		if (this.getKeyValue() && !this.allowInvalid && !this.isList) {
			this.getKeyElement().value = "";
			callOnChange(this.getKeyElement());
		}
		this.showViewImage();
		var displayElement = this.getDisplayElement();
		if (displayElement) {
			displayElement.setAttribute('aria-invalid', 'true');
		}
	},
	clearInvalid: function() {
		this.referenceValid = true;
		if (this.dynamicCreate) {
			removeClassName(this.getDisplayElement(), "ref_dynamic");
		} else {
			removeClassName(this.getDisplayElement(), "ref_invalid");
		}
		this.getDisplayElement().title = "";
		this.getDisplayElement().removeAttribute("data-original-title");
		if (typeof g_form != "undefined") {
			if (g_form.getGlideUIElement) {
				var el = g_form.getGlideUIElement(this.elementName);
				if (el)
					el.isInvalid = false;
			}
		}
		var fieldName = this.elementName.substring(this.elementName.indexOf('.') + 1);
		if (typeof g_form != "undefined" && fieldName && !this.isEditingList()) {
			g_form.hideFieldMsg(fieldName, false, 'invalid_reference');
		}
		var displayElement = this.getDisplayElement();
		if (displayElement && typeof g_form !== 'undefined') {
			var isEmpty = !this.element.present();
			if (this.isList) {
				isEmpty = this.getKeyValue() === '';
			}
			if (g_form.isMandatory(fieldName) && g_form.submitAttemptsCount > 0 && isEmpty) {
				displayElement.setAttribute('aria-invalid', 'true');
			}
			else {
				displayElement.setAttribute('aria-invalid', 'false');
			}
		}
	},
	isReferenceValid: function() {
		return this.referenceValid;
	},
	firefoxBump: function() {
		var children = this.getMenuItems();
		for(var i = 0 ; i < children.length; i++) {
			if (children[i] && children[i].firstChild) {
				var dparentDivWidth = children[i].offsetWidth;
				var firstChild = children[i].firstChild;
				var paddingValue = 2 * (isTextDirectionRTL() ? firstChild.offsetRight : firstChild.offsetLeft);
				var dchildSpanWidth = firstChild.offsetWidth + 2 + paddingValue;
				if (dchildSpanWidth > dparentDivWidth)
					this.setWidth(dchildSpanWidth);
			}
		}
	},
	_setIframeHeight: function(height) {
		this.iFrame.style.height = height - 2;
	},
	hasDropDown:function() {
		if (!this.dropDown)
			return false;
		return this.dropDown.childNodes.length > 0;
	},
	cachePut: function (name, value) {
		if (this.refQualElements)
			return;
		this.cache[name] = value;
	},
	cacheGet: function(name) {
		if (this.refQualElements)
			return;
		return this.cache[name];
	},
	cacheClear: function() {
		this.cache = new Object();
	},
	cacheEmpty: function() {
		var s = this.searchChars;
		if (!s)
		    return false;
		if (s.startsWith("%"))
return false;
		
		while (s.length > 2) {
			s = s.substring(0, s.length - 1);
			var xml = this.cacheGet(s);
			if (!xml)
			  continue;
			var e = xml.documentElement;
		    var rowCount = e.getAttribute('row_count');
			if (rowCount == 0 && e.childElementCount == 0)
			  return true;
break;
		}
		return false;
	}
});
;
/*! RESOURCE: /scripts/classes/ajax/AJAXReferenceCompleterMulti.js */
var AJAXReferenceCompleterMulti = Class.create(AJAXReferenceCompleter, {
	_hash: new Hash(),
	_SEPARATOR: ',',
	_handleDeleteKey: function() {
		this._rebuildFromInput();
	},
	
	_rebuildFromInput: function() {
		var s = this.getDisplayElement().value;
		var arr = s && s.split(this._SEPARATOR) || [];
		var _hashNew = new Hash();
		for (var i = 0; i < arr.length; i++) {
			var hashKeys = this._hash.keys();
var a = arr[i].strip();
			var foundIt = false;
			for (var keyIter = 0; keyIter < hashKeys.length; keyIter++) {
				if (this._hash.get(hashKeys[keyIter]) == a) { 
					_hashNew.set(hashKeys[keyIter], this._hash.get(hashKeys[keyIter]).escapeHTML());
					this._hash.unset(hashKeys[keyIter]);
					foundIt = true;
					break;
				}
			}
			if (!foundIt) {
				if (this.allowInvalid) 
					_hashNew.set(a, a.escapeHTML());
			}
		}
		this._hash = _hashNew;
		this._setFormValues();
	},
	
	_arrayToString: function(array, useSpacer) {
		var s = '';
		for (var i=0; i<array.length; i++) {
			var a = array[i].strip();
			if (a.length==0)
				continue;
			if (i>0) {
				s += this._SEPARATOR;
				if(useSpacer) 
					s += " ";
			}
			s += a;
		}
		return s;
	},
	
	_setFormValues: function() {
		this.getDisplayElement().value = this.getDisplayValue();
		this.getKeyElement().value = this.getKeyValue();
		if (this.element.getAttribute("reference")== "sys_user"){
			var invalidContacts = false;
			var keyContacts = this.getKeyElement().value.split(",");
			var displayContacts = this.getDisplayElement().value.split(",");
			var matchedRef = false;
			if(!this.isBlur && this.currentDisplayValue) {
				keyContacts.splice((keyContacts.length - 1), 1);
				displayContacts.splice((keyContacts.length - 1), 1);
				this.getKeyElement().value = keyContacts;
				this.getDisplayElement().value = displayContacts;
				matchedRef = true;
			}
			for(i=0;i<keyContacts.length;i++) {
				if(!matchedRef && keyContacts[i] != "" && !isEmailValid(keyContacts[i]) && !this._isGEMValue(keyContacts[i])) {
var hexSysId = /^[0-9A-F]{32}$/i.test(keyContacts[i]);
					if (!hexSysId) {
						keyContacts.splice(i, 1);
						displayContacts.splice(i, 1);
						this.getKeyElement().value = keyContacts;
						this.getDisplayElement().value = displayContacts;
						g_form.hideFieldMsg(this.element.parentNode, true);
						g_form.showFieldMsg(this.element.parentNode, "Please enter a valid email address or User", "error");
						invalidContacts = true;
						this.isBlur = false;
						this.onFocus();
					}
				}
			}
			if(!invalidContacts){
				g_form.hideFieldMsg(this.element.parentNode, true);
			}
		}
	},
	
	_isGEMValue: function(value) {
		return value.indexOf("{{") == 0;
	},
	
	getDisplayValue: function() {
		return this._arrayToString(this._hash.values(), true);
	},
	
	getKeyValue: function() {
		return this._arrayToString(this._hash.keys(), false);
	},
		
    referenceSelect: function(sys_id, displayValue) {
   		this._rebuildFromInput();
   		
		this._resolveReference(sys_id, displayValue);	
	},
	
	_resolveReference: function(sys_id, displayValue) {
		var ajax = new GlideAjax("ResolveRefMulti");
		ajax.addParam("sysparm_name", this.elementName);
		ajax.addParam("sysparm_value", sys_id);
		ajax.getXML(this._resolveReferenceResponse.bind(this, sys_id, displayValue));
	},
	
	_resolveReferenceResponse: function(sys_id, displayValue, request) {
		if (!request)
			return;
		
		var xml = request.responseXML;
		if (!xml)
			return;
			
		if (xml) {
		    var item = xml.getElementsByTagName("item");
		    if (item && item.length == 1) {
				displayValue = item[0].getAttribute("label");
				sys_id = item[0].getAttribute("name");
		    }
		}
		this.setHash(sys_id.escapeHTML(), displayValue.strip());
    	this._setFormValues();
    	
        this.showViewImage();
		this.clearInvalid();
		
        this._clearDerivedFields();
		if (this.selectionCallBack && sys_id) {
			eval(this.selectionCallBack);
		}
	},
    
    setHash: function(key, value) {
this._hash.set(key, value.replace(/,/g, ''));
    },
    
    resetHash: function() {
    	this._hash = new Hash();
    },
   
	_getSearchChars: function() {
		var s = this.getDisplayElement().value;
		var sep_pos = s.lastIndexOf(this._SEPARATOR);
		if (sep_pos > 0) {
			s = s.substr(sep_pos+1);
		} 
this.searchChars = s.replace(/^\s+|\s+$/g, '') ;
		return this.searchChars;
	},
	
	setDropDownSize: function() {
		var e = this.element;
		var mLeft = grabOffsetLeft(e) + (this.getDisplayElement().value.length*5) + "px";
		var mTop =  grabOffsetTop(e) + (e.offsetHeight - 1) + "px";
		var mWidth = this.getWidth();
		this.log("width:" + mWidth);
		
		var dd = this.dropDown;
		if (dd.offsetWidth > parseInt(mWidth)) {
			mWidth = dd.offsetWidth;
		    this.log("width:" + mWidth);
		}
		
		this.setTopLeft(dd.style, mTop, mLeft);
		this.setTopLeft(this.iFrame.style, mTop, mLeft);
		this.setWidth(mWidth);
	}, 
	
	onBlur: function() {
		this.isBlur = true;
		this.log("blur event");
		this.hasFocus = false;
		this._rebuildFromInput();
		this.clearDropDown();
	} 
});
;
/*! RESOURCE: /scripts/classes/ajax/AJAXTableCompleter.js */
var AJAXTableCompleter = Class.create(AJAXReferenceCompleter, { 
	_processDoc: function(doc) {
		AJAXReferenceCompleter.prototype._processDoc.call(this, doc);
		this.showDisplayValue = doc.getAttribute('show_display_value');
		this.queryType = doc.getAttribute('query_type');
		this.queryText = doc.getAttribute('sysparm_chars');
		this.columnsSearch = doc.getAttribute('columns_search');
	},
	appendElement: function(element) {
		this.tbody.appendChild(element);
	},
	createInnerDropDown: function() {
		if (this.dropDown.childNodes.length > 0)
			return;
		this._createTable();
	},
   
    createChild: function(item) {
		if ( this.currentMenuCount == 0) {
			this.createInnerDropDown();
		}
		var tr = cel("tr");
		if (this.showDisplayValue != "false") {
			var displayValue = item['label'];
			this._createTD(tr, displayValue);
		}
		this._addColumns(tr, item);
	    tr.id = 'ac_option_' + item.name;
	    tr.setAttribute('role', 'option');
		return tr;  	
	},
   
   onDisplayDropDown: function() {
		var width = this.table.offsetWidth + 2;
		var height = this.table.offsetHeight + 2;
		
		this.getDropDown().style.width = width + "px";
		
		if (!g_isInternetExplorer) {
			width = width - 4;
			height = height - 4;
		}
			
		this.getIFrame().style.width = width + "px";
		this.getIFrame().style.height = height + "px";
   },
   
   _addColumns: function(tr, item) {
     var xml = item["XML"];
	 var fields = xml.getElementsByTagName("field");
		
	 for(var i = 0; i < fields.length; i++) {
		  var field = fields[i];
		  var value	 = field.getAttribute("value");
		  var td = $(this._createTD(tr, value));
	      if (this.prevText[i] == value) 
		    td.addClassName("ac_additional_repeat");
	      else 
		    this.prevText[i] = value;
			
		  td.addClassName("ac_additional");   
	  }	
   },
   
   _showMax: function(foundStrings, foundRecents) {
   		if (!this.rowCount)
			return;
	
		var max = 1 * this.max;
		var showing = Math.min(foundStrings.length, max);
		var recentsLength = foundRecents ? foundRecents.length : 0;
		var total = this.rowCount - recentsLength;
		var tr = cel("tr");
		$(tr).addClassName("ac_header");
		var td = cel("td", tr);
		td.setAttribute("colSpan", 99);
		td.setAttribute("width", "100%");
		var a = cel("a", td);		
		a.onmousedown = this._showAll.bindAsEventListener(this);
		if (this.rowCount >= 250) {
			a.innerHTML = new GwtMessage().getMessage("Showing 1 through {0} of more than {1}", showing, total);
		} else {
			a.innerHTML = new GwtMessage().getMessage("Showing 1 through {0} of {1}", showing, total);
		}
		this.appendElement(tr);	
   },
	_showRecents: function() {
		var tr = cel("tr");
		tr.className = "ac_header";
		var td = cel("td", tr);
		td.setAttribute('colspan', 99);
		td.setAttribute("width", "100%");
		td.innerHTML = new GwtMessage().getMessage("Recent selections");
		this.appendElement(tr);
	},
   
   _showAll: function() {
        this.clearTimeout();
		this.max = this.rowCount;
		this.timer = setTimeout(this.ajaxRequest.bind(this), g_key_delay);	
   },
   _createTD: function(tr, text) {
		var td = cel("td", tr);
		$(td).addClassName("ac_cell");
		td.innerHTML = text.escapeHTML(); 
		return td;  	
   },
   		
	_createTable: function() {
		this.table = cel("table");
		$(this.table).addClassName("ac_table_completer");
		
		this.tbody = cel("tbody", this.table);
		this.dropDown.appendChild(this.table);
		this.prevText = new Object();	
	}
});
;
/*! RESOURCE: /scripts/classes/ajax/AJAXEmailClientCompleter.js */
var g_key_delay = 250;
var AJAXEmailClientCompleter = Class.create(AJAXTableCompleter, { 
	PROCESSOR: "com.glide.email_client.EmailClient",
   
    initialize: function(element, reference, dependentReference, refQualElements, targetTable, inputSpan, options) {
		AJAXCompleter.prototype.initialize.call(this, 'AC.' + reference, reference);
		options = options || {};
		this.className = "AJAXEmailClientCompleter";
		this.inputSpan = inputSpan;
	    this.element = $(element);
	    this.keyElement = gel(reference);
		this.setTargetTable(targetTable);
		this.additionalValues = {};
		this.renderItemTemplate = null;
		if (options.renderItemTemplate) {
			this.renderItemTemplate = options.renderItemTemplate;
		}
		
		this._commonSetup();
		this.oneMatchSelects = true;
		this.clearDerivedFields = true;
		this.allowInvalid = this.element.readAttribute('allow_invalid')=='true';
    }, 
    
	_processDoc: function(doc) {
		AJAXTableCompleter._processDoc(doc);
	},
	
	keyDown: function(evt) {
		var typedChar = getKeyCode(evt);
		if (typedChar == KEY_ARROWUP) {
		  if( !this.selectPrevious()) 
            this.hideDropDown();		  	
		}  else if (typedChar == KEY_ARROWDOWN) {
			if (!this.isVisible()) {
				if (!this.isPopulated()) 
				  return; 
				  
				this.showDropDown();  
			}
			this.selectNext();
		}
	}, 
	
	keyUp: function(evt) {
		var typedChar = getKeyCode(evt);
		if (!this.isDeleteKey(typedChar)) 
			return; 
			
	    this.clearTimeout();
		this.timer = setTimeout(this.ajaxRequest.bind(this), g_acWaitTime || 50);
	},
	
	clearTimeout: function() {
		if (this.timer != null) 
		  clearTimeout(this.timer);
         this.timer = null;
	},
	
	keyPress: function(evtArg) {
		var evt = getEvent(evtArg);
		var typedChar = getKeyCode(evt);
				
		if (typedChar != KEY_ENTER && typedChar != KEY_RETURN)
			this.clearTimeout();  
		if (this.isNavigation(typedChar))
		  return true; 
	    if (!evt.shiftKey && (typedChar == KEY_ARROWDOWN || typedChar == KEY_ARROWUP))
	        return false;
			
		if (this.isDeleteKey(typedChar))
			return true; 			
			
		if (typedChar == KEY_ENTER || typedChar == KEY_RETURN || typedChar == KEY_TAB) {
			if (this.hasDropDown() && this.select()) 
				this.clearTimeout();
			else {
				this.onBlur();
				if (typedChar != KEY_TAB)
					this.hasFocus = true;
			}
				
			return false;
	    }
		
		if (typedChar == this.KEY_ESC) {
			this.clearDropDown();
			return false;
		}
	    this.timer = setTimeout(this.ajaxRequest.bind(this), g_key_delay);
		return true;
	}, 
	
	isNavigation: function(typedChar) {
		if (typedChar == this.KEY_LEFT)
		  return true;
		if (typedChar == this.KEY_RIGHT)
		  return true;
		if (typedChar == KEY_TAB && this.currentDisplayValue == "")
		  return true;
	},
	
	ajaxRequest: function() {
		var s = this.getDisplayValue();
		if (s.length == 0) {
			this.log("ajaxRequest returned no results");
			this.clearDropDown();
			this.searchChars = null;
			return;
		}
		
		if (s == "*")
		  return; 
		  
		if (s == this.searchChars) {
		  this.log("navigator key pressed");
		  return;
		}
		  
		this.searchChars = s;		
		this.clearKeyValue();
		
		this.log("searching for characters '" + this.searchChars + "'");
		var xml = this.cacheGet(s);  
		if (xml) {
			this.log("cached results found");
			this.processXML(xml);
			return;
		}
		
		if (this.cacheEmpty()) {
		  this.log("cache is empty");
		  this.clearDropDown();
		  this.hideDropDown();
		  return;
		}
        var url = "";
		url += this.addSysParms();  
		url += this.addTargetTable();
		url += this.addAdditionalValues();
		url += this.addAttributes("ac_");
		this.callAjax(url);
	},
	
	processXML: function(xml) {
		this.log("processing XML results");
		var e = xml.documentElement;
		this.rowCount = e.getAttribute('row_count');
	    this.max = e.getAttribute('sysparm_max');
	    
		var items = xml.getElementsByTagName("item");
		values = new Array();
	    for(var i = 0; i < items.length; i++) {
		  var item = items[i];
		  var array = this.copyAttributes(item);
		  array['XML'] = item;
		  values[values.length] = array;
	    }		
		
	    if (!this.hasFocus && this.currentDisplayValue == e.getAttribute("sysparm_chars")) {
    		this.log("checking value without focus");
    		this.ignoreFocusEvent = false;
	    	if ((values.length == 1) ||
	    		((values.length > 1) 
	    			&& (values[0]['label'] == this.getDisplayValue()) 
	    			&& (values[1]['label'] != this.getDisplayValue()))) {
	    		this.log("setting value without focus to " + values[0]['label'] + "->" + values[0]['name']);
	    		
	    		var selectionObj = {};
	    		selectionObj.sysId = values[0]['name'];
	    		selectionObj.label = values[0]['label'] || this.getEmailAddressFromACResultXML(values[0].XML);
	    		
	    		var addressFilterIds = this.getAddressFilterIds();
	    		if (addressFilterIds)
	    			this.proccessXmlResultAndValidateAgainstFilters(selectionObj, xml, addressFilterIds);
	    		else
	    			this.renderSelection(selectionObj.sysId, selectionObj.label);
	    	} else {
	    		if (e.getAttribute('allow_invalid') != 'true')
	    			this.setInvalid();
	    	}
	    	return;
	    }
		
		this.createDropDown(values);
	},
	
	addTargetTable: function() {
		var answer = "";
		if (this.getTargetTable()) {
			answer = "&sysparm_reference_target=" + this.getTargetTable();
		}
		return answer;
	},
	select: function() {
		if (this.selectedItemNum < 0) 
			return false;
		var acItem = this.getSelectedObject().acItem;
		var selectionObj = {};
		selectionObj.sysId = acItem['name'];
		selectionObj.label = acItem['label'] || this.getEmailAddressFromACResultXML(acItem.XML);
		var addressFilterIds = this.getAddressFilterIds();
		if (addressFilterIds)
			this.proccessXmlResultAndValidateAgainstFilters(selectionObj, acItem.XML, addressFilterIds);
		else
			this.renderSelection(selectionObj.sysId, selectionObj.label);
		return true;
	},
	
	renderSelection: function(sysId, label) {
		if (!sysId)
			return;
		var name = htmlEscape(sysId);
		var label = htmlEscape(label);
		this.referenceSelect(sysId, label);
		var s = gel(this.inputSpan);
		if (this.renderItemTemplate) {
			s.innerHTML = s.innerHTML + this.renderItemTemplate(sysId, label);
		} else {
s.innerHTML = s.innerHTML + '<span class="address" tabindex="-1" onclick="addressOnClick(event, this)" style="white-space:nowrap;" value="' + sysId + '" aria-label="' + label + '">' + label + ';</span> ';
		}
		this.resetInputField();
	},
	
	validateAgainstFilters: function(selectionObj, email, addressFilters) {
		var ga = new GlideAjax('EmailAddressValidator');
		ga.addParam("sysparm_name", "applyFilters");
		ga.addParam("sysparm_email_address", email);
		ga.addParam("sysparm_address_filters", addressFilters);
		ga.getXML(this.validateAgainstFiltersCallback.bind(this), null, selectionObj);
	},
	validateAgainstFiltersCallback: function(answer, requestParams) {
		var resultXml = answer.responseXML.documentElement.getElementsByTagName("result");
		if (resultXml && resultXml.length != 0) {
			var result = resultXml[0];
			var isValid = result.getAttribute('is_valid');
			if (isValid == 'true') {
				var sysId = requestParams.sysId;
				var label = requestParams.label;
				this.renderSelection(sysId, label);
			} else
				this.renderInvalidFromFilterResult(result);
		}
	},
	
	proccessXmlResultAndValidateAgainstFilters: function(selectionObj, resultXml, addressFilters) {
		var emailAddress = this.getEmailAddressFromACResultXML(resultXml);
		if (!emailAddress) {
			var table = this.getResultTableFromACResultXML(resultXml);
			if (table === 'sys_user_group') {
				this.renderSelection(selectionObj.sysId, selectionObj.label);
				return;
			}
		}
		this.validateAgainstFilters(selectionObj, emailAddress, addressFilters);
	},
	
	renderInvalidFromFilterResult: function(result) {
		if (!result)
			return;
		var invalidReason = result.getAttribute('invalid_reason');
		var emailAddress = result.getAttribute('email_address');
		this._setDisplayValue(emailAddress);
		if (resizeInput)
			resizeInput(this.element);
		this.invalidateInput(invalidReason);
	},
    _clearDisplayValue: function(v) {
        var e = this.getDisplayElement();
        e.value = "";
    },
   
   referenceSelect: function(sys_id, displayValue) {
		this.log("referenceSelect called with a display value of " + displayValue);
		this._setDisplayValue(displayValue);
		var e = this.getKeyElement(); 
		if (e.value != sys_id) {
			e.value = sys_id;
			callOnChange(e);
		}
		this.searchChars = displayValue;
		this.currentDisplayValue = displayValue;
		this.resetInvalidatedField();
		
		if (this.selectionCallBack && sys_id) {
			eval(this.selectionCallBack);
		}	
   },
	
	onBlur: function() {
		this.log("blur event");
		
 		this.hasFocus = false;
		
		if (this.getDisplayValue().length == 0) {
			if (this.currentDisplayValue != "")
				this.referenceSelect("","");
		} else if (this.selectedItemNum > -1) {
			this.select();
		} else if ((this.getKeyValue() == "") || (this.currentDisplayValue != this.getDisplayValue())) {
			var refInvalid = true;
			
			if (this.isExactMatch()) {
				var selectionObj = {};
				var o = this.getObject(0).acItem;
				selectionObj.sysId = o['name'];
				selectionObj.label = o['label'] || this.getEmailAddressFromACResultXML(o.XML);
				var addressFilterIds = this.getAddressFilterIds();
				if (addressFilterIds)
					this.proccessXmlResultAndValidateAgainstFilters(selectionObj, o.XML, addressFilterIds);
				else
					this.renderSelection(selectionObj.sysId, selectionObj.label);
				refInvalid = false;
			}
			
			if (refInvalid)
				this.setInvalid();
				
			if (refInvalid || !this.isPopulated()) {
				this.log("onBlur with no menu items requesting the reference for " + this.getDisplayValue());
			    this.clearTimeout();
			    this.searchChars = null;
			    this.ignoreFocusEvent = true;
				this.timer = setTimeout(this.ajaxRequest.bind(this), 0);
			}
		}
		
		this.clearDropDown();
	},
	
	isExactMatch: function() {
		if (this.isPopulated()) {
			if (this.getMenuCount() == 1) {
				var acItem = this.getObject(0).acItem;
				var label = acItem['label'];
				var displayValue = this.getDisplayValue();
				if (displayValue)
					displayValue = displayValue.toLocaleLowerCase();
				if (label)
					label = label.toLocaleLowerCase();
				if ((label == displayValue))
					return true;
				return false;
			}
				
			var o0 = this.getObject(0).acItem;
			var o1 = this.getObject(1).acItem;
			if ((o0['label'] == this.getDisplayValue()) && (o1['label'] != this.getDisplayValue()))
				return true;
		}
	},
	
	getAddressFilterIds: function() {
		return this.element.getAttribute('ac_email_address_filters');
	},
	
	getEmailAddressFromACResultXML: function(xml) {
		var email = '';
		var fields = xml.getElementsByTagName("field");
		if (fields && fields.length > 0) {
			var field = fields[0];
			if (field.getAttribute('name') === 'email')
				email = field.getAttribute('value');
		}
		return email;
	},
	
	getResultTableFromACResultXML: function(xml) {
		if (!xml)
			return "";
		return xml.getAttribute('sys_class_name');
	},
	hasDropDownWithResults: function() {
		var dropDown = this.getDropDown();
		if (!dropDown)
			return false;
		return dropDown.getElementsByTagName('tr').length > 0;
	},
	
	setTitle: function(message) {
		if (!message)
			this.getDisplayElement().removeAttribute('data-original-title');
		else
			this.getDisplayElement().setAttribute('data-original-title', message);
		this.getDisplayElement().title = message;
		var srInvalidMsg = document.getElementById('sr_invalid_msg');
		if (srInvalidMsg)
			srInvalidMsg.innerText = message;
	},
	
	invalidateInput: function(invalidReason) {
		this.setInvalid();
		this.setTitle(invalidReason);
		this.clearDropDown();
	},
	
	resetInputField: function() {
		this.element.value = "";
		this.currentDisplayValue = "";
		this.resetInvalidatedField();
		this.clearDropDown();
	},
	
	resetInvalidatedField: function() {
		this.clearInvalid();
		this.setTitle("");
	},
	cachePut: function (name, value) {
		this.cache[name] = value;
	},
	
	cacheGet: function(name) {
		return this.cache[name];
	}
});
;
/*! RESOURCE: /scripts/classes/ajax/AJAXReferenceChoice.js */
var AJAXReferenceChoice = Class.create(AJAXReferenceCompleter, { 
   
   addSysParms: function() {
		var sp = "sysparm_processor=PickList" +
		    "&sysparm_name=" + this.elementName + 
		    "&sysparm_timer=" + this.timer + 
		    "&sysparm_max=" + this.max + 
		    "&sysparm_chars=" + encodeText(this.searchChars);	
		return sp;	
	},
	
    ajaxRequest : function(onResponse) {
    	this.onResponse = onResponse;
        var url = "";
		url += this.addSysParms();  
		url += this.addDependentValue();
		url += this.addRefQualValues();
		url += this.addTargetTable();
		url += this.addAdditionalValues();
		url += this.addAttributes("ac_");
		url += "&sysparm_max=250";
		serverRequestPost("xmlhttp.do", url, this.ajaxResponse.bind(this));	
    },
    
    onBlur : function() {},
    onFocus : function() {},
    
	ajaxResponse: function(response) {
        if (!response.responseXML.documentElement) {
			this.isResolvingFlag = false;
			return;
		}
		
		var currentValue = this.element.value;
		this.element.options.length = 0;
		
		var items = response.responseXML.getElementsByTagName("item");
	    for (var i = 0; i < items.length; i++) {
		  var item = items[i];
		  var id = item.getAttribute('value');
		  var l = item.getAttribute('name');
		  var selected = id == currentValue;
		  addOption(this.element, id, l, selected) ;
	    }
	    if (typeof this.onResponse === "function") {
	      this.onResponse();
	    }
	}
   
});
;
/*! RESOURCE: /scripts/classes/ajax/DerivedFields.js */
var DerivedFields = Class.create({
	initialize : function(elementName, value) {
		this.elementName = elementName;
		this.value = value;
		this.isDerivedWaiting = typeof g_form !== 'undefined' && g_form._isDerivedWaiting(elementName);
		this.dfs = typeof g_form !== 'undefined' && g_form.getDerivedFields(elementName, true) || null;
	},
	clearRelated : function() {
		if (typeof g_form === 'undefined')
			return;
		
        var list = this.dfs;
        if (list == null)
           return;
           
        var prefix = this.elementName.split(".");
        var refFieldName = prefix.shift();
        prefix = prefix.join(".");
        for (var i = 0; i < list.length; i++) {
 		   var elname = prefix + "." + list[i];  
		   g_form._addDerivedWaiting(elname, refFieldName, g_form.isDisabled(elname));
		   var el = gel(refFieldName + '.' + elname);
		   if (el && el.getAttribute('choice') !== '3')
			   g_form.clearValue(elname);
        }
	},
	updateRelated : function(key) {
		if (typeof key === 'undefined')
			key = this.value;
		if (typeof key === 'undefined' || typeof g_form  === 'undefined')
			return;
		var list = this.dfs;
		if (list == null)
			return;
		if (key === '' && !this.isDerivedWaiting) {
			list.forEach(function(fn) {
				resetDerivedWaitingThenclearValue(this.elementName + '.' + fn);
			}, this);
			return;
		}
           
		list.forEach(function(fieldName) {
			var widgetName = 'sys_original.' + this.elementName + '.' + fieldName;
			var widget = gel(widgetName);
			if (widget)
				widget.value = '';
		}, this);
		if (key === '' && this.isDerivedWaiting)
			return;
		setDrivedFieldsValues(this.elementName, key, list);
	},
	isDerivedWaitingClearValue : function() {
		return this.value == '' && this.isDerivedWaiting;
	},
	
	toString: function() { return 'DerivedFields'; }
});
;
/*! RESOURCE: /scripts/classes/Select.js */
var Select = Class.create({
    initialize: function(select) {
        this.select = $(select);
    },
    addOption: function(value, label) {
        addOption(this.select, value, label);
    },
    
    addOptions: function(glideRecord, nameField, valueField) {
        if (!valueField) 
            valueField = 'sys_id';
        if (!nameField) 
            nameField = 'name';
        
        while (glideRecord.next()) 
            addOption(this.select, glideRecord[valueField], glideRecord[nameField]);
    },
    
    clear: function() {
        this.select.options.length = 0;
    },
    
    getSelect: function() {
        return this.select;
    },
    
    getValue: function() {
        return this.select.options[this.select.selectedIndex].value;
    },
    
    selectValue: function(value) {
        this.select.selectedIndex = -1;
        var options = this.select.options;
        for (oi = 0; oi < options.length; oi++) {
            var option = options[oi];
            var optval = option.value;
            if (optval != value) 
                continue;
            
            option.selected = true;
            this.select.selectedIndex = oi;
        }
    },
    
    contains: function(value) {
        var options = this.select.options;
        for (oi = 0; oi < options.length; oi++) {
            if (options[oi].value == value)
				return true;
        }
		return false;
    },
    
    getClassName: function() {
        return "SelectList";
    }
});
function addOption(select, value, label, selected, optionalTitle) {
	var o;
	if (select.multiple == true) 
		o = new Option(label, value, true, selected || false);
	else {
		if (label)
			label = label.unescapeHTML();
		o = new Option(label, value);
	}
	if (optionalTitle)
		o.title = optionalTitle;
	select.options[select.options.length] = o;
	if (select.multiple != true && selected)
		select.selectedIndex = select.options.length - 1;
	return o;
}
function addOptionAt(select, value, label, idx, optionalTitle) {
	for (var i = select.options.length; i > idx; i--) {
		var oldOption = select.options[i - 1];
		select.options[i] = new Option(oldOption.text, oldOption.value);
		if (oldOption.id)
			select.options[i].id = oldOption.id;
		if (oldOption.style.cssText)
			select.options[i].style.cssText = oldOption.style.cssText;
	}
	var o = new Option(label, value);
	if (optionalTitle)
		o.title = optionalTitle;
	select.options[idx] = o;
	return o;
}
function getSelectedOption(select) {
    if (typeof select == "undefined" || select.multiple == true || select.selectedIndex < 0) 
        return null;
    
    return select.options[select.selectedIndex];
}
;
/*! RESOURCE: /scripts/classes/GlideClientCache.js */
var GlideClientCacheEntry = Class.create({
	
	initialize: function(value) {
		this.value = value;
		this.bump();	
	},
	
	bump: function() {
		this.stamp = new Date().getTime();
	}
});
var GlideClientCache = Class.create({
	_DEFAULT_SIZE : 50,
	
	initialize: function(maxEntries) {
		if (maxEntries)
			this.maxEntries = maxEntries;
		else
			this.maxEntries = this._DEFAULT_SIZE;
			
		this._init('default');
	},
	
	_init : function(stamp) {
		this._cache = new Object();
		this._stamp = stamp;
	},
	
	put: function(key, value) {
		var entry = new GlideClientCacheEntry(value);
		this._cache[key] = entry;
		this._removeEldest();
	},
	
	get : function(key) {
		var entry = this._cache[key];
		if (!entry)
			return null;
		
		entry.bump();
		return entry.value;
	},
	
	stamp : function(stamp) {
		if (stamp == this._stamp)
			return;
			
		this._init(stamp);
	},
	ensureMaxEntries: function(max) {
		jslog("Cache resize to " + max);
		if (this.maxEntries < max)
			this.maxEntries = max;
	},
	
	_removeEldest : function() {
		var count = 0;
		var eldest = null;
		var eldestKey = null;
		for (key in this._cache) {
			count++;			
			var current = this._cache[key];
			if (eldest == null || eldest.stamp > current.stamp) {
				eldestKey = key;
				eldest = current;				
			}
		}
		if (count <= this.maxEntries)
				return;
				
		if (eldest != null)
			delete this._cache[key];
	}
});
;
/*! RESOURCE: /scripts/classes/GlideURLElement.js */
var GlideURLElement = Class.create({
	initialize: function(name, lockMessage, editMessage) {
		this.name = name;
		this.lockMessage = lockMessage;
		this.editMessage = editMessage;
		this.addonContainer = gel(name + "-addons");
		this.input = gel(name);
		this.currentButton = null;
if (this.addonContainer == null) {
			if (this.input.value == '') {
				var link = gel(this.name + "_link");
				link.tabIndex = -1;
			}
			return;
		}
		if (this.input != null && this.input.type != 'hidden' && this.input.value == '' && "true" == "true") {
			this.unlock();
			this.renderButton(false);
			return;
		}
		this.lock();
		this.renderButton(true);
	},
    setReadOnly: function(isReadonly) {
		if (this.input)
			this.input.readOnly = isReadonly;
if (this.addonContainer == null)
			return;
		if (isReadonly) {
			this.removeButton();
this.lock();
		} else if (this.currentButton == null)
this.renderButton(true);
	},
    setValue: function(value) { 
    	var link = gel(this.name + "_link");
    	link.href = value;
		link.innerHTML = htmlEscape(value);
if (this.addonContainer == null)
			link.tabIndex = value ? "0" : "-1";
		this.input.value = value;
		onChange(this.name);
    },
    
    isDisabled: function() {
		return this.currentButton == null;
    },
	getTabIndex: function(){
		return g_accessibility ? 0 : -1;
	},
	removeButton: function(){
		if (this.currentButton) {
this.currentButton.blur().remove();
		}
		this.currentButton = null;
	},
	renderButton: function(isLocked) {
		this.removeButton();
		if (this.addonContainer == null)
			return;
		var newButton;
		if (isLocked) {
			var urlElement = this;
var srSpan = $j('<span class="sr-only"></span>').attr("id", this.name + "_title_text").text(this.editMessage);
newButton = $j('<button class="btn btn-default btn-ref" type="button"><span class="icon icon-locked" aria-hidden="true"/></button>');
			newButton.attr("aria-labelledby", this.name + "_title_text")
				.attr("title", this.editMessage)
				.attr("tabindex", this.getTabIndex())
				.attr("id", this.name + "_unlock")
				.attr("data-ref", this.name)
				.attr("data-omit-aria-describedby", "true")
				.click(function() {
					urlElement.unlock();
					urlElement.renderButton(false);
urlElement.input.focus();
				})
				.append(srSpan);
		} else {
			var urlElement = this;
var srSpan = $j('<span class="sr-only"></span>').attr("id", this.name + "_title_text_lock").text(this.lockMessage);
newButton = $j('<button class="btn btn-default btn-ref" type="button"><span class="icon icon-unlocked" aria-hidden="true"/></button>');
			newButton.attr("aria-labelledby", this.name + "_title_text_lock")
				.attr("title", this.lockMessage)
				.attr("tabindex", this.getTabIndex())
				.attr("id", this.name + "_lock")
				.attr("data-ref", this.name)
				.attr("data-omit-aria-describedby", "true")
				.click(function() {
					urlElement.lock();
					urlElement.renderButton(true);
urlElement.currentButton.focus();
				})
				.append(srSpan);
		}
		this.currentButton = newButton;
		$j(this.addonContainer).prepend(newButton);
	},
	lock: function() {
		this.input.style.display = "none";
		var link = gel(this.name + "_link");
		link.href = this.input.value;
		link.tabIndex = !this.input.value ? "-1" : "0";
		link.style.removeProperty('display');
link.innerHTML = htmlEscape(this.input.value);
	},
	unlock: function() {
		this.input.style.removeProperty("display");
		var link = gel(this.name + "_link");
		link.style.display = "none";
	},
	type: "GlideURLElement",
	z: null
	
});
GlideURLElement.urlClickSave = function() {
	if (!g_form.submitted && g_form.modified) {
		var actionName = 'url_click_save';
		gsftSubmit(undefined, undefined, actionName);
		g_submitted = true;
		return false;
	} else {
		return false;
	}
};
;
/*! RESOURCE: /scripts/classes/GlideListElement.js */
var GlideListElement = Class.create({
	
	initialize: function(name, table) {
		this.name = name;
		this.table = table;
	},
	
	setValue: function(newValue, newDisplayValue) {
		var isArbitraryEmail = false;
var hiddenElement = gel(this.name);
var visibleElement = gel("select_0" + this.name);
		var readOnlyElementData = {
			values : [],
			displayValues : [],
			updateValue : function(value, displayValue){
				this.values.push(value);
				this.displayValues.push(displayValue);
			},
		};
		if(this.checkIfElementIsReadOnly(this.name)) {
			var labelElement = gel(this.name + "_label");
			labelElement.innerHTML = "";
		}else{
			this.visibleElementId = visibleElement.id;
			visibleElement.options.length = 0;
		}
		hiddenElement.value = "";
if (newValue || newDisplayValue) {
		    if (typeof newValue == "string" && newValue != "") {
newValue = newValue.split(",");
				if (typeof newDisplayValue == "undefined" || newDisplayValue == "")
					isArbitraryEmail = true;
		    }
		    if (typeof newDisplayValue == "string" && newDisplayValue != "")
				newDisplayValue = newDisplayValue.split(",");
			if (newDisplayValue && newValue && newDisplayValue.length != newValue.length) {
				newDisplayValue = '';
				isArbitraryEmail = true;
			}
			var allEmail = true;
			if (typeof newDisplayValue == "undefined" || newDisplayValue == "") {
				for (var i = 0; i < newValue.length; i++) {
					var item = newValue[i];
					if (item.indexOf("@") == -1) {
						allEmail = false;
						break;
					}
				}
if (!allEmail) {
					hiddenElement.value = newValue.join();
					var ajaxArgs = this.table + "," + newValue.join();
					var aj = new GlideAjax("ElementGlideListAjax");
					if(this.table === 'global') {
						aj.addParam("sysparm_name", this.name);
						aj.addParam("sysparm_type", "getChoiceLabels");
					} else
						aj.addParam("sysparm_type", "getDisplayValues");
					aj.addParam("sysparm_value", ajaxArgs);
					aj.getXML(this._glideListGetDisplayValuesDone.bind(this));
return;
				}
			} else
				allEmail = false;
			if (typeof newDisplayValue != "undefined" && newValue.length > 0 && newDisplayValue.length != newValue.length) {
				jslog("Error: Length of first and second parameter arrays to setValue for " + this.name + " are not the same");
				return;
			}
			if (typeof newDisplayValue != "undefined") {
				for (i = 0; i < newDisplayValue.length; i++) {
					if (allEmail){
						this._setValue("", newValue[i]);
						readOnlyElementData.updateValue("", newValue[i]);
					}else{
						this._setValue(newValue[i], newDisplayValue[i]);
						readOnlyElementData.updateValue(newValue[i], newDisplayValue[i]);
					}
				}
			} else if (allEmail && isArbitraryEmail) {
				for (var i = 0; i < newValue.length; i++) {
					this._setValue(newValue[i], newValue[i], true);
					readOnlyElementData.updateValue(newValue[i],newValue[i]);
				}
			} else {
				this._setValue("", newValue);
				readOnlyElementData.updateValue(newValue[i],newValue[i]);
			}
		}
 		if(this.checkIfElementIsReadOnly(this.name)){
 			this._updateReadOnlyDisplay(readOnlyElementData.values, readOnlyElementData.displayValues);
 		}else{
 			this._updateDisplay();
 		}
	},
	
	clearValue : function(noOnChange) {
var hiddenElement = gel(this.name);
var visibleElement = gel("select_0" + this.name);
		if (hiddenElement)
			hiddenElement.value = "";
		if(this.checkIfElementIsReadOnly(this.name)){
			this.clearReadOnlyValue();
			return;
		}
		if (visibleElement)
			visibleElement.options.length = 0;
		this._updateDisplay(!noOnChange);
	},
	clearReadOnlyValue : function(){
		var update_element = gel(this.name + '_label');
		update_element.innerHTML = "";
	},
	
	_setValue: function(newValue, displayValue, allEmails) {
		if(this.checkIfElementIsReadOnly(this.name)) return;
if (!newValue)
			addGlideListChoice(this.visibleElementId, displayValue, displayValue, false);
		else {
			addGlideListChoice(this.visibleElementId, newValue, displayValue, false);
			if (allEmails !== true)
				toggleAddMe(this.name);
		}
	},
	checkIfElementIsReadOnly : function(ref){
		var ele = gel(ref);
		if(!ele) return false;
		var canWrite = ele.getAttribute("writeaccess");
		return canWrite == "false";
	},
	_glideListGetDisplayValuesDone: function(response, args) {
		if (!response || !response.responseXML)
			return;
			
		var hiddenElement = gel(this.name);
		var readOnlyElementData = {
			values : [],
			displayValues : [],
			updateValue : function(value, displayValue){
				this.values.push(value);
				this.displayValues.push(displayValue);
			},
		};
		hiddenElement.values = "";
		var references = response.responseXML.getElementsByTagName("reference");
		var choices = response.responseXML.getElementsByTagName("choice");
		for (var i=0; i<references.length; i++) {
			var displayValue = references[i].attributes.getNamedItem("display").nodeValue;
			var referenceValue = references[i].attributes.getNamedItem("sys_id").nodeValue;
			this._setValue(referenceValue, displayValue);
			readOnlyElementData.updateValue(referenceValue,displayValue);
		}
		for (var i=0; i<choices.length; i++) {
			var displayValue = choices[i].attributes.getNamedItem("display").nodeValue;
			var value = choices[i].attributes.getNamedItem("value").nodeValue;
			this._setValue(value, displayValue);
			readOnlyElementData.updateValue(referenceValue,displayValue);
		}
 		if(this.checkIfElementIsReadOnly(this.name)){
 			this._updateReadOnlyDisplay(readOnlyElementData.values, readOnlyElementData.displayValues);
 		}else{
   			this._updateDisplay();
 		}
	},
	
	_showSpacer: function(display) {
		var spacer = gel("make_spacing_ok_" + this.name);
		if (spacer)
			spacer.style.display = "inline";
	},
	_updateDisplay: function(performOnChange) {
		if(this.checkIfElementIsReadOnly(this.name)) return;
		toggleGlideListIcons(this.name, performOnChange);
		var lockImg = gel(this.name+"_lock");
		var buttonContainer = gel(this.name);
		var buttonContainerVisible = buttonContainer ? buttonContainer.style.display == 'none' : true;
		if (lockImg && (lockImg.style.display == "none" || !buttonContainerVisible))
			this.updateLockedList('select_0' + this.name, this.name + '_nonedit');
	},
	_updateReadOnlyDisplay : function(newValues, displayValues){
		var update_element = gel(this.name + '_label');
		var hiddenElement = gel(this.name);
update_element.innerHTML = htmlEscape(displayValues.join(g_glide_list_separator));
		hiddenElement.value = newValues.join(",");
	},
	updateLockedList: function(current_value_id, update_id){
		var current_value = gel(current_value_id);
		var the_value = "";
		if (current_value.options) {
			for(var i=0; i<current_value.options.length ;i++) {
				if (i > 0)
					the_value += g_glide_list_separator;
				the_value += current_value.options[i].text;
			}
		}
		else
			the_value = current_value.value;
		var update_element = gel(update_id);
if (update_element.href)
			update_element.href = the_value;
update_element.innerHTML = htmlEscape(the_value);
	},
	setReadOnly: function(disabled) {
		var element = gel(this.name + "_unlock");
		var addMe = $("add_me_locked." + this.name);
		if (!element)
			return;
		element.setAttribute('list-read-only', "false");
		if (addMe)
			addMe.setAttribute('list-read-only', "false");
		
		if (disabled) {
			element.setAttribute('list-read-only', "true");
			lock(element, this.name, this.name + '_edit', this.name + '_nonedit', 'select_0' + this.name, this.name + '_nonedit');
			this._showSpacer();
			element.hide();
			if (addMe) {
				addMe.hide();
				addMe.setAttribute('list-read-only', "true");
			}
				
		} else {
			element.show();
			toggleAddMe(this.name);
		}
	},
	isDisabled: function() {
		var unlockElement = $(this.name + "_unlock");
		if(!unlockElement) return true;
		if (unlockElement.style.visibility == "visible")
			return false;
		return true;
	},
	type: "GlideListElement"
});
function viewSelection(sourceSelect, tableName, urlBase, idField, clickThroughPopup, popupView) {
	var sysid = glideListGetSelected(sourceSelect);
	if (clickThroughPopup && window.g_form) {
		var refTable = urlBase.substring(0, urlBase.lastIndexOf('.do'));
		var view = popupView || g_form.getViewName();
		tearOff(refTable, sysid, view, false, null);
		return;
	}
    checkSaveID(tableName, urlBase, sysid);
}
function glideListGetSelected(sourceSelect) {
	var selectedOptions = _glideListGetAllSelected(sourceSelect);
	if (!selectedOptions || selectedOptions.length !== 1)
		return;
	return selectedOptions[0].value;
}
function _glideListGetAllSelected(sourceSelect) {
	if (!sourceSelect)
		return;
	var options = Array.from(sourceSelect.options);
	return options.filter(function (opt) {
		return opt.selected;
	});
}
function editList(tableName, urlBase, idField, reference, maintainOrder, collectionLabel, listLabel) {
	g_form.setMandatoryOnlyIfModified(true);
	var g_dialog = new GlideModal('element_glide_list_slush_bucket', false, 900);
	g_dialog.setTitle(getMessage('Edit Members'));
	g_dialog.setPreference('fieldName', idField);
	g_dialog.setPreference('focusTrap', true);
	var form = document.forms[tableName+'.do'];
	form.setAttribute("target","add_or_remove_multiple_iframe");
	addInput(form, "HIDDEN", "sysparm_collection", tableName);
	addInput(form, "HIDDEN", "sysparm_collection_key", idField);
	addInput(form, "HIDDEN", "sysparm_collection_related_file", reference);
	if (collectionLabel)
		addInput(form, "HIDDEN", "sysparm_variable_collection", collectionLabel);
	if (listLabel)
		addInput(form, "HIDDEN", "sysparm_variable_list", listLabel);
	if (typeof maintainOrder !== "undefined")
		addInput(form, "HIDDEN", "sysparm_maintain_order", maintainOrder);
    var sysid = document.getElementsByName("sys_uniqueValue")[0].value;
    sysid = trim(sysid);    
	addInput(form, "HIDDEN", "sysparm_collectionID", sysid);
	var url = tableName+'.do?sys_id='+sysid;
    var view = gel('sysparm_view');
    if (view != null) {
       view = view.value;
       if (view != '')
          url = url + "&sysparm_view=" + view;
    }
    var changeset = gel('sysparm_changeset');
    if (changeset != null) {
        changeset = changeset.value;
        if (changeset != '')
            url = url + "&sysparm_changeset=" + changeset;
    }
    
    var sysparm_record_row = gel('sysparm_record_row');
    if (sysparm_record_row)
    	url = url + "&sysparm_record_row=" + sysparm_record_row.value;
    var sysparm_record_rows = gel('sysparm_record_rows');
    if (sysparm_record_rows)
    	url = url + "&sysparm_record_rows=" + sysparm_record_rows.value;
    var sysparm_record_list = gel('sysparm_record_list');
    if (sysparm_record_list)
    	url = url + "&sysparm_record_list=" + encodeURIComponent(sysparm_record_list.value);
	addInput(form, "HIDDEN", "sysparm_referring_url", url);
	getRefQualURI(tableName, "*");
	addInput(form, "HIDDEN", "sysparm_client_record", "session");
	form.sys_action.value = 'sysverb_m2ms';
	if (typeof form.onsubmit == "function") {
	  var rc = form.onsubmit();
	  if (!rc)
	     return;
	  g_form.modified = false;
	  if (window.CustomEvent.fireAll)
	  	 window.CustomEvent.fireAll('form.isModified', false);
	}
	g_dialog.render();
	g_dialog.on('bodyrendered', function() {
		if (this.$modalContent[0]){
			this.focusTrap = window.focusTrap(this.$modalContent[0]);
			this.focusTrap.activate();
			form.submit();
		}
	});
	g_dialog.on('closeconfirm', function() {
		g_form.enableMandatoryCheck();
		form.removeAttribute("target");
		form.removeClassName('form-submitted');
		if (g_form.submitted)
			g_form.submitted = false;
		if (this.focusTrap)
			this.focusTrap.deactivate();
	});
	return false;
}
function addGlideListChoice(selectID, value, displayValue,  toggleIcons) {
	if (!value)
		return;
	var ref = selectID.substring('select_0'.length);
	var select = new Select(selectID);
	CustomEvent.fire("element_mapping:glide_list_add", {
		id: ref,
		value: value,
		displayValue: displayValue
	});
	telemetryForRecordUpdateElement(selectID);
	if (select.contains(value)) 
		return;
	select.addOption(value, displayValue);
	if (typeof toggleIcons == "undefined" || toggleIcons == true)
		toggleGlideListIcons(ref);
	if($j) {
		$j(gel(ref)).trigger("change");
	}
}
function addEmailAddressToList(selectID, input, msg) {
	if (typeof input === "undefined")
		return;
	var ref = input.getAttribute('data-ref');
	g_form.hideErrorBox(ref);
	if (input.value == null || input.value == "")
		return;
	if (!isEmailValid(input.value)) {
		g_form.showErrorBox(ref, msg);
		return;
	}
	addGlideListChoice(selectID, input.value, input.value);
	input.value = "";
}
function emailInputKeyPress(e, selectID, input, msg) {
	if (typeof input === "undefined")
		return;
	var ref = input.getAttribute('data-ref');
	g_form.hideErrorBox(ref);
	var keyCode = getKeyCode(e);
	if (keyCode != KEY_ENTER)
		return;
	Event.stop(e);
	addEmailAddressToList(selectID, input, msg);
	return false;
}
function removefieldBackgroundText(the_field, the_text, ref) {
	if (the_field.value == the_text) {
        the_field.value = "";
        var standard_field = gel("select_0" + ref);
        the_field.style.color = standard_field.style.color;
        the_field.style.fontStyle = standard_field.style.fontStyle;
    }
}
function selectFromFieldList(selectID, depTableElementID, refTables, types, title, evt, matchTypesAndTables) {
	if (evt)
		Event.stop(evt);
	var depElement = gel(depTableElementID);
	if (!depElement) {
		jslog("Dependent table not found for list");
		return;
	}
		
	var table = depElement.value;
	if (!table) {
		jslog("Dependent table not specified for list");
		return;
	}
	
	var gDialog = new GlideDialogWindow('field_list_selector');
    gDialog.setTitle(title);
	gDialog.setPreference('sysparm_elementID', selectID);
	gDialog.setPreference('sysparm_table', table);
	gDialog.setPreference('sysparm_ref_tables', refTables);
	gDialog.setPreference('sysparm_types', types);
gDialog.setPreference('sysparm_prefix', '__dollar__{');
	gDialog.setPreference('sysparm_suffix', '}');
	gDialog.setPreference('sysparm_match_types_and_tables', matchTypesAndTables);
	gDialog.setPreference('set_request_params', 'true');
	gDialog.render();
	gDialog = null;
}
function addGlideListReference(fieldid) {
    var value = gel(fieldid).value;
    var displayWidget = gel('sys_display.' + fieldid);
    var display = displayWidget.value;
    displayWidget.value = '';
	addGlideListChoice('select_0' + fieldid,  value, display);
}
function addGlideListFromSelect(selectID, select) {
	var option = select.options[select.selectedIndex];
	addGlideListChoice(selectID, option.value, option.label);
}
function addfieldBackgroundText(the_field, the_text) {
    if (the_field.value == "") {
        the_field.value = the_text;
        the_field.save_old_color = the_field.style.color;
        the_field.style.color = "blue";
        the_field.style.fontStyle = "italic";
    }
}
function setRemovalNotification(id) {
	var msg = new GwtMessage();
	var notification = gel('aria-removal-notification.' + id);
	if (!notification)
		return;
	var select = gel('select_0' + id);
	var selectedOptions = _glideListGetAllSelected(select);
	if (!selectedOptions)
		return;
	var text = !selectedOptions.length
		? msg.getMessage('nothing was selected')
		: selectedOptions.map(function(opt) {
			return msg.getMessage('{0} was successfully removed', opt.text);
		  }).join(', ');
	if (notification.innerText === text)
text += '!';
	notification.innerText = text;
}
function toggleGlideListIcons(id, performOnChange) {
	var add_me = gel('add_me.' + id);
	var remove = gel('remove.' + id);
	var view2 = gel('view2.' + id);
	if (!view2)
		view2 = gel('view2link.' + id);
	var select = gel('select_0' + id);
	var options = select.options;
	var selCnt = 0;
	var isMe = false;
	for (var i = 0; i != options.length; i++) {
		if (options[i].selected)
			selCnt++;
		if (typeof g_user !== "undefined" && options[i].value == g_user.userID)
			isMe = true;
	}
	if (view2) {
		var isEmail = false;
		var selectText = ''
		if (selCnt == 1) {
			var selectValue = select.options[select.selectedIndex].value;
			selectText = select.options[select.selectedIndex].text;
			if (selectValue.indexOf("@") > -1) {
if (selectValue == selectText)
					isEmail = true;
			}
		}
		var view2Link = gel('view2link.' + id);
		if (selCnt == 1 && !isEmail) {
view2.src = 'images/icons/hover_icon_small2.gifx';
			view2Link.disabled = false;
			var clickThrough = (view2Link.getAttribute('data-clickthrough') === 'true');
			var ariaLabel = (clickThrough) ? 'Open selected item: {0}' : 'Preview selected item: {0}';
			view2Link.setAttribute('aria-label', new GwtMessage().getMessage(ariaLabel, selectText));
		} else {
view2.src = 'images/icons/hover_icon_small2_off.gifx';
			view2Link.disabled = true;
			view2Link.removeAttribute('aria-label');
		}
	}
	if (remove) {
		if (selCnt > 0)
			if (remove.tagName == "BUTTON")
				remove.disabled = false;
			else
remove.src = 'images/delete_edit.gifx';
		else
			if (remove.tagName == "BUTTON")
				remove.disabled = true;
			else
remove.src = 'images/delete_edit_off.gifx';
	}
	if (add_me) {
		if (!isMe)
			if (add_me.tagName == "BUTTON")
				add_me.disabled = false;
			else
add_me.src = 'images/icons/user_obj.gifx';
		else
			if (add_me.tagName == "BUTTON")
				add_me.disabled = true;
			else
add_me.src = 'images/icons/user_obj_off.gifx';
	}
						
	add_me = null;
	remove = null;
	view2 = null;
	options = null;
	if (typeof performOnChange != "undefined")
		if (performOnChange == false)
			return;
	
	glideListSaveList(id);
	if (isCatalogGlideList(id))
		variableOnChange(id);
}
function isCatalogGlideList(id) {
	return ((id.startsWith("IO:") || id.startsWith("ni.VE") || id.startsWith("ni.QS")) && typeof (variableOnChange) == 'function')
}
function toggleAddMe(id) {
	var add_me_locked = $('add_me_locked.' + id);
	if (!add_me_locked)
		return;
	var select = gel('select_0' + id);
	var options = select.options;
	var isMe = false;
	for (var i = 0; i != options.length; i++) {
		if (options[i].value == g_user.userID) {
			isMe = true;
			break;
		}
	}
	var unlockImg = $(id + "_unlock");
	if (isMe)
		add_me_locked.hide();
	else if (unlockImg.style.display == "none")
		add_me_locked.hide();
	else
		add_me_locked.show();
}
function glideListSaveList(id) {
    var sel0 = gel('select_0' + id);
    var distribution = gel(id);
    saveAllSelected([ sel0 ], [ distribution ], ',', '\\', '--None--');
    if (!isCatalogGlideList(id))
    onChange(id);
}
function glideListViewSelection(id, refParent, reference, clickThroughPopup) {
	var view2Link = gel("view2link." + id);
	if (view2Link.disabled == true)
		return false;
	var popupView = view2Link.getAttribute('data-popup-view');
	viewSelection(gel("select_0"+id), refParent, reference + ".do", id, clickThroughPopup === 'true', popupView);
}
function glideListPopupSelection(event, id, table) {
	var select = gel("select_0"+id);
	var sysid = glideListGetSelected(select);
	if (sysid) {
		popRecordDiv(event, table, sysid);
		telemetryForPreviewRecord(id, table);
	}
}
function glideListInitReadOnly(id, ref, reference){
	var listObject = new GlideListElement(ref, reference);
	g_form.registerHandler(ref, listObject);
}
function glideListInit(id, ref, reference) {
	var sel = gel(id);
	if (sel.form) {
		addOnSubmitEvent(sel.form, function() {
			saveAllSelected([ gel(id) ], [ gel(ref) ], ',', '\\', '--None--');
		 });
	}
	var listObject = new GlideListElement(ref, reference);
	g_form.registerHandler(ref, listObject);
	toggleGlideListIcons(ref, false);
	var dynamicTable = gel(ref).getAttribute("data-dynamic-table-dependent");
	if (dynamicTable) {
		$j(gel(dynamicTable)).on("change", function() {
			var value = $j(this).val();
			var display = gel("sys_display." + ref);
			display.setAttribute("data-reference", value);
			if (display.ac) {
				display.ac.setAdditionalValue('sysparm_ref_override', value);
			}
			$j(gel(ref)).val("");
			$j(gel('select_0' + ref)).find('option').remove().end().val("");
			CustomEvent.fire("element_mapping:glide_list_table_changed", {
				id: ref,
				newTable: value
			});
		})
	}
	var $look = $j('[id="lookup.' + ref + '"]:not(.sn-popover-complex)');
	if ($look.length) {
		$look.on('click keydown', function(e) {
			if (e.type === "keydown" && !($j.ui.keyCode.ENTER === e.which || $j.ui.keyCode.SPACE === e.which)) return;
			var dsp = $j(gel("sys_display." + ref));
			reflistOpen(ref,
				dsp.attr("data-name"),
				dsp.attr('data-reference'),
				dsp.attr('data-dependent'),
				'false',
				dsp.attr('data-ref-qual'),
				null,
				null,
				null,
				true);
			mousePositionSave(e);
			e.preventDefault();
			e.stopPropagation();
		});
	}
}
function safeAriaLiveAssertive(message) {
	if (window.NOW && window.NOW.accessibility && window.NOW.accessibility.ariaLiveAssertive) {
		window.NOW.accessibility.ariaLiveAssertive(message);
	}
}
;
/*! RESOURCE: /scripts/classes/GlideUserImageElement.js */
var GlideUserImageElement = Class.create({
    initialize: function(name) {
        this.name = name;
        this._ieResize();
    },
	isTemplatable: function(){
		return false;
	},
	isReadOnly : function(){
		var $element = $(this.name);
		return $element.hasClassName('readonly') || $element.getAttribute("writeaccess") == "false";
	},
    setReadOnly: function(disabled) {
		var element = gel(this.name);
        var editButtons = gel("edit." + this.name);
        var addButton = gel("add." + this.name);
        var image = gel("image." + this.name);
		if (element)
			element.readOnly = disabled;
        if (disabled) {
            hideObject(editButtons);
            hideObject(addButton);
        } else { 
            showObjectInline(editButtons);
            if (!image)
                showObjectInline(addButton);
        }
    },
	
	isDisabled: function() {
        var editButtons = $("edit." + this.name);
		if (editButtons && editButtons.visible())
			return false;
		var addButton = $("add." + this.name);
		if (addButton && addButton.visible())
			return false;
		
		return true;				
	},
	
	_ieResize: function() {
		var iInput = gel("image." + this.name);
		if (isMSIE && iInput) {
			var image = $(iInput.value);
			
			var height = image.getLayout().get('height');
			var maxHeight = parseInt(image.getStyle('max-height').sub('px', ''), 10);
			
			var width = image.getLayout().get('width');
			var maxWidth = parseInt(image.getStyle('max-width').sub('px', ''), 10);
			
			if (height > maxHeight || width > maxWidth) {
var widthRatio = width / maxWidth;
var heightRatio = height / maxHeight;
				
				if (widthRatio > heightRatio)
					image.width = maxWidth;
				else 
					image.height = maxHeight;
			}
		}
	}
});  
;
/*! RESOURCE: /scripts/classes/FieldListElement.js */
var FieldListElement = Class.create({
	initialize: function(name, dependent, dependentTable, defaultDisplayName, newRecord, excludeDotWalk) {
		this.name = name;
		this.dependent = dependent;
		this.table = dependentTable == "null" ? null : dependentTable;
		this.excludeDotWalk = excludeDotWalk;
this.defaultDisplayName = (defaultDisplayName == "true");
		if (this.defaultDisplayName)
this.tableChanged = (newRecord == "true");
		else
			this.tableChanged = false;
this.displayName = "";
		this.lastValue = "";
		this.initialSetup = true;
		this.fetching = false;
		this.valuesToSet = null;
	},
	onLoad: function() {
		if (!this.table) {
			var table = resolveDependentValue(this.name, this.dependent, this.table);
			this.table = table;
		}
		var processGlideVarInput = document.getElementById('ni.' + this.name + '.list_item_id');
		processGlideVarInput.onchange = this.processGlideVars.bind(this);
		this._listCols();
	},
	depChange: function() {
		gel(this.name).value = "";
		this._setTableName();
	},
	moveOptionUpdate: function(sourceSelect, targetSelect, keepSourceLabel, unmovableSourceValues, keepTargetLabel,
							   direction, property) {
		moveOption(sourceSelect, targetSelect, keepSourceLabel, unmovableSourceValues, keepTargetLabel,
			direction, property);
		this._setListValues();
	},
	moveUpUpdate: function(select) {
		moveUp(gel(select));
		this._setListValues();
	},
	moveDownUpdate: function(select) {
		moveDown(gel(select));
		this._setListValues();
	},
	_listCols: function() {
		this.fetching = true;
		var colist = gel(this.name);
		var url = "xmlhttp.do?sysparm_processor=ListColumns&sysparm_exclude_dot_walk=" + this.excludeDotWalk + "&sysparm_expanded=0&sysparm_name=" + this.table +
			"&sysparm_include_display_name=true&sysparm_qualified_field_name=" + this.name;
		if (colist.value.length > 0)
			url += "&sysparm_col_list=" + colist.value;
		jslog("FieldListElement: _listCols calling AJAX " + url);
		serverRequest(url, this._colsReturned.bind(this), null);
	},
	_colsReturned: function(request) {
		jslog("FieldListElement: _colsReturned AJAX response received");
		var tcols = request.responseXML;
		var scols = gel("ni." + this.name + ".select_1");
		scols.options.length = 0;
		var acols = gel("ni." + this.name + ".select_0");
		acols.options.length = 0;
		var colist = gel(this.name);
		var mfields = new Array();
		var useSpecFields = false;
		var root = tcols.getElementsByTagName("xml")[0];
		this.displayName = root.getAttribute("displayName");
		if (this.tableChanged) {
			if (this.defaultDisplayName)
				colist.value = this.displayName;
			else
				colist.value = '';
		}
		if (colist.value.length > 0) {
			mfields = colist.value.split(",");
			if (mfields.length > 0)
				useSpecFields = true;
		}
		var items = tcols.getElementsByTagName("item");
		for (var i = 0; i != items.length; i++) {
			var item = items[i];
			var value = item.getAttribute("value");
			var label = item.getAttribute("label");
			var ref = item.getAttribute("reference");
			if (ref) {
				if(ref == '')
					ref = null;
			}
			if (valueExistsInArray(value, mfields)) {
				scols.options[scols.options.length] = this._enhanceOption(item, value, label, root, "selected");
				if (ref)
					acols.options[acols.options.length] = this._enhanceOption(item, value, label, root, "available");
			} else {
				acols.options[acols.options.length] = this._enhanceOption(item, value, label, root, "available");
			}
		}
		if (useSpecFields) {
			var newOptions = new Array();
			for(var i = 0; i != mfields.length; i++) {
				var s = mfields[i];
				for(var z = 0; z != scols.options.length; z++) {
					if (scols.options[z].value == s) {
						newOptions[newOptions.length] = scols.options[z];
						break;
					}
				}
			}
	
			scols.options.length = 0;
			for(var i = 0; i != newOptions.length; i++) {
				scols.options.add(newOptions[i]);
			}
		}
		this._setListValues();
		this.fetching = false;
		if (this.valuesToSet === null)
			return;
		this.setValue(this.valuesToSet.value, this.valuesToSet.displayValue);
		this.valuesToSet = null;
	},
    _fireSetValueEvent : function() {
        if(typeof g_form != 'undefined') {
			var form = g_form.getFormElement();
			if(typeof form != 'undefined')
				$(form).fire('glideform:setvalue');
		}
    },
    
	_enhanceOption: function (item, value, label, root, status) {
		var ref = null;
		var xlabel = label;
		if (status != "selected") {
			ref = item.getAttribute("reference");
			if (ref) {
				if(ref != '') {
					xlabel += " (+)";
				} else
					ref = null;
			}
		}
		var o = new Option(xlabel, value);
		o.cv = value;
		o.cl = label;
		if (ref) {
			o.tl = item.getAttribute("reflabel");
			o.className = 'text-success';
			o.reference = ref;
			o.doNotDelete = 'true';
			if (root) {
				o.bt = root.getAttribute("name");
				o.btl = root.getAttribute("label");
			}
		}
		o.type = item.getAttribute('type');
		var elementAttributes = item.getAttribute('attributes');
		if (elementAttributes) {
			o.elementAttributes = this._setNamedAttributes(o, elementAttributes);
		}
		return o;
	},
	_setNamedAttributes: function(o, attrs) {
		o.namedAttributes = o.namedAttributes || {};
		if (!attrs)
			return;
		var pairs = attrs.split(',');
		for (var i = 0; i < pairs.length; i++) {
			var parts = pairs[i].split('=');
			if (parts.length == 2)
				o.namedAttributes[parts[0]] = parts[1];
		}
	},
	_setTableName: function() {
		var table = resolveDependentValue(this.name, this.dependent, this.table);
		if (table != this.table) {
			this.tableChanged = true;
			this.table = table;
			this._listCols(table);
		}
	},
	_setListValues: function() {
		var scols = gel("ni." + this.name + ".select_1");
		var values = "";
		var text = "";
		var count = 0;
		for (var i=0; i < scols.length; i++) {
			var opt = scols.options[i];
			if (opt.value && opt.value != "--None--") {
				if (count > 0) {
					values += ",";
					text += ", ";
				}
				values += opt.value;
				text += opt.text;
				count++;
			}
		}
		gel(this.name).value = values;
		var nonedit = gel(this.name+"_nonedit");
		if (nonedit)
			nonedit.innerText = text;
		this.tableChanged = false;
		if (this.lastValue != values) {
			this.lastValue = values;
			if (!this.initialSetup)
				onChange(this.name);
		}
		
		if (this.initialSetup)
			this._fireSetValueEvent();
		this.initialSetup = false;
	},
	setReadOnly: function(disabled) {
		if (disabled) {
			var unlockElement = gel(this.name + "_unlock");
			lock(unlockElement, this.name, this.name + '_edit', this.name + '_nonedit', 'ni.' + this.name + '.select_1', this.name + '_nonedit');
			hideObject(unlockElement);
		} else if (gel(this.name + '_edit').style.display == "none") {
			var unlockElement = gel(this.name + "_unlock");
			if (isDoctype())
				showObjectInlineBlock(unlockElement);
			else
				showObjectInline(unlockElement);
		}
		gel(this.name).disabled = disabled;
		return true;
	},
	isDisabled: function() {
		var unlockElement = $(this.name + "_unlock");
		if (unlockElement && unlockElement.visible())
			return false;
		return true;
	},
	setValue: function(value, displayValue) {
		if (this.fetching) {
			this.valuesToSet = {
				value: value,
				displayValue: displayValue
			};
			return;
		}
gel(this.name).value = value;
		var acols = gel("ni." + this.name + ".select_0");
		var scols = gel("ni." + this.name + ".select_1");
		if (typeof value == "string"){
			value = value.split(",");
		}
		if (typeof displayValue == "string"){
			displayValue = displayValue.split(",");
		}
		if ( value && displayValue) {
			if (value.length != displayValue.length) {
				jslog("FieldListElement " + this.name +
				".setValue() received value and displayValue parameters of different lengths");
				return;
			}
		}
		var selectedIds = new Array();
		var index = 0;
		for (var i = 0; i < scols.options.length; i++) {
			selectedIds[index] = i;
			index++;
		}
		if (index > 0) {
			moveSelectedOptions(selectedIds, scols, acols, '--None--', ['home'], '--None--');
		}
		var text = [];
		var validValue = new Array;
		for (var i = 0; i < value.length; i++) {
			var v = value[i];
			var aIndex = this._getOptionIndex(acols, v);
if (aIndex > -1) {
				selectedIds = new Array();
				selectedIds[0] = aIndex;
				text.push(acols.options[aIndex].text);
				validValue[i] = v;
				moveSelectedOptions(selectedIds, acols, scols, '--None--', [], '--None--');
} else {
				if (displayValue && displayValue[i]){
					addChoiceFromValueAndDisplay(scols, v, displayValue[i]);
					text.push(displayValue[i]);
					validValue[i] = v;
				}
			}
		}
        
		if(validValue.length > 0)
			this.lastValue = validValue.join(',');
		var nonedit = gel(this.name+"_nonedit");
		if (nonedit) {
			nonedit.innerHTML = text.join(', ');
		}
		onChange(this.name);
	},
	processGlideVars: function() {
		if (!this.name)
			return;
		var prefix = 'ni.' + this.name + '.';
		var item = document.getElementById(prefix + 'list_item_id');
		var itemId = item && item.value;
		if (itemId) {
			var select = document.getElementById(prefix + 'select_0');
			var option = getSingleSelectedOption(select);
			var table = getTablenameFromOption(option);
			var glideAjax = new GlideAjax('GlideVarItemsProcessor');
			glideAjax.addParam('sysparm_type', 'get_item_variables');
			glideAjax.addParam('sysparm_item_id', itemId);
			glideAjax.addParam("sysparm_name", table);
			glideAjax.getXML(setVariableOptions, null, [prefix, itemId, option.value]);
		}
	},
	_getOptionIndex: function(select, value) {
		for (var i=0; i<select.length; i++)
			if (select.options[i].value == value)
				return i;
		return -1;
	},
	type: function() {
		return "FieldListElement";
	}
});
;
/*! RESOURCE: /scripts/classes/OrderListElement.js */
var OrderListElement = Class.create({
	initialize: function(name, newRecord) {
		this.name = name;
		this.lastValue = "";
		this.initialSetup = true;
		var nonedit = gel(this.name+"_nonedit");
	},
	onLoad: function() {
		var values = gel(this.name).value;
		this.setValue(values);
	},
	moveOptionUpdate: function(sourceSelect, targetSelect, keepSourceLabel, unmovableSourceValues, keepTargetLabel,
							   direction, property) {
		moveOption(sourceSelect, targetSelect, keepSourceLabel, unmovableSourceValues, keepTargetLabel,
			direction, property);
		this._setListValues();
	},
	moveUpUpdate: function(select) {
		moveUp(gel(select));
		this._setListValues();
	},
	moveDownUpdate: function(select) {
		moveDown(gel(select));
		this._setListValues();
	},
    _fireSetValueEvent : function() {
        if(typeof g_form != 'undefined') {
			var form = g_form.getFormElement();
			if(typeof form != 'undefined')
				$(form).fire('glideform:setvalue');
		}
    },
	_setListValues: function() {
		var scols = gel("ni." + this.name + ".select_1");
		var displayValues = [];
		var text = "";
		var count = 0;
		for (var i=0; i < scols.length; i++) {
			var opt = scols.options[i];
			if (opt.value && opt.value != "--None--") {
				if (count > 0) {
					text += ", ";
				}
				displayValues.push({label: opt.text, value: opt.value});
				text += opt.text;
				count++;
			}
		}
		gel(this.name).value = JSON.stringify(displayValues);
		var nonedit = gel(this.name+"_nonedit");
		if (nonedit){
			nonedit.innerText = text;
		}
		if (this.lastValue != displayValues) {
			this.lastValue = displayValues;
			if (!this.initialSetup)
				onChange(this.name);
		}
		
		if (this.initialSetup)
			this._fireSetValueEvent();
		this.initialSetup = false;
		nonedit.style.visibility = "visible";
	},
	setReadOnly: function(disabled) {
		if (disabled) {
			var unlockElement = gel(this.name + "_unlock");
			lock(unlockElement, this.name, this.name + '_edit', this.name + '_nonedit', 'ni.' + this.name + '.select_1', this.name + '_nonedit');
			hideObject(unlockElement);
		} else if (gel(this.name + '_edit').style.display == "none") {
			var unlockElement = gel(this.name + "_unlock");
			if (isDoctype())
				showObjectInlineBlock(unlockElement);
			else
				showObjectInline(unlockElement);
		}
		gel(this.name).disabled = disabled;
		return true;
	},
	isDisabled: function() {
		var unlockElement = $(this.name + "_unlock");
		if (unlockElement && unlockElement.visible())
			return false;
		return true;
	},
	setValue: function(values) {
		if(!values) return;
		values = typeof values === "string" ? JSON.parse(values) : values;
		var scols = gel("ni." + this.name + ".select_1");
		scols.options.length = 0
		values
			.forEach(function(value) {
				scols.options[scols.options.length] =  new Option(value.label, value.value);
			});
		
		this._setListValues();
		var unlockElement = gel(this.name + "_unlock");
		lock(unlockElement, this.name, this.name + '_edit', this.name + '_nonedit', 'ni.' + this.name + '.select_1', this.name + '_nonedit');
		onChange(this.name);
	},
	type: function() {
		return "OrderListElement";
	}
});
;
/*! RESOURCE: /scripts/classes/GlideTimeElement.js */
var GlideTimeElement = Class.create({
	initialize: function(name, initialValue) {
		this.name = name;
		if (initialValue)
			this.setValue(initialValue)
	},
	setValue: function(value, displayValue) {
		if (value == "")
			value = "00:00:00";
		var hours = 0;
		var mins = 0;
		var secs = 0;
		var ampm = "";
		var dateFormat = gel(this.name + '_format').value;
		if (value == "00:00:00") {
if (dateFormat.indexOf("hh") > -1) {
				hours = 12;
				ampm = "AM";
			}
		} else {
			var timeObject = this._getTimeFromFormat(value, dateFormat);
			if (!timeObject) {
				this.log("setValue aborted; unable to interpret time '" + value + "' for format '" + dateFormat + "'");
				return;
			}
			hours = timeObject.hh;
			mins = timeObject.mm;
			secs = timeObject.ss;
			ampm = timeObject.ampm;
		}
		hours = this._LZ(hours, (dateFormat.toLowerCase().indexOf("hh") > -1));
		mins = this._LZ(mins, (dateFormat.toLowerCase().indexOf("mm") > -1));
		secs = this._LZ(secs, (dateFormat.toLowerCase().indexOf("ss") > -1));
		gel(this.name + 'dur_hour').value = hours;
		gel(this.name + 'dur_min').value = mins;
		var secondsInput = gel(this.name + 'dur_sec');
		if (secondsInput)
			secondsInput.value = secs;
	    var ampmw = gel(this.name + 'dur_ampm');
	    if (ampmw)
	       if (ampm)
	          ampmw.value = ampm;
		if ("undefined" === typeof g_form)
GlideTimeElement.updateRealTime(this.name);
		else {
			g_form._internalChange = true;
GlideTimeElement.updateRealTime(this.name);
			g_form._internalChange = false;
		}
	},
	setReadOnly: function(disabled){
		gel(this.name + "dur_hour").disabled = disabled;
		gel(this.name + "dur_min").disabled = disabled;
		var secondsInput = gel(this.name + 'dur_sec');
		if (secondsInput)
			secondsInput.disabled = disabled;
		var dateFormat = gel(this.name + '_format').value;
		if(dateFormat.indexOf("z") > -1)
			gel(this.name + "dur_ampm").disabled = disabled;
		gel(this.name).disabled = disabled;
	},
	_LZ: function(val, padded) {
		if (!padded) {
			if (val.length > 1)
				if (val.charAt(0)=='0')
					val = val.substring(1);
			return val;
		}
		val += "";
		if (val.length < 2)
			val = "0" + val;
		return val;
	},
	_getTimeFromFormat: function(val, format) {
		val = trim(val);
		var i_val=0;
		var i_format = 0;
		var c = "";
		var token = "";
		var hh="", mm="", ss="", ampm="";
		while (i_format < format.length) {
			c=format.charAt(i_format);
			token="";
			while ((format.charAt(i_format)==c) && (i_format < format.length)) {
				token += format.charAt(i_format++);
			}
			if (token=="hh"||token=="h") {
				hh=this._getInt(val,i_val,token.length,2);
				if(hh==null||(hh<1)||(hh>12)) {
					this.log("bad hours: " + hh);
					return;
				}
				i_val+=hh.length;
			} else if (token=="HH"||token=="H") {
				hh=this._getInt(val,i_val,token.length,2);
				if(hh==null||(hh<0)||(hh>23)) {
					this.log("bad hours: " + hh);
					return;
				}
				i_val+=hh.length;
			} else if (token=="mm"||token=="m") {
				mm=this._getInt(val,i_val,token.length,2);
				if(mm==null||(mm<0)||(mm>59)) {
					this.log("bad minutes: " + mm);
					return;
				}
				i_val+=mm.length;
			} else if (token=="ss"||token=="s") {
				ss=this._getInt(val,i_val,token.length,2);
				if(ss==null||(ss<0)||(ss>59)) {
					this.log("bad seconds: " + ss);
					return;
				}
				i_val+=ss.length;
			} else if (token=="a"||token=="aa") {
				if (val.substring(i_val,i_val+2).toLowerCase()=="am")
					ampm="AM";
				else if (val.substring(i_val,i_val+2).toLowerCase()=="pm")
					ampm="PM";
				else {
this.log("bad AM/PM: " + val.substring(i_val,i_val+2));
					return;
				}
				i_val+=2;
			} else {
				if (val.substring(i_val,i_val+token.length)!=token) {
					this.log("time did not match format at character " + i_val);
					return;
				} else
					i_val+=token.length;
			}
		}
		if (i_val != val.length) {
			this.log("time includes trailing characters");
			return;
		}
		return {hh:hh, mm:mm, ss:ss, ampm: ampm};
	},
	_getInt: function(str,i,minlength,maxlength) {
		for (var x=maxlength; x>=minlength; x--) {
			var token=str.substring(i,i+x);
			var intPart = this._getInteger(token);
			if (intPart != "")
				return intPart;
		}
		return null;
	},
	_getInteger: function(val) {
		var digits="1234567890";
		for (var i=0; i < val.length; i++) {
			if (digits.indexOf(val.charAt(i))==-1)
				return val.substring(0,i);
		}
		return val;
	},
	log: function(msg) {
		jslog("GetTimeElement - " + msg);
	},
	type: function() {
		return "GlideTimeElement";
	}
});
GlideTimeElement.updateRealTime = function(ref) {
	var sdata = gel(ref);
	var hour = gel(ref + 'dur_hour');
	var min = gel(ref + 'dur_min');
	var sec = "";
	var ampm = "";
	var dateFormat = gel(ref + '_format').value;
	if (dateFormat.indexOf("a") > -1) {
		var ampmw = gel(ref + 'dur_ampm');
		if (ampmw)
			ampm = ampmw.value;
	}
	if (dateFormat.indexOf("s") > -1) {
		var secondsInput = gel(ref + 'dur_sec');
		if (secondsInput)
			sec = secondsInput.value;
	}
	sdata.value = GlideTimeElement.formatTime(parseInt(hour.value || 0, 10),
		parseInt(min.value || 0, 10),
		parseInt(sec || 0, 10),
		ampm,
		dateFormat);
	onChange(ref);
}
GlideTimeElement.formatTime = function(hour, minute, second, ampm, format) {
	var value=new Object();
	if (ampm=="PM")
		hour += 12;
	value["H"]=hour;
value["HH"]=LZ(hour);
	if (hour==0)
		value["h"]=12;
	else if (hour>12)
		value["h"]=hour-12;
	else
		value["h"]=hour;
	value["hh"]=LZ(value["h"]);
	value["a"]=ampm;
	value["aa"]=ampm;
	value["m"]=minute;
	value["mm"]=LZ(minute);
	value["s"]=second;
	value["ss"]=LZ(second);
	var i_format=0;
	var c="";
	var result="";
	while (i_format < format.length) {
		c=format.charAt(i_format);
		token="";
		while ((format.charAt(i_format)==c) && (i_format < format.length)) {
			token += format.charAt(i_format++);
		}
		if (value[token] != null)
			result=result + value[token];
		else
			result=result + token;
	}
	return result;
}
;
/*! RESOURCE: /scripts/classes/GlideTimerElement.js */
var GlideTimerElement = Class.create({
	initialize : function(name, tmrID, alert) {
		this.name = name;
		this.tmrID = tmrID;
		this._incrementInterval = 1000;
		this.isShowAlert = alert === 'true';
		this.isDirty = false;
		this._setTimer();
	},
	setValue : function(value) {
		value = this._cleanDate(value);
		var elem = document.getElementById("o" + this.tmrID);
		elem.value = value;
		this._updateTotal(this.fields2time());
	},
	setReadOnly: function(readOnly) {
		gel(this.tmrID + "_hour").readOnly = readOnly;
		gel(this.tmrID + "_min").readOnly = readOnly;
		gel(this.tmrID + "_sec").readOnly = readOnly;
		gel(this.name).readOnly = readOnly;
		g_form.setSensitiveDisplayValue(this.name + ".ui_policy_sensitive", readOnly ? 'none' : '');
		return true;
	},
	
	_cancelTimer : function() {
		if (!this.timerID)
			return;
		clearTimeout(this.timerID);
		this.timerID = null;
		this._timerStarted = null;
		this._timerTicks = 0;
	},
	_setTimer : function() {
		if (!this._timerStarted)
			this._timerStarted = new Date().getTime();
		if (!this._timerTicks)
			this._timerTicks = 0;
		var diff = (new Date().getTime() - this._timerStarted) - (this._timerTicks * this._incrementInterval);
		this.timerID = setTimeout(this._incrementTimer.bind(this), this._incrementInterval - diff);
	},
	_incrementTimer : function() {
		if (!this._isPaused()) {
var addedTime = this._incrementInterval / 1000;
			var currentTime = this.fields2time() + addedTime;
			
			if (this._isScrolling)
				this._deferredTime = !!this._deferredTime ? this._deferredTime + addedTime : currentTime;
			else
				this.setIncrementingValue(currentTime);
		}
		this._timerTicks++;
		this._setTimer();
	},
	_isPaused : function() {
		var paused = $(this.tmrID + "_paused");
		return (paused.value == 'true' ? 1 : 0);
	},
	type : function() {
		return "GlideTimerElement";
	},
	_updateTotal : function(currentTime) {
		var e = $(this.tmrID).getAttribute("data-ref");
		var setField = $(e);
		var otime = this.duration2time();
		var newSetTime = parseInt(otime || 0) + parseInt(currentTime);
		this.setTimer(newSetTime, setField);
	},
	updateTotal : function() {
		var currentTime = this.fields2time();
		this._updateTotal(currentTime);
		if (this.isShowAlert) {
			var wasDirty = this.isDirty;
			this.isDirty = currentTime != 0;
			if (this.isDirty != wasDirty)
				g_form.fieldChanged(this.name, this.isDirty);
		}
	},
	fields2time : function() {
		var currentTime = 0;
		var eHour = $(this.tmrID + "_hour");
		var eMin = $(this.tmrID + "_min");
		var eSec = $(this.tmrID + "_sec");
		if (eHour.value)
			currentTime = 60 * 60 * parseInt((isNaN(eHour.value) ? 0 : eHour.value), 10);
		if (eMin.value)
			currentTime += 60 * parseInt((isNaN(eMin.value) ? 0 : eMin.value), 10);
		if (eSec.value)
			currentTime += parseInt((isNaN(eSec.value) ? 0 : eSec.value), 10);
		return currentTime;
	},
	setTotalValue : function(currentTime) {
		var eCalculated = $(this.tmrID);
		var eHour = $(this.tmrID + "_hour");
		var eMin = $(this.tmrID + "_min");
		var eSec = $(this.tmrID + "_sec");
		var hour = doubleDigitFormat(sGetHours(currentTime));
		var minute = doubleDigitFormat(sGetMinutes(currentTime));
		var second = doubleDigitFormat(sGetSeconds(currentTime));
		eCalculated.value = "0 " + hour + ":" + minute + ":" + second;
		eSec.value = second;
		eMin.value = minute;
		eHour.value = hour;
		this.updateTotal();
	},
	setIncrementingValue : function(currentTime) {
		var eCalculated = $(this.tmrID);
		var eHour = $(this.tmrID + "_hour");
		var eMin = $(this.tmrID + "_min");
		var eSec = $(this.tmrID + "_sec");
		var hour = doubleDigitFormat(sGetHours(currentTime));
		var minute = doubleDigitFormat(sGetMinutes(currentTime));
		var second = doubleDigitFormat(sGetSeconds(currentTime));
		var hourUpdate = (parseInt(eMin.value) >= 59 ? true : false);
		eCalculated.value = "0 " + hour + ":" + minute + ":" + second;
		var updateTotal = false;
		if (second != eSec.value) {
			eSec.value = second;
			updateTotal = true;
		}
		if (minute != eMin.value) {
			eMin.value = minute;
			updateTotal = true;
		}
		if (hourUpdate && hour != eHour.value) {
			eHour.value = hour;
			updateTotal = true;
		}
		
		if (updateTotal)
			this.updateTotal();
	},
	setTimer : function(newSetTime, setField) {
		var tHour = $("o" + this.tmrID + "_hour");
		var tMin = $("o" + this.tmrID + "_min");
		var tSec = $("o" + this.tmrID + "_sec");
		var hour = doubleDigitFormat(sGetHours(newSetTime));
		var minute = doubleDigitFormat(sGetMinutes(newSetTime));
		var second = doubleDigitFormat(sGetSeconds(newSetTime));
		
		tHour.innerHTML = hour;
		tMin.innerHTML = minute;
		tSec.innerHTML = second;
		if (hour > 24) {
var days = parseInt(hour / 24);
			hour = days + " " + (hour - (days * 24));
		}
		setField.value = hour + ":" + minute + ":" + second;
	},
	duration2time : function() {
		var currentTime = $("o" + this.tmrID).value;
		return this.duration2timeValue(currentTime);
	},
	duration2timeValue : function(currentTime) {
		var days = 0;
		if (currentTime == 0)
			currentTime = "00:00:00";
		if (currentTime.indexOf(" ") > -1) {
			var sp = currentTime.indexOf(" ");
			days = currentTime.substring(0, sp);
			currentTime = currentTime.substring(sp + 1, currentTime.length);
		}
		var hours = parseInt(currentTime.substring(0, 2), 10);
		var minutes = parseInt(currentTime.substring(3, 5), 10);
		var seconds = parseInt(currentTime.substring(6, 8), 10);
		currentTime = ((60 * 60) * 24) * days;
		currentTime += (60 * 60) * hours;
		currentTime += 60 * minutes;
		currentTime += seconds;
		return currentTime;
	},
	_cleanDate: function(dateToClean) {
		if (dateToClean.indexOf(" ") > -1) {
			var sp = dateToClean.indexOf(" ");
			days = dateToClean.substring(0, sp);
			if (days.indexOf('-') != -1)
days = Math.floor(new Date(days) / 8.64e7);
			dateToClean = days + " " + dateToClean.substring(sp + 1, dateToClean.length);
		}
		return dateToClean;
	},
	
	toString: function() {
		return 'GlideTimerElement';
	}
});
;
/*! RESOURCE: /scripts/classes/UserRolesElement.js */
var UserRolesElement = Class.create({
	initialize: function(name) {
		this.name = name;
		this._initializeEvents();
	},
	setReadOnly: function(disabled) {
		var lockElement = gel(this.name + "_lock");
if (disabled) {
			if (lockElement)
				hideObject(lockElement);
			var unlockElement = gel(this.name + "_unlock");
			lock(unlockElement, this.name, this.name + '_edit', this.name + '_nonedit', this.name + 'select_1', this.name + '_nonedit');
			hideObject(unlockElement);
		} else {
if (lockElement && lockElement.style.display != "none")
				return true;
			var unlockElement = gel(this.name + "_unlock");
			if (isDoctype())
				showObjectInlineBlock(unlockElement);
			else
				showObjectInline(unlockElement);
		}
		gel(this.name).disabled = disabled;
		return true;
	},
	isDisabled: function() {
		var lockElement = $(this.name + "_lock");
		if (lockElement && lockElement.visible())
			return false;
		var unlockElement = $(this.name + "_unlock");
		if (unlockElement && unlockElement.visible())
			return false;
		return true;
	},
	setValue: function(newValue) {
var hiddenElement = $(this.name);
var visibleElement = $(this.name + "select_1");
		this.visibleElementId = visibleElement.id;
		var leftSideSelect = $(this.name + "select_0");
		hiddenElement.value = "";
		visibleElement.options.length = 0;
	    if (typeof newValue == "string" && newValue != "")
newValue = newValue.split(",");
		for (var i = 0; i < newValue.length; i++) {
			var value = newValue[i];
for (var d = leftSideSelect.length - 1; d >= 0; d--) {
    			if (leftSideSelect.options[d].value == value) {
      				leftSideSelect.remove(d);
    			}
  			}
			this._setValue(value);
		}
		this._updateNonEditValue(newValue);
		UserRolesElement.buildSelectList(this.name, true);
		onChange(this.name);
	},
	keyDownLeft: function(evt) {
		var key = evt.keyCode;
		if (this._isSpaceOrEnterKey(key))
			this.selectRole();
	},
	keyDownRight: function(evt) {
		var key = evt.keyCode;
		if (this._isSpaceOrEnterKey(key))
			this.deselectRole();
	},
	_isSpaceOrEnterKey: function(keycode) {
		return keycode == 32 || keycode == 13;
	},
	selectRole: function() {
		moveOption($(this.name + 'select_0'), $(this.name + 'select_1'), '--None--', [], '--None--');
		UserRolesElement.buildSelectList(this.name, true);
	},
	deselectRole: function() {
		moveOption($(this.name + 'select_1'), $(this.name + 'select_0'), '--None--', [], '--None--');
		UserRolesElement.buildSelectList(this.name, true);
	},
	
	fetchUserRoles: function(event) {
		UserRolesElement.getUserRoles(this.name, event.target.dataset['table'], event.target.value);
	},
	_setValue: function(value) {
		if (!value)
			return;
		var select = new Select(this.visibleElementId);
		if (select.contains(value))
			return;
		select.addOption(value, value);
		select = null;
	},
	_updateNonEditValue: function(newValue) {
		var elem = $(this.name + '_nonedit');
		if (newValue.length < 2) {
			elem
				.setStyle('display', 'inline-block')
				.update(newValue);
		} else {
			elem
				.setStyle('display', 'inline-block')
				.update(newValue.join(', '));
		}
	},
	_initializeEvents: function() {
		$(this.name + 'select_0').on('keydown', this.keyDownLeft.bind(this));
		$(this.name + 'select_0').on('dblclick', this.selectRole.bind(this));
		$(this.name + 'select_1').on('keydown', this.keyDownRight.bind(this));
		$(this.name + 'select_1').on('dblclick', this.deselectRole.bind(this));
		$(this.name + '_edit').on('click', '[data-action="add"]', this.selectRole.bind(this));
		$(this.name + '_edit').on('click', '[data-action="remove"]', this.deselectRole.bind(this));
		
		var searchElement = $(this.name + '_sys_user_role');
		searchElement && searchElement.on('keyup', UserRolesElement._debounce(this.fetchUserRoles, 250, this))
	}
});
function buildGraphQLQuery (searchTerm, tableName, ref) {
    return JSON.stringify({
        "query": "query ($searchTerm:String!,$fieldReference:String!,$limit: Int) {"
                    +"GlideLayout_Query {"
                      +"userRolesQuery(searchTerm:$searchTerm,fieldReference:$fieldReference,limit:$limit){"
                        +"userRoles"
                      +"}"
                    +"}"
                  +"}",
        "variables": {
            "searchTerm": searchTerm,
            "fieldReference": tableName,
            "limit": $(ref + '_limit').textContent
        }
    });
}
UserRolesElement.getUserRoles = function(ref, table, searchTerm) {
serverRequestPostJSON("api/now/graphql", buildGraphQLQuery(searchTerm, table, ref), function(response) {
        UserRolesElement.buildSelect0List(ref, response);
    });
}
UserRolesElement.buildSelect0List = function(ref, response) {
	var results = response.response.data.GlideLayout_Query.userRolesQuery.userRoles;
	var sel0 = $(ref + 'select_0');
	var sel1 = $(ref + 'select_1');
	sel0.options.length = 0;
	if (typeof sel1.options !== 'undefined') {
		var options = results.filter(function(r) {
			var foundOption = false;
			for (var i=0,sel1Length=sel1.options.length; i < sel1Length; i++) {
				if (r === sel1.options[i].value) {
					foundOption = true;
					break;
				}
			}
			return !foundOption;
		});
		options.forEach(function(o, index){
			sel0.options[index] = new Option(o, o);
			sel0.options[index].setAttribute('aria-selected', 'false');
		});
	}
}
UserRolesElement.buildSelectList = function(ref, performOnChange) {
	var sel0 = $(ref + 'select_0');
	var sel1 = $(ref + 'select_1');
	var available = $(ref + 'available');
	var selected = $(ref);
	var isLazyLoad = $(ref + '_load_lazy').textContent;
	if (typeof sel1.options !== 'undefined' && sel1.options.length > 0) {
		if(isLazyLoad === 'true')
			saveAllSelected([ sel1 ], [ selected ], ',', '\\', '--None--');
		else if(isLazyLoad === 'false')
			saveAllSelected([ sel0, sel1 ], [available, selected ], ',', '\\', '--None--');
	}
	if (performOnChange == false)
		return;
	onChange(ref);
	telemetryForRecordUpdateElement(ref);
}
UserRolesElement.userRolesMaxWidth = function(ref) {
	var minWidth = 120;
	var scrollPad = 12;
	if (isMSIE)
		scrollPad = 0;
	var prefix = ref + "select_";
	var select0 = gel(prefix + "0");
	minWidth = Math.max(select0.clientWidth + scrollPad, minWidth);
	var select1 = gel(prefix + "1");
	minWidth = Math.max(select1.clientWidth + scrollPad, minWidth);
	select0.style.width = minWidth + "px";
	select1.style.width = minWidth + "px";
}
UserRolesElement._debounce = function(fn, delay, ctx) {
	ctx = ctx || undefined;
	var timeout;
	return function () {
		var args = arguments;
		window.clearTimeout(timeout);
		timeout = window.setTimeout(function() {
			fn.apply(ctx, args);
		}, delay);
	};
}
;
/*! RESOURCE: /scripts/classes/DaysOfWeekElement.js */
var DaysOfWeekElement = Class.create({
    initialize: function(name) {
        this.name = name;
    },
    setReadOnly: function(disabled) {
		var e = gel(this.name);
		if (e) {
			var checkedDays = e.value;
			for (var i = 1; i != 8; i++) {
				var cb = gel('ni.' + this.name + '.' + i);
				if (cb) {
					cb.disabled = disabled;
				}
			}
		}	
    },
    isDisabled: function() {
		var cb = $('ni.' + this.name + '.1');
		if (cb && !cb.disabled) 
			return false;
		
		return true;		
    }
});
;
/*! RESOURCE: /scripts/classes/TextAreaElement.js */
var TextAreaElement = Class.create({
    initialize: function(name) {
        this.name = name;
    },
    setReadOnly: function(disabled) {
    	var d = gel(this.name);
    	if (disabled) {
    		d.readOnly = "readonly";
    		addClassName(d, "readonly");
    	} else {
    		d.readOnly = "";
    		removeClassName(d, "readonly");
    	}
    },
    
	setValue: function(newValue) {
		if (newValue == "XXmultiChangeXX")
			newValue = '';
		var d = gel(this.name + ".ta");
		if (d)
			d.value = newValue;
		d = gel(this.name);
		d.value = newValue;
		onChange(this.name);
		if (window.jQuery)
			$j(d).trigger("autosize.resize");
	}
});
;
/*! RESOURCE: /scripts/classes/AttachmentUploader.js */
var AttachmentUploader = Class.create({ 
	initialize: function(event, file, fileNumber, canAttach, showView, showPopup) {
		this.target = Event.element(event);
		this.file = file;
		this.fileNumber = fileNumber;
		this.showView = showView;
		this.showPopup = showPopup;
		this.canAttach = canAttach;
		this.control = gel("upload_file_" + this.fileNumber);
		this.progress = gel("upload_file_progress_" + this.fileNumber);
		this.CRLF  = "\r\n"
		var sys_id = gel("sys_uniqueValue");
		if (!sys_id)
sys_id = gel("sysparm_item_guid");
		this.parent_sys_id = sys_id.value;
		var table = gel("sys_target");
		if (!table)
table = gel("ni.attachment_target");
		this.table = table.value;
	},
	destroy: function() {
		this.target = null;
		this.xhr = null;
		this.file = null;
		this.control = null;
		this.progress = null;
	},
	send: function(uploadedFunction) {
		this.xhr = new XMLHttpRequest();
		var self = this;
		Event.observe(this.xhr.upload, "load", function() {
			if (self.control) {
				try {
rel(self.control);
					$('header_attachment').style.height = 'auto';
				} catch (ex) {}
			}
		}, false);
		Event.observe(this.xhr.upload, "progress", function(e) {
			if (e.lengthComputable) {
var percentage = Math.round((e.loaded * 100) / e.total);
				self._updateProgressBar(percentage);
			}
		}, false);
		Event.observe(this.xhr.upload, "error", function() {
			self._updateProgress(" error");
			if (self.control)
				self.control.setAttribute('style', 'background-color: tomato; background-color: RGB(var(--now-alert--critical--background-color,var(--now-color_alert--critical-0,241,206,205)));');
			self.destroy();
		}, false);
		Event.observe(this.xhr.upload, "loadstart", function() {
			self._updateProgress("started");
			if (self.control)
				self.control.setAttribute('style', 'background-color: LightCyan; background-color: RGB(var(--now-alert--info--background-color,var(--now-color_alert--info-0,195,221,240)));');
		}, false);
		Event.observe(this.xhr.upload, "abort", function() {
			self._updateProgress(" aborted");
			if (self.control)
				self.control.setAttribute('style', 'background-color: tomato; background-color: RGB(var(--now-alert--critical--background-color,var(--now-color_alert--critical-0,241,206,205)));');
			self.destroy();
		}, false);
		this.xhr.onreadystatechange = function() {
if (self.xhr.readyState === 4) {
				var xml = self.xhr.responseXML;
				if (xml) {
					var sys_id = xml.documentElement.getAttribute("sys_id");
					if (sys_id == "attachment.refused") {
						alert("Attachment refused because file type not allowed or type does not match file contents.");
					} else if (sys_id == "create.permission") {
						alert("You do not have ability to attach file to this record.");
					} else if ( sys_id == "upload.error") {
						alert("Attachment failed. " +
"Invalid table name and/or sys_id when attempting to create attachment.");
					} else {
						var ga = new GlideAjax('AttachmentAjax');
						ga.addParam('sysparm_name','getIconSrc');
						ga.addParam('sysparm_type', 'icon');
						ga.addParam('sysparm_value', sys_id);
						ga.getXMLWait();
						var imgSrc = ga.getAnswer();
						if( !imgSrc )
imgSrc = "images/attachment.gifx";
						addAttachmentNameToForm(sys_id, self.file.name, "New", imgSrc,
							self.canAttach, self.showView, self.showPopup);
						
						ga = new GlideAjax('AttachmentAjax');
						ga.addParam('sysparm_name','getCanDelete');
						ga.addParam('sysparm_type', 'canDelete');
						ga.addParam('sysparm_value', sys_id);
						ga.getXMLWait();
						var canDelete = ga.getAnswer();
						if( !canDelete )
							canDelete = true;
						var gr = new GlideRecord('sys_attachment');
						gr.get(sys_id);
						addAttachmentNameToDialog(sys_id, self.file.name, canDelete,
							gr.sys_created_by, gr.sys_created_on, gr.content_type, imgSrc);
						
_saveAttachmentClose();
						if (typeof uploadedFunction == "function") {
							self.sys_id = sys_id;
							uploadedFunction.call(this, self);
						}
					}
				}
				self.destroy();
			}
		};
		this._checkCompatibleFile(function() {
			var formData = new FormData();
			formData.append("sysparm_sys_id", self.parent_sys_id);
			formData.append("sysparm_table", self.table);
			formData.append("sysparm_nostack", "yes");
			formData.append("sysparm_send_xml", "true");
			if (window.g_ck)
				formData.append("sysparm_ck", window.g_ck);
			formData.append("attachFile", self.file, self.file.name);
			self.xhr.open("POST", "sys_attachment.do", true);
			self.xhr.send(formData);
			jslog("starting send file upload for " + self.file.name);
		})
	},
	_updateProgress: function(txt) {
		if (this.progress)
			this.progress.innerHTML = txt;
	},
	_updateProgressBar: function(percentage) {
		if (this.progress)
			this.progress.innerHTML = "<progress value=\"" + percentage 
			+ "\" max=\"100\">" + percentage + "%";
	},
	_checkCompatibleFile: function(sendFunction) {
		var reader = new FileReader();
		var self = this;
		reader.onerror = function() {
			self._outputIncompatible();
		}
		reader.onloadend = function(evt) {
			if (evt.target.error)
				return;
			sendFunction();
		}
		reader.readAsArrayBuffer(this.file);
	},
	_isIWorkFile: function() {
		var fileName = this.file.name;
		return fileName.endsWith('.key') ||
			fileName.endsWith('.pages') ||
			fileName.endsWith('.numbers') ||
			fileName.endsWith('.keynote');
	},
	_outputIncompatible: function() {
		var errMsg = "There was an error uploading \"{0}.\" ";
		if (this._isIWorkFile())
			errMsg += "Some iWork files cannot be added through drag and drop. ";
		errMsg += "Please select the file and upload through the paperclip icon above.";
		g_form.addErrorMessage(new GwtMessage().getMessage(errMsg, this.file.name));
		if (this.control)
			this.control.style.display = "none";
		this.destroy();
	},
	type: function() {
		return "AttachmentUploader";
	}   
});
AttachmentUploader.isAttachmentEndPoint = function (response) {
	return response?.indexOf('sys_attachment.do') !== -1;
};
AttachmentUploader.uploadBlob = function(blob, filename, url, data, showView, showPopup) {
	var form = this._getFormBuilder();
	for (var key in data) {
		if(data.hasOwnProperty(key)) {
			form.append(key, data[key]);
		}
	}
	form.append('file', blob, filename);
	var xhr = new XMLHttpRequest();
	xhr.onload = function() {
		onSuccess({
			data: xhr.response,
			xml: xhr.responseXML,
			sys_id: xhr.responseXML.documentElement.getAttribute('sys_id')
		});
	};
	xhr.onreadystatechange = function() {
		if(xhr.readyState === 4) {
			try {
				var sys_id = xhr.responseXML.documentElement.getAttribute("sys_id");
				if(!sys_id) {
					return onError(new Error("Attachment failed because file type does not match with file contents."));
				}
				if (sys_id == "create.permission") {
					return onError(new Error("You do not have ability to attach file to this record."));
				}
				if (sys_id == "upload.error") {
					return onError(new Error("Attachment failed. " +
"Invalid table name and/or sys_id when attempting to create attachment."));
				}
				if (xhr.status < 200 || xhr.status >= 300) {
					return onError(new Error('server responded with: ' + xhr.status));
				}
				onSuccess({sys_id:sys_id });
				if (AttachmentUploader.isAttachmentEndPoint(xhr.responseURL || "")) {
					var ga = new GlideAjax('AttachmentAjax');
					ga.addParam('sysparm_name', 'getIconSrc');
					ga.addParam('sysparm_type', 'icon');
					ga.addParam('sysparm_value', sys_id);
					ga.getXMLAnswer(function(imgSrc) {
						if (!imgSrc)
imgSrc = "images/attachment.gifx";
						addAttachmentNameToForm(sys_id, filename, "New", imgSrc, 'true', showView, showPopup);
					});
				}
			} catch (e) {
				onError(new Error('server responded with unusable data'));
			}
		}
	};
	function listen(event, listener){
		if (!xhr.upload.addEventListener)
			xhr.attachEvent(event, listener);
		else
			xhr.upload.addEventListener(event, listener, false);
	}
	listen('progress', function(e) {
		if (e.lengthComputable) {
			onProgress({
				total: e.total,
				loaded: e.loaded,
percent: Math.round((e.loaded * 100) / e.total)
			});
		}
	});
	listen('error', function(e) { onError(e); });
	var errFuns = [];
	function onError(data) {
		errFuns.forEach(function(fun){ fun(data); });
	}
	var sucFuns = [];
	function onSuccess(data) {
		sucFuns.forEach(function(fun){ fun(data); });
	}
	var proFuns = [];
	function onProgress(data) {
		proFuns.forEach(function(fun){ fun(data); });
	}
	xhr.open("POST", url);
	xhr.send(form);
	return {
		success: function(fun) {
			sucFuns.push(fun);
			return this;
		},
		progress: function(fun) {
			proFuns.push(fun);
			return this;
		},
		error: function(fun) {
			errFuns.push(fun);
			return this;
		}
	}
};
AttachmentUploader.uploadDataURLAttachment = function(dataUrl, name, table, sys_id) {
	var parts = AttachmentUploader._parseDataUrl(dataUrl);
	if(name) {
		name = (parts.ext && name.indexOf('.') == -1 ) ? name + parts.ext : name;
	} else {
		name =  'pasted_image'+ (parts.ext ? parts.ext : '.unknown');
	}
	var data = {
		'sysparm_sys_id': sys_id,
		'sysparm_table': table
	};
	return this.uploadBlob(parts.blob, name, 'sys_attachment.do', data);
};
AttachmentUploader.uploadDataURLDBImage = function(dataUrl, name) {
	var parts = AttachmentUploader._parseDataUrl(dataUrl);
	if(name) {
		name = (parts.ext && name.indexOf('.') == -1 ) ? name + parts.ext : name;
	} else {
		name =  'pasted_image'+ (parts.ext ? parts.ext : '.unknown');
	}
	var data = {
		sysparm_table: 'db_image',
		sysparm_sys_id: 'new_db_image'
	};
	return this.uploadBlob(parts, name, 'sys_user_image.do', data);
};
AttachmentUploader._getFormBuilder = function() {
	var form = new FormData();
	form.append('sysparm_nostack', 'yes');
	form.append('sysparm_send_xml', 'true');
	if (window.g_ck)
		form.append('sysparm_ck', window.g_ck);
	return form;
};
AttachmentUploader._parseDataUrl = function(str) {
	if(typeof window.Blob == 'undefined')
		return new Error('cannot create Blobs on this browser');
	var exts = {
'image/jpeg': '.jpg',
'image/bmp': '.bmp',
'image/gif': '.gif',
'image/png': '.png',
'image/tiff': '.tiff',
'image/svg+xml': '.svg',
'image/x-icon': '.ico'
	};
	var mime = str.substring(str.indexOf(':')+1, str.indexOf(';'));
	var base64Str = str.substring(str.indexOf(',')+1);
	var byteString = atob(base64Str);
	var ab = new ArrayBuffer(byteString.length);
	var ia = new Uint8Array(ab);
	for (var i = 0, l = byteString.length; i < l; i++) {
		ia[i] = byteString.charCodeAt(i);
	}
	return {
		blob: new Blob([ia], {type: mime}),
		mime: mime,
		ext: exts[mime]
	};
};
AttachmentUploader.addDropZone = function(dropZone, maxMegabytes, canAttach, showView, showPopup, extensions, uploadedFunction) {	
	if (typeof FileReader == "undefined") 
return;
	if (canAttach == "false") {
		AttachmentUploader.noDropZone("File attachments not allowed");
		return;
	}
	if (maxMegabytes !== "")
		maxMegabytes = parseInt(maxMegabytes, 10);
	else
		maxMegabytes = 0;
	if (isNaN(maxMegabytes))
		maxMegabytes = 0;
	var gotExtensions = false;
	if (extensions) {
		extensions.toLowerCase();
		extensions = extensions.split(",");
		gotExtensions = true;
	}
	Event.observe(dropZone, "dragover", function(event) {
		Event.stop(event);
		var headerAttachment = gel("header_attachment");
		if (headerAttachment && headerAttachment.style.backgroundColor != "orange") {
			headerAttachment.style.backgroundColor = "orange";
			headerAttachment.classList.add('-active');
			needsReset = true;
		}
		var line = gel("header_attachment_line");
		if (line) {
			if (line.style.visibility == "hidden") {
				line.reverseOnCancel = "true";
				if ($$('attachment_list_items').length > 0) {
					showObjectInline(gel("header_attachment_list_label"));
				}
				line.style.visibility = "visible";
				line.style.display = "";
			}
			line.resetDisplay = "1";
		}
setTimeout("AttachmentUploader._resetBackground(false)", 1000);
		if (!(isMSIE || isMSIE11)){
			event.dataTransfer.effectAllowed = "copy";
			event.dataTransfer.dropEffect="copy";
		}
		return false;
	}, true);
	Event.observe(dropZone, "dragend", function(event) {
		AttachmentUploader._resetBackground(true);
	}, true);
	Event.observe(dropZone, "drop", function(event) {
		AttachmentUploader._resetBackground(true);
		var files = event.dataTransfer.files
if (files.length < 1)
			return;
		if (event.dataTransfer != undefined && typeof event.dataTransfer.getData === "function") {
			var dropData = event.dataTransfer.getData("text");
if (dropData != undefined && dropData.toString().startsWith(window.location.origin + "/"))
				return;
		}
		Event.stop(event);
		
if (dropZone.disableAttachments == "true") {
			alert(getMessage("Attachments are not allowed"));
			return;
		}
$('header_attachment').style.height = 'auto';
		if (isFirefox){
			$('header_attachment').style.height = '3em';
		}
		var line = gel("header_attachment_line");
		if (line)
			line.reverseOnCancel = "false";
		var progressSpan = gel("attachment_upload_progress");
		progressSpan.innerHTML = "";
		var filesTooLarge = [];
		var filesBadExtension = [];
		for (var i = 0; i < files.length; i++) {
			var file = files[i];
var megs = file.size / 1048576;
			if (maxMegabytes > 0) {
				if (megs > maxMegabytes) {
					filesTooLarge.push(file.name + " (" + AttachmentUploader.getDisplaySize(file.size) + ")");
					files[i] = null;
					continue;
				}
			}
			if (gotExtensions) {
				var badExtension = false;
				var periodIndex = file.name.lastIndexOf(".");
				var extension = "(none)";
				if (periodIndex == -1)
					badExtension = true;
				else {
					extension = file.name.substring(periodIndex+1).toLowerCase();
					if (extensions.indexOf(extension) == -1)
						badExtension = true;
				}
				if (badExtension) {
					filesBadExtension.push(file.name);
					continue;
				}
			}
			
			var p = cel("p");
			p.id = "upload_file_" + i;
			addClassName(p, 'file');
			p.textContent = files[i].name + " (" + AttachmentUploader.getDisplaySize(files[i].size) + ") ";
			var span = cel("span");
			span.id = "upload_file_progress_" + i;
			p.appendChild(span);
			progressSpan.appendChild(p);
			
			var uploader = new AttachmentUploader(event, file, i, canAttach, showView, showPopup);
			uploader.send(uploadedFunction);
		}
		
		if ((filesTooLarge.length + filesBadExtension.length) > 0)
			AttachmentUploader.setWarning(filesTooLarge, filesBadExtension, maxMegabytes);
	}, true);
};
AttachmentUploader._resetBackground = function(doNow) {
	var line = gel("header_attachment_line");
	if (!line) 
		return;
	if (doNow != true && typeof line.resetDisplay != "undefined") {
		var resetDisplay = parseInt(line.resetDisplay);
		resetDisplay++;
		line.resetDisplay = resetDisplay;
		if (resetDisplay < 10)
			return;
	}
	var headerAttachment = gel("header_attachment");
	if (headerAttachment)
		headerAttachment.style.backgroundColor = "";
		headerAttachment.classList.remove('-active');
	if (line.reverseOnCancel == "true") {
		line.reverseOnCanel = "false";
		hideObject(gel("header_attachment_list_label"));
		line.style.visibility = "hidden";
		line.style.display = "none";
	}
}
AttachmentUploader.getDisplaySize = function(sizeInBytes) {
var kilobytes = Math.round(sizeInBytes / 1024);
	if (kilobytes < 1)
		kilobytes = 1;
	var reportSize = kilobytes + "K";
	if (kilobytes > 1024)
reportSize = Math.round(kilobytes / 1024) + "MB";
	return reportSize;
}
AttachmentUploader.noDropZone = function(message) {
	var dropZone = document.body;
	Event.observe(dropZone, "dragover", function(event) {
		Event.stop(event);
		if (isChrome)
			event.dataTransfer.dropEffect="copy";
		return true;
	}, true);
	Event.observe(dropZone, "dragleave", function(event) {
		Event.stop(event);
	}, true);
	Event.observe(dropZone, "drop", function(event) {
		var files = event.dataTransfer.files
if (files.length < 1)
			return;
		
		Event.stop(event);
		alert(message);
	}, true);
}
AttachmentUploader.isAttachmentDisabled = function() {
	return document.body["disableAttachments"]  === "true";
}
AttachmentUploader.disableAttachments = function() {
	document.body.disableAttachments = "true";
}
AttachmentUploader.enableAttachments = function() {
	document.body.disableAttachments = "false";
}
AttachmentUploader.setWarning = function (filesTooLarge, filesBadExtension, maxFileSize) {
	var gwtMessage = new GwtMessage();
	var warningString =  gwtMessage.getMessage("The following files were not uploaded:");
	warningString += "\n\n";
	if (filesTooLarge.length > 0) {
		var fileSizeWarningString = gwtMessage.getMessage("Files larger than the maximum file size ({0} MB)");
		warningString += gwtMessage.format(fileSizeWarningString, maxFileSize)
		warningString += "\n"
		for (var i = 0; i < filesTooLarge.length; i++)
			warningString += "\t" + filesTooLarge[i] + "\n";
		warningString += "\n";
	}
	if (filesBadExtension.length > 0) {
		warningString += gwtMessage.getMessage("Files with prohibited extensions:");
		warningString += "\n\n";
		for (var i = 0; i < filesBadExtension.length; i++)
			warningString += "\t" + gwtMessage.getMessage(filesBadExtension[i]) + "\n";
	}
	
	alert(warningString);
}
;
/*! RESOURCE: /scripts/classes/GwtDate.js */
 
var GwtDate = Class.create({
    MINUTES_IN_DAY : 1440,
    DAYS_IN_MONTH : [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],
    MONTHS_IN_YEAR : ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
    AJAX_PROCESSOR : "xmlhttp.do?sysparm_processor=com.glide.schedules.AJAXDate",
	initialize: function(s) {
	    if (s) {
	        this.deserialize(s);
	    } else {
	        this.clear();
	    }
	},
    clone: function() {
        var newDate = new GwtDate(this.serialize());
        return newDate;
    },
    clear: function() {
        this.year = 0;
        this.month = 0;
        this.day = 0;
        this.hour = 0;
        this.minute = 0;
        this.second = 0;
    },
    
    serialize: function(dateOnly) {
        var s = this.year + "-" + (this.month + 1) + "-" + this.day;
        if (!dateOnly)
        	s += " " + this.formatTime(true);
        	
        return s;
    },
    
    serializeInUserFormat: function(dateOnly) {
    	if (dateOnly)
    		return this.formatDate(g_user_date_format);
    	else
    		return this.formatDate(g_user_date_time_format);
    },
	
	serializeTimeInUserFormat: function(includeSeconds) {
var spaceIndex = g_user_date_time_format.indexOf(" ");
		var timeFormat = g_user_date_time_format.substr(spaceIndex+1);
		if (!includeSeconds)
timeFormat = timeFormat.replace(/[:\.]ss/,'');
     	var d = this.getDateObject(true);
    	return formatDate(d, timeFormat); 	
	},
    
    deserialize: function(s) {
        this.clear();
        if (typeof s == 'number')
        	return this.setFromMs(s);
        
        var components = s.split(" ");
        if (components) {
            var parts = components[0].split("-");
            this.year = parts[0] * 1;
            if (parts.length > 1) {
                this.month = (parts[1] * 1) - 1;
                if (parts.length > 2) {
                    this.day = parts[2] * 1;
                }
            }
            if (components.length >= 2) {
                var parts = components[1].split(":");
                this.hour = parts[0] * 1;
                if (parts.length > 1) {
                    this.minute = parts[1] * 1;
                }
                if (parts.length > 2) {
                    this.second = parts[2] * 1;
                }
            }
        }
    },
    getYear: function() {
        return this.year;
    },
    
    getMonth: function() {
        return this.month;
    },
    
    getDay: function() {
        return this.day;
    },
    
    getHour: function() {
        return this.hour;
    },
    
    getMinute: function() {
        return this.minute;
    },
    getSecond: function() {
        return this.second;
    },
    getTime: function() {
        var h = this.hour * 60;
        var m = this.minute * 1;
        if (this.second >= 30) {
            m++;
        }
        return h + m;
    },
     
    getDaysInMonth: function() {
        if ((this.month == 1) && ((this.year % 4) == 0) && (((this.year % 100) != 0) || ((this.year % 400) == 0))) {
            return 29;
        } else {
            return this.DAYS_IN_MONTH[this.month];
        }
    },
    setYear: function(year) {
        this.year = year;
    },
    
    setMonth: function(month) {
        this.month = month;
    },
    
    setDay: function(day) {
        this.day = day;
    },
    
    setHour: function(hour) {
        this.hour = hour;
    },
    
    setMinute: function(minute) {
        this.minute = minute;
    },
    
    setSecond: function(second) {
        this.second = second;
    },
    
    setStartOfDay: function() {
        this.hour = 0;
        this.minute = 0;
        this.second = 0;
    },
    
    setEndOfDay: function() {
        this.hour = 23;
        this.minute = 59;
        this.second = 59;
    },
    
    setFromJsDate: function(date) {
        this.year = date.getFullYear();
        this.month = date.getMonth();
        this.day = date.getDate();
        this.hour = date.getHours();
        this.minute = date.getMinutes();
        this.second = date.getSeconds();
    },
    setFromMs: function(milliseconds) {
    	this.setFromJsDate(new Date(milliseconds));
    },
    
    setFromDate: function(date) {
        this.year = date.getYear();
        this.month = date.getMonth();
        this.day = date.getDay();
        this.hour = date.getHour();
        this.minute = date.getMinute();
        this.second = date.getSecond();
    },
    setFromInt: function(intDate, intTime) {
        this.clear();
var year = Math.floor(intDate / 10000);
        this.year = year;
this.month = (Math.floor((intDate - (year * 10000)) / 100)) - 1;
        this.day = intDate % 100;
        if (intTime) {
var hour = Math.floor(intTime / 10000);
            this.hour = hour;
this.minute = Math.floor((intTime - (hour * 10000)) / 100);
            this.second = intTime % 100;
        }
    },
     
    formatTime: function(includeSeconds) {
        var h = doubleDigitFormat(this.hour);
        var m = doubleDigitFormat(this.minute);
        if (!includeSeconds) 
            return h + ":" + m;
            
        return h + ":" + m + ":" + doubleDigitFormat(this.second);
    },
	
    formatDate: function(format) {
    	var d = this.getDateObject(false);
    	d.setYear(this.year);
    	d.setMonth(this.month);
    	d.setDate(this.day);
    	d.setHours(this.hour);
    	d.setMinutes(this.minute);
    	d.setSeconds(this.second);
    	return formatDate(d, format);    	
    },
    
     getDateObject: function(includeTime) {
    	var d = new Date();
		d.setDate(1);
    	d.setYear(this.year);
    	d.setMonth(this.month);
		d.setDate(this.day);
    	if (includeTime) {
    		d.setHours(this.getHour());
    		d.setMinutes(this.getMinute());
    		d.setSeconds(this.getSecond());
    	} else {
    		d.setHours(0);
    		d.setMinutes(0);
    		d.setSeconds(0);
    	}
    	return d;
    },
    isAllDay: function(toDate) {
    	return ((this.getTime() == 0) && (toDate.getTime() >= (this.MINUTES_IN_DAY)));    	
    },
    
    compare: function(otherDate, includeTimes) {
        if (this.getYear() != otherDate.getYear()) {
            return this.getYear() - otherDate.getYear();
        }
        if (this.getMonth() != otherDate.getMonth()) {
            return this.getMonth() - otherDate.getMonth();
        }
        if (this.getDay() != otherDate.getDay()) {
            return this.getDay() - otherDate.getDay();
        }
        if (includeTimes) {
            if (this.getHour() != otherDate.getHour()) {
                return this.getHour() - otherDate.getHour();
            }
            if (this.getMinute() != otherDate.getMinute()) {
                return this.getMinute() - otherDate.getMinute();
            }
            if (this.getSecond() != otherDate.getSecond()) {
                return this.getSecond() - otherDate.getSecond();
            }
        }
        return 0;
    },
    
    addSeconds: function(seconds) {
    	if (seconds < 0)
    		return this.subtractSeconds(seconds * -1);
    		
        for (var i = 0; i < seconds; i++) {
            this._incrementSecond();
        }
    },
    
    addMinutes: function(minutes) {
    	if (minutes < 0)
    		return this.subtractMinutes(minutes * -1);
    		
        for (var i = 0; i < minutes; i++) {
            this._incrementMinute();
        }
    },
    
    addHours: function(hours) {
    	if (hours < 0)
    		return this.subtractHours(hours * -1);
    		
        for (var i = 0; i < hours; i++) {
            this._incrementHour();
        }
    },
    
    addDays: function(days) {
        for (var i = 0; i < days; i++) {
            this._incrementDay();
        }
    },
    
    addMonths: function(months) {
        for (var i = 0; i < months; i++) {
            this._incrementMonth();
        }
        if (this.day > this.getDaysInMonth()) {
            this.day = this.getDaysInMonth();
        }
    },
    
    addYears: function(years) {
        this.year += years;
    },
    
    subtractSeconds: function(seconds) {
        for (var i = 0; i < seconds; i++) {
            this._decrementSecond();
        }
    },
    
    subtractMinutes: function(minutes) {
        for (var i = 0; i < minutes; i++) {
            this._decrementMinute();
        }
    },
    
    subtractHours: function(hours) {
        for (var i = 0; i < hours; i++) {
            this._decrementHour();
        }
    },
    
    subtractDays: function(days) {
        for (var i = 0; i < days; i++) {
            this._decrementDay();
        }
    },
    
    subtractMonths: function(months) {
        for (var i = 0; i < months; i++) {
            this._decrementMonth();
        }
        if (this.day > this.getDaysInMonth()) {
            this.day = this.getDaysInMonth();
        }
    },
    
    subtractYears: function(years) {
        this.year -= years;
    },
    _incrementSecond: function() {
        this.second++;
        if (this.second > 59) {
            this.second = 0;
            this._incrementMinute();
        }
    },
    _incrementMinute: function() {
        this.minute++;
        if (this.minute > 59) {
            this.minute = 0;
            this._incrementHour();
        }
    },
    _incrementHour: function() {
        this.hour++;
        if (this.hour > 23) {
            this.hour = 0;
            this._incrementDay();
        }
    },
    _incrementDay: function() {
        this.day++;
        if (this.day > this.getDaysInMonth()) {
            this.day = 1;
            this._incrementMonth();
        }
    },
    _incrementMonth: function() {
        this.month++;
        if (this.month >= 12) {
            this.year++;
            this.month = 0;
        }    
    },
        
    _decrementSecond: function() {
        this.second--;
        if (this.second < 0) {
        	this.second = 59;
            this._decrementMinute();
        }
    },
    _decrementMinute: function() {
        this.minute--;
        if (this.minute < 0) {
        	this.minute = 59;
            this._decrementHour();
        }
    },
    _decrementHour: function() {
        this.hour--;
        if (this.hour < 0) {
        	this.hour = 23;
            this._decrementDay();
        }
    },
    _decrementDay: function() {
        this.day--;
        if (this.day == 0) {
            this._decrementMonth();
            this.day = this.getDaysInMonth();
        }
    },
    _decrementMonth: function() {
        this.month--;
        if (this.month < 0) {
            this.year--;
            this.month = 11;
        }    
    },
    now: function() {
        var parms = "&sysparm_type=now";
	    var response = serverRequestWait(this.AJAX_PROCESSOR + parms);
	    var xml = response.responseXML;
        var e = xml.documentElement; 
        this.clear();
        this.deserialize(e.getAttribute("now"));
        return this;
    },
    
    getCurrentTimeZone: function() {
        var parms = "&sysparm_type=now";
	    var response = serverRequestWait(this.AJAX_PROCESSOR + parms);
	    var xml = response.responseXML;
        var e = xml.documentElement; 
        return e.getAttribute("time_zone");
    },
    
    getDayOfWeek: function() {
        var parms = "&sysparm_type=day_of_week&date=" + this.serialize(true);
	    var response = serverRequestWait(this.AJAX_PROCESSOR + parms);
	    var xml = response.responseXML;
        var e = xml.documentElement; 
        return e.getAttribute("day_of_week");
    },
    
    getCurrentMonth: function() {
    	return this.MONTHS_IN_YEAR[this.getMonth()];
    },
    
    getWeekNumber: function() {
        var parms = "&sysparm_type=week_number&date=" + this.serialize(true);
	    var response = serverRequestWait(this.AJAX_PROCESSOR + parms);
	    var xml = response.responseXML;
        var e = xml.documentElement; 
        return e.getAttribute("week_number");
    },
    
    toString: function() {
        return this.formatDate('yyyy-MM-dd HH:mm:ss');
    }
});
;
/*! RESOURCE: /scripts/PageTimingService.js */
(function() {
	"use strict";
	if (window.NOW.PageTimingService)
		return;
	window.NOW.PageTimingService = {
		send: function(data, success, error) {
			if (!data.transaction_id) {
				if (window.console && window.console.warn)
					console.warn("missing data.transaction_id, could not send page timing");
				return;
			}
			var transactionID = data.transaction_id;
delete data.transaction_id;
			if (!error) {
				error = function(request, textStatus, errorThrown) {
if (errorThrown === '')
						return;
					if (request.statusText !== 'abort') {
						console.error(errorThrown);
					}
				};
			}
			var headers = {
'Accept': 'application/json',
'Content-Type': 'application/json',
					'X-Transaction-Source': window.transaction_source
			};
			if (typeof g_ck != 'undefined')
				headers['X-UserToken'] = g_ck;
			return $j.ajax({
				headers: headers,
				'type': 'PATCH',
'url': "/api/now/ui/page_timing/" + transactionID,
				'data': JSON.stringify(data),
				'success': success,
				'error': error
			});
		}
	};
})();
;
/*! RESOURCE: /scripts/doctype/PageTiming14.js */
(function() {
	"use strict";
	if (window.g_PageTiming)
		return;
	var categories = null;
	initialize();
	window.g_PageTiming = {initialized: true};
	var CATEGORY_TIMING_NETWORK = 'timing_network';
	var CATEGORY_TIMING_SERVER = 'timing_server';
	var CATEGORY_TIMING_BROWSER = 'timing_browser';
	var flushStamp = new Date();
	var lastRendered;
	var events = [
		{
			timingTypeCategory: CATEGORY_TIMING_NETWORK,
			timings: [
				{
					id: CATEGORY_TIMING_NETWORK,
timingType:  'Cache/DNS/TCP',
					startKey: 'fetchStart',
					endKey: 'connectEnd'
				}
			]
		},
		{
			timingTypeCategory: CATEGORY_TIMING_SERVER,
			timings: [
				{
					id: CATEGORY_TIMING_SERVER,
timingType:  'Server',
					startKey: 'requestStart',
					endKey: 'responseEnd'
				}
			]
		},
		{
			timingTypeCategory: CATEGORY_TIMING_BROWSER,
			timings: [
				{
					id: CATEGORY_TIMING_BROWSER + '_unload',
timingType:  'Unload',
					startKey: 'unloadEventStart',
					endKey: 'unloadEventEnd'
				},
				{
					id: CATEGORY_TIMING_BROWSER + '_dom',
timingType: 'DOM Processing',
					startKey: 'domLoading',
					endKey: 'domComplete'
				},
				{
					id: CATEGORY_TIMING_BROWSER + '_onload',
timingType:  'onLoad',
					startKey: 'loadEventStart',
					endKey: 'loadEventEnd'
				}
			]
		},
	]
	function initialize() {
		CustomEvent.observe('page_timing', _pageTiming);
		CustomEvent.observe('page_timing_network', _pageTimingNetwork);
		CustomEvent.observe('page_timing_show', _pageTimingShow);
		CustomEvent.observe('page_timing_clear', _clearTimingDiv);
		CustomEvent.observe('page_timing_client', _clientTransaction);
	}
	function _pageTiming(timing) {
		var ms;
		if (timing.startTime)
			ms = new Date() - timing.startTime;
		else
			ms = timing.ms;
		if (isNaN(ms))
			return;
		_initCategories();
		var category = timing.name + '';
		ms = new Number(ms);
		if (!categories[category]) {
			categories[category] = {
				children: [],
				ms: 0
			}
		}
		var cat = categories[category];
		if (timing.child) {
			if (timing.child.description) 
				cat.children.push({ name: timing.child.description + '', script_type: timing.child.type, ms: ms, sys_id: timing.child.sys_id, source_table: timing.child.source_table});
			else
				cat.children.push({ name: timing.child + '', ms: ms});
		}
		cat.ms += ms;
		flushStamp = new Date();
	}
	function _pageTimingNetwork(timing) {
		if (!window._timingStartTime)
			timing.ms = 0;
		else if (window.performance && performance.timing.requestStart != performance.timing.responseStart)
			timing.ms = window.performance.timing.requestStart - window.performance.timing.navigationStart;
		else
			timing.ms = Math.max(0, timing.loadTime - window._timingStartTime - _getTiming('SERV'));
		if (isNaN(timing.ms))
			timing.ms = 0;
		_pageTiming(timing);
	}
	function _appendSvgPatterns(timingGraph, category, timingKey, total) {
		var span = timingGraph.find('.' + category);
span.width(Math.round((_getTiming(timingKey) / total) * 100) + '%');
		span.append($j(getSvgPattern(category)))
	}
	 function _pageTimingShow(evtData) {
		if (!window._timingStartTime)
			return;
		_setRlCatName();
		var tot;
		if (window.performance)
			tot = (window.performance.timing.loadEventEnd - window.performance.timing.navigationStart);
		else
			tot = new Date().getTime() - window._timingStartTime;
		if (tot > 900000) {
			_clearTimingDiv();
			return;
		}
		window._timingTotal = tot;
		var o = {RESP: tot};
		for (var c in categories)
			o[c] = _getTiming(c) + '';
		var isFixed = evtData.isFixed === 'true';
		var div = _getOrCreateTimingDiv(o, isFixed);
		if (tot > 0) {
			var timingGraph = $j('.timing_graph');
			var timingGraphDiv = $j('.timingGraphDiv');
			_appendSvgPatterns(timingGraph, CATEGORY_TIMING_NETWORK, 'NETW', tot);
			_appendSvgPatterns(timingGraph, CATEGORY_TIMING_SERVER, 'SERV', tot);
			_appendSvgPatterns(timingGraph, CATEGORY_TIMING_BROWSER, 'REND', tot);
			if(window.performance) {
				var labels = {
					timingType: getMessage('Timing Type'),
					timeRange: getMessage('Time Range'),
					totalTime: getMessage('Total Time')
				};
				var timingBreakdown = $j('<table class="timing_breakdown table table-condensed" id="glide:timingBreakdown_widget" aria-hidden="false">' +
						'<thead>' +
'       <th aria-hidden="true"></th>' +
'       <th class="timing_label" scope="col">' + labels.timingType + '</th>' +
'       <th id="time_range" scope="col">' + labels.timeRange + '</th>' +
'       <th id="total_time" scope="col">' + labels.totalTime + '</th>' +
'</thead>');
					for (var categoryIndex = 0; categoryIndex < events.length; categoryIndex++) {
						var category = events[categoryIndex];
						var timingTypeCategory = category.timingTypeCategory;
						var timings = category.timings;
						var renderFirstCell = true;
						for (var timingIndex = 0; timingIndex < timings.length; timingIndex++) {
							var timing = timings[timingIndex];
							var timingType = getMessage(timing.timingType);
							var timingID = timing.id;
							var startKey = timing.startKey;
							var endKey = timing.endKey;
							var runTime = new GwtMessage().getMessage("{0}ms", (window.performance.timing[endKey] - window.performance.timing[startKey]));
							var start = Math.max(0, window.performance.timing[startKey] - window.performance.timing.navigationStart);
							var end = Math.max(0, window.performance.timing[endKey] - window.performance.timing.navigationStart);
							var startTime;
							if (start === 0 && end === 0)
								startTime = new GwtMessage().getMessage("{0}ms", 0);
							else
								startTime =  new GwtMessage().getMessage("{0}ms", (start + '-' + end));
							var categoryCell = renderFirstCell ? '' +
								'<td aria-hidden="true" rowspan=' + timings.length + ' class="' + timingTypeCategory + '">' +
									'<div class="wrapper_div">' +
										getSvgPattern(timingTypeCategory, true) +
'</div>' +
'</td>' : '';
							renderFirstCell = false;
							timingBreakdown.append($j('' +
								'<tr>' +
									categoryCell +
									'<th scope="row" id="' + timingID + '" class="timing_label">' +
										timingType +
'</th>' +
									'<td headers="time_range ' + timingTypeCategory + '">' +
										startTime +
'</td>' +
									'<td headers="total_time ' + timingTypeCategory + '">' +
										runTime +
'</td>' +
'</tr>'));
						}
					}
					timingBreakdown.attr('aria-label', getMessage('Timing details breakdown'));
					timingBreakdown.insertAfter(timingGraphDiv);
			}
		}
		
		var img = div.down('img');
		if (!img)
			img = div.down('button');
		if (!img)
			return;
		img.observe('click', toggle.bindAsEventListener(this));
		_trackPagePerformance(o);
	}
	function getSvgPattern(timingCategory, isTableSvg) {
		 var svgClass = isTableSvg ? "table_svg" : "breakdown_svg";
return '<svg class="' + svgClass +'" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">' +
'<rect width="100%" height="100%" fill="url(#pattern_'+ timingCategory + ')" />' +
'</svg>';
	}
	function toggle() {
		_buildDetails();
		var modal = new GlideModal();
		modal.setTitle(getMessage("Browser response time"));
		modal.setPreference('focusTrap', true);
		modal.setBody(gel("glide:timing_widget").outerHTML);
	}
	function _getRow(ariaLabel, label, ms) {
		var row = cel("tr");
		row.setAttribute("aria-label", ariaLabel);
		var col1 = cel("td");
		col1.innerText = label;
		var col2 = cel("td");
		col2.innerText = new GwtMessage().getMessage("{0} ms", ms);
		row.appendChild(col1);
		row.appendChild(col2);
		return row;
	}
	function _buildDetails() {
		if (lastRendered && lastRendered >= flushStamp)
			return;
		var timingDetailTable = gel('page_timing_details');
		while(timingDetailTable.firstChild)
			timingDetailTable.removeChild(timingDetailTable.firstChild);
		var other = _getTiming('REND');
		var el = cel("div");
		el.className = "timing_details";
		var currentCategoryIndex  = 1;
		var totalCategories = _getTotalValidCategories(other);
		CATEGORIES.forEach(function(cat) {
			if (!categories[cat.category])
				return;
			var ms = _getTiming(cat.category) + '';
			if ('RLV2' !== cat.category)
				other -= ms;
			var children = categories[cat.category].children;
			var translatedCategory = getMessage(cat.name);
			var ariaLabel  = new GwtMessage().getMessage("{0} of {1} {2}: {3}", currentCategoryIndex, totalCategories, translatedCategory, ms);
			var row = _getRow(ariaLabel, translatedCategory, ms);
			row.setAttribute("data-children", children.length);
			el.appendChild(row);
			if (children.length > 0) {
				row.className="active";
				_buildChildren(el, children);
			}
			currentCategoryIndex  = currentCategoryIndex + 1;
		});
		if (other > 10) {
			var ariaLabel  = new GwtMessage().getMessage("{0} of {1} Other: {2}", totalCategories, totalCategories, other);
			var row = _getRow(ariaLabel, getMessage("Other"), other);
			row.setAttribute("data-children", 0);
			el.appendChild(row);
		}
		timingDetailTable.appendChild(el);
		lastRendered = new Date();
	}
	function _getTotalValidCategories(other) {
		var totalCategories = 0;
		CATEGORIES.forEach(function(cat) {
			if (!categories[cat.category])
				return;
			else {
				totalCategories =  totalCategories + 1;
				var ms = _getTiming(cat.category) + '';
				if ('RLV2' !== cat.category)
					other -= ms;
			}
		});
		return other > 10 ? (totalCategories + 1) : totalCategories;
	}
	function _buildChildren(parentEl, children) {
		var row;
		for (var i = 0; i < children.length; i++) {
			var child = children[i];
			var childNumber = i+1;
			var childAriaLabel  = new GwtMessage().getMessage("{0} of {1} {2}: {3}", childNumber, children.length, child.name, child.ms);
			row = _getRow(childAriaLabel, child.name, child.ms);
			row.className = "page_timing_child";
			parentEl.appendChild(row);
		}
	}
	function _initCategories() {
		if (categories)
			return;
		categories = {};
		var startTime = 0;
		if (window.performance)
			startTime = window.performance.timing.navigationStart;
		else
			startTime = parseInt(new CookieJar().get('g_startTime'), 10);
		window._timingStartTime = startTime;
	}
	function _getTiming(category) {
		if (!categories[category])
			return 0;
		return Math.max(0, categories[category].ms);
	}
	function _setRlCatName() {
		var isDeferred = window.g_related_list_timing != 'default';
		var postFix = (isDeferred === true) ? ' (async)' :' (sync)';
		for (var i = 0; i < CATEGORIES.length; i++) {
			if ((CATEGORIES[i].category === 'RLV2') && (!hasPostFix(CATEGORIES[i].name)))
				CATEGORIES[i].name = CATEGORIES[i].name + postFix;
		}
		function hasPostFix(cat_name) {
			var cat_name_split = cat_name.split(' ');
			var len = cat_name_split.length;
			return !!((cat_name_split[len - 1] === '(async)') || (cat_name_split[len - 1] === '(sync)'));
		}
	}
	function _clearTimingDiv() {
		window._timingTotal = -1;
		var div = gel('page_timing_div');
		if (div) {
			div.innerHTML = '';
div.style.visibility = 'hidden';
		}
	}
	function setAttrs(el, attrs) {
		for(var key in attrs) {
			el.setAttribute(key, attrs[key]);
		}
	}
	function _getOrCreateTimingDiv(timing, isFixed) {
		var div = gel('page_timing_div');
		if (!div) {
			div = cel('div');
			setAttrs(div, {
				"id": "page_timing_div",
				"role": "complementary",
				"aria-label": getMessage("Timing details"),
				"class": "timingDiv"
			});
			div.appendChild(_getSVGPatternDefinition());
			document.body.appendChild(div);
		}
		div.style.visibility = '';
		_getPageTimingContents(div, timing, isFixed);
		return div;
	}
	function _getSVGPatternDefinition() {
var svgNS = "http://www.w3.org/2000/svg";
		var patternSvg = document.createElementNS(svgNS, "svg");
		setAttrs(patternSvg, {
			"class": "patterns_svg",
			"width": "0",
			"height": "0"
		});
		var defs = document.createElementNS(svgNS, "defs");
		var patternNetwork = document.createElementNS(svgNS, "pattern");
		setAttrs(patternNetwork, {
			"id": "pattern_timing_network",
			"patternUnits": "userSpaceOnUse",
			"width": "5",
			"height": "5",
			"patternTransform": "rotate(45)"
		});
		var patternNetworkLine = document.createElementNS(svgNS, "line");
		setAttrs(patternNetworkLine, {
			"class": "pattern_stroke",
			"x1": "0",
			"y1": "0",
			"x2": "0",
			"y2": "5",
			"stroke-width": "2"
		});
		patternNetwork.appendChild(patternNetworkLine);
		defs.appendChild(patternNetwork);
		var patternServer = document.createElementNS(svgNS, "pattern");
		setAttrs(patternServer, {
			"id": "pattern_timing_server",
			"patternUnits": "userSpaceOnUse",
			"width": "6",
			"height": "6",
			"patternTransform": "rotate(45)"
		});
		var patternServerLineA = document.createElementNS(svgNS, "line");
		setAttrs(patternServerLineA, {
			"class": "pattern_stroke",
			"x1": "0",
			"y1": "3",
			"x2": "2",
			"y2": "3",
			"stroke-width": "2"
		});
		patternServer.appendChild(patternServerLineA);
		var patternServerLineB = document.createElementNS(svgNS, "line");
		setAttrs(patternServerLineB, {
			"class": "pattern_stroke",
			"x1": "4",
			"y1": "3",
			"x2": "6",
			"y2": "3",
			"stroke-width": "2"
		});
		patternServer.appendChild(patternServerLineB);
		defs.appendChild(patternServer);
		var patternBrowser = document.createElementNS(svgNS, "pattern");
		setAttrs(patternBrowser, {
			"id": "pattern_timing_browser",
			"patternUnits": "userSpaceOnUse",
			"width": "5.5",
			"height": "5.5",
			"patternTransform": "rotate(135)"
		});
		var patternBrowserLine = document.createElementNS(svgNS, "line");
		setAttrs(patternBrowserLine, {
			"class": "pattern_stroke",
			"x1": "0",
			"y1": "0",
			"x2": "0",
			"y2": "5.5",
			"stroke-width": "7"
		});
		patternBrowser.appendChild(patternBrowserLine);
		defs.appendChild(patternBrowser);
		patternSvg.appendChild(defs);
		return patternSvg;
	}
	function _getPageTimingContents(container, timing, isFixed) {
		var btnTrigger = cel("button");
		btnTrigger.classList = "pointerhand icon-stop-watch btn btn-icon btn-response-time";
		if (isFixed)
			btnTrigger.classList.add("-fixed-response-time");
		var gwt = new GwtMessage();
		var title = [
			gwt.getMessage('Response time(ms): {0}', timing.RESP),
			gwt.getMessage('Network: {0}', timing.NETW),
			gwt.getMessage('Server: {0}', timing.SERV),
			gwt.getMessage('Browser: {0}', timing.REND)
		].join(", ");
		setAttrs(btnTrigger, {
			"type": "button",
			"aria-controls": "glide:timing_widget",
			"title": title,
			"aria-label": getMessage("Response time")
		});
		container.appendChild(btnTrigger);
		
		var widgetContainer = cel("div");
		widgetContainer.style.display = "none";
		var timingWidget = cel("div");
		setAttrs(timingWidget, {
			"class": "timing_span",
			"id": "glide:timing_widget",
		});
		timingWidget.innerText = title;
		var timingGraphContainer = cel("div");
		timingGraphContainer.className = "timingGraphDiv";
		var timingGraph = cel("span");
		setAttrs(timingGraph, {
			"class": "timing_graph",
			"data-aria-label": getMessage("Show Timing Breakdown")
		});
		var networkGraph = cel("span");
		setAttrs(networkGraph, {
			"class": "timing_network",
			"title": gwt.getMessage('Network: {0}ms', timing.NETW)
		});
		timingGraph.appendChild(networkGraph);
		var serverGraph = cel("span");
		setAttrs(serverGraph, {
			"class": "timing_server",
			"title": gwt.getMessage('Server: {0}ms', timing.SERV)
		});
		timingGraph.appendChild(serverGraph);
		var browserGraph = cel("span");
		setAttrs(browserGraph, {
			"class": "timing_browser",
			"title": gwt.getMessage('Browser: {0}ms', timing.REND)
		});
		timingGraph.appendChild(browserGraph);
		timingGraphContainer.appendChild(timingGraph);
		timingWidget.appendChild(timingGraphContainer);
		var detailTable = cel("table");
		setAttrs(detailTable, {
			"class": "table table-condensed table-timing-detail",
			"aria-label": getMessage('Browser timing detail')
		});
		var detailTableHead = cel("thead");
		var detailTableHeadRow = cel("tr");
		var detailTableHeadColLabel = cel("th");
		detailTableHeadColLabel.innerText = getMessage('Browser timing detail');
		detailTableHeadRow.appendChild(detailTableHeadColLabel);
		var detailTableHeadColVal = cel("th");
		detailTableHeadColVal.innerText = getMessage("Time");
		detailTableHeadRow.appendChild(detailTableHeadColVal);
		detailTableHead.appendChild(detailTableHeadRow);
		detailTable.appendChild(detailTableHead);
		var detailTableBody = cel("tbody");
		detailTableBody.id = "page_timing_details";
		detailTable.appendChild(detailTableBody);
		timingWidget.appendChild(detailTable);
		widgetContainer.appendChild(timingWidget);
		container.appendChild(widgetContainer);
	}
	function _clientTransaction(o) {
		if (!window._timingStartTime || !window._timingTotal || window._timingTotal <= 0 || getActiveUser() === false || getTopWindow().loggingOut === true)
			return;
		if (!Object.entries) {
 			Object.entries = function(obj) {
				var ownProps = Object.keys(obj);
				var i = ownProps.length;
var resArray = new Array(i);
				while (i--)
					resArray[i] = [ownProps[i], obj[ownProps[i]]];
				return resArray;
			}
		};
		if (o === undefined || o === null || !Object.entries(o).length)
			return;
		var det = [];
		for (var i = 0; i < CATEGORIES.length; i++) {
			var cat = CATEGORIES[i];
			if (!o.types[cat.category])
				continue;
			if (!categories[cat.category])
				continue;
			var children = categories[cat.category].children;
			if (!children)
				continue;
			for (var ndx = 0; ndx < children.length; ndx++) {
				var child = children[ndx];
				var t = {};
				t.type_code = cat.category;
				t.type = cat.name;
				t.script_detail = child.script_type;
				t.name = child.name;
				t.duration = child.ms;
				t.sys_id = child.sys_id;
				t.source_table = child.source_table;
				det.push(t);
			}
		}
		var data = {
			'transaction_id': o.transaction_id,
			'table_name': o.table_name,
			'form_name': o.form_name,
			'view_id': o.view_id,
			'transaction_time': window._timingTotal,
			'browser_server_time': _getTiming('SERV'),
			'network_time': _getTiming('NETW'),
			'browser_time': _getTiming('REND'),
			'client_script_time': (_getTiming('CSOL') + _getTiming('CSOC')),
			'policy_time': _getTiming('UIOL'),
			'client_details': Object.toJSON(det)
		};
		if (o.logged_in !== false)
			window.NOW.PageTimingService.send(data);
	}
	function _trackPagePerformance(data) {
		var uxMetricsLabels = {
			'RESP' :  'Page Load Time',
			'SERV' : 'Server Time',
			'NETW' : 'Network Time',
			'REND' : 'Browser Time'
		};
		try {
			var uxMetricsData = [];
			var pathName = decodeURIComponent(document.location.pathname);
var pageName = pathName.match(/[$\w]+(?=.do[?]*)/g)[0];
			for (var c in data) {
				uxMetricsLabels[c] && uxMetricsData.push({name: uxMetricsLabels[c], value:Number(data[c])});
			}
			window.GlideUXMetrics && GlideUXMetrics.trackPerformance(pageName, uxMetricsData);
		} catch (err) {
		}
	}
	var CATEGORIES = [
{ category: 'SCPT', name: 'Script Load/Parse' },
		{ category: 'PARS', name: 'CSS and JS Parse' },
		{ category: 'SECT', name: 'Form Sections' },
		{ category: 'UIOL', name: 'UI Policy - On Load' },
		{ category: 'CSOL', name: 'Client Scripts - On Load' },
		{ category: 'CSOC', name: 'Client Scripts - On Change (initial load)' },
		{ category: 'PROC', name: 'Browser processing before onload' },
		{ category: 'DOMC', name: 'DOMContentLoaded to LoadEventEnd' },
		{ category: 'LOADF', name: 'addLoadEvent functions' },
		{ category: 'RLV2', name: 'Related Lists' }
	]
})()
;
/*! RESOURCE: /scripts/classes/GlideUI.js */
var GlideUI = Class.create({
	initialize: function(id) {
		this.id = id;
		this.topWindow = getTopWindow() || window;
		this.outputMessagesTag = "output_messages";
		this.outputMsgDivClass = ".outputmsg_div";
		this.messages = {};
		if (window.NOW && window.NOW.ngLegacySessionNotificationSupport) {
			return;
		}
		CustomEvent.observe(this.getNotificationEventName('system'), this._systemNotification.bind(this));
		CustomEvent.observe(this.getNotificationEventName('info'), this._systemNotification.bind(this));
		CustomEvent.observe(this.getNotificationEventName('error'), this._systemNotification.bind(this));
		CustomEvent.observe(this.getNotificationEventName('system_event'), this._eventNotification.bind(this));
		this._setupAnnouncer();
		this._scrapePageLoadMessages();
	},
	getNotificationEventName : function (type) {
		var idPrefix = this.id ? '.' + this.id : '';
		return GlideUI.UI_NOTIFICATION + idPrefix + '.' + type;
	},
	setMsgTags: function(msgTag,msgDivClass) {
		this.outputMessagesTag = msgTag;
		this.outputMsgDivClass = msgDivClass;
	},
	display: function(htmlTextOrOptions) {
		alert('GlideUI.display() needs to be implemented in an overriding class');
	},
	fireNotifications: function() {
		var spans = $$('span.ui_notification');
		for (var i = 0; i < spans.length; i++) {
			var span = spans[i];
			this.fire(new GlideUINotification({xml: span}));
		}
	},
fire: function( notification) {
		this.topWindow.CustomEvent.fireTop(GlideUI.UI_NOTIFICATION + '.' + notification.getType(), notification);
	},
_systemNotification: function( notification) {
		if (window.NOW && window.NOW.ngLegacySessionNotificationSupport) {
			return;
		}
		var options = {
				text: notification.getText(),
				type: notification.getType()
		};
		if (!options.text)
			return;
		this.display(options);
	},
_eventNotification: function( notification) {
		var type = notification.getAttribute('event');
		if (type == 'refresh_nav')
			CustomEvent.fireTop('navigator.refresh');
	},
	addOutputMessage: function(options) {
		srMessage = {
			info: "Info Message",
			warning: "Warning Message",
			error: "Error Message",
			success: "Success Message",
			suggestion: "Suggestion Message"
		};
		options = Object.extend({
			msg: '',
			id: '',
			icon: 'icon-info',
			iconSr: srMessage.info,
			type: 'info',
			preventDuplicates: true
		}, options || {});
		document.addEventListener("DOMContentLoaded", function(event) {
			if(window.nowapi) {
				window.nowapi.g_i18n.getMessages([srMessage.info, srMessage.warning, srMessage.error, srMessage.success, srMessage.suggestion], function(translations) {
					srMessage.info = translations[srMessage.info];
					srMessage.warning = translations[srMessage.warning];
					srMessage.error = translations[srMessage.error];
					srMessage.success = translations[srMessage.success];
					srMessage.suggestion = translations[srMessage.suggestion];
				});
			}
		});
		if (options.type === 'error') {
			options.icon = 'icon-cross-circle';
			options.iconSr = srMessage.error;
		} else if (options.type === 'warning') {
			options.icon = 'icon-alert';
			options.iconSr = srMessage.warning;
		} else if (options.type === 'success') {
			options.icon = 'icon-check-circle';
			options.iconSr = srMessage.success;
		} else if (options.type === 'suggestion') {
			options.icon = 'icon-ai-sparkle-fill';
			options.iconSr = srMessage.suggestion;
		}
		var divs = this._getOutputMessageDivs();
		if (!divs)
			return false;
		var newMsg;
		if (typeof options.id == 'undefined' || options.id == '')
			newMsg = GlideUI.OUTPUT_MESSAGE_TEMPLATE.evaluate(options);
		else
			newMsg = GlideUI.OUTPUT_MESSAGE_TEMPLATE_WITH_ID.evaluate(options);
		var messageKey = options.type + "_" + options.msg;
		if (options.preventDuplicates && this.messages[messageKey])
			return false;
		this.messages[messageKey] = true;
		divs.container.insert(newMsg);
		this.show(divs.messages);
		if (options.msg && this._shouldAnnounce(divs.container))
			this._announce(options.type, options.msg);
		if (window._frameChanged)
			_frameChanged();
		return true;
	},
clearOutputMessages: function( closeImg) {
		var divs;
		if (closeImg) {
			closeImg = $(closeImg);
			divs = {
			   messages: closeImg.up(),
			   container:  closeImg.up().select(this.outputMsgDivClass)[0]
			}
		} else
			divs = this._getOutputMessageDivs();
		if (!divs)
			return false;
		this.hide(divs.messages);
		divs.container.innerHTML = '';
		this.messages = {};
		return true;
	},
	scrollIntoView: function() {
		this._getOutputMessageDivs().container.scrollIntoView();
	},
	setNavMessage: function(options) {
		options = Object.extend({
			msg: ''
		}, options || {});
		var navMessage = $('nav_message');
		if(navMessage) {
			navMessage.replace(GlideUI.NAV_MESSAGE_TEMPLATE.evaluate(options));
			this.adjustTopScrollHeight();
			return true;
		}
		var firstNavElement = $$('nav.navbar')[0];
		if(firstNavElement) {
			firstNavElement.setStyle({marginBottom: '0px'});
			firstNavElement.insert({after: GlideUI.NAV_MESSAGE_TEMPLATE.evaluate(options)});
			this.adjustTopScrollHeight();
			return true;
		}
		return false;
	},
	clearNavMessage: function() {
		var navMessage = $('nav_message');
		if(!navMessage)
			return false;
		navMessage.remove();
		var firstNavElement = $$('nav.navbar')[0];
		if(firstNavElement)
			firstNavElement.setStyle({marginBottom: '5px'});
		this.adjustTopScrollHeight();
		return true;
	},
	adjustTopScrollHeight: function() {
		var fixedContent = $$('div[data-position-fixed-header="true"]')[0];
		if(!fixedContent)
			return;
		var scrollContent = $$('div[data-position-below-header="true"]')[0];
		if(!scrollContent)
			return;
		scrollContent.setStyle({
			top: fixedContent.getHeight() + 'px'
		});
		if (fixedContent.getHeight() > 60) {
			var debugRelated = $$('div#debug_related')[0];
			if (debugRelated) {
				var marginHeight = fixedContent.getHeight() + 20;
				debugRelated.setStyle({
					marginTop: marginHeight + 'px'
				});
			}
		}
	},
	show: function(el) {
		if (el.classList.contains('outputmsg_hide'))
			el.classList.remove('outputmsg_hide');
		else if (el.style.display === 'none')
			el.style.display = '';
	},
	hide: function(el) {
		el.classList.add('outputmsg_hide');
	},
	onCloseMessagesButtonClick: function(closeImg) {
		var form = closeImg.up('form');
		this.clearOutputMessages(closeImg);
		this.focusFirstElement(form);
	},
	focusFirstElement: function(form) {
		var element = tabbable(form)[0];
		if (element)
			element.focus();
	},
	_getOutputMessageDivs: function() {
		var divs = {};
		divs.messages = $(this.outputMessagesTag);
		if (!divs.messages)
			return null;
		divs.container = divs.messages.select(this.outputMsgDivClass)[0];
		if (!divs.container)
			return null;
		return divs;
	},
	_setupAnnouncer: function() {
		var self = this;
		addRenderEvent(function() {
			var element = document.createElement('span');
			element.setAttribute('aria-live', 'polite');
			element.setAttribute('class', 'sr-only');
			document.body.appendChild(element);
			self._announcer = element;
		}, false);
	},
	_scrapePageLoadMessages: function() {
		var self = this;
		setTimeout(function() {
			var messages = document.querySelectorAll('.outputmsg_div .outputmsg');
			for (var i = 0; i < messages.length; i++) {
				var msg = messages[i];
				var text = msg.textContent;
				var srOnly = msg.querySelectorAll('.sr-only');
				for (var j = 0; j < srOnly.length; j++) {
					text = text.replace(srOnly[j].textContent, '');
				}
				var type = 'info';
				if (msg.classList.contains('outputmsg_error'))
					type = 'error';
				if (msg.classList.contains('outputmsg_warning'))
					type = 'warning';
				if (self._shouldAnnounce(msg))
					self._announce(type, text);
			}
		}, 2000);
	},
	_announce: function(type, text) {
		if (this._announcer && text) {
			var that = this;
			var textNode;
			setTimeout(function() {
				textNode = document.createTextNode(type + ': ' + text);
				that._announcer.appendChild(textNode);
				that._announcer.appendChild(textNode);
			}, 500);
		}
	},
	_pruneOldMessages: function() {
		var nodes = this._announcer.childNodes;
		for (var i = 0; i < nodes.length; i++) {
			var node = nodes[i];
			if (node.readyToDelete)
				node.parentNode.removeChild(node);
		}
	},
	_shouldAnnounce: function(el) {
		if (!el)
			return false;
		var container = el;
		while(!container.hasClassName('outputmsg_div')) {
			container = container.parentElement;
		}
		if (container.getAttribute('data-server-messages') === 'true') {
			container.removeAttribute('data-server-messages');
			return true;
		}
		return (!container.hasAttribute('aria-live')) && container.querySelectorAll('[aria-live]').length === 0;
	},
	toString: function() {
		return 'GlideUI';
	}
});
GlideUI.UI_NOTIFICATION = 'glide:ui_notification';
GlideUI.UI_NOTIFICATION_SYSTEM = GlideUI.UI_NOTIFICATION + '.system';
GlideUI.UI_NOTIFICATION_INFO = GlideUI.UI_NOTIFICATION + '.info';
GlideUI.UI_NOTIFICATION_ERROR = GlideUI.UI_NOTIFICATION + '.error';
GlideUI.UI_NOTIFICATION_SYSTEM_EVENT = GlideUI.UI_NOTIFICATION + '.system_event';
GlideUI.OUTPUT_MESSAGE_TEMPLATE = new Template(
	'<div role="alert" class="outputmsg outputmsg_#{type} notification notification-#{type}">' +
		'<span class="notification-icon #{icon}">' +
'<span class="sr-only">#{iconSr}</span>' +
'</span>' +
'<span class="outputmsg_text">#{msg}</span>' +
'</div>'
);
GlideUI.OUTPUT_MESSAGE_TEMPLATE_WITH_ID = new Template(
	'<div role="alert" class="outputmsg outputmsg_#{type} notification notification-#{type}" id="#{id}">' +
		'<span class="notification-icon #{icon}">' +
'<span class="sr-only">#{iconSr}</span>' +
'</span>' +
'<span class="outputmsg_text">#{msg}</span>' +
'</div>'
);
GlideUI.NAV_MESSAGE_TEMPLATE = new Template(
	'<div role="alert" id="nav_message" class="outputmsg_nav">' +
'<img src="images/icon_nav_info.png"/>' +
'<span class="outputmsg_text outputmsg_nav_inner">&nbsp;#{msg}</span>' +
'</div>'
);
window.g_GlideUI = new GlideUI();
GlideUI.get = function() {
	return window.g_GlideUI;
};
;
/*! RESOURCE: /scripts/classes/GlideUINotification.js */
var GlideUINotification = Class.create({
       
    initialize: function(options) {
        options = Object.extend({
            type: 'system',
            text: '',
            duration: 0,
            attributes: {},
            xml: null,
            window: window
        }, options || {});
        
        this.window = options.window;
        if (!options.xml) {
            this.type = options.type;
            this.text = options.text;
            this.attributes = options.attributes;
            this.duration = options.duration;
        } else
            this.xml = options.xml;
    },
    getType: function() {
        if (this.xml)
            return this.xml.getAttribute('data-type') || '';
        
        return this.type;
    },
    
    getText: function() {
        if (this.xml)
            return this.xml.getAttribute('data-text') || '';
        
        return this.text;
    },
    getDuration: function() {
        if (this.xml)
            return parseInt(this.xml.getAttribute('data-duration'), 10) || 0;
        return this.duration;
    },
    
    getAttribute: function(n) {
        var v;
        if (this.xml)
            v = this.xml.getAttribute('data-attr-' + n) || '';
        else
            v = this.attributes[n] || '';
        
        return v;
    },
    
    getWindow: function() {
        return this.window;
    },
    
    getChildren: function() {
        if (!this.xml)
            return [];
        
        var children = [];
        var spans = this.xml.childNodes;
        for (var i = 0; i < spans.length; i++) {
            if ((spans[i].getAttribute('class') == 'ui_notification_child') || (spans[i].getAttribute('className') == 'ui_notification_child'))
                children.push(new GlideUINotification({xml: spans[i], window: this.window}));
        }
        
        return children;
    },
    
    toString: function() { return 'GlideUINotification'; }
});
;
/*! RESOURCE: /scripts/classes/GlideUIDefault.js */
var GlideUIDefault = {
    init: function() {},
    display: function(htmlTextOrOptions) {
        if (typeof htmlTextOrOptions == 'string')
            new NotificationMessage({ text: htmlTextOrOptions });
        else
            new NotificationMessage(htmlTextOrOptions);
    }    
};
if (GlideUI.get())
    Object.extend(GlideUI.get(), GlideUIDefault).init();
;
/*! RESOURCE: /scripts/classes/doctype/NotificationMessage.js */
var NotificationMessage = Class.create({
	
	FADE_IN_DEFAULT_MS: 400,
	FADE_OUT_DEFAULT_MS: 200,
	CLOSE_DEFAULT_MS: 3000,
	initialize: function(options) {
		this.options = Object.extend({
			text: '',
			type: 'info',
			image: '',
			styles: {},
			sticky: false,
			fadeIn: this.FADE_IN_DEFAULT_MS,
			fadeOut: this.FADE_OUT_DEFAULT_MS,
			closeDelay: this.CLOSE_DEFAULT_MS,
			classPrefix: 'notification',
			container: 'ui_notification',
			classContainer: 'panel-body',
			bundleMessages: false,
			singleMessage: false,
			onBeforeOpen: function() {},
			onAfterOpen: function() {},
			onBeforeClose: function() {},
			onAfterClose: function() {}
		}, options || {});
		if (this.options.type == 'warn')
			this.options.type = 'warning';
		if (this.options.type === '')
			this.options.type = 'info';
		if (this.options.type == 'system')
			this.options.type = 'info';
		
		this.options.fadeIn = this._validNumber(this.options.fadeIn, this.FADE_IN_DEFAULT_MS);
		this.options.fadeOut = this._validNumber(this.options.fadeOut, this.FADE_OUT_DEFAULT_MS);
		this.options.closeDelay = this._validNumber(this.options.closeDelay, this.CLOSE_DEFAULT_MS);
		this._show();
	},
	
	_show: function() {
		var container = this._getContainer(this.options.container);
		this.options.onBeforeOpen.call(this);
		if (this.options.singleMessage)
			container.update("");
		this.notification = this._create();
		if (!this.options.bundleMessages || container.childElements().length === 0) {
			container.insert(this.notification);
			if (!this.options.sticky) {
				this.timeoutId = setTimeout(this._close.bind(this, false),
					this.options.closeDelay + this.options.fadeIn);
				this.notification.observe('mouseover', this._makeSticky.bind(this));
			}
} else {
			var notification = container.down('.' + this.options.classPrefix);
			if (!notification)
				notification = this.notification;
			this._showOuterPanel(notification);
			NotificationMessage.prototype.messages.push(this.notification);
			this._updateMoreText(notification, NotificationMessage.prototype.messages.length + " more...");
		}
		this.notification.on('click', '.notification_close_action', this._close.bind(this, true));
		this.notification.fadeIn(this.options.fadeIn, function() {
			this.options.onAfterOpen.call(this);
		}.bind(this));
	},
	_close: function(boolCloseImmediately, closeEvent) {
		if (!this.notification || this._isClosing === true)
			return;
		this._isClosing = true;
		this.options.onBeforeClose.call(this);
		clearTimeout(this.timeoutId);
		this.timeoutId = null;
		function _onClose(notification) {
			this._isClosing = false;
			notification.stopObserving();
			var parent = notification.up();
			if (notification.up('.' + this.options.classContainer)
					&& notification
						.up('.' + this.options.classContainer).select('.' + this.options.classPrefix).length  <= 1)
				notification.up('#' + this.options.container).remove();
			else {
				if (notification.parentNode)
					notification.remove();
				notification = null;
			}
			this.options.onAfterClose.call(this);
			if (isMSIE && parent) {
				parent.style.display = "none"
				parent.style.display = "block";
			}
		}
		var notification = this.notification;
		if (closeEvent && closeEvent.element)
			notification = closeEvent.element().up('.' + this.options.classPrefix + '-closable');
		if (boolCloseImmediately)
			_onClose.call(this, notification);
		else
			notification.animate({ height: 0, opacity: 0.2 }, this.options.fadeOut, _onClose.bind(this, notification));
	},
	_makeSticky: function() {
		clearTimeout(this.timeoutId);
		this.notification.stopObserving('mouseover');
		this.notification.down('.close').show();
		this.notification.addClassName(this.options.classPrefix + '_message_sticky');
	},
	_showAll: function(more) {
		if (this.notification.up(".panel-body").length === 0) {
			var notificationContainer = this._createContainer();
			this.notification.insert(notificationContainer)
			this.notification.wrap(notificationContainer);
			this.notification.addClassName("notification_inner");
			this.notification = notificationContainer;
		}
		for (var i = 0; i < NotificationMessage.prototype.messages.length; i++) {
			var notification = NotificationMessage.prototype.messages[i];
			this.notification.up('.panel-body').insert(notification);
			notification.stopObserving('mouseover');
			notification.down('.close').show();
			notification.addClassName(this.options.classPrefix + '_message_sticky');
		}
		more.up('.notification-more-container').hide();
		NotificationMessage.prototype.messages = [];
	},
	_getContainer: function(n) {
		var c = $(n);
		if (c)
			return c.down('.' + this.options.classContainer);
		c = new Element('div', {
			'id': n,
			'className': this.options.classPrefix + '_container notification-closable'
		});
		document.body.appendChild(c);
		this._createHeading(c);
		var body = this._createBody(c);
		this._createFooter(c);
		return body;
	},
	_createContainer: function() {
		return this._createMainDiv(true);
	},
	_createHeading: function(container) {
		var heading = new Element('div', {className: "panel-heading", style: 'display: none;' });
		var close = this._createCloseIcon();
		close.setStyle({display:"block"});
		heading.insert(close);
heading.insert("<h3 class=\"panel-title\">Current Notification Messages</h3>");
		container.insert(heading);
	},
	_createBody: function(container) {
		var el = new Element('div', { className: this.options.classContainer, style: 'padding: 0;' });
		container.insert(el);
		return el;
	},
	_createFooter: function(container) {
		var el = new Element('div', { className: 'panel-footer notification-more-container', style: 'display:none; '});
		container.insert(el);
		el.insert(this._createMoreIcon());
	},
	_create: function() {
		var e = this._createMainDiv();
		e.appendChild(this._createCloseIcon());
		e.insert(sanitizeHtml(this.options.text));
		e.style.display = 'none';
		return e;
	},
	_createCloseIcon: function() {
		var closeIconClass = "icon-cross close";
		if(NOW.isUsingPolaris) {
			closeIconClass = "btn icon-cross close";
		}
		var close = new Element('span', {
			className: closeIconClass,
			style: 'display: ' + (this.options.sticky ? 'block' : 'none')
		});
		close.observe('click', this._close.bind(this,true));
		return close;
	},
	_createMainDiv: function(isContainer) {
		var className = this.options.classPrefix;
		if (!isContainer && this.options.type)
			className += ' notification-closable ' + this.options.classPrefix + '-' + this.options.type;
		else if (isContainer)
			className = this.options.classPrefix + '_message_container panel-body';
		if (this.options.sticky)
			className += ' ' + this.options.classPrefix + '_sticky';
		var e = new Element('div', { 'className' : className });
		e.setStyle(this.options.styles);
		return e;
	},
	_createMoreIcon: function(){
		var more = new Element("a", { "className": "notification-more" });
		more.observe('click',this._showAll.bind(this, more));
		return more;
	},
	_showOuterPanel: function(notification) {
		notification.up('.notification_container').down('.panel-heading').show();
		notification.up('.notification_container').down('.panel-body').style.padding = '';
		notification.up('.notification_container').addClassName('panel panel-default');
		notification.up('.panel').down(".notification-more-container").show();
	},
	_updateMoreText: function(notification, text) {
		notification.up('.panel').select(".notification-more")[0].update(sanitizeHtml(text));
	},
	_validNumber: function(n, v) {
		n = parseInt(n, 10);
		return isNaN(n) ? v : n;
	},
	toString: function() { return 'NotificationMessage'; }
});
NotificationMessage.prototype.messages = [];
;
/*! RESOURCE: /scripts/section.js */
function expandCollapseAllSections(expandFlag) {
	var spans = document.getElementsByTagName('span');
	for (var i = 0; i < spans.length; i++) {
	    if (spans[i].id.substr(0, 8) != "section.") 
	    	continue;
	    	
	    var id = spans[i].id.substring(8);
	    var state = collapsedState(id);
	    if (state == expandFlag) 
	    	toggleSectionDisplay(id);
	}
	CustomEvent.fire('toggle.sections', expandFlag);
}
function collapsedState(sectionName) {
	var el = $(sectionName);
	if (el)
		return (el.style.display == "none");
}
function setCollapseAllIcons(action, sectionID) {
	var exp = gel('img.' + sectionID + '_expandall');
	var col = gel('img.' + sectionID + '_collapseall');
	if (!exp || !col)
		return;
	if (action == "expand") {
		exp.style.display = "none";
		col.style.display = "inline";
		return;
	}
	exp.style.display = "inline";
	col.style.display = "none";
}
function toggleSectionDisplay(id,imagePrefix,sectionID) {
	var collapsed = collapsedState(id);
	setPreference("collapse.section." + id, !collapsed, null);
	hideReveal(id, imagePrefix);
	toggleDivDisplay(id + '_spacer');
	if (collapsed) {
		CustomEvent.fire("section.expanded", id);
		setCollapseAllIcons("expand",sectionID);
	}
}
;
/*! RESOURCE: /scripts/classes/doctype/GlideTabs2.js */
var GlideTabs2 = Class.create({
	initialize: function(className, parentElement, offset, tabClassPrefix, isPreloaded) {
		this._timeout = null;
		this._lastIndex = null;
		this.tabs = [];
		this.tabIDs = [];
		this.tabNames = [];
		this.isHidable = [];
this.className = className;
		if (parentElement == null)
			return;
		this.parentElement = parentElement;
		this.omitCountTotalCount = {};
		this.endPage = {};
		this.endPageCount = {};
		this.doesNextPageExist = {};
		this.isFormTabs = window.g_form && parentElement == g_form.getFormElement();
		this.tabs = this.getChildNodesWithClass(parentElement, className);
		if (offset == 1)
			this.tabs.shift();
		if (this.isFormTabs) {
			CustomEvent.observe("form.loaded", this.markMandatoryTabs.bind(this));
			CustomEvent.observe("ui_policy.loaded", this.startCatchingMandatory.bind(this));
			var initialIndex = parseInt($j('#tabs2_section').attr('data-initial-tab-index'), 10);
			this._lastIndex = isNaN(initialIndex) ? 0 : initialIndex;
		}
		CustomEvent.observe("change.handlers.run", this.showTabs.bind(this));
		CustomEvent.observe("change.handlers.run.all", this.showTabs.bind(this));
		if (className !== 'tabs2_list' || !window.NOW.g_relatedLists)
			CustomEvent.observe("partial.page.reload", this.updateTabs.bind(this));
		this.activated = false;
		this.tabDiv = gel(className);
		this.activeTab = -1;
		this.createTabs(tabClassPrefix, isPreloaded);
		this.state = new GlideTabs2State(className + "_" + g_tabs_reference);
		if (this.tabDiv) {
			var $tabDiv = $j(this.tabDiv);
			$tabDiv.attr('role', 'tablist');
			$tabDiv.attr('aria-label', new GwtMessage().getMessage("Section Tab Lists"));
			$tabDiv.on('keydown', this, this.handleKeydown);
			setTimeout(function (tabDiv) {
				$j(tabDiv.getElementsByClassName('tabs2_tab')).not('.tabs2_active').attr({'tabindex':-1,'aria-selected':false});
			}, 0, this.tabDiv);
		}
	},
	handleKeydown: function (e) {
		var self = e.data;
if (e.which == 37) {
			var newIndex = (self.activeTab -1 + self.tabsTabs.length) % self.tabsTabs.length;
			var loopCount = 0;
			while (self.tabsTabs[newIndex].element.style['display'] == 'none' && loopCount < self.tabsTabs.length) {
				newIndex = (newIndex - 1 + self.tabsTabs.length) % self.tabsTabs.length;
				loopCount++;
			}
			self.setActive(newIndex);
} else if (e.which == 39) {
			var newIndex = (self.activeTab + 1 + self.tabsTabs.length) % self.tabsTabs.length;
			var loopCount = 0;
			while (self.tabsTabs[newIndex].element.style['display'] == 'none' && loopCount < self.tabsTabs.length) {
				newIndex = (newIndex + 1 + self.tabsTabs.length) % self.tabsTabs.length;
				loopCount++;
			}
			self.setActive(newIndex);
} else if (e.which === 36) {
			e.preventDefault();
			self.setActive(0);
} else if (e.which === 35) {
			e.preventDefault();
			self.setActive(self.tabsTabs.length - 1);
		}
		for (var i = 0; i < self.tabs.length; i++) {
			self.tabs[i].setAttribute('aria-hidden', i != self.activeTab);
		}
		var activeTab = $j(this.getElementsByClassName('tabs2_active')[0]);
		activeTab.attr('tabindex', 0);
		activeTab.attr('aria-selected', true);
		activeTab.focus();
		$j(this.getElementsByClassName('tabs2_tab')).not('.tabs2_active').attr({'tabindex':-1,'aria-selected':false});
	},
	_setActive: function(index, shouldSavePreference) {
		if (index < 0 || index > this.tabs.length - 1)
			index = 0;
		var tab = this.tabs[index];
		if (this.activeTab != -1) {
			var previousTab = this.tabs[this.activeTab];
			hide(previousTab);
			this.tabsTabs[this.activeTab].setActive(false);
		}
		show(tab);
		this.activeTab = parseInt(index, 10);
		this._configureTabbable(tab);
		
		if (shouldSavePreference) {
this.state.set(this.activeTab);
		if (this.isFormTabs && this._lastIndex !== this.activeTab && this.tabsTabs[this._lastIndex]) {
			$j(this.tabsTabs[this._lastIndex].element).removeClass('tabs2_active');
				this.saveFormTabPreference();
			}
		}
		this.tabsTabs[index].setActive(true);
	},
	setActive: function(index) {
		this._setActive(index, true);
	},
	
	setActiveNoPreference: function(index) {
		this._setActive(index, false);
	},
	isActivated: function() {
		return this.activated;
	},
	saveFormTabPreference: function() {
		clearTimeout(this._timeout);
		this._timeout = setTimeout(function() {
			this._lastIndex = this.activeTab;
			setPreference('tabs2.section.' + g_form.getTableName(), this.activeTab);
		}.bind(this), 2000);
	},
	deactivate: function() {
		removeClassName(this.parentElement, 'tabs_enabled');
		removeClassName(this.parentElement ,'tabs_disabled');
		addClassName(this.parentElement, 'tabs_disabled');
		if (this.tabs.length == 0)
			return;
		if (isDoctype){
			for (var i = 0; i < this.tabs.length; i++)
				$(this.tabs[i]).removeClassName("tab_section");
		}
		var count = this.tabsTabs.length;
		for (var i = 0; i < count; i++) {
			var tabsTab = this.tabsTabs[i];
			if (tabsTab.isVisible())
				show(this.tabs[i]);
		}
		for (var i = 0; i < this.tabs.length; i++) {
			this.tabs[i].setAttribute('aria-hidden', false);
		}
		hide(this.tabDiv);
		this.activated = false;
	},
	activate: function() {
		if (this.className === "tabs2_vars")
			return;
		removeClassName(this.parentElement, 'tabs_enabled');
		removeClassName(this.parentElement, 'tabs_disabled');
		addClassName(this.parentElement, 'tabs_enabled');
		if (this.tabs.length < 2) {
			this.deactivate();
			return;
		}
		if (isDoctype){
			for (var i = 0; i < this.tabs.length; i++)
				$(this.tabs[i]).addClassName("tab_section");
		}
		show(this.tabDiv);
		this.hideAll();
		var index = this.state.get();
		if (index == null)
			index = 0;
		if (!this.tabsTabs[index] || !this.tabsTabs[index].isVisible()) {
			index = this._findFirstVisibleTab();
			if (index != -1)
				this.setActive(index);
		}
		if (index != -1)
			this.setActive(index);
		for (var i = 0; i < this.tabs.length; i++) {
			if (i != index) {
				this.tabs[i].setAttribute('aria-hidden', true);
			}
		}
		this.activated = true;
	},
	hideAll: function() {
		var tabs = this.tabs;
		for (var i = 0; i < tabs.length; i++)
			hide(tabs[i]);
	},
	hideTabByID: function(tabID) {
		var tabIndex = this.findTabIndexByID(tabID);
		if (tabIndex == -1)
			return;
		this.hideTab(tabIndex);
	},
	hideTabByName: function(name) {
		var tabIndex = this.findTabIndexByName(name);
		if (tabIndex == -1)
			return;
		this.hideTab(tabIndex);
	},
	hideTab: function(index) {
		if(this.isHidable[index] === true) {
hide(this.tabs[index].firstChild);
this.showTabs();
		}
	},
	_findFirstVisibleTab: function() {
		var count = this.tabsTabs.length;
		for (var i = 0; i < count; i++) {
			var tabsTab = this.tabsTabs[i];
			if (tabsTab.isVisible()) {
				this.setActive(i);
				return i;
			}
		}
		return -1;
	},
	showAll: function() {
		var tabs = this.tabs;
		for (var i = 0; i < tabs.length; i++)
			show(tabs[i]);
	},
	showTabByID: function(tabID) {
		var tabIndex = this.findTabIndexByID(tabID);
		if (tabIndex == -1)
			return;
		this.showTab(tabIndex);
	},
	showTabByName: function(name) {
		var tabIndex = this.findTabIndexByName(name);
		if (tabIndex == -1)
			return;
		this.showTab(tabIndex);
	},
	isVisible: function(index) {
		var visibility = this.tabs[index].firstChild.style.display;
		return !(visibility == 'none');
	},
	showTab: function(index) {
		show(this.tabs[index].firstChild);
this.showTabs();
	},
	findTabIndexByID: function(tabID) {
		var count = this.tabIDs.length;
		for (var i = 0; i < count; i++) {
			if (this.tabIDs[i] == tabID)
				return i;
		}
		this.log("findTabIndexByID could not find " + tabID);
		return -1;
	},
	findTabIndexByName: function(tabName) {
		var index = this.tabNames.indexOf(tabName);
		if(index === -1)
			this.log("findTabIndexByName could not find " + tabName);
		return index;
	},
	createTabs: function(tabClassPrefix, isPreloaded) {
		var tabs = this.tabs;
		this.tabsTabs = [];
		for (var i = 0, n = tabs.length, tab, title, name; i < n; i++) {
			tab = tabs[i];
			title = this._getCaption(tab);
			name = tab.getAttribute('tab_caption_raw');
			this.tabsTabs[i] = new GlideTabs2Tab(this, i, title, tabClassPrefix, isPreloaded);
			this.tabIDs[i] = tab.getAttribute('id');
			this.isHidable[i] = true;
			var nameStr = "";
			if (name) {
nameStr = name.toLowerCase().replace(" ", "_").replace(/[^0-9a-z_]/gi, "");
				while (this.tabNames.indexOf(nameStr) > -1)
					nameStr += "_";
			} else {
				nameStr = tab.getAttribute('tab_list_name_raw');
			}
			this.tabNames[i]=nameStr;
			tab.setAttribute('role','tabpanel');
			tab.setAttribute('aria-hidden',true);
			var gwtMessage = new GwtMessage();
			tab.setAttribute('aria-label',gwtMessage.getMessage('{0} Section', name));
			if (!isPreloaded) {
				var header = isDoctype ? cel('span') : cel('h3');
				header.className = 'tab_header';
				if (isTextDirectionRTL()) {
					header.dir = 'rtl';
				}
				header.appendChild(this.tabsTabs[i].getElement());
				if (!this.tabDiv) {
					continue;
				}
				this.tabDiv.appendChild(header);
				var img = cel('img');
				img.className = 'tab_spacer';
img.src = 'images/s.gifx';
				img.width = '4';
				img.height = '24';
				this.tabDiv.appendChild(img);
			}
		}
		this.showTabs();
	},
	showTabs: function() {
		for (var i = 0; i < this.tabs.length; i++) {
			var tab = this.tabs[i];
			var s = tab.firstChild;
			var displayed = s.style.display != 'none';
			this.tabsTabs[i].showTab(displayed);
		}
		this._setActiveTab();
	},
	updateTabs: function() {
		var tabs = this.tabs;
		for (var i = 0; i < tabs.length; i++) {
			var tab = tabs[i];
			var t = this._getCaption(tab)
			this.tabsTabs[i].updateCaption(t);
		}
	},
	_setActiveTab: function() {
		if (this.activeTab == -1)
			return;
		var currentTab = this.tabsTabs[this.activeTab];
		if (currentTab.isVisible())
			return;
		for (var i = 0; i < this.tabsTabs.length; i++) {
			var t = this.tabsTabs[i];
			if (!t.isVisible())
				continue;
			this.setActive(i);
			break;
		}
	},
	startCatchingMandatory: function() {
		this.markMandatoryTabs();
		CustomEvent.observe("mandatory.changed", this.markMandatoryTabs.bind(this));
	},
	markMandatoryTabs: function() {
		this.markAllTabsOK();
		if (typeof(g_form) == 'undefined')
			return;
		var missingFields = g_form.getMissingFields();
		for (var i = 0; i < missingFields.length; i++)
			this.markTabMandatoryByField(missingFields[i]);
	},
	markTabMandatoryByField: function(field) {
		var i = this.findTabIndex(field);
		if (i == -1)
			return;
		this.isHidable[i] = false;
		if(!this.isVisible(i))
			this.showTab(i);
		this.tabsTabs[i].markAsComplete(false);
	},
	findTabIndex: function(fieldName) {
		var answer = -1;
		if (typeof(g_form) == 'undefined')
			return;
		var element = g_form.getControl(fieldName);
		var tabSpan = findParentByTag(element, "span");
		while (tabSpan) {
			if (hasClassName(tabSpan, 'tabs2_section'))
				break;
			tabSpan = findParentByTag(tabSpan, "span");
		}
		for (i = 0; i < this.tabs.length; i++) {
			if (this.tabs[i] == tabSpan) {
				answer = i;
				break;
			}
		}
		return answer;
	},
	markAllTabsOK: function() {
		for (var i = 0; i < this.tabsTabs.length; i++)  {
			this.isHidable[i] = true;
			this.tabsTabs[i].markAsComplete(true);
		}
	},
	hasTabs: function() {
		return this.tabs.length > 1;
	},
	_configureTabbable: function(tab) {
		if (window.tabbable) {
			var tabbableItems = window.tabbable(tab);
			if (tabbableItems.length === 0)
				tab.setAttribute("tabindex", "0");
		}
	},
	_bumpSpacer: function(newHeight) {
		var spacerDiv = gel('tabs2_spacer');
		if (!spacerDiv || !newHeight)
			return;
		var spacerHeight = spacerDiv.offsetHeight;
		if (newHeight < spacerHeight)
			return;
		spacerDiv.style.height = newHeight + "px";
		spacerDiv.style.minHeight = newHeight +"px";
	},
	_getCaption: function(tab) {
		var caption = tab.getAttribute('tab_caption');
		var rows = this._getRowCount(tab);
		if (!rows || rows == 0)
			return caption;
		if (tab) {
			if (tab.getAttribute('glide_list_omit_count') == 'false')
				rows = formatNumber(rows);
		}
		if (rows == 0)
			return caption;
		return new GwtMessage().getMessage("{0} ({1})", caption, rows);
	},
	_getRowCount: function(tab) {
		if (tab.firstChild && (tab.firstChild.tagName.toLowerCase() == "span") && tab.id && tab.id.endsWith("_tab")) {
			var rows = tab.getAttribute('tab_rows');
			if (!rows)
				return null;
			var span = tab.firstChild;
			if (!span)
				return null;
			var f;
			for (var i = 0; i < span.childNodes.length; i++) {
				f = span.childNodes[i];
				if (f.tagName.toLowerCase() == "form")
					break;
			}
			if (!f || !f[rows])
				return 0;
			return f[rows].value;
		}
		var id = tab.id.substring(0, tab.id.length - 5) + "_table";
		var idList = tab.id;
		var tab = gel(id);
		if (tab) {
			var omitCount = tab.getAttribute('glide_list_omit_count') == 'true',
				rowsPerPage = parseInt(tab.getAttribute('rows_per_page'), 10),
				totalRows = parseInt(tab.getAttribute('total_rows'), 10),
				firstRow = parseInt(tab.getAttribute('first_row'), 10);
			this.doesNextPageExist[id] = (rowsPerPage + 1) === totalRows;
			if (omitCount) {
				if (isNaN(this.omitCountTotalCount[id]))
					this.omitCountTotalCount[id] = 0;
				if (this.activeTab != -1 && this.tabs[this.activeTab].id != idList && !this.endPage[id])
					return Math.max(totalRows - 1, this.omitCountTotalCount[id]) + '+';
				if (this.doesNextPageExist[id] && !this.endPage[id] && firstRow > this.omitCountTotalCount[id]) {
					this.omitCountTotalCount[id] += totalRows - 1;
					if (this.omitCountTotalCount[id] > totalRows - 1)
						return this.omitCountTotalCount[id] + '+';
					return (totalRows - 1) + '+';
				}
				if (!this.doesNextPageExist[id] && !this.endPage[id]) {
					this.endPage[id] = true;
					this.endPageCount[id] = this.omitCountTotalCount[id] += totalRows;
				}
				if (this.endPage[id])
					return this.endPageCount[id];
				if (this.omitCountTotalCount[id] != 0)
					return this.omitCountTotalCount[id] + '+';
				return (totalRows - 1) + '+';
			}
			if (totalRows <= rowsPerPage) {
				var skippedRowsSpan = $(id.substring(0, id.length - 6) + "_skipped_count");
				if (skippedRowsSpan) {
					var v = skippedRowsSpan.getAttribute("skip_count");
					var skippedRows = parseInt(v);
					if (!isNaN(skippedRows)) {
						totalRows -= skippedRows;
						return String(totalRows);
					}
				}
			}
			return tab.getAttribute('total_rows');
		}
		return "";
	},
	getChildNodesWithClass: function(p, className) {
		var children = p.childNodes;
		var answer = [];
		for (var i = 0, nodes = 0, n = children.length; i < n; i++) {
			var node = children[i];
			if (hasClassName(node, className))
				answer.push(node);
		}
		return answer;
	},
	log: function(msg) {
		jslog("GlideTabs2 " + msg);
	},
	type: 'GlideTabs2'
});
;
/*! RESOURCE: /scripts/classes/doctype/GlideTabs2Tab.js */
var GlideTabs2Tab = Class.create({
	initialize: function(parent, index, caption, classPrefix, isPreloaded) {
		var el;
		var tabs = isPreloaded ? $j('#tabs2_section').find('.tabs2_tab') : '';
this.caption = caption.replace(/\s/g, "\u00a0");
		this.parent = parent;
		this.index = index;
		if (isPreloaded && tabs.length !== 0 && tabs[index]) {
			el = tabs[index];
			this.element = el;
			this.classPrefix = "tabs2";
			this.mandatorySpan = $j(el).find('[mandatory=true]')[0];
			this._createMandatorySpan(this.mandatorySpan);
		} else {
			this.element = cel("span");
			el = this.element;
			if (!classPrefix)
				this.classPrefix = "tabs2";
			else
				this.classPrefix = classPrefix;
			el.className = this.classPrefix + '_tab';
			el.tabIndex = "0";
			el.setAttribute('role', 'tab');
			this.mandatorySpan = this._createMandatorySpan();
			el.appendChild(this.mandatorySpan);
			var c = cel("span");
			c.className = "tab_caption_text";
			c.innerHTML = this.caption;
			el.appendChild(c);
		}
		if (isTextDirectionRTL() && (isMSIE6 || isMSIE7 || isMSIE8 || (isMSIE9 && !getTopWindow().document.getElementById('edge_west'))))
			$j(el).addClass('tabs2_tab_ie');
		Event.observe(el, 'click', this.onClick.bind(this));
		Event.observe(el, 'mouseover', this.onMouseOver.bind(this));
		Event.observe(el, 'mouseout', this.onMouseOut.bind(this));
	},
	setActive: function(yesNo) {
		if (yesNo) {
			this.element.setAttribute('tabindex',0);
			addClassName(this.element, this.classPrefix + '_active');
			CustomEvent.fire("tab.activated", this.parent.className + (this.index+1));
		} else {
			this.element.setAttribute('tabindex',-1);
			removeClassName(this.element, this.classPrefix + '_active');
		}
		this.element.setAttribute('aria-selected',yesNo);
		this.element.setAttribute('aria-controls',this.parent.tabIDs[this.index]);
		this.parent.tabs[this.index].setAttribute('aria-hidden',!yesNo);
	},
	showTab: function(yesNo) {
		var display = 'none';
		if (yesNo)
			display = '';
		this.element.style.display = display;
		var elementParent = this.element.parentElement;
		if (!elementParent || elementParent.tagName != 'H3')
			return;
		var elementParentSibling = elementParent.nextSibling;
		if (elementParentSibling && elementParentSibling.tagName == 'IMG')
			elementParentSibling.style.display = display;
	},
	updateCaption: function(caption) {
		this.caption = caption;
		this.getElement().getElementsByClassName('tab_caption_text')[0].innerHTML = this.caption;
	},
	isVisible: function() {
		return this.element.style.display == '';
	},
	getElement: function() {
		return this.element;
	},
	onClick: function() {
		this.parent.setActive(this.index);
	},
	onMouseOver: function() {
		addClassName(this.element, this.classPrefix + '_hover');
	},
	onMouseOut: function() {
		removeClassName(this.element, this.classPrefix + '_hover');
	},
	markAsComplete: function(yesNo) {
		this.mandatorySpan.style.visibility = yesNo ? 'hidden' : '';
		if (yesNo)
			this.element.removeAttribute('aria-describedby');
		else
			this.element.setAttribute('aria-describedby', 'tab2_section_mandatory_text_' + this.index);
		if (isDoctype())
			this.mandatorySpan.style.display = yesNo ? 'none' : 'inline-block';
	},
	_createMandatorySpan: function(element) {
		var answer = element || cel("span");
		answer.style.marginRight = '2px';
		answer.style.visibility = 'hidden';
		if (isDoctype()) {
			answer.setAttribute('mandatory', 'true');
			answer.setAttribute('aria-hidden', 'true');
			answer.className = 'label_description';
			answer.innerHTML = '*';
			answer.style.display = 'none';
		} else {
			answer.className = 'mandatory';
			var img = cel("img", answer);
img.src = 'images/s.gifx';
			img.alt = '';
			img.style.width = '4px';
			img.style.height = '12px';
			img.style.margin = '0px';
		}
		return answer;
	}
});
;
/*! RESOURCE: /scripts/classes/GlideTabs2State.js */
var GlideTabs2State = Class.create({
	initialize: function(name) {
	    this.name = name; 
	    this.cj = new CookieJar();
	},
	
	get: function() {
	   return this.cj.get(this.name);
	},
	
	set: function(value) {
	   this.cj.put(this.name, value); 
	}, 
	
	type: 'GlideTabs2State'
});
;
/*! RESOURCE: /scripts/doctype/tabs2_14.js */
(function() {
	"use strict";
	window.g_tabs2Sections = null;
	window.g_tabs2List = null;
	function tabs2Init() {
		initFormTabs();
	}
	function initFormTabs() {
		var f = document.forms[0];
		window.g_tabs2Sections = new GlideTabs2('tabs2_section', f, 1, undefined, true);
		initTabs(window.g_tabs2Sections);
		initVariablesTabs();
	}
	function initRelatedListTabs() {
		var f = $j('#related_lists_wrapper')[0];
		window.g_tabs2List = new GlideTabs2('tabs2_list', f, 0);
		initTabs(window.g_tabs2List);
		for (var i = 0; i < hiddenOnLoad.length; i++) 
			hideTab(hiddenOnLoad[i]);
		for (var i = 0; i <showOnLoad.length; i++)
			showTab(showOnLoad[i]);
		showOnLoad = [];
		hiddenOnLoad = [];
	}
	
	function initVariablesTabs() {
		var f = $j('[id^="var_container"]');
		for (var i = 0, l = f.length; l > i; i++) {
			var varTabs = new GlideTabs2("tabs2_vars", f[i], 0);
			initTabs(varTabs);
			varTabs.deactivate();
		}
	}
	function initTabs(tabSet) {
		if (window.g_tabs_print) {
			tabSet.deactivate();
			return;
		}
		if (window.g_tabs_preference)
			tabSet.activate();
		else
			tabSet.deactivate();
		if (!hasTabs(window.g_tabs2Sections) && !hasTabs(window.g_tabs2List))
			tabs2ToggleDisable();
	}
function hasTabs( tabSet) {
		if (tabSet === null)
			return true;
		return tabSet.hasTabs();
	}
	function tabs2ToggleDisable() {
	}
	function tabs2Toggle() {
		window.g_tabs_preference = !window.g_tabs_preference;
		CustomEvent.fireAll('tabbed', window.g_tabs_preference);
	}
	
	CustomEvent.observe('tabbed', function(trueFalse) {
		window.NOW.tabbed = trueFalse;
		window.g_tabs_preference = window.NOW.tabbed;
		setPreference('tabbed.forms', window.g_tabs_preference);
		setTabbed();
	})
	
	function setTabbed() {
		if (window.g_tabs_preference) {
			window.g_tabs2Sections.activate();
			if (window.g_tabs2List)
				window.g_tabs2List.activate();
			CustomEvent.fire('tabs.enable');
		} else {
			window.g_tabs2Sections.deactivate();
			if (window.g_tabs2List)
				window.g_tabs2List.deactivate();
			CustomEvent.fire('tabs.disable');
		}
	}
	window.tabs2Init = tabs2Init;
	window.tabs2Toggle = tabs2Toggle;
	CustomEvent.observe('related_lists.ready', initRelatedListTabs);
	var hiddenOnLoad = [];
	var showOnLoad = [];
	CustomEvent.observe('related_lists.show', function(listTableName) {
		if (window.NOW.g_relatedLists) {
			if (!window.NOW.g_relatedLists.loaded) {
				showOnLoad.push(listTableName);
				return;
			}
		}
		if (!window.g_tabs2List) {
			if (showOnLoad.indexOf(listTableName) == -1)
				showOnLoad.push(listTableName);
			return;
		}
		showTab(listTableName);
	});
	CustomEvent.observe('related_lists.hide', function(listTableName) {
		if (window.NOW.g_relatedLists) {
			if (!window.NOW.g_relatedLists.loaded) {
				hiddenOnLoad.push(listTableName);
				return;
			}
		}
		if (!window.g_tabs2List) {
            if (hiddenOnLoad.indexOf(listTableName) == -1)
                hiddenOnLoad.push(listTableName);
            return;
        }
        hideTab(listTableName);
    });
    function showTab(listTableName) {
        var relatedListID = g_form._getRelatedListID(listTableName);
        window.g_tabs2List.showTabByID(relatedListID);
        if (!window.g_tabs2List.isActivated())
            show(relatedListID);
		formatLastTabRoundedBorder();
	    if (window.NOW.g_relatedLists)
	        if (window.NOW.g_relatedLists.loaded)
	            CustomEvent.fire('calculate_fixed_headers');
    }
    function hideTab(listTableName) {
          var relatedListID = g_form._getRelatedListID(listTableName);
          window.g_tabs2List.hideTabByID(relatedListID);
          if (!g_tabs2List.isActivated())
            hide(relatedListID);
		formatLastTabRoundedBorder();
    }
	function formatLastTabRoundedBorder() {
		$j('.tabs2_strip .tabs2_tab:visible').removeClass('last_tab_closure');
		$j('.tabs2_strip .tabs2_tab:visible:last').addClass('last_tab_closure');
	}
})();
;
/*! RESOURCE: /scripts/annotations_toggle.js */
var SN = SN || {};
SN.formAnnotations = {
	preference: false,
annotations: null,
	hide: function() {
		SN.formAnnotations.annotations.fadeOut();
		SN.formAnnotations.preference = false;
	},
	show: function() {
		if(isPolarisTemplate())
			SN.formAnnotations.annotations.fadeIn().css('display', 'block');
		else
			SN.formAnnotations.annotations.fadeIn();
		SN.formAnnotations.preference = true;
	},
	toggle: function () {
		if (SN.formAnnotations.preference) {
			SN.formAnnotations.hide();
			GlideUXMetrics && GlideUXMetrics.track('Toggle Annotations', { action: 'Off' });
		}
		else {
			SN.formAnnotations.show();
			GlideUXMetrics && GlideUXMetrics.track('Toggle Annotations', { action: 'On' });
		}
		setPreference('glide.ui.show_annotations', SN.formAnnotations.preference);
	},
	toggleFromInfoMsg: function() {
		SN.formAnnotations.toggle();
		GlideUI.get().clearOutputMessages();
	},
	init: function() {
		var selectors = ['.annotation-row[data-annotation-type="Info Box Blue"]',
		                 '.annotation-row[data-annotation-type="Info Box Red"]',
		                 '.annotation-row[data-annotation-type="Section Details"]',
		                 '.annotation-row[data-annotation-type="Text"]'];
		
		SN.formAnnotations.annotations = $j(selectors.join(','));
		var $annotationButton = $j('#header_toggle_annotations');
		if (SN.formAnnotations.annotations.length) {
			$annotationButton.show().click(SN.formAnnotations.toggle);
			if (!SN.formAnnotations.preference && SN.formAnnotations.infoPreference) {
				SN.formAnnotations.addHiddenAnnotationMessage();
				$j("#info_toggle_annotations").show().click(SN.formAnnotations.toggleFromInfoMsg);
			}
		} else {
			$annotationButton.prop('disabled', true)
			var $annotationTooltip = $annotationButton.closest('.annotation-tooltip');
			$annotationTooltip.attr('title', $annotationTooltip.attr('data-title-disabled'));
		}
		
		if (SN.formAnnotations.preference)
			SN.formAnnotations.show();
	},
	setInfoPref: function() {
		setPreference("glide.ui.annotations.show_hidden_msg", "false");
		GlideUI.get().clearOutputMessages();
	},
	addHiddenAnnotationMessage: function() {
		var msg = getMessage('This form has annotations - click');
msg += ' <span id="info_toggle_annotations" tabindex="0" class="icon-button icon-help sn-cloak" title="Toggle annotations on / off" style="display: inline-block;color:#678;cursor:pointer;font-size:1.4em"></span> ';
		msg += getMessage("to toggle them");
		msg += ' - (<span style="text-decoration:underline;cursor:pointer;" onclick="SN.formAnnotations.setInfoPref()">';
		msg += getMessage("click here");
msg += '</span> ';
		msg += getMessage("to never show this again");
		msg += ')';
		g_form.addInfoMessage(msg);
	}
};
;
/*! RESOURCE: /scripts/doctype/js_includes_doctype.js */
/*! RESOURCE: scripts/GlideFlow.js */
var GlideFlow=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=188)}([function(e,t,n){var r=n(3),o=n(9),i=n(23),u=n(30),s=n(16),a=function(e,t,n){var c,f,l,d,p=e&a.F,h=e&a.G,v=e&a.S,g=e&a.P,b=e&a.B,m=h?r:v?r[t]||(r[t]={}):(r[t]||{}).prototype,y=h?o:o[t]||(o[t]={}),_=y.prototype||(y.prototype={});for(c in h&&(n=t),n)l=((f=!p&&m&&void 0!==m[c])?m:n)[c],d=b&&f?s(l,r):g&&"function"==typeof l?s(Function.call,l):l,m&&u(m,c,l,e&a.U),y[c]!=l&&i(y,c,d),g&&_[c]!=l&&(_[c]=l)};r.core=o,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a},function(e,t,n){var r=n(102)("wks"),o=n(68),i=n(3).Symbol,u="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=u&&i[e]||(u?i:o)("Symbol."+e))}).store=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(12));t.default=function(e){function t(t){window.console&&console.log(e+" "+t)}return{debug:function(e){"debug"===r.default.logLevel&&t("[DEBUG] "+e)},addInfoMessage:function(e){t("[INFO] "+e)},addErrorMessage:function(e){t("[ERROR] "+e)},addWarnMessage:function(e){t("[WARN] "+e)}}}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){"use strict";var r=n(121),o=Object.prototype.toString;function i(e){return"[object Array]"===o.call(e)}function u(e){return void 0===e}function s(e){return null!==e&&"object"==typeof e}function a(e){if("[object Object]"!==o.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===o.call(e)}function f(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!u(e)&&null!==e.constructor&&!u(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isPlainObject:a,isUndefined:u,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:c,isStream:function(e){return s(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:f,merge:function e(){var t={};function n(n,r){a(t[r])&&a(n)?t[r]=e(t[r],n):a(n)?t[r]=e({},n):i(n)?t[r]=n.slice():t[r]=n}for(var r=0,o=arguments.length;r<o;r++)f(arguments[r],n);return t},extend:function(e,t,n){return f(t,(function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var r=n(33),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t,n){"use strict";var r=n(24);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){var r=n(130),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(71);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(1)("unscopables"),o=Array.prototype;null==o[r]&&n(23)(o,r,{}),e.exports=function(e){o[r][e]=!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.WEBSOCKET_TYPE_NAME=t.TOKEN_MANAGEMENT_EXTENSION=void 0,t.WEBSOCKET_TYPE_NAME="websocket",t.TOKEN_MANAGEMENT_EXTENSION="tokenManagementExtension";t.default={servletPath:"amb",logLevel:"info",loginWindow:"true",wsConnectTimeout:1e4,overlayStyle:"",pruneFailedTransports:"true",subscribeCommandsFlow:{enable:!1,maxInflight:1,maxWait:1e4,retries:3,retryDelay:{min:2e3,max:3e5,increaseFactor:2}},redeliveryDisconnectTimeoutInMins:10,requestHeaderToClearStickySessionCookie:!0}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(15);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(17);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(16),o=n(43),i=n(10),u=n(6),s=n(78);e.exports=function(e,t){var n=1==e,a=2==e,c=3==e,f=4==e,l=6==e,d=5==e||l,p=t||s;return function(t,s,h){for(var v,g,b=i(t),m=o(b),y=r(s,h,3),_=u(m.length),x=0,w=n?p(t,_):a?p(t,0):void 0;_>x;x++)if((d||x in m)&&(g=y(v=m[x],x,b),e))if(n)w[x]=g;else if(g)switch(e){case 3:return!0;case 5:return v;case 6:return x;case 2:w.push(v)}else if(f)return!1;return l?-1:c||f?f:w}}},function(e,t,n){var r=n(274),o=n(279);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o,i,u,s){if(!e){var a;if(void 0===t)a=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,i,u,s],f=0;(a=new Error(t.replace(/%s/g,(function(){return c[f++]})))).name="Invariant Violation"}throw a.framesToPop=1,a}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(31),o=n(70);e.exports=n(32)?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(26),o=n(275),i=n(276),u=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":u&&u in Object(e)?o(e):i(e)}},function(e,t,n){var r=n(8).Symbol;e.exports=r},function(e,t,n){var r=n(97),o=n(368),i=n(369),u=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":u&&u in Object(e)?o(e):i(e)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(3),o=n(23),i=n(42),u=n(68)("src"),s=Function.toString,a=(""+s).split("toString");n(9).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(c&&(i(n,u)||o(n,u,e[t]?""+e[t]:a.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[u]||s.call(this)}))},function(e,t,n){var r=n(14),o=n(191),i=n(192),u=Object.defineProperty;t.f=n(32)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return u(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports=!n(24)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t){e.exports={}},function(e,t,n){var r=n(43),o=n(71);e.exports=function(e){return r(o(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(239);Object.defineProperty(t,"startFlow",{enumerable:!0,get:function(){return r.startFlow}}),Object.defineProperty(t,"startSubflow",{enumerable:!0,get:function(){return r.startSubflow}}),Object.defineProperty(t,"startAction",{enumerable:!0,get:function(){return r.startAction}}),Object.defineProperty(t,"getExecution",{enumerable:!0,get:function(){return r.getExecution}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FLOW_TYPES={FLOW:"flow",SUBFLOW:"subflow",ACTION:"action"},t.FLOWOBJECT_API_PATH="api/now/processflow/flowobject",t.START="start",t.OUTPUTS="outputs",t.STATUS="status"},function(e,t,n){var r=n(141),o=n(304),i=n(50);e.exports=function(e){return i(e)?r(e):o(e)}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){(function(e){var r=n(8),o=n(302),i=t&&!t.nodeType&&t,u=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=u&&u.exports===i?r.Buffer:void 0,a=(s?s.isBuffer:void 0)||o;e.exports=a}).call(this,n(39)(e))},function(e,t,n){var r=n(92),o=n(45),i=n(334),u=n(5);e.exports=function(e,t){return(u(e)?r:i)(e,o(t,3))}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(22);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(33),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},function(e,t,n){var r=n(262),o=n(311),i=n(53),u=n(5),s=n(320);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?u(e)?o(e[0],e[1]):r(e):s(e)}},function(e,t,n){var r=n(264),o=n(265),i=n(266),u=n(267),s=n(268);function a(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=s,e.exports=a},function(e,t,n){var r=n(81);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(19)(Object,"create");e.exports=r},function(e,t,n){var r=n(288);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(62),o=n(88);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t,n){var r=n(25),o=n(13);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},function(e,t,n){var r=n(51);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(155),o=n(156);e.exports=function(e,t,n,i){var u=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var c=t[s],f=i?i(n[c],e[c],c,n,e):void 0;void 0===f&&(f=e[c]),u?o(n,c,f):r(n,c,f)}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,r.default)((0,o.default)(e),"executionId is a required string argument"),!0};var r=i(n(21)),o=i(n(96));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){var r=n(164),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WS_CONNECTION_NODE_ID=t.TRANSACTION_ALREADY_SUBMITTED=t.REQUEST_SUCCESS=t.REQUEST_ACCEPTED=t.PUBLISH_FAILURE=t.NODEID_COOKIE_KEY=t.MSG_SHARD=t.MSG_NUM=t.MISSING_REQUEST_DATA=t.MISSING_INTERACTION_ID=t.META_HANDSHAKE=t.MESSAGE_REDELIVERY_OPTIONS=t.GLIDE_REMEMBER_ME=t.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC=t.CHANNEL_READY_TO_DELIVER=t.CHANNEL_NOT_READY_TO_DELIVER=t.CANCEL_TRANSACTION_CHANNEL=t.CANCEL_TRANSACTION_ACTION=void 0,t.MSG_NUM="msg_num",t.MSG_SHARD="msg_shard",t.MESSAGE_REDELIVERY_OPTIONS="msg_redelivery_options",t.CHANNEL_READY_TO_DELIVER="Channel set to deliver messages now: ",t.CHANNEL_NOT_READY_TO_DELIVER="Channel set to not deliver messages until re-subscription & re-delivery of missed messages is over: ",t.META_HANDSHAKE="/meta/handshake",t.WS_CONNECTION_NODE_ID="glide.amb.wsConnectionNodeId",t.NODEID_COOKIE_KEY="glide_node_id_for_js",t.GLIDE_REMEMBER_ME="glide.remember.me",t.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC="glide.amb.hup.signal.reconnect.in.sec",t.CANCEL_TRANSACTION_CHANNEL="/service/transaction/cancel",t.CANCEL_TRANSACTION_ACTION="cancelTransaction",t.REQUEST_SUCCESS="200::Success",t.REQUEST_ACCEPTED="202::Request accepted",t.MISSING_REQUEST_DATA="400::Missing request data",t.MISSING_INTERACTION_ID="400::Missing nowUiInteractionId id",t.TRANSACTION_ALREADY_SUBMITTED="409::Transaction with nowUiInteraction has already been submitted for cancel",t.PUBLISH_FAILURE="503::Unable to publish message"},function(e,t,n){var r=n(27),o=n(29);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==r(e)}},function(e,t,n){var r=n(180)(Object,"create");e.exports=r},function(e,t,n){var r=n(427);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(433);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},function(e,t,n){var r=n(25),o=n(20);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var r=n(94),o=n(93),i=n(45),u=n(331),s=n(5);e.exports=function(e,t,n){var a=s(e)?r:u,c=arguments.length<3;return a(e,i(t,4),n,c,o)}},function(e,t,n){e.exports=n(242)},function(e,t,n){var r=n(152),o=n(93),i=n(330),u=n(5);e.exports=function(e,t){return(u(e)?r:o)(e,i(t))}},function(e,t,n){var r=n(22),o=n(1)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,u;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:i?r(t):"Object"==(u=r(t))&&"function"==typeof t.callee?"Arguments":u}},function(e,t){e.exports=!1},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(15),o=n(3).document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(35),o=n(6),i=n(44);e.exports=function(e){return function(t,n,u){var s,a=r(t),c=o(a.length),f=i(u,c);if(e&&n!=n){for(;c>f;)if((s=a[f++])!=s)return!0}else for(;c>f;f++)if((e||f in a)&&a[f]===n)return e||f||0;return!e&&-1}}},function(e,t,n){var r=n(102)("keys"),o=n(68);e.exports=function(e){return r[e]||(r[e]=o(e))}},function(e,t,n){var r=n(3).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(31).f,o=n(42),i=n(1)("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){"use strict";var r=n(17);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){var r=n(22);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(218);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(448),o=(0,function(e){return e&&e.__esModule?e:{default:e}}(n(367)).default)();t.default=function(e,t,n){var i=n.body,u=n.transform,s=(0,r.snHttpFactory)({xsrfToken:o.g_ck});return new Promise((function(n,r){s.request(e,t,{data:i,batch:!1}).then((function(e){var t=e.data.result;n(u(t))})).catch((function(e){var t=e.response,n=(t=void 0===t?{}:t).data.error;r(n)}))}))}},function(e,t,n){var r=n(46),o=n(269),i=n(270),u=n(271),s=n(272),a=n(273);function c(e){var t=this.__data__=new r(e);this.size=t.size}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=u,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(19)(n(8),"Map");e.exports=r},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(280),o=n(287),i=n(289),u=n(290),s=n(291);function a(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=s,e.exports=a},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}},function(e,t,n){var r=n(299),o=n(140),i=Object.prototype.propertyIsEnumerable,u=Object.getOwnPropertySymbols,s=u?function(e){return null==e?[]:(e=Object(e),r(u(e),(function(t){return i.call(e,t)})))}:o;e.exports=s},function(e,t,n){var r=n(301),o=n(13),i=Object.prototype,u=i.hasOwnProperty,s=i.propertyIsEnumerable,a=r(function(){return arguments}())?r:function(e){return o(e)&&u.call(e,"callee")&&!s.call(e,"callee")};e.exports=a},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(5),o=n(51),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||u.test(e)||!i.test(e)||null!=t&&e in Object(t)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(326),o=n(329)(r);e.exports=o},function(e,t){e.exports=function(e,t,n,r){var o=-1,i=null==e?0:e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}},function(e,t,n){var r=n(135);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t,n){var r=n(27),o=n(28),i=n(29);e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==r(e)}},function(e,t,n){var r=n(56).Symbol;e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2));t.default=function(e,t,n){var o,i,u=new r.default("amb.ChannelListener"),s=e;return{getCallback:function(){return i},getSubscriptionCallback:function(){return n},getID:function(){return o},setNewChannel:function(e){s.unsubscribe(this),s=e,this.subscribe(i)},subscribe:function(e){return i=e,o=s.subscribe(this),this},resubscribe:function(){return this.subscribe(i)},unsubscribe:function(){return s.unsubscribe(this),u.debug("Unsubscribed from channel: "+s.getName()),this},publish:function(e,t){s.publish(e,t)},getName:function(){return s.getName()}}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isUndefined=t.isObject=t.isNull=t.isNil=t.isEmptyObject=void 0;var o=function(e){return void 0===e};t.isUndefined=o;var i=function(e){return null===e};t.isNull=i,t.isNil=function(e){return i(e)||o(e)};var u=function(e){return null!=e&&"object"===r(e)};t.isObject=u,t.isEmptyObject=function(e){return u(e)&&0===Object.keys(e).length}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){var r=n(9),o=n(3),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(67)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){"use strict";var r=n(193)(!0);n(104)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(67),o=n(0),i=n(30),u=n(23),s=n(34),a=n(194),c=n(75),f=n(198),l=n(1)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,h,v,g,b){a(n,t,h);var m,y,_,x=function(e){if(!d&&e in O)return O[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},w=t+" Iterator",S="values"==v,T=!1,O=e.prototype,E=O[l]||O["@@iterator"]||v&&O[v],C=E||x(v),j=v?S?x("entries"):C:void 0,A="Array"==t&&O.entries||E;if(A&&(_=f(A.call(new e)))!==Object.prototype&&_.next&&(c(_,w,!0),r||"function"==typeof _[l]||u(_,l,p)),S&&E&&"values"!==E.name&&(T=!0,C=function(){return E.call(this)}),r&&!b||!d&&!T&&O[l]||u(O,l,C),s[t]=C,s[w]=p,v)if(m={values:S?C:x("values"),keys:g?C:x("keys"),entries:j},b)for(y in m)y in O||i(O,y,m[y]);else o(o.P+o.F*(d||T),t,m);return m}},function(e,t,n){var r=n(197),o=n(106);e.exports=Object.keys||function(e){return r(e,o)}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var r=n(11),o=n(200),i=n(34),u=n(35);e.exports=n(104)(Array,"Array",(function(e,t){this._t=u(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var r=n(14);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(34),o=n(1)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[o]===e)}},function(e,t,n){var r=n(66),o=n(1)("iterator"),i=n(34);e.exports=n(9).getIteratorMethod=function(e){if(null!=e)return e[o]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(14),o=n(17),i=n(1)("species");e.exports=function(e,t){var n,u=r(e).constructor;return void 0===u||null==(n=r(u)[i])?t:o(n)}},function(e,t,n){var r,o,i,u=n(16),s=n(204),a=n(74),c=n(69),f=n(3),l=f.process,d=f.setImmediate,p=f.clearImmediate,h=f.MessageChannel,v=f.Dispatch,g=0,b={},m=function(){var e=+this;if(b.hasOwnProperty(e)){var t=b[e];delete b[e],t()}},y=function(e){m.call(e.data)};d&&p||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return b[++g]=function(){s("function"==typeof e?e:Function(e),t)},r(g),g},p=function(e){delete b[e]},"process"==n(22)(l)?r=function(e){l.nextTick(u(m,e,1))}:v&&v.now?r=function(e){v.now(u(m,e,1))}:h?(i=(o=new h).port2,o.port1.onmessage=y,r=u(i.postMessage,i,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(r=function(e){f.postMessage(e+"","*")},f.addEventListener("message",y,!1)):r="onreadystatechange"in c("script")?function(e){a.appendChild(c("script")).onreadystatechange=function(){a.removeChild(this),m.call(e)}}:function(e){setTimeout(u(m,e,1),0)}),e.exports={set:d,clear:p}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(14),o=n(15),i=n(76);e.exports=function(e,t){if(r(e),o(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(3),o=n(31),i=n(32),u=n(1)("species");e.exports=function(e){var t=r[e];i&&t&&!t[u]&&o.f(t,u,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(1)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!o)return!1;var n=!1;try{var i=[7],u=i[r]();u.next=function(){return{done:n=!0}},i[r]=function(){return u},e(i)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(31),o=n(70);e.exports=function(e,t,n){t in e?r.f(e,t,o(0,n)):e[t]=n}},function(e,t,n){var r=n(17),o=n(10),i=n(43),u=n(6);e.exports=function(e,t,n,s,a){r(t);var c=o(e),f=i(c),l=u(c.length),d=a?l-1:0,p=a?-1:1;if(n<2)for(;;){if(d in f){s=f[d],d+=p;break}if(d+=p,a?d<0:l<=d)throw TypeError("Reduce of empty array with no initial value")}for(;a?d>=0:l>d;d+=p)d in f&&(s=t(s,f[d],d,c));return s}},function(e,t,n){"use strict";var r=n(77),o=n(15),i=n(6),u=n(16),s=n(1)("isConcatSpreadable");e.exports=function e(t,n,a,c,f,l,d,p){for(var h,v,g=f,b=0,m=!!d&&u(d,p,3);b<c;){if(b in a){if(h=m?m(a[b],b,n):a[b],v=!1,o(h)&&(v=void 0!==(v=h[s])?!!v:r(h)),v&&l>0)g=e(t,n,h,i(h.length),g,l-1)-1;else{if(g>=9007199254740991)throw TypeError();t[g]=h}g++}b++}return g}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(241)),o=s(n(165)),i=s(n(55)),u=s(n(370));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return(0,i.default)(e),{getExecutionId:function(){return e},getExecutionStatus:function(){return(0,r.default)(e)},getOutputs:function(){return(0,o.default)(e)},awaitCompletion:function(){return(0,u.default)(e)}}}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(4);function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var u=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),u.push(o(t)+"="+o(e))})))})),i=u.join("&")}if(i){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";(function(t){var r=n(4),o=n(248),i={"Content-Type":"application/x-www-form-urlencoded"};function u(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(e=n(125)),e}(),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(u(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(u(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){s.headers[e]=r.merge(i)})),e.exports=s}).call(this,n(247))},function(e,t,n){"use strict";var r=n(4),o=n(249),i=n(251),u=n(122),s=n(252),a=n(255),c=n(256),f=n(126);e.exports=function(e){return new Promise((function(t,n){var l=e.data,d=e.headers;r.isFormData(l)&&delete d["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var h=e.auth.username||"",v=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";d.Authorization="Basic "+btoa(h+":"+v)}var g=s(e.baseURL,e.url);if(p.open(e.method.toUpperCase(),u(g,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:e,request:p};o(t,n,i),p=null}},p.onabort=function(){p&&(n(f("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){n(f("Network Error",e,null,p)),p=null},p.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(f(t,e,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var b=(e.withCredentials||c(g))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;b&&(d[e.xsrfHeaderName]=b)}if("setRequestHeader"in p&&r.forEach(d,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),n(e),p=null)})),l||(l=null),p.send(l)}))}},function(e,t,n){"use strict";var r=n(250);e.exports=function(e,t,n,o,i){var u=new Error(e);return r(u,t,n,o,i)}},function(e,t,n){"use strict";var r=n(4);e.exports=function(e,t){t=t||{};var n={},o=["url","method","data"],i=["headers","auth","proxy","params"],u=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function a(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function c(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=a(void 0,e[o])):n[o]=a(e[o],t[o])}r.forEach(o,(function(e){r.isUndefined(t[e])||(n[e]=a(void 0,t[e]))})),r.forEach(i,c),r.forEach(u,(function(o){r.isUndefined(t[o])?r.isUndefined(e[o])||(n[o]=a(void 0,e[o])):n[o]=a(void 0,t[o])})),r.forEach(s,(function(r){r in t?n[r]=a(e[r],t[r]):r in e&&(n[r]=a(void 0,e[r]))}));var f=o.concat(i).concat(u).concat(s),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===f.indexOf(e)}));return r.forEach(l,c),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t){e.exports=function(e,t){var n="000000000"+e;return n.substr(n.length-t)}},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(83))},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(292),o=n(13);e.exports=function e(t,n,i,u,s){return t===n||(null==t||null==n||!o(t)&&!o(n)?t!=t&&n!=n:r(t,n,i,u,e,s))}},function(e,t,n){var r=n(293),o=n(134),i=n(296);e.exports=function(e,t,n,u,s,a){var c=1&n,f=e.length,l=t.length;if(f!=l&&!(c&&l>f))return!1;var d=a.get(e);if(d&&a.get(t))return d==t;var p=-1,h=!0,v=2&n?new r:void 0;for(a.set(e,t),a.set(t,e);++p<f;){var g=e[p],b=t[p];if(u)var m=c?u(b,g,p,t,e,a):u(g,b,p,e,t,a);if(void 0!==m){if(m)continue;h=!1;break}if(v){if(!o(t,(function(e,t){if(!i(v,t)&&(g===e||s(g,e,n,u,a)))return v.push(t)}))){h=!1;break}}else if(g!==b&&!s(g,b,n,u,a)){h=!1;break}}return a.delete(e),a.delete(t),h}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t,n){var r=n(8).Uint8Array;e.exports=r},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(139),o=n(86),i=n(38);e.exports=function(e){return r(e,i,o)}},function(e,t,n){var r=n(85),o=n(5);e.exports=function(e,t,n){var i=t(e);return o(e)?i:r(i,n(e))}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(300),o=n(87),i=n(5),u=n(40),s=n(142),a=n(143),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),f=!n&&o(e),l=!n&&!f&&u(e),d=!n&&!f&&!l&&a(e),p=n||f||l||d,h=p?r(e.length,String):[],v=h.length;for(var g in e)!t&&!c.call(e,g)||p&&("length"==g||l&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v))||h.push(g);return h}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){return!!(t=null==t?9007199254740991:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(303),o=n(89),i=n(144),u=i&&i.isTypedArray,s=u?o(u):r;e.exports=s},function(e,t,n){(function(e){var r=n(130),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,u=i&&i.exports===o&&r.process,s=function(){try{return u&&u.binding&&u.binding("util")}catch(e){}}();e.exports=s}).call(this,n(39)(e))},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(306),o=n(82),i=n(307),u=n(308),s=n(309),a=n(25),c=n(131),f=c(r),l=c(o),d=c(i),p=c(u),h=c(s),v=a;(r&&"[object DataView]"!=v(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=v(new o)||i&&"[object Promise]"!=v(i.resolve())||u&&"[object Set]"!=v(new u)||s&&"[object WeakMap]"!=v(new s))&&(v=function(e){var t=a(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case f:return"[object DataView]";case l:return"[object Map]";case d:return"[object Promise]";case p:return"[object Set]";case h:return"[object WeakMap]"}return t}),e.exports=v},function(e,t,n){var r=n(20);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},function(e,t,n){var r=n(150),o=n(52);e.exports=function(e,t){for(var n=0,i=(t=r(t,e)).length;null!=e&&n<i;)e=e[o(t[n++])];return n&&n==i?e:void 0}},function(e,t,n){var r=n(5),o=n(91),i=n(313),u=n(151);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(u(e))}},function(e,t,n){var r=n(316);e.exports=function(e){return null==e?"":r(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}();t.arrayToObject=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},t.merge=function(e,n,o){if(!n)return e;if("object"!=typeof n){if(Array.isArray(e))e.push(n);else{if("object"!=typeof e)return[e,n];(o.plainObjects||o.allowPrototypes||!r.call(Object.prototype,n))&&(e[n]=!0)}return e}if("object"!=typeof e)return[e].concat(n);var i=e;return Array.isArray(e)&&!Array.isArray(n)&&(i=t.arrayToObject(e,o)),Array.isArray(e)&&Array.isArray(n)?(n.forEach((function(n,i){r.call(e,i)?e[i]&&"object"==typeof e[i]?e[i]=t.merge(e[i],n,o):e.push(n):e[i]=n})),e):Object.keys(n).reduce((function(e,i){var u=n[i];return r.call(e,i)?e[i]=t.merge(e[i],u,o):e[i]=u,e}),i)},t.assign=function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),n="",r=0;r<t.length;++r){var i=t.charCodeAt(r);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?n+=t.charAt(r):i<128?n+=o[i]:i<2048?n+=o[192|i>>6]+o[128|63&i]:i<55296||i>=57344?n+=o[224|i>>12]+o[128|i>>6&63]+o[128|63&i]:(r+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(r)),n+=o[240|i>>18]+o[128|i>>12&63]+o[128|i>>6&63]+o[128|63&i])}return n},t.compact=function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],r=0;r<t.length;++r)for(var o=t[r],i=o.obj[o.prop],u=Object.keys(i),s=0;s<u.length;++s){var a=u[s],c=i[a];"object"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:a}),n.push(c))}return function(e){for(var t;e.length;){var n=e.pop();if(t=n.obj[n.prop],Array.isArray(t)){for(var r=[],o=0;o<t.length;++o)void 0!==t[o]&&r.push(t[o]);n.obj[n.prop]=r}}return t}(t)},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!=e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,n){"use strict";var r=String.prototype.replace,o=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return r.call(e,o,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,n){var r=n(156),o=n(81),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var u=e[t];i.call(e,t)&&o(u,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){var r=n(157);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t,n){var r=n(19),o=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,n){var r=n(141),o=n(338),i=n(50);e.exports=function(e){return i(e)?r(e,!0):o(e)}},function(e,t,n){var r=n(85),o=n(160),i=n(86),u=n(140),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,i(e)),e=o(e);return t}:u;e.exports=s},function(e,t,n){var r=n(145)(Object.getPrototypeOf,Object);e.exports=r},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(161),o=Math.max;e.exports=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,u=-1,s=o(i.length-t,0),a=Array(s);++u<s;)a[u]=i[t+u];u=-1;for(var c=Array(t+1);++u<t;)c[u]=i[u];return c[t]=n(a),r(e,this,c)}}},function(e,t,n){var r=n(359),o=n(361)(r);e.exports=o},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(83))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=u(n(79)),i=u(n(55));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return e};t.default=function(e){(0,i.default)(e);var t=r.FLOWOBJECT_API_PATH+"/"+r.OUTPUTS+"/"+e;return(0,o.default)(t,"GET",{transform:s})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){var t=[],n=0;return{subscribe:function(e,r){var o=n++;return t.push({event:e,callback:r,id:o}),o},unsubscribe:function(e){for(var n=0;n<t.length;n++)e===t[n].id&&t.splice(n,1)},publish:function(e,t){for(var n=this._getSubscriptions(e),r=0;r<n.length;r++)n[r].callback.apply(null,t)},getEvents:function(){return e},_getSubscriptions:function(e){for(var n=[],r=0;r<t.length;r++)t[r].event===e&&n.push(t[r]);return n}}}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=v(n(166)),i=v(n(2)),u=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=function(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return function(e){return e?n:t}(e)}(t);if(n&&n.has(e))return n.get(e);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var s=i?Object.getOwnPropertyDescriptor(e,u):null;s&&(s.get||s.set)?Object.defineProperty(o,u,s):o[u]=e[u]}return o.default=e,n&&n.set(e,o),o}(n(12)),s=v(n(168)),a=v(n(169)),c=v(n(381)),f=n(99),l=v(n(382)),d=v(n(383)),p=v(n(384)),h=n(57);function v(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new c.default,n=!1,r=!1,v=null,g=new o.default({CONNECTION_INITIALIZED:"connection.initialized",CONNECTION_OPENED:"connection.opened",CONNECTION_CLOSED:"connection.closed",CONNECTION_BROKEN:"connection.broken",SESSION_LOGGED_IN:"session.logged.in",SESSION_LOGGED_OUT:"session.logged.out",SESSION_INVALIDATED:"session.invalidated",SESSION_REESTABLISHED:"session.reestablished"}),b={SESSION_LOGGED_IN:"session.logged.in",SESSION_LOGGED_OUT:"session.logged.out",SESSION_INVALIDATED:"session.invalidated"},m="closed",y={},_={},x=new i.default("amb.ServerConnection");!function(){e.addListener("/meta/handshake",this,Y),e.addListener("/meta/connect",this,ae),e.addListener("/meta/subscribe",this,oe),e.addListener("/meta/unsubscribe",this,ee)}();var w=b.SESSION_INVALIDATED,S=null,T="true"===u.default.loginWindow,O=null,E={UNKNOWN_CLIENT:"402::Unknown client",UNKNOWN_SESSION:"402::session_unknown",NODE_MISMATCH:"websocket_http_node_mismatch",RECONNECT_REMEMBER_ME:"reconnect_remember_me_http_activity",HUP_SIGNAL:"reconnect_on_hup_signal"},C=!1,j={},A=!1,N=new s.default(e,j),I=!1,M="glide.amb.session.logout.overlay.style",k="glide.amb.redelivery.disconnect.timeout.in.mins",L="glide.amb.clear_node_affinity_cookie",R="glide.session.status",P="session.touch.http",D="amb.ServerConnection.reestablish.session",F="set.header.request.sent",U="request.reconnection",q=e.getExtension(u.TOKEN_MANAGEMENT_EXTENSION),B=null,H=new p.default(e),G=null,W=!0,z=null,V=null,$=null,Q=null,X=null;function Y(e){ee(e),void 0!==K(e,h.WS_CONNECTION_NODE_ID)&&(v=K(e,h.WS_CONNECTION_NODE_ID),x.debug("Node Id from handshake callback initially set to "+v));var t=K(e,M);t&&(u.default.overlayStyle=t);var n=K(e,k);n&&(u.default.redeliveryDisconnectTimeoutInMins=n),K(e,L)&&(u.default.requestHeaderToClearStickySessionCookie=!0===K(e,L)),w=K(e,R),function(e){if(e.ext){var t=e.ext.subscribeCommandsFlow;if(t){var n=u.default.subscribeCommandsFlow;if(u.default.subscribeCommandsFlow.enable=function(e,t){var n=t;return(0,f.isNil)(e)||(n=!!e),n}(t.enable,n.enable),u.default.subscribeCommandsFlow.enable){u.default.subscribeCommandsFlow.retries=ie(t.retries,n.retries),u.default.subscribeCommandsFlow.maxInflight=ie(t.maxInflight,n.maxInflight),u.default.subscribeCommandsFlow.maxWait=ie(t.maxWait,n.maxWait);var r=t.retryDelay;if(r){var o=u.default.subscribeCommandsFlow.retryDelay;u.default.subscribeCommandsFlow.retryDelay.min=ie(r.min,o.min),u.default.subscribeCommandsFlow.retryDelay.max=ie(r.max,o.max),u.default.subscribeCommandsFlow.retryDelay.increaseFactor=ie(r.increaseFactor,o.increaseFactor)}}u.default.subscribeCommandsFlow.enable&&(x.addInfoMessage("_initializeSubscriptionCommandSender: SubscriptionCommandSender is enabled"),null!=q&&q.updateTokenCount(u.default.subscribeCommandsFlow.maxInflight),B&&B.stop(),B=new d.default(new l.default(1e4),q))}}}(e),setTimeout((function(){e.successful&&ce()}),0)}function K(e,t){if((0,f.isObject)(e.ext))return e.ext[t]}function J(t,n){if(t in y)return y[t];var r=new a.default(e,t,I,n);return y[t]=r,r}function Z(e){_[e]=y[e],delete y[e]}function ee(t){if(t.ext){!1===t.ext["glide.amb.active"]&&j.disconnect();var n=K(t,"glide.amb.client.log.level");n&&(u.default.logLevel=n,e.setLogLevel(u.default.logLevel)),u.default.pruneFailedTransports="false"!==K(t,"glide.amb.pruneFailedTransports")}}function te(){null!==ne()&&(clearInterval(V),V=null,z=null,A=!0,O=E.RECONNECT_REMEMBER_ME,j.connect())}function ne(){if(void 0!==document.cookie)for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var n=e[t].trim();if(n.startsWith("".concat(h.NODEID_COOKIE_KEY,"=")))return n.substring(h.NODEID_COOKIE_KEY.length+1)}return null}function re(t){v=null,r=!0,e.disconnect((function(){x.addInfoMessage("Disconnected WS Connection. Connecting back"),O=t,n=!1,pe(),$=null,A=!0,r=!1,j.connect()}))}function oe(e){ee(e)}function ie(e,t){var n=Math.floor(parseInt(e));return(isNaN(n)||n<0)&&(n=t),n}function ue(){for(var e in x.debug("Resubscribing to all!"),y){var t=y[e];t&&t.resubscribeToCometD()}}function se(){for(var e in x.debug("Unsubscribing from all!"),y){var t=y[e];t&&t.unsubscribeFromCometD()}}function ae(t){if(ee(t),K(t,h.GLIDE_REMEMBER_ME)&&(z=K(t,h.GLIDE_REMEMBER_ME)),K(t,h.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC)&&function(e){$||($=setTimeout((function(){x.addInfoMessage("Reconnecting after "+e+"sec as the server received an HUP signal from load balancer"),re(E.HUP_SIGNAL)}),1e3*e))}(K(t,h.GLIDE_AMB_HUP_SIGNAL_RECONNECT_IN_SEC)),r)setTimeout((function(){n=!1,pe()}),0);else{n&&!ve(K(t,R))&&function(){if(null!==v){var e=ne();null!==e&&v!==e&&setTimeout((function(){null!==(e=ne())&&v!==e&&(x.addInfoMessage("WS Connection is with "+v+" whereas httpsession is with "+e+". Disconnecting WS connection"),re(E.NODE_MISMATCH))}),2e4)}}();var o=K(t,P);u.WEBSOCKET_TYPE_NAME===e.getTransport().getType()&&!0===o&&j._touchHttpSession();var i=t.error;i&&(O=i),function(e){var t=K(e,R);t&&t!==w&&(C=!0===K(e,"glide.amb.login.window.override"),he(t))}(t);var s=n;n=!0===t.successful,!s&&n?fe():s&&!n&&(x.addErrorMessage("Connection broken"),m="broken",A=!0,me(g.getEvents().CONNECTION_BROKEN),G=Date.now(),B&&(B.stop(),B=null)),Q=new Date}}function ce(){x.debug("Connection initialized"),I=!0,m="initialized",me(g.getEvents().CONNECTION_INITIALIZED)}function fe(){x.debug("Connection opened"),H.processConnectionOpened(),A?function(e){return Object.values(E).includes(e)}(j.getLastError())?(j.setLastError(null),j._sendSessionSetupRequest((function(e){var t=e.status,n=e.response;if(200===t){A=!1;var r=JSON.parse(n)["glide.session.status"];x.debug("/amb_session_setup.do response: "+n),r&&w!==r?(N.initialize(de),he(r)):N.initialize((function(){le(!1)}))}else x.addWarnMessage("/amb_session_setup.do status: "+t)}))):x.addWarnMessage("Error connecting to server. Unkown status "+j.getLastError()):N.initialize((function(){le(!0)}))}function le(e){ue(),de(),e&&(x.debug("Sending signal to reconnect"),t.emit(U,U))}function de(){m="opened",me(g.getEvents().CONNECTION_OPENED)}function pe(){x.debug("Connection closed"),m="closed",me(g.getEvents().CONNECTION_CLOSED)}function he(e){x.debug("session.status - "+e),ve(e)?(x.debug("INVALIDATED event fire!"),se(),me(g.getEvents().SESSION_INVALIDATED),u.default.requestHeaderToClearStickySessionCookie&&(void 0!==navigator.locks?navigator.locks.request("lock-set_clear_node_affinity_header",be):(x.debug("navigator.locks.request not supported"),be())),ge()||j.disconnect((function(){j.loginHide(),n=!1,pe(),r=!1,z&&function(e){return void 0!==document.cookie&&(document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/",!0)}(h.NODEID_COOKIE_KEY)&&(V=setInterval(te,5e3))}))):function(e){return w===b.SESSION_LOGGED_IN&&e===b.SESSION_LOGGED_OUT}(e)?(x.debug("LOGGED_OUT event fire!"),se(),me(g.getEvents().SESSION_LOGGED_OUT),T&&!C&&j.loginShow(),ge()):function(e){return w===b.SESSION_INVALIDATED&&e===b.SESSION_LOGGED_OUT}(e)?(x.debug("REESTABLISHED event fire!"),ue(),me(g.getEvents().SESSION_REESTABLISHED)):function(e){return(w===b.SESSION_INVALIDATED||w===b.SESSION_LOGGED_OUT)&&e===b.SESSION_LOGGED_IN}(e)&&(x.debug("LOGGED_IN event fire!"),ue(),me(g.getEvents().SESSION_LOGGED_IN),j.loginHide(),W=!0),w=e}function ve(e){return(w===b.SESSION_LOGGED_IN||w===b.SESSION_LOGGED_OUT)&&e===b.SESSION_INVALIDATED}function ge(){return!!(Q&&X&&X>Q)&&(x.debug("Either the session is logged out/invalidated from a different tab. Calling reestablishSession as lastReconnectionEventTime "+X+" happened after lastMetaConnectResponseTime "+Q),ye(!1),!0)}function be(){W?(x.debug("Sending set_clear_node_affinity_header"),t.emit(F,F),j._sendSetHeaderToClearNodeAffinityCookie((function(e){var t=e.status;200!==t?x.addErrorMessage("Error sending set_clear_node_affinity_header: "+t):W=!1}))):x.debug("set_clear_node_affinity_header not sent")}function me(e){try{g.publish(e)}catch(t){x.addErrorMessage("error publishing '"+e+"' - "+t)}}function ye(e){j._sendSessionSetupRequest((function(e){var t=e.response;t&&he(JSON.parse(t)["glide.session.status"])})),e&&t.emit(D,D)}return j.connect=function(){n?x.debug(">>> connection exists, request satisfied"):(x.debug("Connecting to glide amb server -> "+u.default.servletURI),e.configure({url:j.getURL(u.default.servletPath),logLevel:u.default.logLevel,connectTimeout:u.default.wsConnectTimeout}),e.handshake(),t.on(D,(function(){j._reestablishSession(!1)})),t.on(F,(function(){W=!1})),t.on(U,(function(){x.debug("Received signal to reconnect"),n?w===b.SESSION_LOGGED_OUT?ye(!1):w===b.SESSION_LOGGED_IN&&(X=new Date):j.connect()})))},j.reload=function(){e.reload()},j.abort=function(){e.getTransport().abort()},j.disconnect=function(t){x.debug("Disconnecting from glide amb server.."),r=!0,e.disconnect(t)},j.getURL=function(e){return window.location.protocol+"//"+window.location.host+"/"+e},j.getConnectionBrokenTS=function(){return G},j.unsubscribeAll=function(){se()},j.resubscribeAll=function(){ue()},j.removeChannel=function(e){Z(e)},j.getEvents=function(){return g.getEvents()},j.getConnectionState=function(){return m},j.getLastError=function(){return O},j.setLastError=function(e){O=e},j.getErrorMessages=function(){return E},j.isLoggedIn=function(){return w===b.SESSION_LOGGED_IN},j.isSessionActive=function(){return w!==b.SESSION_INVALIDATED},j.getChannelRedirect=function(){return N},j.getChannel=function(e,t){return J(e,t)},j.getChannels=function(){return y},j.getRemovedChannels=function(){return _},j.getState=function(){return m},j.getLoginWindowOverlayStyle=function(){return u.default.overlayStyle},j.loginShow=function(){x.debug("Show login window");var e='<iframe src="/amb_login.do" style="border: 0" height="400px" width="405px"></iframe>',t='<div id="amb_disconnect_modal" tabindex="-1" aria-hidden="true" class="modal" role="dialog" style="'.concat(u.default.overlayStyle,'">\n\t\t\t\t<div class="modal-dialog small-modal" style="width:450px">\n\t\t\t\t   <div class="modal-content">\n\t\t\t\t\t  <header class="modal-header">\n\t\t\t\t\t\t <h4 id="small_modal1_title" class="modal-title">Login</h4>\n\t\t\t\t\t  </header>\n\t\t\t\t\t  <div class="modal-body">\n\t\t\t\t\t  </div>\n\t\t\t\t   </div>\n\t\t\t\t</div>\n\t\t\t</div>');try{if(window.NOW&&!0===window.NOW.amb_themed_login){var n=new GlideModal("amb_login_router");n.renderWithContent&&(n.template=t),n.render(),S=n}else{var r=new GlideModal("amb_disconnect_modal");r.renderWithContent?(r.template=t,r.renderWithContent(e)):(r.setBody(e),r.render()),S=r}}catch(e){x.debug(e)}},j.loginHide=function(){S&&(S.destroy(),S=null)},j.loginComplete=function(){j.reestablishSession()},j.reestablishSession=function(){j._reestablishSession(!0)},j.subscribeToEvent=function(e,t){return g.getEvents().CONNECTION_OPENED===e&&n&&t(),g.subscribe(e,t)},j.unsubscribeFromEvent=function(e){g.unsubscribe(e)},j.isLoginWindowEnabled=function(){return T},j.setLoginWindowEnabled=function(e){T=e},j.isLoginWindowOverride=function(){return C},j.getSubscriptionCommandSender=function(){return B},j._metaConnect=ae,j._metaHandshake=Y,j._metaSubscribe=oe,j._sendSessionSetupRequest=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=function(){x.debug("sending /amb_session_setup.do!");var t=new XMLHttpRequest;return t.open("POST","/amb_session_setup.do",!0),t.setRequestHeader("Content-type","application/json;charset=UTF-8"),t.setRequestHeader("X-UserToken",window.g_ck),t.setRequestHeader("X-CometD-SessionID",e.getClientId()),t}();n.onload=function(){return t(n)},n.send()},j._onChannelRedirectSubscriptionComplete=le,j._getChannel=J,j._removeChannel=Z,j._connectionInitialized=ce,j._connectionOpened=fe,j._reestablishSession=ye,j._touchHttpSession=function(){var e=new XMLHttpRequest;e.open("POST","/amb",!0),e.setRequestHeader("Content-type","application/json"),e.send()},j._sendSetHeaderToClearNodeAffinityCookie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=function(){var e=new XMLHttpRequest;return e.open("POST","/set_clear_node_affinity_header",!0),e}();t.onload=function(){return e(t)},t.send()},j}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(2)),o=i(n(98));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var n,i=e,u=new r.default("amb.ChannelRedirect");function s(e){u.debug("_onAdvice:"+e.data.clientId);var n=t.getChannels(),r=null!=n?n[e.data.fromChannel]:null;if(!r){var o=t.getRemovedChannels();r=null!=o?o[e.data.fromChannel]:null}var i=t.getChannel(e.data.toChannel);r&&i?(function(e,t){for(var n=e.getChannelListeners(),r=0;r<n.length;r++)n[r].setNewChannel(t)}(r,i),u.debug("published channel switch event, fromChannel:"+r.getName()+", toChannel:"+i.getName())):u.debug("Could not redirect from "+e.data.fromChannel+" to "+e.data.toChannel)}return{initialize:function(e){var r="/sn/meta/channel_redirect/"+i.getClientId(),a=t.getChannel(r);n&&a===n?n.subscribeToCometD():(n&&t.removeChannel(n.getName()),n=a,new o.default(n,t,e).subscribe(s)),u.debug("ChannelRedirect initialized: "+r)},_onAdvice:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n(2)),o=n(99),i=c(n(170)),u=c(n(380)),s=c(n(12)),a=n(57);function c(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){var c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return{}},f=null,l=null,d=[],p=[],h=new r.default("amb.Channel"),v=0,g=n,b=-1,m=null,y=!0,_=new u.default;function x(){return(0,i.default)().getServerConnection().getSubscriptionCommandSender()}return{subscribe:function(e){if(e.getCallback()){for(var n=0;n<d.length;n++)if(d[n]===e)return h.debug("Channel listener already in the list"),e.getID();d.push(e);var r=e.getSubscriptionCallback();if(r&&(l?r(l):p.push(r)),!f&&g)try{this.subscribeToCometD()}catch(e){return void h.addErrorMessage(e)}return++v}h.addErrorMessage("Cannot subscribe to channel: "+t+", callback not provided")},resubscribe:function(){f=null;for(var e=0;e<d.length;e++)d[e].resubscribe()},_handleResponse:function(e){y?this.processMessageCallback(e):this.processReSubscriptionMessages(e)},processReSubscriptionMessages:function(e){var n=this;_.shouldDeliver(e)?(h.debug(a.CHANNEL_READY_TO_DELIVER+t),y=!0,this.processMessageCallback(e)):_.shouldDeliverPendingMessages()&&_.getAllPendingMessages().forEach((function(e){return n.processMessageCallback(e)}))},processMessageCallback:function(e){for(var t=0;t<d.length;t++)d[t].getCallback()(e);_.containsMetaInfo(e)&&(b=e.ext[a.MSG_NUM],m=e.ext[a.MSG_SHARD])},unsubscribe:function(n){if(n){for(var r=0;r<d.length;r++)if(d[r].getID()===n.getID()){d.splice(r,1);break}d.length<1&&f&&!function(){var t=e.getStatus();return"disconnecting"===t||"disconnected"===t}()&&this.unsubscribeFromCometD()}else h.addErrorMessage("Cannot unsubscribe from channel: "+t+", listener argument does not exist")},publish:function(n,r){e.publish(t,n,r)},subscribeToCometD:function(){h.debug("subscribeToCometD channelName : "+t+", subscription : "+f),x()?x().subscribeToChannel(this):this._subscribeToCometD(this.subscriptionCallback)},_subscribeToCometD:function(n){h.debug("_subscribeToCometD channelName : "+t);var r=this._populateSubscriptionOptions();if((0,o.isNil)(r)||(0,o.isEmptyObject)(r))f=e.subscribe(t,this._handleResponse.bind(this),n);else{var i={subscribeOptions:r};f=e.subscribe(t,this._handleResponse.bind(this),i,n)}h.debug("Successfully subscribed to channel: "+t+", subscribeOptions: "+JSON.stringify(r))},_populateSubscriptionOptions:function(){var e=c(),n=Date.now()-this.fetchDisconnectionTS();return this._shouldRedeliveryBeRequested(n)&&((0,o.isNil)(e)&&(e={}),e[a.MESSAGE_REDELIVERY_OPTIONS]={},e[a.MESSAGE_REDELIVERY_OPTIONS].last_msg_num=b,e[a.MESSAGE_REDELIVERY_OPTIONS].last_msg_shard=m,e[a.MESSAGE_REDELIVERY_OPTIONS].request_duration=n,h.debug(a.CHANNEL_NOT_READY_TO_DELIVER+t),y=!1,_.resetState()),e},_shouldRedeliveryBeRequested:function(e){return e<=6e4*s.default.redeliveryDisconnectTimeoutInMins&&-1!=b&&!(0,o.isNil)(m)},subscriptionCallback:function(e){h.debug("Cometd subscription callback completed for channel: "+t),h.debug("Listener callback queue size: "+p.length),l=e,p.map((function(e){e(l)})),p=[]},unsubscribeFromCometD:function(){h.debug("unsubscribeFromCometD  from : "+t+", subscription : "+f),null!==f&&(x()?x().unsubscribeToChannel(this):this._unsubscribeFromCometD())},_unsubscribeFromCometD:function(){h.debug("_unsubscribeFromCometD  from : "+t+", subscription : "+f),null!==f&&(e.unsubscribe(f),f=null,l=null,h.debug("Successfully unsubscribed from channel: "+t))},resubscribeToCometD:function(){h.debug("Resubscribe to "+t),x()?x().subscribeToChannel(this):this._subscribeToCometD(this.subscriptionCallback)},getSubscribeOptionsCallback:function(){return c},getName:function(){return t},getChannelListeners:function(){return d},getLastMessageShard:function(){return m},getLastMessageNumber:function(){return b},fetchDisconnectionTS:function(){var e=(0,i.default)().getServerConnection().getConnectionBrokenTS();return h.debug("Client Disconnect Time in ms:"+e),e||0},getRedeliveryManager:function(){return _},isReadyToDeliver:function(){return y},getListenerCallbackQueue:function(){return p},setSubscriptionCallbackResponse:function(e){l=e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(171)),o=u(n(378)),i=u(n(379));function u(e){return e&&e.__esModule?e:{default:e}}function s(e){return e.MSInputMethodContext&&e.document.documentMode}function a(e,t){if(void 0!==e.getClientWindow&&e.getClientWindow()===t)return e;var n=function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}({},e);return n.getChannel=function(n,r,o){return e.getChannel(n,r,o||t)},n.getRecordWatcherChannel=function(n,r,o,i,u){return e.getRecordWatcherChannel(n,r,o,i,u||t)},n.subscribeToEvent=function(n,r,o){return e.subscribeToEvent(n,r,o||t)},n.unsubscribeFromEvent=function(n,r){return e.unsubscribeFromEvent(n,r||t)},n.getClientWindow=function(){return t},n}t.default=function(){var e=function(e){try{if(!s(e))for(;e!==e.parent&&!e.g_ambClient;)e=e.parent;if(e.g_ambClient)return e.g_ambClient}catch(e){console.log("AMB getClient() tried to access parent from an iFrame. Caught error: "+e)}return null}(window);return e||function(e){var t=window.self;t.g_ambClient=e,t.addEventListener("unload",(function(){t.g_ambClient.disconnect()}));var n=!(!t.NOW||!t.NOW.hasOwnProperty("deferAmbConnection"))&&t.NOW.deferAmbConnection,r=t.NOW&&t.NOW.hasOwnProperty("deferredAmbConnectionTimeout")&&function(e){return function(e){return parseInt(e,10)===e}(e)&&e>0}(t.NOW.deferredAmbConnectionTimeout)?t.NOW.deferredAmbConnectionTimeout:1e4;n?t.setTimeout(i,r):("complete"===(t.document?t.document.readyState:null)?i():t.addEventListener("load",i),t.setTimeout(i,1e4));var o=!1;function i(){o||(o=!0,t.g_ambClient.connect())}}(e=a(function(e){return function(){var t=new r.default,n=function(){var e=[];function t(e,t,r){if(e&&r){var o=n(e);if(o)for(var i=o.subscriptions,u=i.length-1;u>=0;u--)i[u].id===t&&i[u].callback===r&&i.splice(u,1)}}function n(t){for(var n=0,r=e.length;n<r;n++)if(e[n].window===t)return e[n];return null}function r(t){var n={window:t,onUnload:function(){n.unloading=!0;for(var t,r=n.subscriptions;t=r.pop();)t.unsubscribe();!function(t){for(var n=0,r=e.length;n<r;n++)if(e[n].window===t.window){e.splice(n,1);break}t.subscriptions=[],t.window.removeEventListener("unload",t.onUnload),t.onUnload=null,t.window=null}(n)},unloading:!1,subscriptions:[]};return t.addEventListener("unload",n.onUnload),e.push(n),n}return{add:function(e,o,i,u){if(e&&i&&u){t(e,o,i);var s=n(e);s||(s=r(e)),s.unloading||s.subscriptions.push({id:o,callback:i,unsubscribe:u})}},remove:t}}(),u=t.getServerConnection();return e&&u.setLoginWindowEnabled(!1),{getServerConnection:function(){return u},connect:function(){t.connect()},abort:function(){t.abort()},disconnect:function(){t.disconnect()},getConnectionState:function(){return t.getConnectionState()},getState:function(){return t.getConnectionState()},cancelTransaction:function(e){t.cancelTransaction(e)},getClientId:function(){return t.getClientId()},getChannel:function(e,r,o){var i=t.getChannel(e,r),s=i.subscribe,a=i.unsubscribe;return o=o||window,i.subscribe=function(e){return n.add(o,i,e,(function(){i.unsubscribe(e)})),s.call(i,e),i},i.unsubscribe=function(r){n.remove(o,i,r);var s=a.call(i,r);return 0===u.getChannel(e).getChannelListeners().length&&t.removeChannel(e),s},i},getChannel0:function(e,n){return t.getChannel(e,n)},getRecordWatcherChannel:function(e,t,n,r,u){var s=o.default.stringify(i.default.parse(t)).replace(/=/g,"-");return n=n||"default",this.getChannel("/rw/"+n+"/"+e+"/"+s,r,u)},registerExtension:function(e,n){t.registerExtension(e,n)},unregisterExtension:function(e){t.unregisterExtension(e)},batch:function(e){t.batch(e)},subscribeToEvent:function(e,r,o){o=o||window;var i=t.subscribeToEvent(e,r);return n.add(o,i,!0,(function(){t.unsubscribeFromEvent(i)})),i},unsubscribeFromEvent:function(e,r){r=r||window,n.remove(r,e,!0),t.unsubscribeFromEvent(e)},isLoggedIn:function(){return t.isLoggedIn()},getConnectionEvents:function(){return t.getConnectionEvents()},getEvents:function(){return t.getConnectionEvents()},reestablishSession:function(){t.reestablishSession()},loginComplete:function(){t.loginComplete()},getChannels:function(){return t.getChannels()},extendSession:function(){return t.extendSession()},getTokenManagementExtension:function(){return t.getTokenManagementExtension()}}}()}(s(window)&&null!==window.frameElement),window)),a(e,window)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=d(n(373)),o=d(n(167)),i=d(n(2)),u=d(n(98)),s=d(n(374)),a=n(12),c=d(n(375)),f=d(n(376)),l=d(n(377));function d(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=new r.default.CometD;e.registerTransport(a.WEBSOCKET_TYPE_NAME,new r.default.WebSocketTransport,0),e.registerTransport("long-polling",new r.default.LongPollingTransport,1),e.unregisterTransport("callback-polling");var t=new s.default;e.registerExtension("graphQLSubscription",t);var n=new c.default;e.registerExtension("sessionExtension",n);var d=new f.default;e.registerExtension(a.TOKEN_MANAGEMENT_EXTENSION,d);var p=new o.default(e),h=new i.default("amb.MessageClient"),v=new l.default,g=!1;return{getServerConnection:function(){return p},isLoggedIn:function(){return p.isLoggedIn()},loginComplete:function(){p.loginComplete()},reestablishSession:function(){p.reestablishSession()},connect:function(){g?h.addInfoMessage(">>> connection exists, request satisfied"):(g=!0,p.connect())},reload:function(){g=!1,p.reload()},abort:function(){g=!1,p.abort()},disconnect:function(){g=!1,p.disconnect()},isConnected:function(){return g},getConnectionEvents:function(){return p.getEvents()},subscribeToEvent:function(e,t){return p.subscribeToEvent(e,t)},unsubscribeFromEvent:function(e){p.unsubscribeFromEvent(e)},getConnectionState:function(){return p.getConnectionState()},getClientId:function(){return e.getClientId()},getChannel:function(e,n){var r=n||{},o=r.subscriptionCallback,i=r.serializedGraphQLSubscription,s=r.subscribeOptionsCallback,a=p.getChannel(e,s);return t.isGraphQLChannel(e)&&(i?t.addGraphQLChannel(e,i):h.addErrorMessage("Serialized subscription not present for GraphQL channel "+e)),new u.default(a,p,o)},removeChannel:function(e){p.removeChannel(e),t.isGraphQLChannel(e)&&t.removeGraphQLChannel(e)},getChannels:function(){return p.getChannels()},cancelTransaction:function(e){v.cancelTransaction(e,this)},extendSession:function(){n.extendSession()},getTokenManagementExtension:function(){return d},registerExtension:function(t,n){e.registerExtension(t,n)},unregisterExtension:function(t){e.unregisterExtension(t)},batch:function(t){e.batch(t)}}}},function(e,t,n){e.exports=function(){var e=e||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},o=r.lib={},i=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var u=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=u<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],o=function(t){t=t;var n=987654321,r=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=o(4294967296*(n||e.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new u.init(r,t)}}),s=r.enc={},a=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},f=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},l=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i),a=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,c=e.min(4*a,o);if(a){for(var f=0;f<a;f+=i)this._doProcessBlock(r,f);var l=r.splice(0,a);n.sigBytes-=c}return new u.init(l,c)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(o.Hasher=l.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math);return e}()},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(389),o=n(390);e.exports=function(e){return null==e?[]:r(e,o(e))}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}},function(e,t,n){var r=n(393),o=n(29),i=Object.prototype,u=i.hasOwnProperty,s=i.propertyIsEnumerable,a=r(function(){return arguments}())?r:function(e){return o(e)&&u.call(e,"callee")&&!s.call(e,"callee")};e.exports=a},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(179),o=n(100);e.exports=function(e){return null!=e&&o(e.length)&&!r(e)}},function(e,t,n){var r=n(27),o=n(101);e.exports=function(e){if(!o(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var r=n(415),o=n(419);e.exports=function(e,t){var n=o(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(260),o=n(129),i=0,u=Math.pow(36,4);function s(){return o((Math.random()*u<<0).toString(36),4)}function a(){return i=i<u?i:0,++i-1}function c(){return"c"+(new Date).getTime().toString(36)+o(a().toString(36),4)+r()+(s()+s())}c.slug=function(){var e=(new Date).getTime().toString(36),t=a().toString(36).slice(-4),n=r().slice(0,1)+r().slice(-1),o=s().slice(-2);return e.slice(-2)+t+n+o},c.fingerprint=r,e.exports=c},function(e,t,n){var r=n(261),o=n(45),i=n(323),u=Math.max;e.exports=function(e,t,n){var s=null==e?0:e.length;if(!s)return-1;var a=null==n?0:i(n);return a<0&&(a=u(s+a,0)),r(e,o(t,3),a)}},function(e,t,n){var r=n(151);e.exports=function(e){return r(e).toUpperCase()}},function(e,t,n){"use strict";var r=n(332),o=n(333),i=n(154);e.exports={formats:i,parse:o,stringify:r}},function(e,t,n){var r=n(335);e.exports=function(e){return r(e,5)}},function(e,t,n){var r=n(134),o=n(357)(r);e.exports=o},function(e,t,n){var r=n(366),o=n(89),i=n(144),u=i&&i.isArrayBuffer,s=u?o(u):r;e.exports=s},function(e,t,n){n(189),n(210),n(234),e.exports=n(238)},function(e,t,n){n(190),n(103),n(199),n(201),n(208),n(209),e.exports=n(9).Promise},function(e,t,n){"use strict";var r=n(66),o={};o[n(1)("toStringTag")]="z",o+""!="[object z]"&&n(30)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){e.exports=!n(32)&&!n(24)((function(){return 7!=Object.defineProperty(n(69)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(15);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(33),o=n(71);e.exports=function(e){return function(t,n){var i,u,s=String(o(t)),a=r(n),c=s.length;return a<0||a>=c?e?"":void 0:(i=s.charCodeAt(a))<55296||i>56319||a+1===c||(u=s.charCodeAt(a+1))<56320||u>57343?e?s.charAt(a):i:e?s.slice(a,a+2):u-56320+(i-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(195),o=n(70),i=n(75),u={};n(23)(u,n(1)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(u,{next:o(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(14),o=n(196),i=n(106),u=n(73)("IE_PROTO"),s=function(){},a=function(){var e,t=n(69)("iframe"),r=i.length;for(t.style.display="none",n(74).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),a=e.F;r--;)delete a.prototype[i[r]];return a()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[u]=e):n=a(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(31),o=n(14),i=n(105);e.exports=n(32)?Object.defineProperties:function(e,t){o(e);for(var n,u=i(t),s=u.length,a=0;s>a;)r.f(e,n=u[a++],t[n]);return e}},function(e,t,n){var r=n(42),o=n(35),i=n(72)(!1),u=n(73)("IE_PROTO");e.exports=function(e,t){var n,s=o(e),a=0,c=[];for(n in s)n!=u&&r(s,n)&&c.push(n);for(;t.length>a;)r(s,n=t[a++])&&(~i(c,n)||c.push(n));return c}},function(e,t,n){var r=n(42),o=n(10),i=n(73)("IE_PROTO"),u=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?u:null}},function(e,t,n){for(var r=n(107),o=n(105),i=n(30),u=n(3),s=n(23),a=n(34),c=n(1),f=c("iterator"),l=c("toStringTag"),d=a.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=o(p),v=0;v<h.length;v++){var g,b=h[v],m=p[b],y=u[b],_=y&&y.prototype;if(_&&(_[f]||s(_,f,d),_[l]||s(_,l,b),a[b]=d,m))for(g in r)_[g]||i(_,g,r[g],!0)}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r,o,i,u,s=n(67),a=n(3),c=n(16),f=n(66),l=n(0),d=n(15),p=n(17),h=n(202),v=n(203),g=n(111),b=n(112).set,m=n(205)(),y=n(76),_=n(113),x=n(206),w=n(114),S=a.TypeError,T=a.process,O=T&&T.versions,E=O&&O.v8||"",C=a.Promise,j="process"==f(T),A=function(){},N=o=y.f,I=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[n(1)("species")]=function(e){e(A,A)};return(j||"function"==typeof PromiseRejectionEvent)&&e.then(A)instanceof t&&0!==E.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(e){}}(),M=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},k=function(e,t){if(!e._n){e._n=!0;var n=e._c;m((function(){for(var r=e._v,o=1==e._s,i=0,u=function(t){var n,i,u,s=o?t.ok:t.fail,a=t.resolve,c=t.reject,f=t.domain;try{s?(o||(2==e._h&&P(e),e._h=1),!0===s?n=r:(f&&f.enter(),n=s(r),f&&(f.exit(),u=!0)),n===t.promise?c(S("Promise-chain cycle")):(i=M(n))?i.call(n,a,c):a(n)):c(r)}catch(e){f&&!u&&f.exit(),c(e)}};n.length>i;)u(n[i++]);e._c=[],e._n=!1,t&&!e._h&&L(e)}))}},L=function(e){b.call(a,(function(){var t,n,r,o=e._v,i=R(e);if(i&&(t=_((function(){j?T.emit("unhandledRejection",o,e):(n=a.onunhandledrejection)?n({promise:e,reason:o}):(r=a.console)&&r.error&&r.error("Unhandled promise rejection",o)})),e._h=j||R(e)?2:1),e._a=void 0,i&&t.e)throw t.v}))},R=function(e){return 1!==e._h&&0===(e._a||e._c).length},P=function(e){b.call(a,(function(){var t;j?T.emit("rejectionHandled",e):(t=a.onrejectionhandled)&&t({promise:e,reason:e._v})}))},D=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),k(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw S("Promise can't be resolved itself");(t=M(e))?m((function(){var r={_w:n,_d:!1};try{t.call(e,c(F,r,1),c(D,r,1))}catch(e){D.call(r,e)}})):(n._v=e,n._s=1,k(n,!1))}catch(e){D.call({_w:n,_d:!1},e)}}};I||(C=function(e){h(this,C,"Promise","_h"),p(e),r.call(this);try{e(c(F,this,1),c(D,this,1))}catch(e){D.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(207)(C.prototype,{then:function(e,t){var n=N(g(this,C));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=j?T.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&k(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=c(F,e,1),this.reject=c(D,e,1)},y.f=N=function(e){return e===C||e===u?new i(e):o(e)}),l(l.G+l.W+l.F*!I,{Promise:C}),n(75)(C,"Promise"),n(115)("Promise"),u=n(9).Promise,l(l.S+l.F*!I,"Promise",{reject:function(e){var t=N(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(s||!I),"Promise",{resolve:function(e){return w(s&&this===u?C:this,e)}}),l(l.S+l.F*!(I&&n(116)((function(e){C.all(e).catch(A)}))),"Promise",{all:function(e){var t=this,n=N(t),r=n.resolve,o=n.reject,i=_((function(){var n=[],i=0,u=1;v(e,!1,(function(e){var s=i++,a=!1;n.push(void 0),u++,t.resolve(e).then((function(e){a||(a=!0,n[s]=e,--u||r(n))}),o)})),--u||r(n)}));return i.e&&o(i.v),n.promise},race:function(e){var t=this,n=N(t),r=n.reject,o=_((function(){v(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return o.e&&r(o.v),n.promise}})},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(16),o=n(108),i=n(109),u=n(14),s=n(6),a=n(110),c={},f={};(t=e.exports=function(e,t,n,l,d){var p,h,v,g,b=d?function(){return e}:a(e),m=r(n,l,t?2:1),y=0;if("function"!=typeof b)throw TypeError(e+" is not iterable!");if(i(b)){for(p=s(e.length);p>y;y++)if((g=t?m(u(h=e[y])[0],h[1]):m(e[y]))===c||g===f)return g}else for(v=b.call(e);!(h=v.next()).done;)if((g=o(v,m,h.value,t))===c||g===f)return g}).BREAK=c,t.RETURN=f},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(3),o=n(112).set,i=r.MutationObserver||r.WebKitMutationObserver,u=r.process,s=r.Promise,a="process"==n(22)(u);e.exports=function(){var e,t,n,c=function(){var r,o;for(a&&(r=u.domain)&&r.exit();e;){o=e.fn,e=e.next;try{o()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(a)n=function(){u.nextTick(c)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var f=s.resolve(void 0);n=function(){f.then(c)}}else n=function(){o.call(r,c)};else{var l=!0,d=document.createTextNode("");new i(c).observe(d,{characterData:!0}),n=function(){d.data=l=!l}}return function(r){var o={fn:r,next:void 0};t&&(t.next=o),e||(e=o,n()),t=o}}},function(e,t,n){var r=n(3).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(30);e.exports=function(e,t,n){for(var o in t)r(e,o,t[o],n);return e}},function(e,t,n){"use strict";var r=n(0),o=n(9),i=n(3),u=n(111),s=n(114);r(r.P+r.R,"Promise",{finally:function(e){var t=u(this,o.Promise||i.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){"use strict";var r=n(0),o=n(76),i=n(113);r(r.S,"Promise",{try:function(e){var t=o.f(this),n=i(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){n(103),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(229),n(231),n(232),n(233),n(107),e.exports=n(9).Array},function(e,t,n){var r=n(0);r(r.S,"Array",{isArray:n(77)})},function(e,t,n){"use strict";var r=n(16),o=n(0),i=n(10),u=n(108),s=n(109),a=n(6),c=n(117),f=n(110);o(o.S+o.F*!n(116)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,o,l,d=i(e),p="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,g=void 0!==v,b=0,m=f(d);if(g&&(v=r(v,h>2?arguments[2]:void 0,2)),null==m||p==Array&&s(m))for(n=new p(t=a(d.length));t>b;b++)c(n,b,g?v(d[b],b):d[b]);else for(l=m.call(d),n=new p;!(o=l.next()).done;b++)c(n,b,g?u(l,v,[o.value,b],!0):o.value);return n.length=b,n}})},function(e,t,n){"use strict";var r=n(0),o=n(117);r(r.S+r.F*n(24)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)o(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(0),o=n(35),i=[].join;r(r.P+r.F*(n(43)!=Object||!n(7)(i)),"Array",{join:function(e){return i.call(o(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(0),o=n(74),i=n(22),u=n(44),s=n(6),a=[].slice;r(r.P+r.F*n(24)((function(){o&&a.call(o)})),"Array",{slice:function(e,t){var n=s(this.length),r=i(this);if(t=void 0===t?n:t,"Array"==r)return a.call(this,e,t);for(var o=u(e,n),c=u(t,n),f=s(c-o),l=new Array(f),d=0;d<f;d++)l[d]="String"==r?this.charAt(o+d):this[o+d];return l}})},function(e,t,n){"use strict";var r=n(0),o=n(17),i=n(10),u=n(24),s=[].sort,a=[1,2,3];r(r.P+r.F*(u((function(){a.sort(void 0)}))||!u((function(){a.sort(null)}))||!n(7)(s)),"Array",{sort:function(e){return void 0===e?s.call(i(this)):s.call(i(this),o(e))}})},function(e,t,n){"use strict";var r=n(0),o=n(18)(0),i=n(7)([].forEach,!0);r(r.P+r.F*!i,"Array",{forEach:function(e){return o(this,e,arguments[1])}})},function(e,t,n){var r=n(15),o=n(77),i=n(1)("species");e.exports=function(e){var t;return o(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!o(t.prototype)||(t=void 0),r(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(0),o=n(18)(1);r(r.P+r.F*!n(7)([].map,!0),"Array",{map:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),o=n(18)(2);r(r.P+r.F*!n(7)([].filter,!0),"Array",{filter:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),o=n(18)(3);r(r.P+r.F*!n(7)([].some,!0),"Array",{some:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),o=n(18)(4);r(r.P+r.F*!n(7)([].every,!0),"Array",{every:function(e){return o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),o=n(118);r(r.P+r.F*!n(7)([].reduce,!0),"Array",{reduce:function(e){return o(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(0),o=n(118);r(r.P+r.F*!n(7)([].reduceRight,!0),"Array",{reduceRight:function(e){return o(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(0),o=n(72)(!1),i=[].indexOf,u=!!i&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(u||!n(7)(i)),"Array",{indexOf:function(e){return u?i.apply(this,arguments)||0:o(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),o=n(35),i=n(33),u=n(6),s=[].lastIndexOf,a=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(a||!n(7)(s)),"Array",{lastIndexOf:function(e){if(a)return s.apply(this,arguments)||0;var t=o(this),n=u(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,i(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(0);r(r.P,"Array",{copyWithin:n(228)}),n(11)("copyWithin")},function(e,t,n){"use strict";var r=n(10),o=n(44),i=n(6);e.exports=[].copyWithin||function(e,t){var n=r(this),u=i(n.length),s=o(e,u),a=o(t,u),c=arguments.length>2?arguments[2]:void 0,f=Math.min((void 0===c?u:o(c,u))-a,u-s),l=1;for(a<s&&s<a+f&&(l=-1,a+=f-1,s+=f-1);f-- >0;)a in n?n[s]=n[a]:delete n[s],s+=l,a+=l;return n}},function(e,t,n){var r=n(0);r(r.P,"Array",{fill:n(230)}),n(11)("fill")},function(e,t,n){"use strict";var r=n(10),o=n(44),i=n(6);e.exports=function(e){for(var t=r(this),n=i(t.length),u=arguments.length,s=o(u>1?arguments[1]:void 0,n),a=u>2?arguments[2]:void 0,c=void 0===a?n:o(a,n);c>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(0),o=n(18)(5),i=!0;"find"in[]&&Array(1).find((function(){i=!1})),r(r.P+r.F*i,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(11)("find")},function(e,t,n){"use strict";var r=n(0),o=n(18)(6),i="findIndex",u=!0;i in[]&&Array(1)[i]((function(){u=!1})),r(r.P+r.F*u,"Array",{findIndex:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(11)(i)},function(e,t,n){n(115)("Array")},function(e,t,n){n(235),n(236),n(237),e.exports=n(9).Array},function(e,t,n){"use strict";var r=n(0),o=n(72)(!0);r(r.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n(11)("includes")},function(e,t,n){"use strict";var r=n(0),o=n(119),i=n(10),u=n(6),s=n(17),a=n(78);r(r.P,"Array",{flatMap:function(e){var t,n,r=i(this);return s(e),t=u(r.length),n=a(r,0),o(n,r,r,t,0,1,e,arguments[1]),n}}),n(11)("flatMap")},function(e,t,n){"use strict";var r=n(0),o=n(119),i=n(10),u=n(6),s=n(33),a=n(78);r(r.P,"Array",{flatten:function(){var e=arguments[0],t=i(this),n=u(t.length),r=a(t,0);return o(r,t,t,n,0,void 0===e?1:s(e)),r}}),n(11)("flatten")},function(e,t,n){"use strict";n.r(t);var r=n(36);n.d(t,"startFlow",(function(){return r.startFlow})),n.d(t,"startSubflow",(function(){return r.startSubflow})),n.d(t,"startAction",(function(){return r.startAction})),n.d(t,"getExecution",(function(){return r.getExecution}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExecution=t.startAction=t.startSubflow=t.startFlow=void 0;var r=n(37),o=u(n(240)),i=u(n(120));function u(e){return e&&e.__esModule?e:{default:e}}t.startFlow=function(e,t){return(0,o.default)({type:r.FLOW_TYPES.FLOW,name:e,inputs:t})},t.startSubflow=function(e,t){return(0,o.default)({type:r.FLOW_TYPES.SUBFLOW,name:e,inputs:t})},t.startAction=function(e,t){return(0,o.default)({type:r.FLOW_TYPES.ACTION,name:e,inputs:t})},t.getExecution=function(e){return Promise.resolve((0,i.default)(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=s(n(120)),i=s(n(385)),u=s(n(79));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e){return(0,o.default)(e.execution_id)};t.default=function(e){(0,i.default)(e);var t=e.type,n=e.name,o=e.inputs,s="/"+r.FLOWOBJECT_API_PATH+"/"+r.START+"/"+t,c={name:n,inputs:o};return(0,u.default)(s,"POST",{body:c,transform:a})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=u(n(79)),i=u(n(55));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(e){return e.status};t.default=function(e){(0,i.default)(e);var t=r.FLOWOBJECT_API_PATH+"/"+r.STATUS+"/"+e;return(0,o.default)(t,"GET",{transform:s})}},function(e,t,n){"use strict";var r=n(4),o=n(121),i=n(243),u=n(127);function s(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var a=s(n(124));a.Axios=i,a.create=function(e){return s(u(a.defaults,e))},a.Cancel=n(128),a.CancelToken=n(257),a.isCancel=n(123),a.all=function(e){return Promise.all(e)},a.spread=n(258),a.isAxiosError=n(259),e.exports=a,e.exports.default=a},function(e,t,n){"use strict";var r=n(4),o=n(122),i=n(244),u=n(245),s=n(127);function a(e){this.defaults=e,this.interceptors={request:new i,response:new i}}a.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[u,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},a.prototype.getUri=function(e){return e=s(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){a.prototype[e]=function(t,n){return this.request(s(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){a.prototype[e]=function(t,n,r){return this.request(s(r||{},{method:e,url:t,data:n}))}})),e.exports=a},function(e,t,n){"use strict";var r=n(4);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},function(e,t,n){"use strict";var r=n(4),o=n(246),i=n(123),u=n(124);function s(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return s(e),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||u.adapter)(e).then((function(t){return s(e),t.data=o(t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(s(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(4);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var a,c=[],f=!1,l=-1;function d(){f&&a&&(f=!1,a.length?c=a.concat(c):l=-1,c.length&&p())}function p(){if(!f){var e=s(d);f=!0;for(var t=c.length;t;){for(a=c,c=[];++l<t;)a&&a[l].run();l=-1,t=c.length}a=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||f||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(4);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(126);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(4);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,u){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(o)&&s.push("path="+o),r.isString(i)&&s.push("domain="+i),!0===u&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(253),o=n(254);e.exports=function(e,t){return e&&!r(t)?o(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(4),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,u={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(u[t]&&o.indexOf(t)>=0)return;u[t]="set-cookie"===t?(u[t]?u[t]:[]).concat([n]):u[t]?u[t]+", "+n:n}})),u):u}},function(e,t,n){"use strict";var r=n(4);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(128);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,n){var r=n(129),o="object"==typeof window?window:self,i=Object.keys(o),u=r(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+i.toString(36),4);e.exports=function(){return u}},function(e,t){e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},function(e,t,n){var r=n(263),o=n(310),i=n(148);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(80),o=n(132);e.exports=function(e,t,n,i){var u=n.length,s=u,a=!i;if(null==e)return!s;for(e=Object(e);u--;){var c=n[u];if(a&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++u<s;){var f=(c=n[u])[0],l=e[f],d=c[1];if(a&&c[2]){if(void 0===l&&!(f in e))return!1}else{var p=new r;if(i)var h=i(l,d,f,e,t,p);if(!(void 0===h?o(d,l,3,i,p):h))return!1}}return!0}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(47),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},function(e,t,n){var r=n(47);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(47);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(47);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},function(e,t,n){var r=n(46);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(46),o=n(82),i=n(84);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var u=n.__data__;if(!o||u.length<199)return u.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(u)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(62),o=n(277),i=n(20),u=n(131),s=/^\[object .+?Constructor\]$/,a=Function.prototype,c=Object.prototype,f=a.toString,l=c.hasOwnProperty,d=RegExp("^"+f.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?d:s).test(u(e))}},function(e,t,n){var r=n(26),o=Object.prototype,i=o.hasOwnProperty,u=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=u.call(e);return r&&(t?e[s]=n:delete e[s]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r=n(278),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(8)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(281),o=n(46),i=n(82);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(e,t,n){var r=n(282),o=n(283),i=n(284),u=n(285),s=n(286);function a(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=s,e.exports=a},function(e,t,n){var r=n(48);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(48),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(48),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},function(e,t,n){var r=n(48);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(49);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(49);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(49);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(49);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},function(e,t,n){var r=n(80),o=n(133),i=n(297),u=n(298),s=n(146),a=n(5),c=n(40),f=n(143),l="[object Arguments]",d="[object Array]",p="[object Object]",h=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,g,b){var m=a(e),y=a(t),_=m?d:s(e),x=y?d:s(t),w=(_=_==l?p:_)==p,S=(x=x==l?p:x)==p,T=_==x;if(T&&c(e)){if(!c(t))return!1;m=!0,w=!1}if(T&&!w)return b||(b=new r),m||f(e)?o(e,t,n,v,g,b):i(e,t,_,n,v,g,b);if(!(1&n)){var O=w&&h.call(e,"__wrapped__"),E=S&&h.call(t,"__wrapped__");if(O||E){var C=O?e.value():e,j=E?t.value():t;return b||(b=new r),g(C,j,n,v,b)}}return!!T&&(b||(b=new r),u(e,t,n,v,g,b))}},function(e,t,n){var r=n(84),o=n(294),i=n(295);function u(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}u.prototype.add=u.prototype.push=o,u.prototype.has=i,e.exports=u},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(26),o=n(135),i=n(81),u=n(133),s=n(136),a=n(137),c=r?r.prototype:void 0,f=c?c.valueOf:void 0;e.exports=function(e,t,n,r,c,l,d){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!l(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var p=s;case"[object Set]":var h=1&r;if(p||(p=a),e.size!=t.size&&!h)return!1;var v=d.get(e);if(v)return v==t;r|=2,d.set(e,t);var g=u(p(e),p(t),r,c,l,d);return d.delete(e),g;case"[object Symbol]":if(f)return f.call(e)==f.call(t)}return!1}},function(e,t,n){var r=n(138),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,i,u,s){var a=1&n,c=r(e),f=c.length;if(f!=r(t).length&&!a)return!1;for(var l=f;l--;){var d=c[l];if(!(a?d in t:o.call(t,d)))return!1}var p=s.get(e);if(p&&s.get(t))return p==t;var h=!0;s.set(e,t),s.set(t,e);for(var v=a;++l<f;){var g=e[d=c[l]],b=t[d];if(i)var m=a?i(b,g,d,t,e,s):i(g,b,d,e,t,s);if(!(void 0===m?g===b||u(g,b,n,i,s):m)){h=!1;break}v||(v="constructor"==d)}if(h&&!v){var y=e.constructor,_=t.constructor;y!=_&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof _&&_ instanceof _)&&(h=!1)}return s.delete(e),s.delete(t),h}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var u=e[n];t(u,n,e)&&(i[o++]=u)}return i}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(25),o=n(13);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(25),o=n(88),i=n(13),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!u[r(e)]}},function(e,t,n){var r=n(90),o=n(305),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t,n){var r=n(145)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(19)(n(8),"DataView");e.exports=r},function(e,t,n){var r=n(19)(n(8),"Promise");e.exports=r},function(e,t,n){var r=n(19)(n(8),"Set");e.exports=r},function(e,t,n){var r=n(19)(n(8),"WeakMap");e.exports=r},function(e,t,n){var r=n(147),o=n(38);e.exports=function(e){for(var t=o(e),n=t.length;n--;){var i=t[n],u=e[i];t[n]=[i,u,r(u)]}return t}},function(e,t,n){var r=n(132),o=n(312),i=n(317),u=n(91),s=n(147),a=n(148),c=n(52);e.exports=function(e,t){return u(e)&&s(t)?a(c(e),t):function(n){var u=o(n,e);return void 0===u&&u===t?i(n,e):r(t,u,3)}}},function(e,t,n){var r=n(149);e.exports=function(e,t,n){var o=null==e?void 0:r(e,t);return void 0===o?n:o}},function(e,t,n){var r=/^\./,o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,u=n(314)((function(e){var t=[];return r.test(e)&&t.push(""),e.replace(o,(function(e,n,r,o){t.push(r?o.replace(i,"$1"):n||e)})),t}));e.exports=u},function(e,t,n){var r=n(315);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(84);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=e.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(o.Cache||r),n}o.Cache=r,e.exports=o},function(e,t,n){var r=n(26),o=n(92),i=n(5),u=n(51),s=r?r.prototype:void 0,a=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(u(t))return a?a.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t,n){var r=n(318),o=n(319);e.exports=function(e,t){return null!=e&&o(e,t,r)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(150),o=n(87),i=n(5),u=n(142),s=n(88),a=n(52);e.exports=function(e,t,n){for(var c=-1,f=(t=r(t,e)).length,l=!1;++c<f;){var d=a(t[c]);if(!(l=null!=e&&n(e,d)))break;e=e[d]}return l||++c!=f?l:!!(f=null==e?0:e.length)&&s(f)&&u(d,f)&&(i(e)||o(e))}},function(e,t,n){var r=n(321),o=n(322),i=n(91),u=n(52);e.exports=function(e){return i(e)?r(u(e)):o(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var r=n(149);e.exports=function(e){return function(t){return r(t,e)}}},function(e,t,n){var r=n(324);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t,n){var r=n(325);e.exports=function(e){return e?(e=r(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(20),o=n(51),i=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=s.test(e);return n||a.test(e)?c(e.slice(2),n?2:8):u.test(e)?NaN:+e}},function(e,t,n){var r=n(327),o=n(38);e.exports=function(e,t){return e&&r(e,t,o)}},function(e,t,n){var r=n(328)();e.exports=r},function(e,t){e.exports=function(e){return function(t,n,r){for(var o=-1,i=Object(t),u=r(t),s=u.length;s--;){var a=u[e?s:++o];if(!1===n(i[a],a,i))break}return t}}},function(e,t,n){var r=n(50);e.exports=function(e,t){return function(n,o){if(null==n)return n;if(!r(n))return e(n,o);for(var i=n.length,u=t?i:-1,s=Object(n);(t?u--:++u<i)&&!1!==o(s[u],u,s););return n}}},function(e,t,n){var r=n(53);e.exports=function(e){return"function"==typeof e?e:r}},function(e,t){e.exports=function(e,t,n,r,o){return o(e,(function(e,o,i){n=r?(r=!1,e):t(n,e,o,i)})),n}},function(e,t,n){"use strict";var r=n(153),o=n(154),i={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},u=Date.prototype.toISOString,s={delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},a=function e(t,n,o,i,u,a,c,f,l,d,p,h){var v=t;if("function"==typeof c)v=c(n,v);else if(v instanceof Date)v=d(v);else if(null===v){if(i)return a&&!h?a(n,s.encoder):n;v=""}if("string"==typeof v||"number"==typeof v||"boolean"==typeof v||r.isBuffer(v))return a?[p(h?n:a(n,s.encoder))+"="+p(a(v,s.encoder))]:[p(n)+"="+p(String(v))];var g,b=[];if(void 0===v)return b;if(Array.isArray(c))g=c;else{var m=Object.keys(v);g=f?m.sort(f):m}for(var y=0;y<g.length;++y){var _=g[y];u&&null===v[_]||(b=Array.isArray(v)?b.concat(e(v[_],o(n,_),o,i,u,a,c,f,l,d,p,h)):b.concat(e(v[_],n+(l?"."+_:"["+_+"]"),o,i,u,a,c,f,l,d,p,h)))}return b};e.exports=function(e,t){var n=e,u=t?r.assign({},t):{};if(null!==u.encoder&&void 0!==u.encoder&&"function"!=typeof u.encoder)throw new TypeError("Encoder has to be a function.");var c=void 0===u.delimiter?s.delimiter:u.delimiter,f="boolean"==typeof u.strictNullHandling?u.strictNullHandling:s.strictNullHandling,l="boolean"==typeof u.skipNulls?u.skipNulls:s.skipNulls,d="boolean"==typeof u.encode?u.encode:s.encode,p="function"==typeof u.encoder?u.encoder:s.encoder,h="function"==typeof u.sort?u.sort:null,v=void 0!==u.allowDots&&u.allowDots,g="function"==typeof u.serializeDate?u.serializeDate:s.serializeDate,b="boolean"==typeof u.encodeValuesOnly?u.encodeValuesOnly:s.encodeValuesOnly;if(void 0===u.format)u.format=o.default;else if(!Object.prototype.hasOwnProperty.call(o.formatters,u.format))throw new TypeError("Unknown format option provided.");var m,y,_=o.formatters[u.format];"function"==typeof u.filter?n=(y=u.filter)("",n):Array.isArray(u.filter)&&(m=y=u.filter);var x,w=[];if("object"!=typeof n||null===n)return"";x=u.arrayFormat in i?u.arrayFormat:"indices"in u?u.indices?"indices":"repeat":"indices";var S=i[x];m||(m=Object.keys(n)),h&&m.sort(h);for(var T=0;T<m.length;++T){var O=m[T];l&&null===n[O]||(w=w.concat(a(n[O],O,S,f,l,d?p:null,y,h,v,g,_,b)))}var E=w.join(c),C=!0===u.addQueryPrefix?"?":"";return E.length>0?C+E:""}},function(e,t,n){"use strict";var r=n(153),o=Object.prototype.hasOwnProperty,i={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:r.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},u=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/g,u=/(\[[^[\]]*])/.exec(r),s=u?r.slice(0,u.index):r,a=[];if(s){if(!n.plainObjects&&o.call(Object.prototype,s)&&!n.allowPrototypes)return;a.push(s)}for(var c=0;null!==(u=i.exec(r))&&c<n.depth;){if(c+=1,!n.plainObjects&&o.call(Object.prototype,u[1].slice(1,-1))&&!n.allowPrototypes)return;a.push(u[1])}return u&&a.push("["+r.slice(u.index)+"]"),function(e,t,n){for(var r=t,o=e.length-1;o>=0;--o){var i,u=e[o];if("[]"===u)i=(i=[]).concat(r);else{i=n.plainObjects?Object.create(null):{};var s="["===u.charAt(0)&&"]"===u.charAt(u.length-1)?u.slice(1,-1):u,a=parseInt(s,10);!isNaN(a)&&u!==s&&String(a)===s&&a>=0&&n.parseArrays&&a<=n.arrayLimit?(i=[])[a]=r:i[s]=r}r=i}return r}(a,t,n)}};e.exports=function(e,t){var n=t?r.assign({},t):{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.ignoreQueryPrefix=!0===n.ignoreQueryPrefix,n.delimiter="string"==typeof n.delimiter||r.isRegExp(n.delimiter)?n.delimiter:i.delimiter,n.depth="number"==typeof n.depth?n.depth:i.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:i.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"==typeof n.decoder?n.decoder:i.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:i.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:i.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:i.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:i.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:i.strictNullHandling,""===e||null==e)return n.plainObjects?Object.create(null):{};for(var s="string"==typeof e?function(e,t){for(var n={},r=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,u=t.parameterLimit===1/0?void 0:t.parameterLimit,s=r.split(t.delimiter,u),a=0;a<s.length;++a){var c,f,l=s[a],d=l.indexOf("]="),p=-1===d?l.indexOf("="):d+1;-1===p?(c=t.decoder(l,i.decoder),f=t.strictNullHandling?null:""):(c=t.decoder(l.slice(0,p),i.decoder),f=t.decoder(l.slice(p+1),i.decoder)),o.call(n,c)?n[c]=[].concat(n[c]).concat(f):n[c]=f}return n}(e,n):e,a=n.plainObjects?Object.create(null):{},c=Object.keys(s),f=0;f<c.length;++f){var l=c[f],d=u(l,s[l],n);a=r.merge(a,d,n)}return r.compact(a)}},function(e,t,n){var r=n(93),o=n(50);e.exports=function(e,t){var n=-1,i=o(e)?Array(e.length):[];return r(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}},function(e,t,n){var r=n(80),o=n(152),i=n(155),u=n(336),s=n(337),a=n(340),c=n(341),f=n(342),l=n(343),d=n(138),p=n(344),h=n(146),v=n(345),g=n(346),b=n(355),m=n(5),y=n(40),_=n(20),x=n(38),w="[object Arguments]",S="[object Function]",T="[object Object]",O={};O[w]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object DataView]"]=O["[object Boolean]"]=O["[object Date]"]=O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Map]"]=O["[object Number]"]=O[T]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object Symbol]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Error]"]=O[S]=O["[object WeakMap]"]=!1,e.exports=function e(t,n,E,C,j,A){var N,I=1&n,M=2&n,k=4&n;if(E&&(N=j?E(t,C,j,A):E(t)),void 0!==N)return N;if(!_(t))return t;var L=m(t);if(L){if(N=v(t),!I)return c(t,N)}else{var R=h(t),P=R==S||"[object GeneratorFunction]"==R;if(y(t))return a(t,I);if(R==T||R==w||P&&!j){if(N=M||P?{}:b(t),!I)return M?l(t,s(N,t)):f(t,u(N,t))}else{if(!O[R])return j?t:{};N=g(t,R,e,I)}}A||(A=new r);var D=A.get(t);if(D)return D;A.set(t,N);var F=k?M?p:d:M?keysIn:x,U=L?void 0:F(t);return o(U||t,(function(r,o){U&&(r=t[o=r]),i(N,o,e(r,n,E,o,t,A))})),N}},function(e,t,n){var r=n(54),o=n(38);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(54),o=n(158);e.exports=function(e,t){return e&&r(t,o(t),e)}},function(e,t,n){var r=n(20),o=n(90),i=n(339),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=o(e),n=[];for(var s in e)("constructor"!=s||!t&&u.call(e,s))&&n.push(s);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){(function(e){var r=n(8),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,u=i&&i.exports===o?r.Buffer:void 0,s=u?u.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(39)(e))},function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t,n){var r=n(54),o=n(86);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t,n){var r=n(54),o=n(159);e.exports=function(e,t){return r(e,o(e),t)}},function(e,t,n){var r=n(139),o=n(159),i=n(158);e.exports=function(e){return r(e,i,o)}},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,n){var r=n(95),o=n(347),i=n(348),u=n(350),s=n(351),a=n(353),c=n(354);e.exports=function(e,t,n,f){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return o(e,f);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return c(e,f);case"[object Map]":return i(e,f,n);case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return u(e);case"[object Set]":return s(e,f,n);case"[object Symbol]":return a(e)}}},function(e,t,n){var r=n(95);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},function(e,t,n){var r=n(349),o=n(94),i=n(136);e.exports=function(e,t,n){var u=t?n(i(e),1):i(e);return o(u,r,new e.constructor)}},function(e,t){e.exports=function(e,t){return e.set(t[0],t[1]),e}},function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,n){var r=n(352),o=n(94),i=n(137);e.exports=function(e,t,n){var u=t?n(i(e),1):i(e);return o(u,r,new e.constructor)}},function(e,t){e.exports=function(e,t){return e.add(t),e}},function(e,t,n){var r=n(26),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},function(e,t,n){var r=n(95);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},function(e,t,n){var r=n(356),o=n(160),i=n(90);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:r(o(e))}},function(e,t,n){var r=n(20),o=Object.create,i=function(){function e(){}return function(t){if(!r(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=i},function(e,t,n){var r=n(161),o=n(92),i=n(45),u=n(358),s=n(89),a=n(362);e.exports=function(e){return a((function(t){return t=o(t,s(i)),u((function(n){var o=this;return e(t,(function(e){return r(e,o,n)}))}))}))}},function(e,t,n){var r=n(53),o=n(162),i=n(163);e.exports=function(e,t){return i(o(e,t,r),e+"")}},function(e,t,n){var r=n(360),o=n(157),i=n(53),u=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i;e.exports=u},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var o=n(),i=16-(o-r);if(r=o,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(363),o=n(162),i=n(163);e.exports=function(e){return i(o(e,void 0,r),e+"")}},function(e,t,n){var r=n(364);e.exports=function(e){return null!=e&&e.length?r(e,1):[]}},function(e,t,n){var r=n(85),o=n(365);e.exports=function e(t,n,i,u,s){var a=-1,c=t.length;for(i||(i=o),s||(s=[]);++a<c;){var f=t[a];n>0&&i(f)?n>1?e(f,n-1,i,u,s):r(s,f):u||(s[s.length]=f)}return s}},function(e,t,n){var r=n(26),o=n(87),i=n(5),u=r?r.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(u&&e&&e[u])}},function(e,t,n){var r=n(25),o=n(13);e.exports=function(e){return o(e)&&"[object ArrayBuffer]"==r(e)}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("Unable to locate global object")}}).call(this,n(83))},function(e,t,n){var r=n(97),o=Object.prototype,i=o.hasOwnProperty,u=o.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=u.call(e);return r&&(t?e[s]=n:delete e[s]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(55)),o=u(n(165)),i=u(n(371));function u(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){(0,r.default)(e);var t=(0,i.default)(),n="/flow/execution/"+e,o=t.getChannel(n);return new Promise((function(t,n){o.subscribe((function(r){var i=r.data,u=i.status,f=i.outputs,l=i.error,d=i.fetchOutputs;l?c(l,n):d?s(e,u,{resolve:t,reject:n}):a(u,f,t),setTimeout((function(){return o.unsubscribe()}),0)}))}))};var s=function(e,t,n){(0,o.default)(e).then((function(e){a(t,e,n.resolve)}),(function(e){c(e,n.reject)}))},a=function(e,t,n){n({status:e,outputs:t})},c=function(e,t){t({error:e})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(372));t.default=function(){return r.default.getClient()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=d(n(12)),o=d(n(2)),i=d(n(166)),u=d(n(167)),s=d(n(168)),a=d(n(98)),c=d(n(169)),f=d(n(171)),l=d(n(170));function d(e){return e&&e.__esModule?e:{default:e}}var p={properties:r.default,Logger:o.default,EventManager:i.default,ServerConnection:u.default,ChannelRedirect:s.default,ChannelListener:a.default,Channel:c.default,MessageClient:f.default,getClient:l.default};t.default=p},function(e,t,n){e.exports=function(){var e={isString:function(e){return null!=e&&("string"==typeof e||e instanceof String)},isArray:function(e){return null!=e&&e instanceof Array},inArray:function(e,t){for(var n=0;n<t.length;++n)if(e===t[n])return n;return-1}},t=function(){var t,n,r;this.registered=function(e,r){t=e,n=r},this.unregistered=function(){t=null,n=null},this._notifyTransportTimeout=function(e){var t=n._getTransportListeners("timeout");if(t)for(var r=0;r<t.length;++r){var o=t[r];try{var i=o.call(this,e);if("number"==typeof i&&i>0)return i}catch(e){this._info("Exception during execution of transport listener",o,e)}}return 0},this._debug=function(){n._debug.apply(n,arguments)},this._info=function(){n._info.apply(n,arguments)},this._mixin=function(){return n._mixin.apply(n,arguments)},this.getConfiguration=function(){return n.getConfiguration()},this.getAdvice=function(){return n.getAdvice()},this.setTimeout=function(e,t){return n.setTimeout(e,t)},this.clearTimeout=function(e){n.clearTimeout(e)},this.convertToJSON=function(e){for(var t=this.getConfiguration().maxSendBayeuxMessageSize,n="[",r=0;r<e.length;++r){r>0&&(n+=",");var o=e[r],i=JSON.stringify(o);if(i.length>t)throw"maxSendBayeuxMessageSize "+t+" exceeded";n+=i}return n+"]"},this.convertToMessages=function(t){if(e.isString(t))try{return JSON.parse(t)}catch(e){throw this._debug("Could not convert to JSON the following string",'"'+t+'"'),e}if(e.isArray(t))return t;if(null==t)return[];if(t instanceof Object)return[t];throw"Conversion Error "+t+", typeof "+typeof t},this.accept=function(e,t,n){throw"Abstract"},this.getType=function(){return t},this.getURL=function(){return r},this.setURL=function(e){r=e},this.send=function(e,t){throw"Abstract"},this.reset=function(e){this._debug("Transport",t,"reset",e?"initial":"retry")},this.abort=function(){this._debug("Transport",t,"aborted")},this.toString=function(){return this.getType()}};t.derive=function(e){function t(){}return t.prototype=e,new t};var n=function(){var n=new t,r=t.derive(n),o=0,i=null,u=[],s=[];function a(e,t){if(this.transportSend(e,t)&&(t.expired=!1,!e.sync)){var n=this.getConfiguration().maxNetworkDelay;!0===t.metaConnect&&(n+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"started waiting for message replies of request",t.id,":",n,"ms");var r=this;t.timeout=this.setTimeout((function(){(function e(t,n,r){var o=this._notifyTransportTimeout(t.messages);if(o>0){this._debug("Transport",this.getType(),"extended waiting for message replies of request",n.id,":",o,"ms");var i=this;n.timeout=this.setTimeout((function(){e.call(i,t,n,r+o)}),o)}else{n.expired=!0;var u="Transport "+this.getType()+" expired waiting for message replies of request "+n.id+": "+r+" ms",s={reason:u},a=n.xhr;s.httpCode=this.xhrStatus(a),this.abortXHR(a),this._debug(u),this.complete(n,!1,n.metaConnect),t.onFailure(a,t.messages,s)}}).call(r,e,t,n)}),n)}}function c(e){var t=++o,n={id:t,metaConnect:!1,envelope:e};u.length<this.getConfiguration().maxConnections-1?(u.push(n),a.call(this,e,n)):(this._debug("Transport",this.getType(),"queueing request",t,"envelope",e),s.push([e,n]))}function f(t,n){var r=e.inArray(t,u);if(r>=0&&u.splice(r,1),s.length>0){var o=s.shift(),i=o[0],a=o[1];if(this._debug("Transport dequeued request",a.id),n)this.getConfiguration().autoBatch&&function(e){for(;s.length>0;){var t=s[0],n=t[0],r=t[1];if(n.url!==e.url||n.sync!==e.sync)break;s.shift(),e.messages=e.messages.concat(n.messages),this._debug("Coalesced",n.messages.length,"messages from request",r.id)}}.call(this,i),c.call(this,i),this._debug("Transport completed request",t.id,i);else{var f=this;this.setTimeout((function(){f.complete(a,!1,a.metaConnect);var e={reason:"Previous request failed"},t=a.xhr;e.httpCode=f.xhrStatus(t),i.onFailure(t,i.messages,e)}),0)}}}return r.complete=function(e,t,n){n?function(e){var t=e.id;if(this._debug("Transport",this.getType(),"/meta/connect complete, request",t),null!==i&&i.id!==t)throw"/meta/connect request mismatch, completing request "+t;i=null}.call(this,e):f.call(this,e,t)},r.transportSend=function(e,t){throw"Abstract"},r.transportSuccess=function(e,t,n){t.expired||(this.clearTimeout(t.timeout),this._debug("Transport",this.getType(),"cancelled waiting for message replies"),this.complete(t,!0,t.metaConnect),n&&n.length>0?e.onSuccess(n):e.onFailure(t.xhr,e.messages,{httpCode:204}))},r.transportFailure=function(e,t,n){t.expired||(this.clearTimeout(t.timeout),this._debug("Transport",this.getType(),"cancelled waiting for failed message replies"),this.complete(t,!1,t.metaConnect),e.onFailure(t.xhr,e.messages,n))},r.send=function(e,t){t?function(e){if(null!==i)throw"Concurrent /meta/connect requests not allowed, request id="+i.id+" not yet completed";var t=++o;this._debug("Transport",this.getType(),"/meta/connect send, request",t,"envelope",e);var n={id:t,metaConnect:!0,envelope:e};a.call(this,e,n),i=n}.call(this,e):c.call(this,e)},r.abort=function(){n.abort();for(var e=0;e<u.length;++e){var t=u[e];t&&(this._debug("Aborting request",t),this.abortXHR(t.xhr)||this.transportFailure(t.envelope,t,{reason:"abort"}))}var r=i;r&&(this._debug("Aborting /meta/connect request",r),this.abortXHR(r.xhr)||this.transportFailure(r.envelope,r,{reason:"abort"})),this.reset(!0)},r.reset=function(e){n.reset(e),i=null,u=[],s=[]},r.abortXHR=function(e){if(e)try{var t=e.readyState;return e.abort(),t!==window.XMLHttpRequest.UNSENT}catch(e){this._debug(e)}return!1},r.xhrStatus=function(e){if(e)try{return e.status}catch(e){this._debug(e)}return-1},r},r=function(){var e=new n,r=t.derive(e),o=!0;return r.accept=function(e,t,n){return o||!t},r.newXMLHttpRequest=function(){return new window.XMLHttpRequest},r.xhrSend=function(e){var t=r.newXMLHttpRequest();!function(e){try{e.context=r.context}catch(e){r._debug("Could not copy transport context into XHR",e)}}(t),t.withCredentials=!0,t.open("POST",e.url,!0!==e.sync);var n=e.headers;if(n)for(var o in n)n.hasOwnProperty(o)&&t.setRequestHeader(o,n[o]);return t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.onload=function(){200===t.status?e.onSuccess(t.responseText):e.onError(t.statusText)},t.onabort=t.onerror=function(){e.onError(t.statusText)},t.send(e.body),t},r.transportSend=function(e,t){this._debug("Transport",this.getType(),"sending request",t.id,"envelope",e);var n=this;try{var r=!0;return t.xhr=this.xhrSend({transport:this,url:e.url,sync:e.sync,headers:this.getConfiguration().requestHeaders,body:this.convertToJSON(e.messages),onSuccess:function(r){n._debug("Transport",n.getType(),"received response",r);var i=!1;try{var u=n.convertToMessages(r);0===u.length?(o=!1,n.transportFailure(e,t,{httpCode:204})):(i=!0,n.transportSuccess(e,t,u))}catch(r){if(n._debug(r),!i){o=!1;var s={exception:r};s.httpCode=n.xhrStatus(t.xhr),n.transportFailure(e,t,s)}}},onError:function(i,u){n._debug("Transport",n.getType(),"received error",i,u),o=!1;var s={reason:i,exception:u};s.httpCode=n.xhrStatus(t.xhr),r?n.setTimeout((function(){n.transportFailure(e,t,s)}),0):n.transportFailure(e,t,s)}}),r=!1,!0}catch(r){return this._debug("Transport",this.getType(),"exception:",r),o=!1,this.setTimeout((function(){n.transportFailure(e,t,{exception:r})}),0),!1}},r.reset=function(t){e.reset(t),o=!0},r},o=function(){var e=new n,r=t.derive(e),o=0;function i(e,t,n){var r=this;return function(){r.transportFailure(e,t,"error",n)}}return r.accept=function(e,t,n){return!0},r.jsonpSend=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("script"),r="_cometd_jsonp_"+o++;window[r]=function(o){t.removeChild(n),delete window[r],e.onSuccess(o)};var i=e.url;i+=i.indexOf("?")<0?"?":"&",i+="jsonp="+r,i+="&message="+encodeURIComponent(e.body),n.src=i,n.async=!0!==e.sync,n.type="application/javascript",n.onerror=function(t){e.onError("jsonp "+t.type)},t.appendChild(n)},r.transportSend=function(e,t){for(var n=this,r=0,o=e.messages.length,u=[];o>0;){var s=JSON.stringify(e.messages.slice(r,r+o)),a=e.url.length+encodeURI(s).length,c=this.getConfiguration().maxURILength;if(a>c){if(1===o){var f="Bayeux message too big ("+a+" bytes, max is "+c+") for transport "+this.getType();return void this.setTimeout(i.call(this,e,t,f),0)}--o}else u.push(o),r+=o,o=e.messages.length-r}var l=e;if(u.length>1){var d=0,p=u[0];this._debug("Transport",this.getType(),"split",e.messages.length,"messages into",u.join(" + ")),(l=this._mixin(!1,{},e)).messages=e.messages.slice(d,p),l.onSuccess=e.onSuccess,l.onFailure=e.onFailure;for(var h=1;h<u.length;++h){var v=this._mixin(!1,{},e);d=p,p+=u[h],v.messages=e.messages.slice(d,p),v.onSuccess=e.onSuccess,v.onFailure=e.onFailure,this.send(v,t.metaConnect)}}this._debug("Transport",this.getType(),"sending request",t.id,"envelope",l);try{var g=!0;return this.jsonpSend({transport:this,url:l.url,sync:l.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(l.messages),onSuccess:function(e){var r=!1;try{var o=n.convertToMessages(e);0===o.length?n.transportFailure(l,t,{httpCode:204}):(r=!0,n.transportSuccess(l,t,o))}catch(e){n._debug(e),r||n.transportFailure(l,t,{exception:e})}},onError:function(e,r){var o={reason:e,exception:r};g?n.setTimeout((function(){n.transportFailure(l,t,o)}),0):n.transportFailure(l,t,o)}}),g=!1,!0}catch(e){return this.setTimeout((function(){n.transportFailure(l,t,{exception:e})}),0),!1}},r},i=function(){var n,r=new t,o=t.derive(r),i=!0,u=!1,s=!0,a=null,c=null,f=!1,l=null;function d(e,t){e&&(this.webSocketClose(e,t.code,t.reason),this.onClose(e,t))}function p(e){return e===c||e===a}function h(e,t,n){for(var r=[],o=0;o<t.messages.length;++o){var i=t.messages[o];i.id&&r.push(i.id)}e.envelopes[r.join(",")]=[t,n],this._debug("Transport",this.getType(),"stored envelope, envelopes",e.envelopes)}function v(t,n){for(var r=!1,o=t.envelopes,i=0;i<n.length;++i){var u=n[i];for(var s in o)if(o.hasOwnProperty(s)){var a=s.split(","),c=e.inArray(u,a);if(c>=0){r=!0,a.splice(c,1);var f=o[s][0],l=o[s][1];delete o[s],a.length>0&&(o[a.join(",")]=[f,l]);break}}}r&&this._debug("Transport",this.getType(),"removed envelope, envelopes",o)}function g(e,t,n){var r=this._notifyTransportTimeout([t]);if(r>0){this._debug("Transport",this.getType(),"extended waiting for message replies:",r,"ms");var o=this;e.timeouts[t.id]=this.setTimeout((function(){g.call(o,e,t,n+r)}),r)}else this._debug("Transport",this.getType(),"expired waiting for message reply",t.id,":",n,"ms"),d.call(this,e,{code:1e3,reason:"Message Timeout"})}function b(e,t,n){var r=this;try{var o=this.convertToJSON(t.messages)}catch(n){this._debug("Transport",this.getType(),"exception:",n);for(var i=[],u=0;u<t.messages.length;++u){var s=t.messages[u];i.push(s.id)}return v.call(this,e,i),void this.setTimeout((function(){r._notifyFailure(t.onFailure,e,t.messages,{exception:n})}),0)}e.webSocket.send(o),this._debug("Transport",this.getType(),"sent",t,"/meta/connect =",n);var a=this.getConfiguration().maxNetworkDelay;n&&(a+=this.getAdvice().timeout,f=!0);for(var c=[],l=0;l<t.messages.length;++l)!function(){var n=t.messages[l];n.id&&(c.push(n.id),e.timeouts[n.id]=r.setTimeout((function(){g.call(r,e,n,a)}),a))}();this._debug("Transport",this.getType(),"started waiting for message replies",a,"ms, messageIds:",c,", timeouts:",e.timeouts)}function m(e,t,r){try{null===e?(e=c||{envelopes:{},timeouts:{}},h.call(this,e,t,r),function(e){if(!c){var t=n.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",t);try{var r=n.getConfiguration().protocol;e.webSocket=r?new window.WebSocket(t,r):new window.WebSocket(t),c=e}catch(e){throw i=!1,this._debug("Exception while creating WebSocket object",e),e}s=!1!==n.getConfiguration().stickyReconnect;var o=this,f=n.getConfiguration().connectTimeout;f>0&&(e.connectTimer=this.setTimeout((function(){n._debug("Transport",o.getType(),"timed out while connecting to URL",t,":",f,"ms"),d.call(o,e,{code:1e3,reason:"Connect Timeout"})}),f));var l=function(t){t=t||{code:1e3},n._debug("WebSocket onclose",e,t,"connecting",c,"current",a),e.connectTimer&&o.clearTimeout(e.connectTimer),o.onClose(e,t)};e.webSocket.onopen=function(){n._debug("WebSocket onopen",e),e.connectTimer&&o.clearTimeout(e.connectTimer),p(e)?(c=null,a=e,u=!0,o.onOpen(e)):(n._warn("Closing extra WebSocket connection",this,"active connection",a),d.call(o,e,{code:1e3,reason:"Extra Connection"}))},e.webSocket.onclose=l,e.webSocket.onerror=function(){l({code:1e3,reason:"Error"})},e.webSocket.onmessage=function(t){n._debug("WebSocket onmessage",t,e),o.onMessage(e,t)},this._debug("Transport",this.getType(),"configured callbacks on",e)}}.call(this,e)):(h.call(this,e,t,r),b.call(this,e,t,r))}catch(t){var o=this;this.setTimeout((function(){d.call(o,e,{code:1e3,reason:"Exception",exception:t})}),0)}}return o.reset=function(e){r.reset(e),i=!0,e&&(u=!1),s=!0,e&&(a=null),c=null,f=!1},o._notifySuccess=function(e,t){e.call(this,t)},o._notifyFailure=function(e,t,n,r){e.call(this,t,n,r)},o.onOpen=function(e){var t=e.envelopes;for(var n in this._debug("Transport",this.getType(),"opened",e,"pending messages",t),t)if(t.hasOwnProperty(n)){var r=t[n],o=r[0],i=r[1];l=o.onSuccess,b.call(this,e,o,i)}},o.onMessage=function(e,t){this._debug("Transport",this.getType(),"received websocket message",t,e);for(var n=!1,r=this.convertToMessages(t.data),o=[],i=0;i<r.length;++i){var u=r[i];if((/^\/meta\//.test(u.channel)||void 0===u.data)&&u.id){o.push(u.id);var s=e.timeouts[u.id];s&&(this.clearTimeout(s),delete e.timeouts[u.id],this._debug("Transport",this.getType(),"removed timeout for message",u.id,", timeouts",e.timeouts))}"/meta/connect"===u.channel&&(f=!1),"/meta/disconnect"!==u.channel||f||(n=!0)}v.call(this,e,o),this._notifySuccess(l,r),n&&this.webSocketClose(e,1e3,"Disconnect")},o.onClose=function(e,t){this._debug("Transport",this.getType(),"closed",e,t),p(e)&&(i=s&&u,c=null,a=null);var n=e.timeouts;for(var r in e.timeouts={},n)n.hasOwnProperty(r)&&this.clearTimeout(n[r]);var o=e.envelopes;for(var l in e.envelopes={},o)if(o.hasOwnProperty(l)){var d=o[l][0];o[l][1]&&(f=!1);var h={websocketCode:t.code,reason:t.reason};t.exception&&(h.exception=t.exception),this._notifyFailure(d.onFailure,e,d.messages,h)}},o.registered=function(e,t){r.registered(e,t),n=t},o.accept=function(e,t,r){return this._debug("Transport",this.getType(),"accept, supported:",i),i&&!!window.WebSocket&&!1!==n.websocketEnabled},o.send=function(e,t){this._debug("Transport",this.getType(),"sending",e,"/meta/connect =",t),m.call(this,a,e,t)},o.webSocketClose=function(e,t,n){try{e.webSocket&&e.webSocket.close(t,n)}catch(e){this._debug(e)}},o.abort=function(){r.abort(),d.call(this,a,{code:1e3,reason:"Abort"}),this.reset(!0)},o},u=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",".","-",":","+","=","^","!","/","*","?","&","<",">","(",")","[","]","{","}","@","%","$","#"],s=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0];return{CometD:function(t){var n,u,s,a,c,f=new function(){var e=0,t={};this.register=function(n){var r=++e;return t[r]=n,r},this.unregister=function(e){var n=t[e];return delete t[e],n},this.setTimeout=function(e,t){return window.setTimeout(e,t)},this.clearTimeout=function(e){window.clearTimeout(e)}},l=this,d=t||"default",p=!1,h=new function(){var e=[],t={};this.getTransportTypes=function(){return e.slice(0)},this.findTransportTypes=function(n,r,o){for(var i=[],u=0;u<e.length;++u){var s=e[u];!0===t[s].accept(n,r,o)&&i.push(s)}return i},this.negotiateTransport=function(n,r,o,i){for(var u=0;u<e.length;++u)for(var s=e[u],a=0;a<n.length;++a)if(s===n[a]){var c=t[s];if(!0===c.accept(r,o,i))return c}return null},this.add=function(n,r,o){for(var i=!1,u=0;u<e.length;++u)if(e[u]===n){i=!0;break}return i||("number"!=typeof o?e.push(n):e.splice(o,0,n),t[n]=r),!i},this.find=function(n){for(var r=0;r<e.length;++r)if(e[r]===n)return t[n];return null},this.remove=function(n){for(var r=0;r<e.length;++r)if(e[r]===n){e.splice(r,1);var o=t[n];return delete t[n],o}return null},this.clear=function(){e=[],t={}},this.reset=function(n){for(var r=0;r<e.length;++r)t[e[r]].reset(n)}},v="disconnected",g=0,b=null,m=0,y=[],_=!1,x=0,w={},S={},T=0,O=null,E=[],C={},j={},A={},N=!1,I=!1,M=0,k=0,L=null,R={useWorkerScheduler:!0,protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,urls:{},maxURILength:2e3,maxSendBayeuxMessageSize:8192,advice:{timeout:6e4,interval:0,reconnect:void 0,maxInterval:0}};function P(e,t){try{return e[t]}catch(e){return}}function D(t){return e.isString(t)}function F(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function U(e){return e>="0"&&e<="9"}function q(e){switch(e){case" ":case"!":case"#":case"$":case"(":case")":case"*":case"+":case"-":case".":case"/":case"@":case"_":case"{":case"~":case"}":return!0;default:return!1}}function B(e){if(!D(e))return!1;if(e.length<2)return!1;if("/"!==e.charAt(0))return!1;for(var t=1;t<e.length;++t){var n=e.charAt(t);if(!(F(n)||U(n)||q(n)))return!1}return!0}function H(e){return null!=e&&"function"==typeof e}function G(e,t){for(var n="";--t>0&&!(e>=Math.pow(10,t));)n+="0";return n+e}function W(e,t){if(window.console){var n=window.console[e];if(H(n)){var r=new Date;[].splice.call(t,0,0,G(r.getHours(),2)+":"+G(r.getMinutes(),2)+":"+G(r.getSeconds(),2)+"."+G(r.getMilliseconds(),3)),n.apply(window.console,t)}}}function z(e){return new RegExp("(^https?://)?(((\\[[^\\]]+])|([^:/?#]+))(:(\\d+))?)?([^?#]*)(.*)?").exec(e)}function V(e){l._debug("Configuring cometd object with",e),D(e)&&(e={url:e}),e||(e={}),R=l._mixin(!1,R,e);var t=l.getURL();if(!t)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var n=z(t),r=n[2],o=n[8],i=n[9];if(p=l._isCrossDomain(r),R.appendMessageTypeToURL)if(void 0!==i&&i.length>0)l._info("Appending message type to URI "+o+i+" is not supported, disabling 'appendMessageTypeToURL' configuration"),R.appendMessageTypeToURL=!1;else{var u=o.split("/"),s=u.length-1;o.match(/\/$/)&&(s-=1),u[s].indexOf(".")>=0&&(l._info("Appending message type to URI "+o+" is not supported, disabling 'appendMessageTypeToURL' configuration"),R.appendMessageTypeToURL=!1)}if(window.Worker&&window.Blob&&window.URL&&R.useWorkerScheduler){var a=function(){var e={};self.onmessage=function(t){var n=t.data,r=e[n.id];switch(n.type){case"setTimeout":e[n.id]=self.setTimeout((function(){delete e[n.id],self.postMessage({id:n.id})}),n.delay);break;case"clearTimeout":delete e[n.id],r&&self.clearTimeout(r);break;default:throw"Unknown command "+n.type}}}.toString();a=a.substring(a.indexOf("{")+1,a.lastIndexOf("}"));var c=new window.Blob([a],{type:"application/json"}),d=window.URL.createObjectURL(c),h=new window.Worker(d);f.setTimeout=function(e,t){var n=f.register(e);return h.postMessage({id:n,type:"setTimeout",delay:t}),n},f.clearTimeout=function(e){f.unregister(e),h.postMessage({id:e,type:"clearTimeout"})},h.onmessage=function(e){var t=e.data.id,n=f.unregister(t);n&&n()}}}function $(e){if(e){var t=w[e.channel];t&&t[e.id]&&(delete t[e.id],l._debug("Removed",e.listener?"listener":"subscription",e))}}function Q(e){e&&!e.listener&&$(e)}function X(){for(var e in w)if(w.hasOwnProperty(e)){var t=w[e];if(t)for(var n in t)t.hasOwnProperty(n)&&Q(t[n])}}function Y(e){v!==e&&(l._debug("Status",v,"->",e),v=e)}function K(){return"disconnecting"===v||"disconnected"===v}function J(){return""+ ++g}function Z(e,t,n,r,o){try{return t.call(e,r)}catch(e){var i=l.onExtensionException;if(H(i)){l._debug("Invoking extension exception handler",n,e);try{i.call(l,e,n,o,r)}catch(e){l._info("Exception during execution of extension exception handler",n,e)}}else l._info("Exception during execution of extension",n,e);return r}}function ee(e){for(var t=E.length-1;t>=0&&null!=e;--t){var n=E[t],r=n.extension.outgoing;if(H(r)){var o=Z(n.extension,r,n.name,e,!0);e=void 0===o?e:o}}return e}function te(e,t){var n=w[e];if(n)for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];if(o)try{o.callback.call(o.scope,t)}catch(e){var i=l.onListenerException;if(H(i)){l._debug("Invoking listener exception handler",o,e);try{i.call(l,e,o,o.listener,t)}catch(e){l._info("Exception during execution of listener exception handler",o,e)}}else l._info("Exception during execution of listener",o,t,e)}}}function ne(e,t){te(e,t);for(var n=e.split("/"),r=n.length-1,o=r;o>0;--o){var i=n.slice(0,o).join("/")+"/*";o===r&&te(i,t),te(i+="*",t)}}function re(){null!==O&&l.clearTimeout(O),O=null}function oe(e,t){re();var n=C.interval+t;l._debug("Function scheduled in",n,"ms, interval =",C.interval,"backoff =",T,e),O=l.setTimeout(e,n)}function ie(e,t,r){for(var o=0;o<e.length;++o){var i=e[o],u=i.id;b&&(i.clientId=b),void 0!==(i=ee(i))&&null!==i?(i.id=u,e[o]=i):(delete j[u],e.splice(o--,1))}if(0!==e.length){t&&(L=e[0]);var s=l.getURL();R.appendMessageTypeToURL&&(s.match(/\/$/)||(s+="/"),r&&(s+=r));var f={url:s,sync:!1,messages:e,onSuccess:function(e){try{a.call(l,e)}catch(e){l._info("Exception during handling of messages",e)}},onFailure:function(e,t,n){try{var r=l.getTransport();n.connectionType=r?r.getType():"unknown",c.call(l,e,t,n)}catch(e){l._info("Exception during handling of failure",e)}}};l._debug("Send",f),n.send(f,t)}}function ue(e){m>0||!0===_?y.push(e):ie([e],!1)}function se(){T=0}function ae(){var e=y;y=[],e.length>0&&ie(e,!1)}function ce(e){Y("connecting"),oe((function(){!function(){if(!K()){var e={id:J(),channel:"/meta/connect",connectionType:n.getType()};I||(e.advice={timeout:0}),Y("connecting"),l._debug("Connect sent",e),ie([e],!0,"connect"),Y("connected")}}()}),e)}function fe(e){e&&(C=l._mixin(!1,{},R.advice,e),l._debug("New advice",C))}function le(e){if(re(),e&&n&&n.abort(),p=!1,n=null,Y("disconnected"),b=null,m=0,se(),N=!1,I=!1,M=0,L=null,y.length>0){var t=y;y=[],c.call(l,void 0,t,{reason:"Disconnected"})}}function de(e,t,n){var r=l.onTransportException;if(H(r)){l._debug("Invoking transport exception handler",e,t,n);try{r.call(l,n,e,t)}catch(e){l._info("Exception during execution of transport exception handler",e)}}}function pe(e,t){H(e)&&(t=e,e=void 0),b=null,X(),K()&&h.reset(!0),fe({}),m=0,_=!0,u=e,s=t;var r=l.getURL(),o=h.findTransportTypes("1.0",p,r),i={id:J(),version:"1.0",minimumVersion:"1.0",channel:"/meta/handshake",supportedConnectionTypes:o,advice:{timeout:C.timeout,interval:C.interval}},a=l._mixin(!1,{},u,i);if(l._putCallback(a.id,t),!n&&!(n=h.negotiateTransport(o,"1.0",p,r))){var c="Could not find initial transport among: "+h.getTransportTypes();throw l._warn(c),c}l._debug("Initial transport is",n.getType()),Y("handshaking"),l._debug("Handshake sent",a),ie([a],!1,"handshake")}function he(e,t){try{e.call(l,t)}catch(e){var n=l.onCallbackException;if(H(n)){l._debug("Invoking callback exception handler",e);try{n.call(l,e,t)}catch(e){l._info("Exception during execution of callback exception handler",e)}}else l._info("Exception during execution of message callback",e)}}function ve(e){var t=l._getCallback([e.id]);H(t)&&(delete j[e.id],he(t,e))}function ge(e){var t=A[e.id];if(delete A[e.id],t){l._debug("Handling remote call response for",e,"with context",t);var n=t.timeout;n&&l.clearTimeout(n);var r=t.callback;if(H(r))return he(r,e),!0}return!1}function be(e){l._debug("Transport failure handling",e),e.transport&&(n=e.transport),e.url&&n.setURL(e.url);var t=e.action,r=e.delay||0;switch(t){case"handshake":!function(e){Y("handshaking"),_=!0,oe((function(){pe(u,s)}),e)}(r);break;case"retry":ce(r);break;case"none":le(!0);break;default:throw"Unknown action "+t}}function me(e,t){ve(e),ne("/meta/handshake",e),ne("/meta/unsuccessful",e),K()&&(t.action="none"),l.onTransportFailure.call(l,e,t,be)}function ye(e){me(e,{cause:"failure",action:"handshake",transport:null})}function _e(e){return"disconnected"===v||!(!L||L.id!==e.id)&&(L=null,!0)}function xe(e,t){ne("/meta/connect",e),ne("/meta/unsuccessful",e),K()&&(t.action="none"),l.onTransportFailure.call(l,e,t,be)}function we(e){_e(e)?(I=!1,xe(e,{cause:"failure",action:"retry",transport:null})):l._debug("Mismatched /meta/connect failure",e)}function Se(e){le(!0),ve(e),ne("/meta/disconnect",e),ne("/meta/unsuccessful",e)}function Te(e){Se(e)}function Oe(e){var t=w[e.subscription];if(t)for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];r&&!r.listener&&(delete t[n],l._debug("Removed failed subscription",r))}ve(e),ne("/meta/subscribe",e),ne("/meta/unsuccessful",e)}function Ee(e){Oe(e)}function Ce(e){ve(e),ne("/meta/unsubscribe",e),ne("/meta/unsuccessful",e)}function je(e){Ce(e)}function Ae(e){ge(e)||(ve(e),ne("/meta/publish",e),ne("/meta/unsuccessful",e))}function Ne(e){Ae(e)}function Ie(e){if(M=0,void 0!==(e=function(e){for(var t=0;t<E.length&&null!=e;++t){var n=E[t],r=n.extension.incoming;if(H(r)){var o=Z(n.extension,r,n.name,e,!1);e=void 0===o?e:o}}return e}(e))&&null!==e)switch(fe(e.advice),e.channel){case"/meta/handshake":!function(e){var t=l.getURL();if(e.successful){var r=l._isCrossDomain(z(t)[2]),o=h.negotiateTransport(e.supportedConnectionTypes,e.version,r,t);if(null===o)return e.successful=!1,void me(e,{cause:"negotiation",action:"none",transport:null});n!==o&&(l._debug("Transport",n.getType(),"->",o.getType()),n=o),b=e.clientId,_=!1,ae(),e.reestablish=N,N=!0,ve(e),ne("/meta/handshake",e),k=e["x-messages"]||0;var i=K()?"none":C.reconnect||"retry";switch(i){case"retry":se(),0===k?ce(0):l._debug("Processing",k,"handshake-delivered messages");break;case"none":le(!0);break;default:throw"Unrecognized advice action "+i}}else me(e,{cause:"unsuccessful",action:C.reconnect||"handshake",transport:n})}(e);break;case"/meta/connect":!function(e){if(_e(e))if(I=e.successful){ne("/meta/connect",e);var t=K()?"none":C.reconnect||"retry";switch(t){case"retry":se(),ce(T);break;case"none":le(!1);break;default:throw"Unrecognized advice action "+t}}else xe(e,{cause:"unsuccessful",action:C.reconnect||"retry",transport:n});else l._debug("Mismatched /meta/connect reply",e)}(e);break;case"/meta/disconnect":!function(e){e.successful?(le(!1),ve(e),ne("/meta/disconnect",e)):Se(e)}(e);break;case"/meta/subscribe":!function(e){e.successful?(ve(e),ne("/meta/subscribe",e)):Oe(e)}(e);break;case"/meta/unsubscribe":!function(e){e.successful?(ve(e),ne("/meta/unsubscribe",e)):Ce(e)}(e);break;default:!function(e){void 0!==e.data?ge(e)||(ne(e.channel,e),k>0&&0==--k&&(l._debug("Processed last handshake-delivered message"),ce(0))):void 0===e.successful?l._warn("Unknown Bayeux Message",e):e.successful?(ve(e),ne("/meta/publish",e)):Ae(e)}(e)}}function Me(e){var t=w[e];if(t)for(var n in t)if(t.hasOwnProperty(n)&&t[n])return!0;return!1}function ke(e,t){var n={scope:e,method:t};if(H(e))n.scope=void 0,n.method=e;else if(D(t)){if(!e)throw"Invalid scope "+e;if(n.method=e[t],!H(n.method))throw"Invalid callback "+t+" for scope "+e}else if(!H(t))throw"Invalid callback "+t;return n}function Le(e,t,n,r){var o=ke(t,n);l._debug("Adding",r?"listener":"subscription","on",e,"with scope",o.scope,"and callback",o.method);var i=++x,u={id:i,channel:e,scope:o.scope,callback:o.method,listener:r},s=w[e];return s||(s={},w[e]=s),s[i]=u,l._debug("Added",r?"listener":"subscription",u),u}this._mixin=function(e,t,n){for(var r=t||{},o=2;o<arguments.length;++o){var i=arguments[o];if(null!=i)for(var u in i)if(i.hasOwnProperty(u)){var s=P(i,u),a=P(r,u);if(s===t)continue;if(void 0===s)continue;if(e&&"object"==typeof s&&null!==s)if(s instanceof Array)r[u]=this._mixin(e,a instanceof Array?a:[],s);else{var c="object"!=typeof a||a instanceof Array?{}:a;r[u]=this._mixin(e,c,s)}else r[u]=s}}return r},this._warn=function(){W("warn",arguments)},this._info=function(){"warn"!==R.logLevel&&W("info",arguments)},this._debug=function(){"debug"===R.logLevel&&W("debug",arguments)},this._isCrossDomain=function(e){return!!(window.location&&window.location.host&&e)&&e!==window.location.host},this.send=ue,this._getCallback=function(e){return j[e]},this._putCallback=function(e,t){var n=this._getCallback(e);return H(t)&&(j[e]=t),n},this.onTransportFailure=function(e,t,r){this._debug("Transport failure",t,"for",e);var o=this.getTransportRegistry(),i=this.getURL(),u=this._isCrossDomain(z(i)[2]),s=o.findTransportTypes("1.0",u,i);if("none"===t.action){if("/meta/handshake"===e.channel&&!t.transport){var a="Could not negotiate transport, client=["+s+"], server=["+e.supportedConnectionTypes+"]";this._warn(a),de(n.getType(),null,{reason:a,connectionType:n.getType(),transport:n})}}else if(t.delay=this.getBackoffPeriod(),"/meta/handshake"===e.channel){if(!t.transport){var c=n?n.getType():null,f=o.negotiateTransport(s,"1.0",u,i);if(f){var d=f.getType();this._debug("Transport",c,"->",d),de(c,d,e.failure),t.action="handshake",t.transport=f}else this._warn("Could not negotiate transport, client=["+s+"]"),de(c,null,e.failure),t.action="none"}"none"!==t.action&&this.increaseBackoffPeriod()}else{var p=(new Date).getTime();if(0===M&&(M=p),"retry"===t.action){t.delay=this.increaseBackoffPeriod();var h=C.maxInterval;if(h>0){var v=C.timeout+C.interval+h;p-M+T>v&&(t.action="handshake")}}"handshake"===t.action&&(t.delay=0,o.reset(!1),this.resetBackoffPeriod())}r.call(l,t)},this.receive=Ie,a=function(e){l._debug("Received",e);for(var t=0;t<e.length;++t){Ie(e[t])}},c=function(e,t,n){l._debug("handleFailure",e,t,n),n.transport=e;for(var r=0;r<t.length;++r){var o=t[r],i={id:o.id,successful:!1,channel:o.channel,failure:n};switch(n.message=o,o.channel){case"/meta/handshake":ye(i);break;case"/meta/connect":we(i);break;case"/meta/disconnect":Te(i);break;case"/meta/subscribe":i.subscription=o.subscription,Ee(i);break;case"/meta/unsubscribe":i.subscription=o.subscription,je(i);break;default:Ne(i)}}},this.registerTransport=function(e,t,n){var r=h.add(e,t,n);return r&&(this._debug("Registered transport",e),H(t.registered)&&t.registered(e,this)),r},this.unregisterTransport=function(e){var t=h.remove(e);return null!==t&&(this._debug("Unregistered transport",e),H(t.unregistered)&&t.unregistered()),t},this.unregisterTransports=function(){h.clear()},this.getTransportTypes=function(){return h.getTransportTypes()},this.findTransport=function(e){return h.find(e)},this.getTransportRegistry=function(){return h},this.configure=function(e){V.call(this,e)},this.init=function(e,t){this.configure(e),this.handshake(t)},this.handshake=function(e,t){if("disconnected"!==v)throw"Illegal state: handshaken";pe(e,t)},this.disconnect=function(e,t){if(!K()){H(e)&&(t=e,e=void 0);var n={id:J(),channel:"/meta/disconnect"},r=this._mixin(!1,{},e,n);l._putCallback(r.id,t),Y("disconnecting"),ie([r],!1,"disconnect")}},this.startBatch=function(){++m,l._debug("Starting batch, depth",m)},this.endBatch=function(){!function(){if(--m,l._debug("Ending batch, depth",m),m<0)throw"Calls to startBatch() and endBatch() are not paired";0!==m||K()||_||ae()}()},this.batch=function(e,t){var n=ke(e,t);this.startBatch();try{n.method.call(n.scope),this.endBatch()}catch(e){throw this._info("Exception during execution of batch",e),this.endBatch(),e}},this.addTransportListener=function(e,t){if("timeout"!==e)throw"Unsupported event "+e;var n=S[e];n||(S[e]=n=[]),n.push(t)},this.removeTransportListener=function(e,t){var n=S[e];if(n){var r=n.indexOf(t);if(r>=0)return n.splice(r,1),!0}return!1},this._getTransportListeners=function(e){return S[e]},this.addListener=function(e,t,n){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!D(e))throw"Illegal argument type: channel must be a string";return Le(e,t,n,!0)},this.removeListener=function(e){if(!(e&&e.channel&&"id"in e))throw"Invalid argument: expected subscription, not "+e;$(e)},this.clearListeners=function(){w={}},this.subscribe=function(e,t,n,r,o){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!B(e))throw"Illegal argument: invalid channel "+e;if(K())throw"Illegal state: disconnected";H(t)&&(o=r,r=n,n=t,t=void 0),H(r)&&(o=r,r=void 0);var i=!Me(e),u=Le(e,t,n,!1);if(i){var s={id:J(),channel:"/meta/subscribe",subscription:e},a=this._mixin(!1,{},r,s);l._putCallback(a.id,o),ue(a)}else H(o)&&l.setTimeout((function(){he(o,{id:J(),successful:!0,channel:"/meta/subscribe",subscription:e})}),0);return u},this.unsubscribe=function(e,t,n){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(K())throw"Illegal state: disconnected";H(t)&&(n=t,t=void 0),this.removeListener(e);var r=e.channel;if(Me(r))H(n)&&l.setTimeout((function(){he(n,{id:J(),successful:!0,channel:"/meta/unsubscribe",subscription:r})}),0);else{var o={id:J(),channel:"/meta/unsubscribe",subscription:r},i=this._mixin(!1,{},t,o);l._putCallback(i.id,n),ue(i)}},this.resubscribe=function(e,t){if(Q(e),e)return this.subscribe(e.channel,e.scope,e.callback,t)},this.clearSubscriptions=function(){X()},this.publish=function(e,t,n,r){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!B(e))throw"Illegal argument: invalid channel "+e;if(/^\/meta\//.test(e))throw"Illegal argument: cannot publish to meta channels";if(K())throw"Illegal state: disconnected";H(t)?(r=t,t={},n=void 0):H(n)&&(r=n,n=void 0);var o={id:J(),channel:e,data:t},i=this._mixin(!1,{},n,o);l._putCallback(i.id,r),ue(i)},this.publishBinary=function(e,t,n,r,o,i){H(t)?(i=t,t=new ArrayBuffer(0),n=!0,r=void 0,o=void 0):H(n)?(i=n,n=!0,r=void 0,o=void 0):H(r)?(i=r,r=void 0,o=void 0):H(o)&&(i=o,o=void 0);var u={meta:r,data:t,last:n},s=this._mixin(!1,o,{ext:{binary:{}}});this.publish(e,u,s,i)},this.remoteCall=function(e,t,n,r,o){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!D(e))throw"Illegal argument type: target must be a string";if(K())throw"Illegal state: disconnected";if(H(t)?(o=t,t={},n=R.maxNetworkDelay,r=void 0):H(n)?(o=n,n=R.maxNetworkDelay,r=void 0):H(r)&&(o=r,r=void 0),"number"!=typeof n)throw"Illegal argument type: timeout must be a number";e.match(/^\//)||(e="/"+e);var i="/service"+e;if(!B(i))throw"Illegal argument: invalid target "+e;var u={id:J(),channel:i,data:t},s=this._mixin(!1,{},r,u),a={callback:o};n>0&&(a.timeout=l.setTimeout((function(){l._debug("Timing out remote call",s,"after",n,"ms"),Ae({id:s.id,error:"406::timeout",successful:!1,failure:{message:s,reason:"Remote Call Timeout"}})}),n),l._debug("Scheduled remote call timeout",s,"in",n,"ms")),A[s.id]=a,ue(s)},this.remoteCallBinary=function(e,t,n,r,o,i,u){H(t)?(u=t,t=new ArrayBuffer(0),n=!0,r=void 0,o=R.maxNetworkDelay,i=void 0):H(n)?(u=n,n=!0,r=void 0,o=R.maxNetworkDelay,i=void 0):H(r)?(u=r,r=void 0,o=R.maxNetworkDelay,i=void 0):H(o)?(u=o,o=R.maxNetworkDelay,i=void 0):H(i)&&(u=i,i=void 0);var s={meta:r,data:t,last:n},a=this._mixin(!1,i,{ext:{binary:{}}});this.remoteCall(e,s,o,a,u)},this.getStatus=function(){return v},this.isDisconnected=K,this.setBackoffIncrement=function(e){R.backoffIncrement=e},this.getBackoffIncrement=function(){return R.backoffIncrement},this.getBackoffPeriod=function(){return T},this.increaseBackoffPeriod=function(){return T<R.maxBackoff&&(T+=R.backoffIncrement),T},this.resetBackoffPeriod=function(){se()},this.setLogLevel=function(e){R.logLevel=e},this.registerExtension=function(e,t){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!D(e))throw"Illegal argument type: extension name must be a string";for(var n=!1,r=0;r<E.length;++r){var o=E[r];if(o.name===e){n=!0;break}}return n?(this._info("Could not register extension with name",e,"since another extension with the same name already exists"),!1):(E.push({name:e,extension:t}),this._debug("Registered extension",e),H(t.registered)&&t.registered(e,this),!0)},this.unregisterExtension=function(e){if(!D(e))throw"Illegal argument type: extension name must be a string";for(var t=!1,n=0;n<E.length;++n){var r=E[n];if(r.name===e){E.splice(n,1),t=!0,this._debug("Unregistered extension",e);var o=r.extension;H(o.unregistered)&&o.unregistered();break}}return t},this.getExtension=function(e){for(var t=0;t<E.length;++t){var n=E[t];if(n.name===e)return n.extension}return null},this.getName=function(){return d},this.getClientId=function(){return b},this.getURL=function(){if(n){var e=n.getURL();if(e)return e;if(e=R.urls[n.getType()])return e}return R.url},this.getTransport=function(){return n},this.getConfiguration=function(){return this._mixin(!0,{},R)},this.getAdvice=function(){return this._mixin(!0,{},C)},this.setTimeout=function(e,t){return f.setTimeout((function(){try{l._debug("Invoking timed function",e),e()}catch(t){l._debug("Exception invoking timed function",e,t)}}),t)},this.clearTimeout=function(e){f.clearTimeout(e)},window.WebSocket&&this.registerTransport("websocket",new i),this.registerTransport("long-polling",new r),this.registerTransport("callback-polling",new o)},Transport:t,RequestTransport:n,LongPollingTransport:r,CallbackPollingTransport:o,WebSocketTransport:i,Utils:e,Z85:{encode:function(e){var t=null;if(e instanceof ArrayBuffer?t=e:e.buffer instanceof ArrayBuffer?t=e.buffer:Array.isArray(e)&&(t=new Uint8Array(e).buffer),null==t)throw"Cannot Z85 encode "+e;for(var n=t.byteLength,r=n%4,o=4-(0===r?4:r),i=new DataView(t),s="",a=0,c=0;c<n+o;++c){var f=c>=n;if(a=256*a+(f?0:i.getUint8(c)),(c+1)%4==0){for(var l=52200625,d=5;d>0;--d){if(!f||d>o){var p=Math.floor(a/l)%85;s+=u[p]}l/=85}a=0}}return s},decode:function(e){for(var t=e.length%5,n=5-(0===t?5:t),r=0;r<n;++r)e+=u[u.length-1];for(var o=e.length,i=new ArrayBuffer(4*o/5-n),a=new DataView(i),c=0,f=0,l=0,d=0;d<o;++d){var p=e.charCodeAt(f++)-32;if(c=85*c+s[p],f%5==0){for(var h=16777216;h>=1;)l<a.byteLength&&a.setUint8(l++,Math.floor(c/h)%256),h/=256;c=0}}return i}}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2));t.default=function(){var e=new r.default("amb.GraphQLSubscriptionExtension"),t={};this.isGraphQLChannel=function(e){return e&&e.startsWith("/rw/graphql")},this.addGraphQLChannel=function(e,n){t[e]=n},this.removeGraphQLChannel=function(e){delete t[e]},this.getGraphQLSubscriptions=function(){return t},this.outgoing=function(n){return"/meta/subscribe"===n.channel&&this.isGraphQLChannel(n.subscription)&&(n.ext||(n.ext={}),t[n.subscription]&&(e.debug("Subscribing with GraphQL subscription:"+t[n.subscription]),n.ext.serializedGraphQLSubscription=t[n.subscription])),n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2));t.default=function(){var e=new r.default("amb.SessionExtension"),t=!1;this.extendSession=function(){t=!0},this.outgoing=function(n){return"/meta/connect"===n.channel&&t&&(n.ext||(n.ext={}),e.debug("extendSession"),n.ext.extendSession=!0,t=!1),n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(2)),o=i(n(12));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=new r.default("amb.TokenManagementExtension"),t=o.default.subscribeCommandsFlow.maxInflight,n=[];function i(e){return"/meta/subscribe"==e.channel||"/meta/unsubscribe"==e.channel}function u(){e.debug("notifyOnAvailabilityOfToken - current tokenCount: "+t);try{n.forEach((function(e){e()}))}catch(t){e.addErrorMessage("notifyOnAvailabilityOfToken - failed to call tokenEventListeners. Error Details : "+t)}}this.updateTokenCount=function(e){t=e},this.refillTokens=function(){t=o.default.subscribeCommandsFlow.maxInflight,u(),e.debug("refillTokens -- tokenCount : "+t)},this.outgoing=function(e){return function(e){return"/meta/handshake"===e.channel}(e)&&(e.ext||(e.ext={}),e.ext.supportsSubscribeCommandFlow=!0),o.default.subscribeCommandsFlow.enable?(i(e)&&t>0&&t--,e):e},this.incoming=function(e){return o.default.subscribeCommandsFlow.enable?(i(e)?(t<o.default.subscribeCommandsFlow.maxInflight&&t++,u()):function(e){if(!e.ext)return!1;var t=e.ext.received_by_glide;return!!t&&t&&i(t)}(e)&&(e=null),e):e},this.getTokenCount=function(){return t},this.addTokenAvailabilityListener=function(t){t&&(e.debug("addTokenAvailabilityListener - tokenEventListener : "+t),n.push(t))},this.removeTokenAvailabilityListener=function(t){if(t){e.debug("removeTokenAvailabilityListener - tokenEventListener : "+t);var r=n.findIndex((function(e){return t===e}));-1!==r&&(e.debug("removeTokenAvailabilityListener - removing listener at index : "+r),n.splice(r,1))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(57),i=["callback"];t.default=function(){var e=new r.default("amb.CancelTransactionSender"),t={},n=new Map,u=null,s=!1;function a(e,t){var n={};return n.request=e,n.request.action=o.CANCEL_TRANSACTION_ACTION,n.response=t,n}function c(e,t){n.has(e)&&(n.get(e)(t),n.delete(e))}function f(t){var n;t?t.data&&t.ext&&t.ext.status?t.ext.status!==o.REQUEST_ACCEPTED?t.ext.status!==o.REQUEST_SUCCESS||(null===(n=t.ext.result)||void 0===n?void 0:n.length)===t.data.length?t.data.forEach((function(e,n){if(e.hasOwnProperty("nowUiInteraction")){var r=a(e,t.ext.status===o.REQUEST_SUCCESS?t.ext.result[n]:t.ext);c(e.nowUiInteraction,r)}})):e.addWarnMessage("Invalid response for cancel request"):e.debug("Batch Cancel Request accepted"):e.addWarnMessage("Invalid response for cancel request"):e.addWarnMessage("Empty response for cancel request")}return t.cancelTransaction=function(t,r){if(e.debug("cancelTransaction"),s||function(e){(u=e.getChannel(o.CANCEL_TRANSACTION_CHANNEL)).subscribe(f),s=!0}(r),t&&0!==t.length){var l=[];if(t.forEach((function(t){var r=function(t){var r={isValid:!0,error:null};return t?t.hasOwnProperty("nowUiInteraction")&&"string"==typeof t.nowUiInteraction?n.has(t.nowUiInteraction)?(e.debug("Transaction has already been submitted for cancellation. nowUiInteraction: "+t.nowUiInteraction),r.isValid=!1,r.error=o.TRANSACTION_ALREADY_SUBMITTED,r):r:(e.debug("nowUiInteraction is unavailable or invalid"),r.isValid=!1,r.error=o.MISSING_INTERACTION_ID,r):(e.debug("empty cancel request"),r.isValid=!1,r.error=o.MISSING_REQUEST_DATA,r)}(t);if(r.isValid){var u=t.nowUiInteraction,s=t.callback;l.push({nowUiInteraction:u}),s&&n.set(t.nowUiInteraction,s)}else!function(e,t){null!=e&&e.callback&&(0,e.callback)(a(function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,i),{successful:!1,status:t}))}(t,r.error)})),0!==l.length)for(var d=function(e){var t=l.slice(e,e+10);u.publish(t,(function(e){return function(e,t){if(!t.successful){var n={successful:!1,status:o.PUBLISH_FAILURE};e.forEach((function(e){c(e.nowUiInteraction,a(e,n))}))}}(t,e)}))},p=0;p<l.length;p+=10)d(p);else e.debug("All requests filtered due to invalid inputs")}else e.addWarnMessage("Request array is empty or not defined")},t}},function(e,t,n){e.exports=function(e){return function(){var t=e,n=t.lib.WordArray;t.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var u=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(u>>>6*(3-s)&63));var a=r.charAt(64);if(a)for(;o.length%4;)o.push(a);return o.join("")},parse:function(e){var t=e.length,r=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<r.length;i++)o[r.charCodeAt(i)]=i}var u=r.charAt(64);if(u){var s=e.indexOf(u);-1!==s&&(t=s)}return function(e,t,r){for(var o=[],i=0,u=0;u<t;u++)if(u%4){var s=r[e.charCodeAt(u-1)]<<u%4*2,a=r[e.charCodeAt(u)]>>>6-u%4*2;o[i>>>2]|=(s|a)<<24-i%4*8,i++}return n.create(o,i)}(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(n(172))},function(e,t,n){e.exports=function(e){return e.enc.Utf8}(n(172))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2)),o=n(57);function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(){var e,t,n=new r.default("amb.MessagesRedeliveryManager"),u=[],s=[],a=function(e){return e.ext.redelivery_message},c=function(e){return!0!==e.ext.redelivery_message.redelivery_not_authorized},f=function(e,t){return e.find((function(e){return function(e,t){return e.ext[o.MSG_SHARD]===t.ext[o.MSG_SHARD]&&e.ext[o.MSG_NUM]===t.ext[o.MSG_NUM]}(e,t)}))},l=function(e){return o.MSG_NUM+":"+e.ext[o.MSG_NUM]+","+o.MSG_SHARD+":"+e.ext[o.MSG_SHARD]};function d(){n.debug("Clearing all messages"),u=[],s=[]}return{resetState:function(){d(),e=!0,t=!1},containsMetaInfo:function(e){return e.ext&&e.ext[o.MSG_NUM]&&e.ext[o.MSG_SHARD]},shouldDeliver:function(r){return e?function(e){return e.ext.redelivery_notification&&!1===e.ext.redelivery_notification.can_redeliver}(r)?(n.debug("No messages to redeliver"),e=!1,!1):!!this.containsMetaInfo(r)&&(a(r)&&c(r)?(n.debug("Processing redelivered - "+l(r)),u.push(r)):a(r)&&!c(r)?n.debug("Not Processing unauthorized redelivery message - "+l(r)):(s.push(r),n.debug("Processing original - "+l(r))),function(e){return a(e)&&!0===e.ext.redelivery_message.is_last_redelivery}(r)&&(n.debug("Redelivery over"),e=!1,t=!0),!1):f(u,r)?(n.debug("Dropping duplicate: "+l(r)),!1):(n.debug("Out of redelivery. New message received: "+l(r)),d(),!0)},shouldDeliverPendingMessages:function(){return t},getAllPendingMessages:function(){var e=[];if(u.length>0||s.length>0){var r=function(e,t){return t.filter((function(t){return!f(e,t)}))}(u,s);e=u.concat(r)}return n.debug("Flushing: "+function(e){var t,n="",r=i(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n=n.concat("<"+l(o)+">")}}catch(e){r.e(e)}finally{r.f()}return n}(e)),u=e,s=[],t=!1,e},getMissedMessagesSize:function(){return u.length},getOriginalMessagesSize:function(){return s.length}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(2));function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(e,t,n){return Object.defineProperty(e,"prototype",{writable:!1}),e}((function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"emit",(function(e,t){window.localStorage.setItem(e,JSON.stringify(t)),window.localStorage.removeItem(e)})),o(this,"on",(function(e,n){if(t.registeredListeners.has(e)){var r=t.registeredListeners.get(e);window.removeEventListener("storage",r),t.LOGGER.debug("Removed storage event listener "+e)}var o=function(t){var r=t.key,o=t.newValue;r===e&&o&&n(JSON.parse(o))};window.addEventListener("storage",o),t.LOGGER.debug("Registered storage event listener "+e),t.registeredListeners.set(e,o)})),this.registeredListeners=new Map,this.LOGGER=new r.default("amb.CrossClientChannel")}));t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:134217727,t=[],n=Math.max(1,Math.floor(e));return{enqueue:function(e){return this.getAvailableSpace()>0&&(t.push(e),!0)},enqueueMultiple:function(e){return this.getAvailableSpace()>=e.length&&(t=t.concat(e),!0)},dequeue:function(){var e;return t.length>0&&(e=t.shift()),e},dequeueMultiple:function(e){var n;return e>=0&&t.length>=e&&(n=[],e>0&&(n=t.slice(0,e),t=t.slice(e))),n},clear:function(){t=[]},getSize:function(){return t.length},getCapacity:function(){return n},getAvailableSpace:function(){return n-t.length},getQueueBuffer:function(){return t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(12)),o=n(99),i=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){var n="subscribe",u="unsubscribe",s=3e5,a=new i.default("amb.SubscriptionCommandSender");t.addTokenAvailabilityListener((function(){_()}));var c=!r.default.subscribeCommandsFlow.enable,f=null;function l(e,t,n){return Math.min(n,Math.max(t,e))}function d(){return t.getTokenCount()>=r.default.subscribeCommandsFlow.maxInflight}function p(){(0,o.isNil)(f)||(a.debug("stopTimer"),clearTimeout(f),f=null)}function h(){var e=parseInt(r.default.subscribeCommandsFlow.retryDelay.min);return l(e,0,s)}function v(e,t,i,s){var c;a.debug("scheduleRetry - channel : "+e.getName()+", triesLeft : "+t+", mode : "+i);var f=function(e){return l(r.default.subscribeCommandsFlow.retryDelay.increaseFactor*e,r.default.subscribeCommandsFlow.retryDelay.min,r.default.subscribeCommandsFlow.retryDelay.max)}(s);switch(i){case n:c=function(){return m(e,t,f)};break;case u:c=function(){return y(e,t,f)}}(0,o.isNil)(c)||setTimeout(c,s)}function g(e,n,r,o,i){a.debug("onResponse - response ".concat(JSON.stringify(e),", channel ").concat(JSON.stringify(n),", mode : ").concat(r,", \n\t\t\ttriesLeft ").concat(o,", stopping : ").concat(c,", tokenCount : ").concat(t.getTokenCount(),", isBucketFull - ").concat(d(),", retryDelay - ").concat(i)),c?n.subscriptionCallback(e):(o-=1,d()&&p(),o>0&&function(e){if(a.debug("isRetriable - response : "+e),e&&e.ext){var t=e.ext.rejected_by_glide;if(t){var n=parseInt(e.ext["glide.amb.reply.status.code"]);if(a.addWarnMessage("isRetriable - rejected_by_glide : "+t+", glide.amb.reply.status.code : "+n),!isNaN(n))return 429==n||202==n}}return a.debug("isRetriable -  "+!1),!1}(e)?v(n,o,r,i):n.subscriptionCallback(e),_())}function b(t){return a.debug("addItemToQueue - item : "+t),!!e.enqueue(t)&&(_(),!0)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h();return a.debug("enqueueSubscribe - channel: "+e.getName()+", triesLeft : "+t+", stopping : "+c+", retryDelay : "+i),!!(!c&&(0,o.isObject)(e)&&((0,o.isNil)(t)&&(t=1+Math.floor(r.default.subscribeCommandsFlow.retries)),t>0))&&b((function(){a.debug("enqueueSubscribe - inside the item execution. Calling channel._subscribeToCometD - channel: "+e.getName()+", triesLeft : "+t),e._subscribeToCometD((function(r){return g(r,e,n,t,i)}))}))}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h();return a.debug("enqueueUnsubscribe - channel: "+e.getName()+", triesLeft : "+t+", stopping : "+c+", retryDelay : "+n),!!(!c&&(0,o.isObject)(e)&&((0,o.isNil)(t)&&(t=1+Math.floor(r.default.subscribeCommandsFlow.retries)),t>0))&&b((function(){e._unsubscribeFromCometD((function(r){return g(r,e,u,t,n)}))}))}function _(){var n=Math.min(e.getSize(),l(t.getTokenCount(),0,r.default.subscribeCommandsFlow.maxInflight));a.debug("processQueue - numberToProcess : "+n),n>0&&(e.dequeueMultiple(n).forEach((function(e){return(0,o.isNil)(e)||e()})),function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e||(0,o.isNil)(f)){var n=l(r.default.subscribeCommandsFlow.maxWait,0,s);a.debug("restartTimer - force: "+e+", timerObject : "+f+", timeInterval : "+n),p(),f=setTimeout((function(){f=null,a.debug("onTimer - stopping : "+c),c||(t.refillTokens(),_())}),n)}}(!1))}return{subscribeToChannel:function(e){return a.debug("subscribeToChannel - to : "+e.getName()),m(e)},unsubscribeToChannel:function(e){return a.debug("unsubscribeToChannel - from : "+e.getName()),y(e)},stop:function(){a.debug("stop"),a.debug("signalStop - stopping : "+c),c||(c=!0,p(),e.clear())},isStopping:function(){return c},getQueue:function(){return e},isBucketEmpty:function(){return!d()},getTimerObject:function(){return f},getTokenCountFromTokenManager:function(){return t.getTokenCount()}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(2)),o=i(n(12));function i(e){return e&&e.__esModule?e:{default:e}}function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){a=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(a)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}t.default=function(e){var t={},n=new r.default("amb.TransportManagement");return t.isPruningEnabled=function(){return"false"!==o.default.pruneFailedTransports},t.processConnectionOpened=function(){this.isPruningEnabled()&&(n.debug("Processing connection opened"),this.removeSkippedTransportsInConnect())},t.removeSkippedTransportsInConnect=function(){var t=null===e.getTransport()?null:e.getTransport().getType();if(n.addInfoMessage("Connected using transport "+t),n.debug("Purging failed transports from registry..."),null!==t){var r,o=[],i=u(e.getTransportTypes());try{for(i.s();!(r=i.n()).done;){var s=r.value;if(s==t)break;e.unregisterTransport(s),o.push(s)}}catch(e){i.e(e)}finally{i.f()}n.addInfoMessage("Removed failed registry transports after connect: {"+o+"}")}},t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(!(0,i.default)(e)&&(0,u.default)(e),"Expected startConfig to be an object"),(0,o.default)((0,c.default)(e,"type")&&(0,s.default)(e.type)&&(0,f.default)(d,e.type),"Expected type to be one of: "+d.join(", ")),(0,o.default)((0,c.default)(e,"name")&&(0,s.default)(e.name),"Expected name string argument"),(0,o.default)((0,u.default)(e.inputs)||(0,i.default)(e.inputs),"Expected inputs to be object or undefined"),!0};var r=n(37),o=l(n(21)),i=l(n(386)),u=l(n(387)),s=l(n(96)),a=l(n(174)),c=l(n(403)),f=l(n(440));function l(e){return e&&e.__esModule?e:{default:e}}var d=(0,a.default)(r.FLOW_TYPES)},function(e,t){e.exports=function(e){return void 0===e}},function(e,t,n){var r=n(27),o=n(388),i=n(29),u=Function.prototype,s=Object.prototype,a=u.toString,c=s.hasOwnProperty,f=a.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=r(e))return!1;var t=o(e);if(null===t)return!0;var n=c.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&a.call(n)==f}},function(e,t,n){var r=n(173)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(175);e.exports=function(e,t){return r(t,(function(t){return e[t]}))}},function(e,t,n){var r=n(391),o=n(400),i=n(178);e.exports=function(e){return i(e)?r(e):o(e)}},function(e,t,n){var r=n(392),o=n(176),i=n(28),u=n(394),s=n(177),a=n(396),c=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=i(e),f=!n&&o(e),l=!n&&!f&&u(e),d=!n&&!f&&!l&&a(e),p=n||f||l||d,h=p?r(e.length,String):[],v=h.length;for(var g in e)!t&&!c.call(e,g)||p&&("length"==g||l&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v))||h.push(g);return h}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(27),o=n(29);e.exports=function(e){return o(e)&&"[object Arguments]"==r(e)}},function(e,t,n){(function(e){var r=n(56),o=n(395),i=t&&!t.nodeType&&t,u=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=u&&u.exports===i?r.Buffer:void 0,a=(s?s.isBuffer:void 0)||o;e.exports=a}).call(this,n(39)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(397),o=n(398),i=n(399),u=i&&i.isTypedArray,s=u?o(u):r;e.exports=s},function(e,t,n){var r=n(27),o=n(100),i=n(29),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!u[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(164),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,u=i&&i.exports===o&&r.process,s=function(){try{return u&&u.binding&&u.binding("util")}catch(e){}}();e.exports=s}).call(this,n(39)(e))},function(e,t,n){var r=n(401),o=n(402),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(173)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(404),o=n(405);e.exports=function(e,t){return null!=e&&o(e,t,r)}},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e,t){return null!=e&&n.call(e,t)}},function(e,t,n){var r=n(406),o=n(176),i=n(28),u=n(177),s=n(100),a=n(439);e.exports=function(e,t,n){for(var c=-1,f=(t=r(t,e)).length,l=!1;++c<f;){var d=a(t[c]);if(!(l=null!=e&&n(e,d)))break;e=e[d]}return l||++c!=f?l:!!(f=null==e?0:e.length)&&s(f)&&u(d,f)&&(i(e)||o(e))}},function(e,t,n){var r=n(28),o=n(407),i=n(408),u=n(437);e.exports=function(e,t){return r(e)?e:o(e,t)?[e]:i(u(e))}},function(e,t,n){var r=n(28),o=n(58),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||u.test(e)||!i.test(e)||null!=t&&e in Object(t)}},function(e,t,n){var r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,i=n(409)((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(r,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=i},function(e,t,n){var r=n(410);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(411);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=e.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(o.Cache||r),n}o.Cache=r,e.exports=o},function(e,t,n){var r=n(412),o=n(432),i=n(434),u=n(435),s=n(436);function a(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=s,e.exports=a},function(e,t,n){var r=n(413),o=n(424),i=n(431);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(e,t,n){var r=n(414),o=n(420),i=n(421),u=n(422),s=n(423);function a(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=s,e.exports=a},function(e,t,n){var r=n(59);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t,n){var r=n(179),o=n(416),i=n(101),u=n(418),s=/^\[object .+?Constructor\]$/,a=Function.prototype,c=Object.prototype,f=a.toString,l=c.hasOwnProperty,d=RegExp("^"+f.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(r(e)?d:s).test(u(e))}},function(e,t,n){var r=n(417),o=function(){var e=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(56)["__core-js_shared__"];e.exports=r},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(59),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(59),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:o.call(t,e)}},function(e,t,n){var r=n(59);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(425),o=n(426),i=n(428),u=n(429),s=n(430);function a(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=o,a.prototype.get=i,a.prototype.has=u,a.prototype.set=s,e.exports=a},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(60),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0||(n==t.length-1?t.pop():o.call(t,n,1),--this.size,0))}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(60);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(60);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(60);e.exports=function(e,t){var n=this.__data__,o=r(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}},function(e,t,n){var r=n(180)(n(56),"Map");e.exports=r},function(e,t,n){var r=n(61);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(61);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(61);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(61);e.exports=function(e,t){var n=r(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}},function(e,t,n){var r=n(438);e.exports=function(e){return null==e?"":r(e)}},function(e,t,n){var r=n(97),o=n(175),i=n(28),u=n(58),s=r?r.prototype:void 0,a=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(u(t))return a?a.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t,n){var r=n(58);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,n){var r=n(441),o=n(178),i=n(96),u=n(445),s=n(174),a=Math.max;e.exports=function(e,t,n,c){e=o(e)?e:s(e),n=n&&!c?u(n):0;var f=e.length;return n<0&&(n=a(f+n,0)),i(e)?n<=f&&e.indexOf(t,n)>-1:!!f&&r(e,t,n)>-1}},function(e,t,n){var r=n(442),o=n(443),i=n(444);e.exports=function(e,t,n){return t==t?i(e,t,n):r(e,o,n)}},function(e,t){e.exports=function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(446);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t,n){var r=n(447);e.exports=function(e){return e?(e=r(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(101),o=n(58),i=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=s.test(e);return n||a.test(e)?c(e.slice(2),n?2:8):u.test(e)?NaN:+e}},function(e,t,n){"use strict";n.r(t),n.d(t,"snHttpFactory",(function(){return Ae}));var r=n(64),o=n.n(r),i=Uint8Array,u=Uint16Array,s=Uint32Array,a=new i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c=new i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),f=new i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),l=function(e,t){for(var n=new u(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var o=new s(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)o[i]=i-n[r]<<5|r;return[n,o]},d=l(a,2),p=d[0],h=d[1];p[28]=258,h[258]=28;for(var v=l(c,0),g=(v[0],v[1]),b=new u(32768),m=0;m<32768;++m){var y=(43690&m)>>>1|(21845&m)<<1;y=(61680&(y=(52428&y)>>>2|(13107&y)<<2))>>>4|(3855&y)<<4,b[m]=((65280&y)>>>8|(255&y)<<8)>>>1}var _=function(e,t,n){for(var r=e.length,o=0,i=new u(t);o<r;++o)++i[e[o]-1];var s,a=new u(t);for(o=0;o<t;++o)a[o]=a[o-1]+i[o-1]<<1;if(n){s=new u(1<<t);var c=15-t;for(o=0;o<r;++o)if(e[o])for(var f=o<<4|e[o],l=t-e[o],d=a[e[o]-1]++<<l,p=d|(1<<l)-1;d<=p;++d)s[b[d]>>>c]=f}else for(s=new u(r),o=0;o<r;++o)e[o]&&(s[o]=b[a[e[o]-1]++]>>>15-e[o]);return s},x=new i(288);for(m=0;m<144;++m)x[m]=8;for(m=144;m<256;++m)x[m]=9;for(m=256;m<280;++m)x[m]=7;for(m=280;m<288;++m)x[m]=8;var w=new i(32);for(m=0;m<32;++m)w[m]=5;var S=_(x,9,0),T=_(w,5,0),O=function(e){return(e+7)/8|0},E=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8},C=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},j=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var o=n.length,s=n.slice();if(!o)return[R,0];if(1==o){var a=new i(n[0].s+1);return a[n[0].s]=1,[a,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var c=n[0],f=n[1],l=0,d=1,p=2;for(n[0]={s:-1,f:c.f+f.f,l:c,r:f};d!=o-1;)c=n[n[l].f<n[p].f?l++:p++],f=n[l!=d&&n[l].f<n[p].f?l++:p++],n[d++]={s:-1,f:c.f+f.f,l:c,r:f};var h=s[0].s;for(r=1;r<o;++r)s[r].s>h&&(h=s[r].s);var v=new u(h+1),g=A(n[d-1],v,0);if(g>t){r=0;var b=0,m=g-t,y=1<<m;for(s.sort((function(e,t){return v[t.s]-v[e.s]||e.f-t.f}));r<o;++r){var _=s[r].s;if(!(v[_]>t))break;b+=y-(1<<g-v[_]),v[_]=t}for(b>>>=m;b>0;){var x=s[r].s;v[x]<t?b-=1<<t-v[x]++-1:++r}for(;r>=0&&b;--r){var w=s[r].s;v[w]==t&&(--v[w],++b)}g=t}return[new i(v),g]},A=function(e,t,n){return-1==e.s?Math.max(A(e.l,t,n+1),A(e.r,t,n+1)):t[e.s]=n},N=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new u(++t),r=0,o=e[0],i=1,s=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==o&&a!=t)++i;else{if(!o&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(o),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(o);i=1,o=e[a]}return[n.subarray(0,r),t]},I=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},M=function(e,t,n){var r=n.length,o=O(t+2);e[o]=255&r,e[o+1]=r>>>8,e[o+2]=255^e[o],e[o+3]=255^e[o+1];for(var i=0;i<r;++i)e[o+i+4]=n[i];return 8*(o+4+r)},k=function(e,t,n,r,o,i,s,l,d,p,h){E(t,h++,n),++o[256];for(var v=j(o,15),g=v[0],b=v[1],m=j(i,15),y=m[0],O=m[1],A=N(g),k=A[0],L=A[1],R=N(y),P=R[0],D=R[1],F=new u(19),U=0;U<k.length;++U)F[31&k[U]]++;for(U=0;U<P.length;++U)F[31&P[U]]++;for(var q=j(F,7),B=q[0],H=q[1],G=19;G>4&&!B[f[G-1]];--G);var W,z,V,$,Q=p+5<<3,X=I(o,x)+I(i,w)+s,Y=I(o,g)+I(i,y)+s+14+3*G+I(F,B)+(2*F[16]+3*F[17]+7*F[18]);if(Q<=X&&Q<=Y)return M(t,h,e.subarray(d,d+p));if(E(t,h,1+(Y<X)),h+=2,Y<X){W=_(g,b,0),z=g,V=_(y,O,0),$=y;var K=_(B,H,0);for(E(t,h,L-257),E(t,h+5,D-1),E(t,h+10,G-4),h+=14,U=0;U<G;++U)E(t,h+3*U,B[f[U]]);h+=3*G;for(var J=[k,P],Z=0;Z<2;++Z){var ee=J[Z];for(U=0;U<ee.length;++U){var te=31&ee[U];E(t,h,K[te]),h+=B[te],te>15&&(E(t,h,ee[U]>>>5&127),h+=ee[U]>>>12)}}}else W=S,z=x,V=T,$=w;for(U=0;U<l;++U)if(r[U]>255){te=r[U]>>>18&31,C(t,h,W[te+257]),h+=z[te+257],te>7&&(E(t,h,r[U]>>>23&31),h+=a[te]);var ne=31&r[U];C(t,h,V[ne]),h+=$[ne],ne>3&&(C(t,h,r[U]>>>5&8191),h+=c[ne])}else C(t,h,W[r[U]]),h+=z[r[U]];return C(t,h,W[256]),h+z[256]},L=new s([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),R=new i(0),P=function(e,t,n,r,o,f){var l=e.length,d=new i(r+l+5*(1+Math.ceil(l/7e3))+o),p=d.subarray(r,d.length-o),v=0;if(!t||l<8)for(var b=0;b<=l;b+=65535){var m=b+65535;m<l?v=M(p,v,e.subarray(b,m)):(p[b]=f,v=M(p,v,e.subarray(b,l)))}else{for(var y=L[t-1],_=y>>>13,x=8191&y,w=(1<<n)-1,S=new u(32768),T=new u(w+1),E=Math.ceil(n/3),C=2*E,j=function(t){return(e[t]^e[t+1]<<E^e[t+2]<<C)&w},A=new s(25e3),N=new u(288),I=new u(32),P=0,D=0,F=(b=0,0),U=0,q=0;b<l;++b){var B=j(b),H=32767&b,G=T[B];if(S[H]=G,T[B]=H,U<=b){var W=l-b;if((P>7e3||F>24576)&&W>423){v=k(e,p,0,A,N,I,D,F,q,b-q,v),F=P=D=0,q=b;for(var z=0;z<286;++z)N[z]=0;for(z=0;z<30;++z)I[z]=0}var V=2,$=0,Q=x,X=H-G&32767;if(W>2&&B==j(b-X))for(var Y=Math.min(_,W)-1,K=Math.min(32767,b),J=Math.min(258,W);X<=K&&--Q&&H!=G;){if(e[b+V]==e[b+V-X]){for(var Z=0;Z<J&&e[b+Z]==e[b+Z-X];++Z);if(Z>V){if(V=Z,$=X,Z>Y)break;var ee=Math.min(X,Z-2),te=0;for(z=0;z<ee;++z){var ne=b-X+z+32768&32767,re=ne-S[ne]+32768&32767;re>te&&(te=re,G=ne)}}}X+=(H=G)-(G=S[H])+32768&32767}if($){A[F++]=268435456|h[V]<<18|g[$];var oe=31&h[V],ie=31&g[$];D+=a[oe]+c[ie],++N[257+oe],++I[ie],U=b+V,++P}else A[F++]=e[b],++N[e[b]]}}v=k(e,p,f,A,N,I,D,F,q,b-q,v),!f&&7&v&&(v=M(p,v+1,R))}return function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof u?u:e instanceof s?s:i)(n-t);return r.set(e.subarray(t,n)),r}(d,0,r+O(v)+o)},D=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),F=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8};function U(e,t){t||(t={});var n=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=D[255&n^t[r]]^n>>>8;e=n},d:function(){return~e}}}(),r=e.length;n.p(e);var o=function(e,t,n,r,o){return P(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,r,!o)}(e,t,function(e){return 10+(e.filename&&e.filename.length+1||0)}(t),8),i=o.length;return function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&F(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}}(o,t),F(o,i-8,n.d()),F(o,i-4,r),o}var q="undefined"!=typeof TextDecoder&&new TextDecoder;try{q.decode(R,{stream:!0})}catch(e){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;var B=n(181),H=n.n(B);function G(){return H()()}var W=n(21),z=n.n(W),V=n(182),$=n.n(V);function Q(e,t,n,r){if(z()(["push","unshift"].includes(r),"snHttpFactory: options must contain 'enqueueRequest' must return an operation of push or unshit."),z()(["high","low"].includes(n),"snHttpFactory: options must contain 'enqueueRequest' must return an priority of low or high."),"high"===n&&"push"===r||"low"===n&&"unshift"===r){const n=$()(e,e=>"low"===e.config.priority);-1===n?e.push(t):e.splice(n,0,t)}"high"===n&&"unshift"===r&&e.unshift(t),"low"===n&&"push"===r&&e.push(t)}var X=n(65),Y=n.n(X),K=n(63),J=n.n(K),Z=n(183),ee=n.n(Z),te=n(184),ne=n.n(te),re=n(41),oe=n.n(re);const ie="X-UserToken",ue="x-is-logged-in";var se=n(185),ae=n.n(se);const ce=new TextEncoder;var fe=(()=>{let e,t,n;const r=o.a.create({transformRequest:o.a.defaults.transformRequest.concat((function(r,o){if("string"==typeof r&&e&&r.length>=e){o["Content-Encoding"]="gzip";const e={};return t&&(e.level=t),n&&(e.mem=n),U(ce.encode(r),e)}return r}))});let i,u,s;return r.interceptors.request.use(e=>{const t=e.headers[ie]||i,n={...s,...e.headers,[ie]:t,...u&&{"X-Transaction-Source":u}};return{...e,headers:n}}),r.interceptors.response.use(void 0,e=>{const{response:t}=e;return t&&401===t.status&&t.config?new Promise((n,o)=>{const u=t.headers["x-usertoken-response"];if(!u||u===i)return o(e);i=u;const s=ae()(t.config);return s.headers[ie]=u,n(r(s))}):Promise.reject(e)}),r.interceptors.request.use(function(e){return t=>{if(!t.data||!t.data.batch_request_id)return t;const n=t.transformRequest[0],r=t.data.rest_requests||[],o=oe()(r,t=>{const{headers:r,body:o,url:i,params:u,...s}=t,a=function(e,t){return`)}`}(i,u),c=o?function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode("0x"+t)})))}(n(o)):o;return{...s,url:a,headers:e?[...r,{name:ie,value:e}]:[...r],body:c}});return{...t,data:{...t.data,rest_requests:o}}}}(i)),r.interceptors.response.use(function(){function e(e){let t=function(e){return decodeURIComponent(atob(e).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))}(e);if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}return t}function t(t){return{id:t.id,data:e(t.body),headers:function(e){return J()(e,(e,{name:t,value:n})=>({...e,[t]:n}),{})}(t.headers),status:t.status_code,statusText:t.status_text,...t.error_message&&{error:!0,errorMessage:t.error_message}}}return e=>{const{config:n,data:r={},headers:o}=e;if(!0===n.batch){const{serviced_requests:n=[]}=r,i=function(e=[],t={}){return t.hasOwnProperty(ue)?oe()(e,e=>{const n=e;return n.headers[ue]=t[ue],n}):e}(oe()(n,t),o);return{...e,data:{...r,serviced_requests:i}}}return e}}(),function(){function e(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}return t=>{const{config:n,response:r,message:o}=t;return n&&!0===n.batch?Promise.reject({...t,config:{...n,data:e(n.data)},...r&&{...r,data:e(r.data)},message:o}):Promise.reject(t)}}()),r.getSource=()=>o.a.CancelToken.source(),r.setXsrfToken=e=>{i=e},r.setXTransactionSource=e=>{u=e},r.setDefaultHeaders=e=>{s=e},r.setHttpRequestCompressionThreshold=t=>{Number.isInteger(t)&&t>0&&(e=t)},r.setHttpRequestCompressionLevel=e=>{Number.isInteger(e)&&e>=0&&e<=9&&(t=e)},r.setHttpRequestCompressionMemoryLevel=e=>{Number.isInteger(e)&&e>=0&&e<=12&&(n=e)},r.getHttpRequestCompressionThreshold=()=>e,r.getHttpRequestCompressionLevel=()=>t,r.getHttpRequestCompressionMemoryLevel=()=>n,r})(),le=n(186),de=n.n(le),pe=n(187),he=n.n(pe),ve=n(40),ge=n.n(ve),be=n(62),me=n.n(be),ye=n(13),_e=n.n(ye);const{toString:xe}=Object.prototype;function we(e){return"undefined"!=typeof FormData&&e instanceof FormData}function Se(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function Te(e){return"[object File]"===xe.call(e)}function Oe(e){return"[object Blob]"===xe.call(e)}function Ee(e){return _e()(e)&&me()(e.pipe)}function Ce(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function je(){return{priority:"high",operation:"push"}}var Ae=(e=>(t={})=>{const n=t.methods||["get","post","put","patch","delete","head"],r=t.maxConcurrent||2,o=t.queue||[],i=t.enqueueRequestPrioritizer||je,u=!1!==t.batching;t.xsrfToken?e.setXsrfToken(t.xsrfToken):console.warn("No XSRF token supplied in snHttp construction.  Setting an initial XSRF token (typically found on window.g_ck) is highly advised to avoid a 401 on initial request."),t.xTransactionSource&&e.setXTransactionSource(t.xTransactionSource),t.headers&&e.setDefaultHeaders(t.headers),t.httpRequestCompressionThreshold&&e.setHttpRequestCompressionThreshold(t.httpRequestCompressionThreshold),t.httpRequestCompressionLevel&&e.setHttpRequestCompressionLevel(t.httpRequestCompressionLevel),t.httpRequestCompressionMemoryLevel&&e.setHttpRequestCompressionMemoryLevel(t.httpRequestCompressionMemoryLevel);const s=function({batchUrl:e="/api/now/v1/batch",batchMethod:t="post",batchMax:n=10,batchInterval:r=50,sendRequest:o}={}){z()(o,"createHttpRequestBatcher: options must contain 'sendRequest' function.");const i=[],u=new Map;function s(e){const{config:{priority:t,operation:o}}=e;Q(i,e,t,o),1===i.length&&setTimeout(()=>{i.length&&f()},r),i.length===n&&f()}function a(e){const t=e.response||{},n=(e.config||{}).data||{};Y()(n.rest_requests,n=>{const{id:r}=n;if(void 0===r||!u.has(r))return;const{deferredReject:o}=u.get(r);o({...e,response:{headers:t.headers,data:t.data,status:t.status,statusText:t.statusText}}),u.delete(r)})}function c(e){const{data:t={},config:n={}}=e,{serviced_requests:r=[],unserviced_requests:o=[]}=t;Y()(r,e=>{const{id:t,...r}=e;if(void 0===t||!u.has(t))return;const{deferredResolve:o,deferredReject:i}=u.get(t);!function(e){return e>=200&&e<300}(e.status)?i({config:n,response:r}):o(r),u.delete(t)}),Y()(o,e=>{s(u.get(e))})}function f(){const n=G(),r=[];let s;for(;i.length&&(!s||s===i[0].config.priority);){const e=i.shift();r.push(e.request),u.set(e.requestId,e),s=e.config.priority}o(e,t,{batch:!0,data:{batch_request_id:n,enforce_order:!1,rest_requests:r}}).then(c).catch(a),i.length&&f()}return{get currentQueueSize(){return i.length},get batchInterval(){return r},enqueueRequest:function(e,t,n){const r=G();let o,i;const u=new Promise((e,t)=>{o=e,i=t}),{data:a,params:c,headers:f,priority:l="high",operation:d="push"}=n;return s({requestId:r,config:{priority:l,operation:d},request:{id:r,headers:function(e={}){return J()(e,(e,t,n)=>(e.push({name:n,value:t}),e),[])}(f),url:e,method:ee()(n.method||t),...a&&{body:a},...c&&{params:c}},deferredReject:i,deferredResolve:o}),u}}}({sendRequest:h});let a=[];function c(){return r-a.length}function f(){a.length>0&&a.shift(),l()}function l(){o.splice(0,c()).forEach(d)}function d(t){const{config:n,deferredResolve:r,deferredReject:o,cancel:i}=t;e.request(n).then(e=>{r(e)}).catch(e=>{o(e)}).then(f),function(e){a.push(e)}({config:n,cancel:i})}function p(){a.slice().forEach(({cancel:e})=>{e(),a.shift()})}function h(t,n,r){let i,a;const f=new Promise((e,t)=>{i=e,a=t}),d=r.source||e.getSource(),p=d.token,h=()=>{!function(e){const{priority:t="high",operation:n="push"}=e.config;Q(o,e,t,n)}({config:Object.assign({},{url:t,method:n,cancelToken:p},r),deferredResolve:i,deferredReject:a,cancel:()=>d.cancel("Request cancelled by user")}),0!==c()&&l()};if(u&&!1===r.batch&&"low"===r.priority){const e=setInterval(()=>{s.currentQueueSize||(((...e)=>{(window.requestIdleCallback||window.setTimeout)(...e)})(()=>h()),clearInterval(e))},s.batchInterval)}else h();return f}function v(e,t,r){if(!t)throw new Error("Must supply method");if(!n.includes(t.toLowerCase()))throw new Error(`Method "" is not supported (supported methods are )`);return function(e={}){const{batching:t=!0,batch:n,data:r={}}=e;return(!0===n||!1===n?n:t)&&t&&function(e){return!de()([he.a,Se,Oe,ge.a,Te,we,Ee,Ce])(e)}(r)}({...r,batching:u})?function(e,t,n){return s.enqueueRequest(e,t,Object.assign({},n,{batch:!0}))}(e,t,{...r,batch:!0,...i(e)}):h(e,t,{...r,batch:!1,...i(e)})}const g={get client(){return e},get queue(){return o},get interceptors(){return e.interceptors},cancelRequests:function(){p(),o.slice().forEach(e=>{e.deferredReject("Request cancelled by user"),o.shift()})},cancelInFlightRequests:p,request:v};return n.reduce((e,t)=>({...e,[t]:(e,n={})=>v(e,t,n)}),g)})(fe)}]);
;
/*! RESOURCE: scripts/classes/WFStageSet.js */
var WFStageSet = (function() {
	function getWorkflowVersionFromQuery(qry) {
	    if (!qry)
		    return null;
	    var exps = qry.split("^");
	    for (var i = 0; i < exps.length; i++) {
	    	var exp = exps[i];
	    	var parts = exp.split('=');
	    	if (parts.length == 2 && parts[0].trim() == 'workflow_version' && parts[1].trim() != '')
	    		return parts[1].trim();
	    }
	    return null;
	}
	
	function exportStageSet(setName, workflowVersionId, filter) {
		var ga = new GlideAjax('WFStageSet');
		ga.addParam('sysparm_name',     'exportStageSet');
		ga.addParam('sysparm_set_name', setName);    
		ga.addParam('sysparm_workflow', workflowVersionId);
		if (filter != null)
  		    ga.addParam('sysparm_filter', filter);
		ga.getXMLWait();
		return ga.getAnswer();
	}
	function importStages(source, workflowVersionId, setId) {
		var ga = new GlideAjax('WFStageSet');
		ga.addParam('sysparm_name',     'import'+source);
		ga.addParam('sysparm_set_id',   setId);    
		ga.addParam('sysparm_workflow', workflowVersionId);
		ga.getXMLWait();
		return ga.getAnswer();
	}
	function incrementCounter(table, column, sys_id, increment) {
		var ga = new GlideAjax('WFStageSet');
		ga.addParam('sysparm_name',      'incrementCounter');
		ga.addParam('sysparm_sys_id',    sys_id);    
		ga.addParam('sysparm_table',     table);
		ga.addParam('sysparm_column',    column);
		ga.addParam('sysparm_increment', increment);
		ga.getXMLWait();
		return ga.getAnswer();
	}
	
	function warnNoWorkflow(msg) {
	    var dialog = new GlideDialogWindow('glide_warn');
		var msgs = new GwtMessage();
	    dialog.setPreference('title', msgs.getMessage('Operation not supported.')
+ '<br/>'
							        + msgs.getMessage(msg) );
	    dialog.render();
	    return 'ok';
	}
	
	return {
		getWorkflowVersionFromQuery: getWorkflowVersionFromQuery,
					 exportStageSet: exportStageSet,
					   importStages: importStages,
				   incrementCounter: incrementCounter,
				     warnNoWorkflow: warnNoWorkflow
				}
	
}());
;
/*! RESOURCE: scripts/classes/GlideMenu.js */
var GlideMenu = Class.create();
GlideMenu.prototype = {
	initialize: function(idSuffix, type) {
		this.suffix = idSuffix;
		this.type = type;
		this.clear();
	},
	destroy: function() {
		this.clear();
	},
	clear: function() {
		this.menuItems = [];
		this.variables = {};
		this.onShowScripts = [];
	},
	isEmpty: function() {
		var e = gel('context.' + this.type + "." + this.suffix);
		if (e) {
			var script = e.innerHTML;
if (window.execScript)
				window.execScript(script);
			else
				eval.call(window, script);
			
			Element.remove(e);
		}
		
		for ( var i = 0; i < this.menuItems.length; i++) {
			if (this.menuItems[i].parentId == '')
				return false;
		}
		return true;
	},
	load: function() {
	    
	},
    add: function(sysId, id, parentId, label, type, action, order, img, trackSelected) {
        var item = {};
        item.sysId = sysId;
        item.id = id;
        item.parentId = parentId;
        item.label = label;
        item.type = type;
        item.action = action || "";
        item.order = order;
        item.image = img;
        item.trackSelected = (trackSelected == "true");
        this._add(item);
    },
	addItem: function(id, parentId, label, type, action, order, img, trackSelected, onShowScript) {
		var item = {};
		item.id = id;
		item.parentId = parentId;
		item.label = label;
		item.type = type;
		item.action = action;
		item.order = order;
		item.image = img;
		item.trackSelected = (trackSelected == "true");
		item.onShowScript = onShowScript;
		this._add(item);
	},
	_add: function(item) {
        if (!item.order)
            item.order = 0;
        this.menuItems.push(item);
    },
    increaseItemsOrder: function(increase){
		for (var i = 0; i < this.menuItems.length; i++)
			this.menuItems[i].order += increase;
	},
	
	addAction: function(label, action, order) {
		this.addItem("", "", label, "action", action, order);
	},
	showContextMenu: function(evt, id, variables) {
		this.variables = variables;
		id += this.suffix;
		if (!getMenuByName(id))
			this._createMenu(id);
		var cm = getMenuByName(id);
		if (cm.context.isEmpty())
			return;
		this._loadVariables(variables);
		for ( var i = 0; i < this.onShowScripts.length; i++) {
			var onShow = this.onShowScripts[i];
			g_menu = getMenuByName(onShow.menuId);
			if (!g_menu)
				continue;
			g_menu = g_menu.context;
			if (!g_menu)
				continue;
			g_item = g_menu.getItem(onShow.itemId);
			if (!g_item)
				continue;
			this._runOnShowScript(onShow.script, onShow.itemId);
		}
		if (id.includes('context_list'))
			this._trackListMetrics(evt, id, variables);
		this._clearVariables(variables);
		g_menu = null;
		g_item = null;
		return contextShow(evt, id, 0, 0, 0, 0);
	},
	_trackListMetrics: function(evt, id, variables) {
		if (!id || !variables || !variables.g_list)
			return;
		var payload = {
			isRightClick: evt.type === 'contextmenu',
		};
		if (id.includes('context_list_header')) {
			payload.fieldType = variables.g_fieldType;
			payload.columnName = variables.g_fieldLabel;
			payload.fieldName = variables.g_fieldName;
			payload.contextMenuType = 'header';
		}
		else if (id.includes('context_list_row')) {
			payload.selectedSysId = variables.g_sysId;
			payload.fieldName = variables.g_fieldName;
			payload.contextMenuType = 'row';
		}
		else if (id.includes('context_list_title')) {
			payload.contextMenuType = 'title';
		}
		else {
			return;
		}
		GlideListUxMetricsUtils.track('Open List Context Menu', variables.g_list, payload);
	},
	setOnShow: function(onshow) {
		this.onshow = onshow;
	},
	setOnHide: function(onhide) {
		this.onhide = onhide;
	},
	_createMenu: function(id) {
		var cm = new GwtContextMenu(id);
		cm.setOnShow(this.onshow);
		cm.setOnHide(this.onhide);
		cm.clear();
		this._sort();
		this._buildMenu("", cm);
	},
	_sort: function() {
		this.menuItems = this.menuItems.sort(function(a, b) {
			var aOrder = parseInt("0" + a.order, 10);
			var bOrder = parseInt("0" + b.order, 10);
			if ((aOrder) < (bOrder)) {
				return -1;
			}
			if ((aOrder) > (bOrder)) {
				return 1;
			}
			return 0;
		});
	},
	_buildMenu: function(parentId, cm) {
		var lastType;
		var itemsAfterLine = 0;
		for ( var i = 0; i < this.menuItems.length; i++) {
			var item = this.menuItems[i];
			if (parentId != item.parentId)
				continue;
			if (lastType == "line" && item.type == "line")
				continue;
			if (lastType == "line" && itemsAfterLine > 0) {
				this._addLine(cm);
				itemsAfterLine = 0;
			}
			lastType = item.type;
			if (lastType == "line")
				continue;
			if (this._addMenuItem(cm, item))
				itemsAfterLine++;
		}
	},
	_addLine: function(cm) {
		cm.addLine();
	},
	_addMenuItem: function(cm, item) {
		var added = true;
		var mi;
		if (item.type == "action") {
			if (!this._getAction(item))
				mi = cm.addLabel(item.label);
			else
				mi = cm.addFunc(item.label, this._runMenuAction.bind(this, item), item.id);
		} else if (item.type == "label") {
			mi = cm.addLabel(item.label);
		} else if (item.type == "menu") {
			var sm = new GwtContextMenu(item.id + '_' + this.suffix);
			if (item.trackSelected)
				sm.setTrackSelected(true);
			this._buildMenu(item.id, sm);
			if (sm.isEmpty())
				added = false;
			else
				mi = cm.addMenu(item.label, sm, item.id);
		}
		if (mi && item.image)
			cm.setImage(mi, item.image);
		if (added && this._getOnShowScript(item)) {
			var o = {};
			o.menuId = cm.id;
			o.itemId = item.id;
			o.script = this._getOnShowScript(item);
			this.onShowScripts.push(o);
		}
		return added;
	},
	
	_getAction: function(item) {
	    var action = '';
	    if (item.action)
	       action = item.action;
	   
	   if (item.sysId)
	       action += '\n' + GlideMenu.scripts[item.sysId];
	   
	   return action;
	},
    _getOnShowScript: function(item) {
        if (item.sysId)
            return GlideMenu.onScripts[item.sysId];
        
        return item.onShowScript;
     },
	_runMenuAction: function(item) {
		this._loadVariables(this.variables);
		try {
			eval(this._getAction(item));
		} catch (ex) {
			jslog("Error running context menu '" + item.label + "': " + ex);
		}
		this._clearVariables(this.variables);
	},
	_runOnShowScript: function(script, itemId) {
		try {
			eval(script);
		} catch (ex) {
			jslog("Error running onShow script for item '" + itemId + "': " + ex);
		}
	},
	_loadVariables: function(variables) {
		for ( var n in variables) {
			var s = n + '=variables["' + n + '"]';
			eval(s);
		}
	},
	_clearVariables: function(variables) {
		for ( var n in variables) {
			var s = n + '=null;';
			eval(s);
		}
	},
	type: 'GlideMenu'
};
GlideMenu.scripts = {};
GlideMenu.onScripts = {};
GlideMenu.addScripts = function(o) {
	
	if (o == null)
		return;
	
	for (var s in o.scripts)
		GlideMenu.scripts[s] = o.scripts[s];
   
	for (var s in o.onScripts)
		GlideMenu.onScripts[s] = o.onScripts[s];
	
}
;
/*! RESOURCE: scripts/OpticsInspector.js */
var OpticsInspector = Class
		.create({
			CATEGORIES : {
				"sys_script" : "BUSINESS RULE",
				"sys_script_client" : "CLIENT SCRIPT",
				"data_lookup" : "DATA LOOKUP",
				"sys_data_policy2" : "DATA POLICY",
				"ui_policy" : "UI POLICY",
				"wf_context" : "WORKFLOW",
				"request_action" : "REQUEST ACTION",
				"script_engine" : "SCRIPT ENGINE",
				"wf_activity" : "WORKFLOW ACTIVITY",
				"acl" : "ACL",
				"sys_ui_action" : "UI ACTION",
				"reference_qual" : "REFERENCE QUALIFIER QUERY",
				"container_action" : "CONTAINER ACTION"
			},
			initialize : function() {
				this.opticsContextStack = new Array();
				this.tableName = null;
				this.fieldName = null;
				this.enabled = false;
			},
			pushOpticsContext : function(category, name, sys_id, sourceTable) {
				if(category == 'sys_script_client')
					name = "\""+name+"\"";				
				var context = {
					"category" : category,
					"name" : name,
					"sys_id" : sys_id,
					"startTime" : new Date(),
					actions : [],
					type : 'context',
"sourceTable": sourceTable || category
				};
				if ((typeof g_form !== 'undefined') && g_form.actionStack)
					g_form.actionStack.push(context);
				if (this.isInspecting() && category !== 'container_action')
					this.opticsContextStack.push(context);
			},
			popOpticsContext : function() {
				var context ;
				if ((typeof g_form !== 'undefined') && g_form.actionStack) {
					context = g_form.actionStack.pop();
					if (g_form._pushAction)
						g_form._pushAction(context);
				}
				if (this.isInspecting() && this.opticsContextStack.length > 0 && (context && context.category !== 'container_action'))
					return this.opticsContextStack.pop();
				return null;
			},
			isInspecting : function(tableName, fieldName) {
				if (this.tableName == null && this.fieldName == null)
					return false;
				if (arguments.length == 0)
					return (this.tableName && this.tableName.length > 0
							&& this.fieldName && this.fieldName.length > 0);
				if (arguments.length == 2)
					return tableName == this.tableName
							&& fieldName == this.fieldName;
				return false;
			},
			getTableName : function() {
				return (this.tableName && this.tableName.length > 0) ? this.tableName
						: '';
			},
			getFieldName : function() {
				return (this.fieldName && this.fieldName.length > 0) ? this.fieldName
						: '';
			},
			hideWatchIcons: function(){
				if(isDoctype()) {
					$$(".icon-debug.watch_icon").each(function (element) {
						$(element).hide()
					});
				} else {
					$$("img.watch_icon").each(function (element) {
						$(element).hide()
					});
				}
			},
			addWatchIcon:function(watchField){
				if (!watchField) {
					return;
				}
				var td = $('label.' + watchField);
				if (!td) {
					var fieldParts = watchField.split(".");
					if ((fieldParts.length == 2 && fieldParts[0].length > 0 && fieldParts[1].length > 0)) {
						td = $('label_' + fieldParts[1]);
						if (td && td.tagName !== 'TD') {
							var tds = td.getElementsByTagName("TD");
							if (tds && tds.length > 0) {
								td = tds[0];
							}
						}
						if (!td) {
							td = $('ni.' + fieldParts[1] + '_label');
						}
					}
				}
				var icon;
				if (td) {
					if(isDoctype()) {
						var label = td.select('label');
						if (label.length > 0) {
							label = label[0];
						} else {
							label = td.select('legend');
							if (label.length > 0) {
								label = label[0];
							} else if (td.nodeName == "LABEL") {
								label = td;
							}
						}
						icon = '<span class="label-icon icon-debug watch_icon" id="'
						+ watchField
						+ '.watch_icon"'
						+ ' onclick="CustomEvent.fireTop(\'showFieldWatcher\')" '
+ ' src="images/debug.gifx" '
						+ ' alt="Field is being watched"'
+ ' title="Field is being watched"></span>';
						if(label){
							$(label).insert(icon);
						}
					} else {
						if (fieldParts.length === 2
								&& fieldParts[1].startsWith("IO:")) {
							var legend = td.select('legend');
							if (legend.length > 0) {
								td = legend[0];
							}
						}
						icon = '<img class="watch_icon" id="'
						+ watchField
						+ '.watch_icon"'
						+ ' onclick="CustomEvent.fireTop(\'showFieldWatcher\')" '
+ ' src="images/debug.gifx" '
						+ ' alt="Field is being watched"'
+ ' title="Field is being watched" />';
						td.insert(icon);
					}
				}
			},
			clearWatchField : function(watchfield) {
				this.opticsContextStack = new Array();
				this.tableName = null;
				this.fieldName = null;
				this.hideWatchIcons();
				var debuggerTools = getTopWindow().debuggerTools;
				if (debuggerTools && debuggerTools.isDebugPanelVisible()) {
					var wndw = debuggerTools.getJsDebugWindow();
					if (wndw.updateFieldInfo)
						wndw.updateFieldInfo(null);
				} else {
					debuggerTools = parent.parent.debuggerTools;
					if (debuggerTools && debuggerTools.isDebugPanelVisible()) {
						var wndw = debuggerTools.getJsDebugWindow();
						if (wndw.updateFieldInfo)
							wndw.updateFieldInfo(null);
					}
				}
			},
			setWatchField : function(watchField) {
				if (!watchField)
					return;
				var fieldParts = watchField.split(".");
				if (!(fieldParts.length == 2 && fieldParts[0].length > 0 && fieldParts[1].length > 0))
					return;
				this.tableName = fieldParts[0];
				this.fieldName = fieldParts[1];
				this.hideWatchIcons();
				var icon = $(watchField + ".watch_icon");
				if (icon) {
					icon.show();
				}
				else {
					this.addWatchIcon(watchField);
				}
				var debuggerTools = getTopWindow().debuggerTools;
				if (debuggerTools && debuggerTools.isDebugPanelVisible()) {
					var wndw = debuggerTools.getJsDebugWindow();
					if (wndw.updateFieldInfo)
						wndw.updateFieldInfo(watchField);
				} else{
					debuggerTools = parent.parent.debuggerTools;
					if (debuggerTools && debuggerTools.isDebugPanelVisible()) {
						var wndw = debuggerTools.getJsDebugWindow();
						if (wndw.updateFieldInfo)
							wndw.updateFieldInfo(watchField);
					}
				}
			},
			showWatchField : function(watchField) {
				var debuggerTools = getTopWindow().debuggerTools;
				if (debuggerTools) {
					if (!debuggerTools.isDebugPanelVisible())
						debuggerTools.showFieldWatcher();
					setWatchField(watchField);
				} else {
					debuggerTools = parent.parent.debuggerTools;
					if (debuggerTools) {
						if (!debuggerTools.isDebugPanelVisible())
							debuggerTools.showFieldWatcher();
						setWatchField(watchField);
					}
				}
			},
			processClientMessage : function(notification) {
				var opticsContext = this.opticsContextStack[this.opticsContextStack.length - 1];
				if (!opticsContext) {
					jslog("No optics context found");
					return;
				}
				var info = {
					type : 'CLIENT ',
					message : notification.message,
					message_type : "static",
					category : opticsContext.category,
					name : opticsContext.name,
					level : this.opticsContextStack.length,
					time : getFormattedTime(new Date()),
					call_trace : this._getCallTrace(this.opticsContextStack),
					sys_id : opticsContext["sys_id"],
					sourceTable: opticsContext["sourceTable"]
				};
				if (notification["oldvalue"] && notification["newvalue"]) {
					info.message_type = "change";
					info.oldvalue = notification["oldvalue"];
					info.newvalue = notification["newvalue"];
				}
				this.process(info);
			},
			processServerMessages : function() {
				var spans = $$('span[data-type="optics_debug"]');
				for (var i = 0; i < spans.length; i++) {
					var notification = new GlideUINotification({
						xml : spans[i]
					});
					this.processServerMessage(notification);
					spans[i].setAttribute("data-attr-processed", "true");
				}
			},
			processServerMessage : function(notification) {
				if (notification.getAttribute('processed') == "true")
					return;
				var info = {
					type : 'SERVER',
					category : notification.getAttribute('category'),
					name : notification.getAttribute('name'),
					message : notification.getAttribute('message'),
					message_type : notification.getAttribute('message_type'),
					oldvalue : notification.getAttribute('oldvalue'),
					newvalue : notification.getAttribute('newvalue'),
					level : notification.getAttribute('level'),
					time : notification.getAttribute('time'),
					sys_id : notification.getAttribute('sys_id'),
					sourceTable : notification.getAttribute('sourceTable'),
					call_trace : this._getCallTrace(eval(notification
							.getAttribute('call_trace')))
				};
				this.process(info);
			},
			process : function(notification) {
var msg = '<div class="debug_line ' + notification['category'] + '">' + this._getMessage(notification) + '</div>';
				this._log(msg);
			},
			addLine : function() {
this._log('<hr class="logs-divider"/>');
			},
			openScriptWindow : function(tablename, sysid) {
				if (tablename && sysid) {
					if (tablename == "request_action")
						tablename = "sys_ui_action";
var url = "/" + tablename + ".do?sys_id=" + sysid;
					window.open(url, "tablewindow");
				}
			},
			_log : function(msg) {
				var debuggerTools = getTopWindow().debuggerTools;
				if (debuggerTools && debuggerTools.isDebugPanelVisible()) {
					var wndw = debuggerTools.getJsDebugWindow();
					if (wndw.insertJsDebugMsg)
						wndw.insertJsDebugMsg(msg);
				} else {
					if(parent && parent.parent) {
						debuggerTools = parent.parent.debuggerTools;
						if (debuggerTools && debuggerTools.isDebugPanelVisible()) {
							var wndw = debuggerTools.getJsDebugWindow();
							if (wndw.insertJsDebugMsg)
								wndw.insertJsDebugMsg(msg);
						}
					}
				}
			},
			_getCallTrace : function(contextStack) {
				var trace = '';
var arrows = '<span class="rtl-arrow"> &larr;</span><span class="lrt-arrow">&rarr; </span>';
				var space = arrows;
				for (i = 0, maxi = contextStack.length; i < maxi; i++) {
					var context = contextStack[i];
					if (i > 0)
						space = arrows + space;
					if (context['name'] && context['name'].length > 0)
						trace += '<div>' + space
								+ this._getCategoryName(context['category'])
+ '&nbsp;-&nbsp;' + context['name'] + '</div>';
					else
						trace += '<div>' + space
								+ this._getCategoryName(context['category'])
+ '</div>';
				}
				if (trace && trace.length > 0)
trace = '<div class="call_trace">' + trace + '</div>';
				return trace;
			},
			_getMessage : function(notification) {
				var notif_type = notification['type'];
				var legend_title = (notif_type.indexOf('CLIENT') > -1) ? 'Client-side activity'
						: 'Server-side activity';
var msg = '<span class="expand-button" onclick="toggleCallTrace(this);">&nbsp;</span>';
msg += '<img class="infoIcon" height="16"  width="16" border="0" src="images/info-icon.png" title="'
						+ legend_title + '" alt="' + legend_title + '">';
				msg += '<span class="log-time ' + notif_type + '">'
+ notification['time'] + '</span>';
				msg += '<span class="log-category">'
						+ this.CATEGORIES[notification['category']];
				if (notification['name'] && notification['name'].length > 0) {
					if (notification["sys_id"])
						msg += '&nbsp;-&nbsp;<a data-tablename="'
								+ notification['sourceTable']
								+ '" data-sys_id="'
								+ notification['sys_id']
								+ '" onclick="javascript:openScriptWindow(this);">'
+ notification['name'] + '</a></span>';
					else
						msg += '&nbsp;-&nbsp;' + notification['name']
+ '</span>';
				} else
msg += '</span>';
				msg += '<span class="log-value">';
				if ("request_action" === notification['category']) {
					msg += 'Value received from client is: <span class="value" title="Value">'
+ notification['message'] + '</span>';
				} else if (notification["message_type"] == "change") {
					msg += '<span>'
							+ notification["oldvalue"]
+ '</span><span class="rtl-arrow"> &larr; </span><span class="lrt-arrow"> &rarr; </span><span>'
+ notification["newvalue"] + '</span>';
				} else {
					msg += notification['message'];
				}
msg += '</span>';
				msg += notification['call_trace'];
				return msg;
			},
			_getCategoryName : function(category) {
				var name = this.CATEGORIES[category];
				if (name === 'undefined' || name === null)
					name = category;
				return name;
			},
			_getLevelStr : function(level) {
				if (level == 'undefined' || level == null || level <= 0)
					level = 1;
				var levelStr = '';
				for (i = 0; i < level; i++)
					levelStr += '-';
				return levelStr + '>';
			},
			toString : function() {
				return 'OpticsInspector';
			}
		});
var g_optics_inspect_handler = new OpticsInspector();
OpticsInspector.WATCH_EVENT = 'glide:ui_notification.optics_debug';
OpticsInspector.WATCH_EVENT_UI = 'glide:ui_notification.optics_debug_ui';
OpticsInspector.WATCH_FIELD = 'glide_optics_inspect_watchfield';
OpticsInspector.SHOW_WATCH_FIELD = 'glide_optics_inspect_watchfield';
OpticsInspector.UPDATE_WATCH_FIELD = 'glide_optics_inspect_update_watchfield';
OpticsInspector.CLEAR_WATCH_FIELD = 'glide_optics_inspect_clear_watchfield';
OpticsInspector.SHOW_WATCH_FIELD = 'glide_optics_inspect_show_watchfield';
OpticsInspector.PUT_CONTEXT = 'glide_optics_inspect_put_context';
OpticsInspector.POP_CONTEXT = 'glide_optics_inspect_pop_context';
OpticsInspector.PUT_CS_CONTEXT = 'glide_optics_inspect_put_cs_context';
OpticsInspector.POP_CS_CONTEXT = 'glide_optics_inspect_pop_cs_context';
OpticsInspector.PUT_CONTEXT = 'glide_optics_inspect_put_context';
OpticsInspector.POP_CONTEXT = 'glide_optics_inspect_pop_context';
OpticsInspector.LOG_MESSAGE = 'glide_optics_inspect_log_message';
OpticsInspector.WINDOW_OPEN = 'glide_optics_inspect_window_open';
function getClientScriptContextName(name, type) {
	var csname = null;
	if (type === "submit")
		csname = g_event_handlers_onSubmit[name];
	else if (type === "load")
		csname = g_event_handlers_onLoad[name];
	else if (type === "change")
		csname = g_event_handlers_onChange[name];
	return csname;
}
CustomEvent.observe(OpticsInspector.PUT_CONTEXT, function(category, name, sys_id, sourceTable) {
	g_optics_inspect_handler.pushOpticsContext(category, name, sys_id, sourceTable);
});
CustomEvent.observe(OpticsInspector.POP_CONTEXT, function() {
	g_optics_inspect_handler.popOpticsContext();
});
CustomEvent.observe(OpticsInspector.PUT_CS_CONTEXT, function(name, type) {
	var csname = getClientScriptContextName(name, type);
	if (csname)
		g_optics_inspect_handler.pushOpticsContext("sys_script_client", csname,
				g_event_handler_ids[name]);
});
CustomEvent.observe(OpticsInspector.POP_CS_CONTEXT, function(name, type) {
	var csname = getClientScriptContextName(name, type);
	if (csname)
		g_optics_inspect_handler.popOpticsContext();
});
CustomEvent.observe(OpticsInspector.LOG_MESSAGE, function(notification) {
	if (g_optics_inspect_handler.isInspecting(notification["table"],
			notification["field"])) {
		g_optics_inspect_handler.processClientMessage(notification);
	}
});
CustomEvent.observe(OpticsInspector.WATCH_EVENT_UI, function(notification) {
	g_optics_inspect_handler.process(notification);
});
CustomEvent.observe(OpticsInspector.WATCH_EVENT, function(notification) {
	g_optics_inspect_handler.processServerMessage(notification);
});
CustomEvent.observe(OpticsInspector.WATCH_FIELD, function(watchfield) {
	g_optics_inspect_handler.setWatchField(watchfield);
});
CustomEvent.observe(OpticsInspector.SHOW_WATCH_FIELD, function(watchfield) {
	g_optics_inspect_handler.showWatchField(watchfield);
});
CustomEvent.observe(OpticsInspector.CLEAR_WATCH_FIELD, function(watchfield) {
	g_optics_inspect_handler.clearWatchField(watchfield);
});
CustomEvent.observe(OpticsInspector.UPDATE_WATCH_FIELD, function(watchfield) {
	g_optics_inspect_handler.setWatchField(watchfield);
if (window.name !== "jsdebugger") {
		g_optics_inspect_handler.addLine();
		g_optics_inspect_handler.processServerMessages();
	}
});
;
/*! RESOURCE: scripts/labels.js */
var refreshRateProperty = "60";
var refreshLabelRate = (refreshRateProperty != null && refreshRateProperty > 0? refreshRateProperty : 60);
var refreshLabelTimer = null;
var g_label_status = initLabelStatus();
CustomEvent.observe('nav.loaded', refreshLabels);
function initLabelStatus() {
	var answer = new Object();
	answer.loading = false;
answer.error_count = 0;
	return answer;
}
function refreshLabels() {
	var labelList = new Array();
	var divTags = document.getElementsByTagName('div');
	if (divTags) {
		for(var c=0;c != divTags.length; ++c) {
			var divTag = divTags[c];
    		var label = divTag.sclabel || divTag.getAttribute('sclabel');
    		if (label && label == 'true') {
    			var id = divTag.appid || divTag.getAttribute('appid');
				labelList.push(id);
    		}
		}
	}
    startRefresh(labelList);
}
function clearLabelRefresh() {
	if (refreshLabelTimer == null)
	    return;
	clearTimeout(refreshLabelTimer);
	refreshLabelTimer = null;
}
function startRefresh(labelRefresh) {
	clearLabelRefresh();
	if (labelRefresh.length < 1)
		return;
	if (labelsGetRequest(labelRefresh))
		refreshLabelTimer = setTimeout(refreshLabels, refreshLabelRate * 1000);
}
function labelsGetRequest(labelIds) {
if (g_label_status.loading)
return true;
if (g_label_status.error_count > 3) {
	    jslog('Stopped tag fetch due to excessive error counts');
return false;
	}
	g_label_status.loading = true;
	var aj = new GlideAjax("LabelsAjax");
	aj.addParam("sysparm_value", labelIds.join(","));
	aj.addParam("sysparm_type", 'get');
	aj.getXML(labelsGetResponse);
	return true;
}
function labelsGetResponse(request) {
	g_label_status.loading = false;
	if (request.status == 200)
		g_label_status.error_count = 0;
	else
		g_label_status.error_count += 1;
	if (!request.responseXML)
		return;
	var labels = request.responseXML.getElementsByTagName("label");
	if (labels && labels.length > 0 ) {
		for (var i = 0; i < labels.length; i++) {
			var labelEntry = labels[i];
			updateMenuItems(labelEntry);
		}
	}
}
function updateMenuItems(labelElement) {
	var appid = labelElement.getAttribute("id");
	var divElem = gel('div.' + appid)
	var tds = divElem.getElementsByTagName("td");
	var appTD = tds[0];
    var notRead = 0;
    var span = gel(appid);
    var table = cel("table");
	var tbody = cel("tbody", table);
    var label;
    var items = labelElement.getElementsByTagName("item");
	if (items && items.length > 0 ) {
		for (var i=0; i < items.length; i++) {
		    label = items[i].getAttribute("label");
			var lid = items[i].getAttribute("name");
			var style = items[i].getAttribute("style");
			var read = items[i].getAttribute("read");
			if ("true" != read)
			   notRead++;
			var url = items[i].getAttribute("url");
			var title = items[i].getAttribute("title");
			var image = items[i].getAttribute("image");
			createLabelMod(tbody, style, lid, url, title, image, appid);
		}
	}
	updateLabelReadCount(appTD, notRead);
	clearNodes(span)
    span.appendChild(table);
	table = null;
}
function createLabelMod(parent, style, id, url, title, image, appid) {
    var tr = cel("tr", parent);
var scrollIcon = isTextDirectionRTL() ? "images/scroll_lft.gifx" : "images/scroll_rt.gifx";
if (image == "images/s.gifx")
		image = scrollIcon;
    var img;
	if (image == null || image == '')
img = '<img style="width:16px; cursor:hand" src="images/icons/remove.gifx" alt="Click me to remove the tag entry" onmouseover="this.src = \'images/closex_hover.gifx\'" onmouseout="this.src = \'images/icons/remove.gifx\'" src="images/icons/remove.gifx"/>';
	else
img = "<img style='width:16px' src='"+image+"' alt='' />";
	var tdimg = cel("td", tr);
	tdimg.style.width = "16px";
	var tdhtml;
	if (image == scrollIcon)
		tdhtml = img;
	else
tdhtml = '<a onclick="removeLabel(\'' + appid + '\',\'' + id + '\');" onmouseover="this.src = \'images/closex_hover.gifx\'" onmouseout="this.src = \'images/icons/remove.gifx\'" title="Click me to remove the tag entry">' + img+'</a>';
	tdimg.innerHTML = tdhtml;
	var td = cel("td", tr);
	var html = '<a class="menulabel" style="' + style + '" id= "' + id + '"';
html += ' target="gsft_main" href="' + url +'">'+ title +'</a>';
	td.innerHTML = html;
	tr = null;
	tdimg = null;
	td = null;
}
function updateLabelReadCount(appTD, notRead) {
	var inner = appTD.innerHTML;
var term = '</H2>';
var paren = inner.indexOf("</H2>");
	if (paren < 0) {
paren = inner.indexOf("</h2");
term = '</h2>';
	}
	if (paren > -1 ) {
	  inner = inner.substring(0, paren);
	  paren--;
	  var c = inner.substring(paren,paren+1);
	  if (c == ')') {
	     while (paren > 0 && c != '(') {
	        paren--;
	        c = inner.substring(paren,paren+1)
	     }
	     if (paren > 0 ) {
	        inner = inner.substring(0, paren);
	     }
	  }
	  inner = inner.trim();
	  if (notRead > 0)
	    inner = inner + ' (' + notRead + ')';
	  inner = inner + term;
	  clearNodes(appTD);
	  appTD.innerHTML = inner;
	}
}
function doAssignLabel(tableName, label, sysId) {
	var form = getFormByTableName(tableName);
	if (sysId == null || !sysId) {
		if (!populateParmQuery(form, '', 'NULL'))
			return false;
	} else {
addInput(form, 'HIDDEN', 'sysparm_checked_items', sysId);
	}
	if (!label && typeof option != 'undefined' && option.getAttribute("gsft_base_label"))
		label = option.getAttribute("gsft_base_label");
	addInput(form, 'HIDDEN', 'sys_action', 'java:com.glide.labels.LabelActions');
	addInput(form, 'HIDDEN', 'sys_action_type', 'assign_label');
	addInput(form, 'HIDDEN', 'sysparm_label_picked', label);
	form.submit();
}
function doRemoveLabel(tableName, label, sysId) {
	var form = getFormByTableName(tableName);
	if (sysId == null || !sysId) {
		if (!populateParmQuery(form, '', 'NULL'))
			return false;
	} else {
addInput(form, 'HIDDEN', 'sysparm_checked_items', sysId);
	}
	if (!label && typeof option != 'undefined' && option.getAttribute("gsft_base_label"))
		label = option.getAttribute("gsft_base_label");
	addInput(form, 'HIDDEN', 'sys_action', 'java:com.glide.labels.LabelActions');
	addInput(form, 'HIDDEN', 'sys_action_type', 'remove_label');
	addInput(form, 'HIDDEN', 'sysparm_label_picked', label);
	form.submit();
}
function assignLabelActionViaLookupModal(tableName, listId) {
	var list = GlideList2.get(listId);
	if (!list)
		return;
	var sysIds = list.getChecked();
	if (!sysIds)
		return;
	assignLabelViaLookup(tableName, sysIds, list.getView());
}
function assignLabelViaLookup(tableName, sysId, viewName) {
	var assignCallback = function (labelId) {
		assignLabel(labelId, tableName, sysId, viewName);
	};
	showLabelLookupWindow("Assign Tag", tableName, sysId, assignCallback);
}
function removeLabelActionViaLookupModal(tableName, listId) {
	var list = GlideList2.get(listId);
	if (!list)
		return;
	var sysIds = list.getChecked();
	if (!sysIds)
		return;
	removeLabelViaLookup(tableName, sysIds);
}
function removeLabelViaLookup(tableName, sysId) {
	var removeCallback = function (labelId) {
		removeLabelById(labelId, sysId);
	};
	showLabelLookupWindow("Remove Tag", tableName, sysId, removeCallback);
}
function showLabelLookupWindow(actionName, tableName, sysID, callback) {
	var tagLookupForm = new GlideDialogWindow("tag_lookup_form");
	tagLookupForm.setTitle(actionName);
	tagLookupForm.setPreference("sys_ids", sysID);
	tagLookupForm.setPreference("table_name", tableName);
	tagLookupForm.setPreference('on_accept', callback);
	tagLookupForm.removeCloseDecoration();
	tagLookupForm.render();
}
function newLabel(tableName, sysID,  callback,  focusTrap) {
	var isDoctype = document.documentElement.getAttribute("data-doctype") == "true";
	if (isDoctype) {
		var tagForm = new GlideDialogWindow("tag_form");
		tagForm.setTitle(getMessage('Tag Details'));
		tagForm.setPreference("sys_ids", sysID);
		tagForm.setPreference("table_name", tableName);
		tagForm.removeCloseDecoration();
		tagForm.render();
		if (focusTrap) {
			$j('#tag_form').on('ft-ready', function() {tagForm.enableFocusTrap();});
			$j('#tag_form').on('select2-open', function() {tagForm.disableFocusTrap();});
			$j('#tag_form').on('select2-close', function() {tagForm.enableFocusTrap();});
		}
	} else {
		var keys = ["Please enter the name for the new tag", "New tag"];
		var msgs = getMessages(keys);
		if (!callback)
			gsftPrompt(msgs["New tag"], msgs["Please enter the name for the new tag"],  function(labelName) { newLabelRequest(tableName, labelName, sysID)} );
		else
			gsftPrompt(msgs["New tag"], msgs["Please enter the name for the new tag"],  callback);
	}
}
function newLabelRequest(tableName, labelName, sysID) {
	if (labelName == null)
		return;
	var viewName;
	var view = gel('sysparm_view');
	if (view != null)
		viewName = view.value;
	assignLabel(labelName, tableName, sysID, viewName);
}
function assignLabel(labelName, tableName, sysId, viewName) {
    if (!labelName)
        return;
	var url = new GlideAjax("LabelsAjax");
	url.addParam("sysparm_name", tableName);
	url.addParam("sysparm_value", sysId);
	url.addParam("sysparm_chars", labelName);
	url.addParam("sysparm_type", "create");
	if (viewName)
		url.addParam("sysparm_view", viewName);
	url.getXML(function(){ reloadWindow(window); });
}
function removeLabel(appid, labelid) {
	var aj = new GlideAjax("LabelsAjax");
	aj.addParam("sysparm_name", appid);
	aj.addParam("sysparm_value", labelid);
	aj.addParam("sysparm_type", 'delete');
	aj.getXML(removeLabelResponse);
}
function removeLabelByName(labelName, sysId) {
	var aj = new GlideAjax("LabelsAjax");
	aj.addParam("sysparm_name", labelName);
	aj.addParam("sysparm_value", sysId);
	aj.addParam("sysparm_type", 'removeByName');
	aj.getXML(function(){ reloadWindow(window); });
}
function removeLabelById(labelId, sysId) {
	var aj = new GlideAjax("LabelsAjax");
	aj.addParam("sysparm_name", labelId);
	aj.addParam("sysparm_value", sysId);
	aj.addParam("sysparm_type", 'remove');
	aj.getXML(refreshNavIfNotDoctypeUI);
}
function removeLabelResponse(response, args) {
  	var labelId = response.responseXML.documentElement.getAttribute("sysparm_name");
   	if (!labelId)
		refreshNavIfNotDoctypeUI();
	else {
		var labelIds = new Array();
		labelIds.push(labelId);
		labelsGetRequest(labelIds);
	}
}
function newLabelPromptListAction(tableName, listId) {
	var nonDoctypeUICallback = function (labelName) { assignLabelToCheckedSysIds(labelName, tableName, listId) };
	var list = GlideList2.get(listId);
	if (!list)
		return;
	var sysIds = list.getChecked();
	if (!sysIds)
		return;
	newLabel(tableName, sysIds, nonDoctypeUICallback, true);
}
function assignLabelToCheckedSysIds(labelName, tableName, listId) {
    if (!labelName || labelName.strip() == '')
        return;
    var list = GlideList2.get(listId);
    if (!list)
        return;
    var sysIds = list.getChecked();
    if (!sysIds)
        return;
    assignLabel(labelName, tableName, sysIds, list.getView());
}
function removeLabelFromCheckedSysIds(labelName, listId) {
    var list = GlideList2.get(listId);
    var sysIds = list.getChecked();
    if (!sysIds)
        return;
    removeLabelByName(labelName, sysIds);
}
function getFormByTableName(tableName) {
	var form = getControlForm(tableName);
	if (!form)
		form = document.forms[tableName + '.do'];
	return form;
}
function refreshNavIfNotDoctypeUI() {
	var isDoctype = document.documentElement.getAttribute("data-doctype") == "true";
	if (!isDoctype)
		refreshNav();
}
;
/*! RESOURCE: scripts/SNCredStoreFormUtil.js */
var SNCredStoreFormUtil = {
	mandatoryFieldMap: {
		name: 'Name',
		type: 'Type'
	},
	
	validateMandatoryFields: function() {
		var unfilledMandatoryFields = [];
		
		for (var key in this.mandatoryFieldMap) {
			g_form.hideErrorBox(key);
			if (!g_form.getValue(key)) {
				g_form.showErrorBox(key, this.mandatoryFieldMap[key] + " is required");
				unfilledMandatoryFields.push(this.mandatoryFieldMap[key]);
			}	
		}
		
		if (unfilledMandatoryFields.length > 0)
			g_form.addErrorMessage(g_scratchpad.unfilledMandatoryFieldsMsg + unfilledMandatoryFields.join());
		
		return unfilledMandatoryFields;
	},
		
	isValidHistoryLimit: function() {
		var limit;
		
		if (g_form.getBooleanValue('enforce_history_policy')) {
			limit = this.getPwdHistoryLimit();
			if (limit === -1) {
				g_form.addErrorMessage(g_scratchpad.mandatoryHistoryParamMsg);
				return false;
			}
		}
		
		return true;
	},
	
	_showHistoryLimitConfirmation: function(newLimit, oldLimit, action) {
		var modal = new GlideModal('pwd_history_change_confirmation');
		modal.setTitle('Confirmation');
		modal.setPreference('sysparm_old_limit', oldLimit);
		modal.setPreference('sysparm_new_limit', newLimit);
		modal.setPreference('sysparm_action', action);
		modal.setPreference('sysparm_conf_type', 'limit_decrease_confirmation');
		modal.setWidth(350);
		modal.render();
	},
	
	_showEnforceHistoryUncheckConfirmation: function(action) {
		var modal = new GlideModal('pwd_history_change_confirmation');
		modal.setTitle('Confirmation');
		modal.setPreference('sysparm_action', action);
		modal.setPreference('sysparm_conf_type', 'history_uncheck_confirmation');
		modal.setWidth(350);
		modal.render();
	},
		
	getPwdHistoryLimit: function() {
		var list = GlideList2.getListsForTable('pwd_cred_store_param')[0];
		
		if (list) {
			var numRows = list.table.rows.length;
			for (var i = 1; i < numRows-1; i++) {
				var curRow = list.table.rows[i];
				var paramId  = curRow.getAttribute('sys_id');
				var paramName = list.getCell(paramId, 'name').textContent;
				
				if (paramName == 'password_history_limit') {
					if (curRow.className.indexOf("list_delete") > 0) {
						return -1;
					}
						
					if (list.getCell(paramId, 'value').textContent)
						return parseInt(list.getCell(paramId, 'value').textContent);
					
					return -1;
				}
			}	
		}
		return -1;
	},
	
	save: function() {
		this.saveOrSubmit("save");
	},
	
	update: function() {
		this.saveOrSubmit("submit");
	},
	
	saveOrSubmit: function(action) {
		if (!action)
			action = "submit";
		
		var hasIssues = false;
		if (this.validateMandatoryFields().length > 0) {
			hasIssues = true;
			return;
		}	
		
		if (!g_form.getBooleanValue('enforce_history_policy') && g_scratchpad.cur_enforce_history_policy) {
			hasIssues = true
			this._showEnforceHistoryUncheckConfirmation(action);
		}
		
		if (g_form.getBooleanValue('enforce_history_policy')) {
			if (!this.isValidHistoryLimit()) {
				hasIssues = true;
				return;
			}	
			
			var newLimit = this.getPwdHistoryLimit();
			var oldLimit = g_scratchpad.cur_password_history_limit;
			
			if (newLimit < oldLimit) {
				hasIssues = true;
				this._showHistoryLimitConfirmation(newLimit, oldLimit, action);
			}	
		}
		
		if (!hasIssues) {
			if (action == "submit") {
				gsftSubmit(null, g_form.getFormElement(), "sysverb_update");
				return;
			}
			
			gsftSubmit(null, g_form.getFormElement(), "sysverb_update_and_stay");
		}	
	}
};
;
/*! RESOURCE: scripts/TestClient.js */
function popTestClient(test_definition, test_subject) {
	var test_execution;
	if (!test_subject) 
		test_execution = test_definition;
		
	var dialog = new GlideDialogWindow('test_client', false, "50em", "25em");
	if (test_execution) {
		dialog.setPreference('sysparm_test_execution', test_execution);
	} else {
		dialog.setPreference('sysparm_test_definition', test_definition);
		dialog.setPreference('sysparm_test_subject', test_subject);
	}
	
	dialog.render();
}
var TestClient = Class.create();
TestClient.prototype = {
	TEST_STATES : [ "Pending", "Running", "Succeeded", "Failed" ],
STATUS_IMAGES : [ "images/workflow_skipped.gif",
"images/loading_anim2.gifx", "images/workflow_complete.gifx",
"images/workflow_rejected.gifx" ],
	TRANSLATED_TEXT : [ "Pending", "Running", "Succeeded", "Failed",
			"Details", "more", "Hide Details", "Show Details" ],
TIMEOUT_INTERVAL : 1000,
	translator : new GwtMessage(),
	detailStates : {},
	id : "",
	container : null,
	initialize : function(test_definition, test_subject) {
		this.container = $("container");
		this._setContainerStyles(this.container);
		this.translator.getMessages(this.TRANSLATED_TEXT);
		
		var test_execution;
		if (!test_subject) {
			this.id = test_definition
			return
		}
		this.testDefinition = test_definition;
		this.testSubject = test_subject;
		
	},
	start : function() {
		if (this.id) {
			this.getStatus();
			return;
		}
		var ga = new GlideAjax('AJAXTestProcessor');
		ga.addParam('sysparm_name', 'startTest');
		ga.addParam('sysparm_test_definition', this.testDefinition);
		ga.addParam('sysparm_test_subject', this.testSubject);
		ga.getXML(this.handleStart.bind(this));
	},
	handleStart : function(response) {
		this.id = response.responseXML.documentElement.getAttribute("answer");
		this.getStatus();
	},
	getStatus : function() {
		var ga = new GlideAjax('AJAXTestProcessor');
		ga.addParam('sysparm_name', 'getStatus');
		ga.addParam('sysparm_execution_id', this.id);
		if (typeof this.id != "string" || this.id == "")
			return;
		ga.getXML(this.handleGetStatus.bind(this));
	},
	handleGetStatus : function(response) {
		var answer = response.responseXML.documentElement.getAttribute("answer");
		eval("var so = " + answer);
		this.renderStatus(so);
		this.container = $("container");
		if (this.container == null)
			return;
		if (so.state == "0" || so.state == "1")
			setTimeout(this.getStatus.bind(this), this.TIMEOUT_INTERVAL);
	},
	renderStatus : function(so) {
		if (!so)
			return;
		var new_container = new Element("div");
		this._setContainerStyles(new_container);
		new_container.appendChild(this.getStatusRow(so));
		this.container.replace(new_container);
		this.container = new_container;
	},
	getStatusRow : function(obj, order) {
		var name = obj.name;
		var state = obj.state;
		var message = obj.message;
		var percent = NaN;
		if (obj.percent_complete) {
			percent = parseInt(obj.percent_complete);
		}
		var hasPercent = (!isNaN(percent) && percent > 0 && percent <= 100);
		var hasDetails = (obj.results.length >= 1 || message != "");
		var tr = new Element("div", {
			id : "row_container-" + obj.sys_id
		});
		tr.style.padding = "5px";
		var simp = new Element("div");
		simp.appendChild(this._getImage(obj));
		simp.appendChild(this._getItemTitleElement(name, order));
		var det = this._getDetailElement();
		var dtl;
		if (hasDetails || hasPercent)
			dtl = det.appendChild(this._getShowDetailsLink(obj.sys_id));
		
		simp.appendChild(det);
		simp.appendChild(this._getFloatClear("both"));
		tr.appendChild(simp);
		
		if (hasDetails || hasPercent) {
			var dtd = new Element("div");
			var ddc = new Element("div");
			ddc.style.marginTop = ".5em";
			ddc.style.marginLeft = "30px";
			ddc.id = "detail_cont-" + obj.sys_id;
			dtd.appendChild(ddc);
			if (hasPercent) {
				ddc.appendChild(this._getProgressBar(percent));
				ddc.appendChild(this._getFloatClear("both"));
			}
			if (message != "") {
				var dds = new Element("div");
				dds.appendChild(this._getDetailsText(message, obj));
				dds.style.fontSize = "smaller";
				dds.style.marginBottom = ".5em";
				ddc.appendChild(dds);
			}
			dtl.details_container = ddc;
			if (typeof this.detailStates[obj.sys_id] == "boolean" && this.detailStates[obj.sys_id] == false && dtl != null)
				dtl.onclick();
			
			tr.appendChild(dtd);
			this.renderChildren(obj, ddc);
		}
		return tr;
	},
	_getItemTitleElement : function (name, order) {
var nameHtml = "<b>" + name + "</b>";
		if (order) {
			nameHtml = "\t" + order + ".\t" + nameHtml;
		}
		var nsp = new Element("span");
		nsp.innerHTML = nameHtml;
		nsp.style.float = "left";
		return nsp;
	},
	_getImage : function(obj) {
		var state = obj.state;
		var si = new Element("img");
		si.id = "img-" + obj.sys_id;
		si.src = this.STATUS_IMAGES[state];
		si.style.marginRight = "10px";
		si.style.float = "left";
		si.title = this.TEST_STATES[state];
		return si;
	},
	_getDetailElement : function () {
		var det = new Element("span");
		det.style.marginLeft = "10px";
		det.style.float = "left";
		return det;
	},
	_getShowDetailsLink : function(objSysID) {
		var da = new Element("a");
		da.id = objSysID;
		da.controller = this;
		da.innerHTML = "(" + this.translator.getMessage("Hide Details") + ")";
		da.toggleText = "(" + this.translator.getMessage("Show Details") + ")";
		da.style.fontSize = "8pt";
		da.style.float = "left";
		da.onclick = this.__detailsToggle;
		return da;
	},
	__detailsToggle : function() {
		var cont = this.details_container;
		cont.toggle();
		this.controller.detailStates[this.id] = cont.visible();
		var nt = this.toggleText;
		this.toggleText = this.innerHTML;
		this.innerHTML = nt;
	},
	_getDetailsText : function(message, obj) {
		if (message.length > 150) {
			var new_message = new Element("span");
			new_message.innerHTML = "<b>"
+ this.translator.getMessage("Details") + ": </b>"
					+ message.slice(0, 150) + "... ";
			var anch = new Element("a");
			anch.href = "test_execution.do?sys_id=" + obj.sys_id;
			anch.innerHTML = "<b>(" + this.translator.getMessage("more")
+ ")</b>";
			new_message.appendChild(anch);
			return new_message;
		} else {
			var new_message = new Element("span")
			new_message.innerHTML = "<b>"
+ this.translator.getMessage("Details") + ": </b>"
					+ message;
			return new_message;
		}
	},
	_getProgressBar : function (percent) {
		percent = Math.max(0, Math.min(100, percent));
		var progressContainer = new Element("div");
		progressContainer.style.width = "300px";
		progressContainer.style.height = "8px";
		progressContainer.style.border = "1px solid black";
		progressContainer.style.borderRadius = "10px";
		progressContainer.style.padding = "2px";
    	progressContainer.style.marginTop = "2px";
    	progressContainer.style.marginBottom = "2px";
    	progressContainer.style.float = "left";
		var progressBar = new Element("div");
		progressBar.style.width = percent + "%";
		progressBar.style.height = "100%";
		progressBar.style.borderRadius = "10px";
		progressBar.style.backgroundColor = "#667788";
		progressContainer.appendChild(progressBar);
		return progressContainer;
	},
	_getFloatClear : function (which) {
		var br = new Element("br");
		br.style.clear = which;
		return br;
	},
	renderChildren : function(so, pr_cont) {
		if (!so.results)
			return;
		for ( var i = 0; i < so.results.length; i++) {
			pr_cont.appendChild(this.getStatusRow(so.results[i], i + 1)).style.marginLeft = "15px";
		}
	},
	_setContainerStyles : function(container) {
		container.id = "container";
		container.style.overflowY = "auto";
		container.style.maxHeight = "50em";
		container.style.marginRight = ".25em";
		container.style.marginLeft = ".25em";
	},
	type : 'TestClient'
};
;
/*! RESOURCE: scripts/Uploader.js */
var Uploader = Class.create({
	
    initialize: function(containerName, tableName, sys_id) {
        this.containerName = containerName;
this.height = 20;
        this._createInput();
        this.sys_id = sys_id;
        this.tableName = tableName;
this.fieldName;
this.callback;
Event.observe(window, 'unload', this._reset.bind(this));
this.startLoading;
        this.tempSpot;
        this.mouseDown = false;
	},
    
    setCallback: function(fDefinition) {
        this.callback = fDefinition;
    },
    
    setStartLoading: function(fDefinition) {
      this.startLoading = fDefinition;  
    },
    
    setFieldName: function(fieldName) {
        this.fieldName = fieldName;
    },
    
    setTitle: function(title) {
        this.input.title = title;        
    },
    
    setHeight: function(height) {
        if (this.height == height) 
            return; 
            
        this.height = height;
        this.input.parentNode.removeChild(this.input);
delete(this.input);
        this._createInput();            
	},
	
    _createInput: function() {
        var parent = this.containerName;
        if (this.tempSpot)
            parent = this.tempSpot;
        
        parent = $(parent);
        this.input = new Element("input");
        var input = this.input;
        input.setAttribute("type", "file");
        input.className = "upload_input_file";
        input.name = this.containerName + "_input_file";        	
        input.setStyle({
            display: 'inline',
        	height: this.height + "px",
        	width: this.height + "px",
        	fontSize: this.height + "px",
        	opacity: "0 !important",
        	filter: "alpha(opacity=0) !important",
        	cursor: "pointer !important",
        	zIndex: (isMSIE7) ? "100" : "100 !important"
        });
        
        Event.observe(input, 'change', this._onFileChange.bind(this, input));
        parent.appendChild(input);
    },
    _onFileChange: function(input) {
        if (this.startLoading)
            this.startLoading.call();   
              
        var iframe = this._createIFrame();
        var form = this._createForm();
        form.appendChild(this.input);
        Event.observe(iframe, 'load', this._uploaded.bind(this));
        form.submit();
    },
    
    _uploaded: function() {
        var f = this.iframe;
        var doc = null; 
        if (isMSIE)
            doc = f.contentWindow.document.XMLDocument ? f.contentWindow.document.XMLDocument : f.contentWindow.document;
        else
            doc = f.contentDocument;
        var root = doc.documentElement;
        if (this.callback) {
            var uri = root.getAttribute('attachment_uri');
            var name = root.getAttribute('file_name');
            var sys_id = root.getAttribute('sys_id');
            this.callback.call(this, uri, name, sys_id);            
        }
        
        this.form.parentNode.removeChild(this.form);
        delete this.form;
        this.form = null;
        
        var iframe = this.iframe;
        this.iframe = null;
        setTimeout(function(){ 
          iframe.parentNode.removeChild(iframe);
          delete iframe; 
        }, 1000);
        
        this._createInput();
    },
    
    _createIFrame: function() {
       var name = this.containerName + "_iframe";
var s = "<iframe src='javascript: false' name='" + name + "'/>";
       this.iframe = toElement(s);
       this.iframe.style.display = 'none';
       this.iframe.style.position = 'absolute';
       this.iframe.style.left = '-999px';
       document.body.appendChild(this.iframe);
       return this.iframe;
    },
    
    _createForm: function() {
        this.containerName + "_form";
var s = "<form method='post' enctype='multipart/form-data' name='" + this.containerName + "' ></form>";
    	var form = toElement(s)
        this._addInput(form, "sysparm_table", this.tableName);
        this._addInput(form, "sysparm_xml", "true");
        if (this.fieldName)
            this._addInput(form, "sysparm_fieldname", this.fieldName);
        
        this._addInput(form, "sysparm_sys_id", this.sys_id);
        if (typeof g_ck != 'undefined')
	        this._addInput(form, "sysparm_ck", g_ck);
        
        form.setAttribute("action", "sys_attachment.do"); 
        form.setAttribute("target", this.containerName + "_iframe");
        form.style.display = 'none';
	    form.style.position = 'absolute';
	    form.style.left = '-999px';
        this.form = form;
        document.body.appendChild(this.form);
        return form;
    },
    
    _addInput: function(form, name, value) {
        var input = cel("input");
        input.value = value;
        input.name = name;
        form.appendChild(input);
    },
	
	_reset: function() {
		this.input = null;
	},
    
    moveInputTo: function(elementName) {
        this.tempSpot = elementName;
        if (elementName == null)
elementName = this.containerName;
        
        var input = this.input;
        var p = input.parentNode;
        var parent = gel(elementName);
        if (p == parent)
            return; 
            
        input.parentNode.removeChild(input);
        parent.appendChild(input);
    },
    
	toString: function() { return 'Uploader'; }
});
function toElement(innerHTML) {
    var div = cel('div');
    div.innerHTML = innerHTML; 
    var element = div.firstChild;
    div.removeChild(element);
    return element;
}
;
/*! RESOURCE: scripts/ImageUploader.js */
var ImageUploader = Class.create(Uploader, {
	initialize: function($super, containerName, tableName, sys_id) {
	    $super(containerName, tableName, sys_id);
	},
	
	_onFileChange: function($super, input) {
		if (!this._isFileNameValid(input.value)) 
            return; 
         
        $super(input);      
    },
	
	_isFileNameValid: function(filename) {
		if (endsWithImageExtension(filename)) 
			return true;
            
		var message = getMessage('Name is not a recognized image file format');
		alert(message);
		return false;
	}
});
;
/*! RESOURCE: scripts/spell.js */
var TAG_DIV			= "div";
var TAG_SPAN		= "span";
var TAG_FORM		= "form";
var TAG_TEXTAREA	= "textarea";
var TAG_INPUT		= "input";
var TAG_A			= "a";
var SMENU_TAG		= "_suggestmenu";
var DISPLAY_TAG		= "_display";
var MENU_BGCOLOR	= "#DDDDDD";
var HTML_TEXT		= 0;
var FLAT_TEXT		= 1;
var POSITION		= 0;
var WORD 			= 1;
var SETWORD 		= 2;
var MODE 			= 3;
var SUGGESTS		= 4;
var TEXT_MODE		= 0;
var BOX_MODE		= 1;
var ITEM_HEIGHT		= 16;
var FONT_SIZE		= 9;
var FONT_FACE		= "Arial";
var PREVIEW_BORDER	= 1;
var PREVIEW_PADDING	= 2;
var SUGGEST_TOP_BORDER	= 3;
var SUGGEST_BOT_BORDER	= 2;
var mods		= new Array();
var originalSpellValue = new Array();
var keys = ["Checking...", "Resume", "Resume editing", "No misspellings found"];
var processing = false;
function spellCheck(elementName) {
	var msgs = getMessages(keys);
	var linkName = "link." + elementName;
	var link = getObjectByName(linkName, TAG_A);
	var textField = getObjectByName(elementName, TAG_TEXTAREA);
	if (textField == null)
	   textField = getObjectByName(elementName, TAG_INPUT);
	textField.parentNode.onsubmit = saveAllChanges;
	
	if (!link.savedHTML)
		link.savedHTML = link.innerHTML;
	
	setStatus(linkName, msgs["Checking..."]);
	jslog("element:  " + elementName);
	
	
	if (!textField.mode) {
		if (!processing)
			grabSpellData(elementName, textField, linkName, msgs);
	} else {
		var previewDiv = getObjectByName(elementName + DISPLAY_TAG, TAG_DIV);
		setStatus(linkName, "");
		textField.mode = 0;
		updateTextBox(elementName);
		hideDiv(previewDiv);
		hideAllMenus();
		delete originalSpellValue[elementName];
	}
}
function displaySpellText(elementName) {
	var sDiv = getObjectByName(elementName + DISPLAY_TAG, TAG_DIV);
	var textField = getObjectByName(elementName, TAG_TEXTAREA);
	if (textField == null)
	   textField = getObjectByName(elementName, TAG_INPUT);  
	     
	var scroll = 'auto';
    if (textField.tagName == 'INPUT')
       scroll = 'visible';
    
	if (!sDiv) {
		sDiv = createEditDiv(elementName + DISPLAY_TAG, textField, scroll);
		addChild(sDiv);
	}
	var displayText = buildDisplayText(elementName, HTML_TEXT);
	sDiv.innerHTML = "<pre wrap='wrap' style=\"" +
			"margin-top: 0px; margin-bottom: 0px; " + 
			"font-family: " + FONT_FACE + "; " + 
			"white-space: pre-wrap; " +
			"word-wrap: break-word; " +
			"font-size: " + FONT_SIZE + "pt;" +
"\">" + displayText + "</pre>";
    saveAllChanges(); 
	showDiv(sDiv);
}
function buildDisplayText(elementName, flatText) {
	var rText;
	var prevPos = 0;
	var curPos = 0;
	var spellCheckText = new Array();
	var textField = getObjectByName(elementName, TAG_TEXTAREA);
	if (textField == null)
	   textField = getObjectByName(elementName, TAG_INPUT);
    var baseText = textField.value;
	for(var zo = 0; zo < mods[elementName].length; zo++) {
		var mod = mods[elementName][zo];
		var zPos = mod[POSITION];
		var zWord = mod[WORD];
		var zSetWord = mod[SETWORD];
		var zMode = mod[MODE];
		var fName = buildRefID(elementName, zPos);
		if (zPos > 0) {
			spellCheckText.push(baseText.substring(prevPos, zPos));
			curPos += zPos - prevPos;
		}
		if (flatText) {
		    if (zMode == BOX_MODE) {
				var iField = getObjectByName(fName, TAG_INPUT);
				spellCheckText.push(iField.value);
				mod[WORD] = iField.value;
				mod[POSITION] = curPos;
		    } else {
				spellCheckText.push(zSetWord);
				mod[WORD] = zSetWord;
				mod[POSITION] = curPos;
		    }
		} else {
		    if (zMode == BOX_MODE) {
		    	var iField = getObjectByName(fName, TAG_INPUT);
	            if (iField)
	                    zSetWord = iField.value;
				spellCheckText.push("<input type=input " +
					"id=\"" + fName + "\" name=\"" + fName + "\" " +
					"style=\"font-weight: bold; font-family: " + FONT_FACE + 
					"; font-size: " + FONT_SIZE +
					"pt; color: black;\"" +
					"value=\"" + zSetWord + "\" " +
					"size=" + ((zWord.length < 4 ? 4 : zWord.length - 2)) + ">");
		    } else {
				spellCheckText.push("<a " +
					"id=\"" + fName + "\" name=\"" + fName + "\" " +
					"style=\"color: " +
					(zWord == zSetWord ? "red" : "green") +
					"; font-weight: bold;\" onclick=\"showSuggestions(" +
					zo + ", '" + fName +
"', '" + elementName + "');Event.stop(event);\">" + zSetWord + "</a>");
		    }
		}
		prevPos = parseInt(zPos) + (zWord.length);
		curPos += mod[WORD].length;
	}
	spellCheckText.push(baseText.substring(prevPos));
	rText = spellCheckText.join("")
	return rText;
}
function buildRefID(elementName, position) {
	return elementName + "_pos_" + position;
}
function hideDiv(theDiv) {
	if (theDiv)
		theDiv.style.visibility = "hidden";
}
function showDiv(theDiv) {
	if (theDiv)
		theDiv.style.visibility = "visible";
}
function createEditDiv(id, field, overflow) {
	var menu = document.createElement(TAG_DIV);
	menu.id = id;
	menu.name = id;
	menu.style.borderRight="black " + PREVIEW_BORDER + "px solid";
	menu.style.borderLeft="black " + PREVIEW_BORDER + "px solid";
	menu.style.borderTop="black " + PREVIEW_BORDER + "px solid";
	menu.style.borderBottom="black " + PREVIEW_BORDER + "px solid";
	menu.style.paddingRight=PREVIEW_PADDING;
	menu.style.paddingLeft=PREVIEW_PADDING;
	menu.style.paddingTop=PREVIEW_PADDING;
	menu.style.paddingBottom=PREVIEW_PADDING;
	menu.style.visibility="hidden";
	menu.style.position="absolute";
	menu.style.backgroundColor="#CCCCEE";
	menu.style.overflow=overflow;
	menu.style.fontFamily=FONT_FACE;
	menu.style.fontSize=FONT_SIZE + "pt";
	menu.style.whiteSpace="pre";
	menu.style.wordWrap="break-word";
    menu.style.zIndex = 20000;		
	adjustSpellCheckEditDiv(menu, field);
	menu.onclick = hideAllMenus;
	menu.onscroll = hideAllMenus;
	menu.onkeyup = saveAllChanges; 
	return menu;
}
function adjustSpellCheckEditDiv(menu, field) {
	menu.style.left = grabOffsetLeft(field) + "px";
	menu.style.top = grabOffsetTop(field) + "px";
	var setWidth = field.offsetWidth;
	var setHeight = field.offsetHeight;
	if (!isMSIE) {
		var borderSizes = ( PREVIEW_BORDER * 2 ) + ( PREVIEW_PADDING * 2);
		setHeight -= borderSizes;
		setWidth -= borderSizes;
	}
	menu.style.height = (setHeight - 2) + "px";
	menu.style.width = (setWidth - 2) + "px";
}
var hideAllMenus=function() {
	var divs = document.getElementsByTagName(TAG_DIV);
	for(var ca = 0; ca < divs.length; ca++) {
		var daDiv = divs[ca];
		var divID = daDiv.id;
		if (divID.length > SMENU_TAG.length &&
		   (divID.substring(divID.length - SMENU_TAG.length) == SMENU_TAG)) {
			hideDiv(daDiv);
		}
	}
	return;
}
var saveAllChanges=function() {
	var divs = document.getElementsByTagName(TAG_DIV);
	for(var ca = 0; ca < divs.length; ca++) {
		var daDiv = divs[ca];
		var divID = daDiv.id;
        var displayTag = elementName + DISPLAY_TAG;
		if (divID.length > displayTag.length &&
		   (divID.substring(divID.length - displayTag.length) == displayTag)) {
			var elementName = divID.substring(0, divID.length - DISPLAY_TAG.length);
			updateTextBox(elementName);
		}
	}
    
	return;
}
function createSuggestDiv(link, id, elementName) {
	var menu = document.createElement(TAG_DIV);
	menu.id = id;
	menu.name = menu.id;
	menu.elementName = elementName;
	menu.style.borderRight="gray 2px outset";
	menu.style.borderLeft="white 2px outset";
	menu.style.borderTop="white " + SUGGEST_TOP_BORDER + "px outset";
	menu.style.borderBottom="gray " + SUGGEST_BOT_BORDER + "px outset";
	menu.style.paddingRight="1";
	menu.style.paddingLeft="1";
	menu.style.paddingTop="2";
	menu.style.paddingBottom="2";
	menu.style.visibility="hidden";
	menu.style.position="absolute";
	menu.style.backgroundColor=MENU_BGCOLOR;
	menu.style.fontFamily=FONT_FACE;
	menu.style.fontSize="8pt";
    menu.style.zIndex = 20000;		
	return menu;
}
function grabSpellData(nam, textField, linkName, msgs) {
	processing = true;
	mods = new Array();
    var request = findXMLObject();
    var searchURL = "xmlhttp.do";
	var textField = getObjectByName(nam, TAG_TEXTAREA);
	if (textField == null)
	   textField = getObjectByName(nam, TAG_INPUT);
    var baseText = textField.value;
	originalSpellValue[nam] = baseText;
	
	var aj = new GlideAjax("SpellCheckerAjax");
	aj.setEncode(false);
	aj.addParam("sysparm_name", encodeText(nam));
	aj.addParam("sysparm_chars", encodeText(baseText));
	
	aj.getXML(afterGrabSpellData, null, [nam, textField, linkName, msgs, processing]);
	
}
function afterGrabSpellData(response, args) {
	if (!response || !response.responseXML)
		return;
		
	elementName = args[0];
	textField = args[1];
	linkName = args[2];
	msgs = args[3];
	processing = args[4];
	var changes = extractSpellChanges(response.responseXML);	
	mods[elementName] = changes;
	if (changes.length) {
		textField.mode = 1;
		displaySpellText(elementName);
		if (textField.tagName == 'INPUT')
		    setStatus(linkName, msgs["Resume"]);
		else
			setStatus(linkName, msgs["Resume editing"]);
	} else {
		setStatus(linkName, msgs["No misspellings found"]);
		setTimeout("setStatus('" + linkName + "', '');", 3000);
	}
	processing = false;
}
function extractSpellChanges(responseXML) {
    if (responseXML && responseXML.documentElement) {
		var items = responseXML.getElementsByTagName("match");
		var elementName = responseXML.documentElement.getAttribute("sysparm_name");
		var origText = responseXML.documentElement.getAttribute("sysparm_chars");
		for(i = 0; i < items.length; i++) {
			var item = items[i];
			var word = item.getAttribute("word");
			var pos = item.getAttribute("position");
			var sugs  = item.getElementsByTagName("suggest")
			mods[mods.length] = new Array(pos, word, word, TEXT_MODE, sugs);
		}
    }
	return mods;
}
function encodeText(txt) {
        if (encodeURIComponent)
                return encodeURIComponent(txt);
        if (escape)
                return escape(txt)
}
function findXMLObject() {
    var obj=null;
    try {
            obj=new ActiveXObject("Msxml2.XMLHTTP")
    } catch(e) {
            try {
                    obj=new ActiveXObject("Microsoft.XMLHTTP")
            } catch(sc) {
                    obj=null
            }
    }
    if (!obj && typeof XMLHttpRequest!="undefined") {
            obj=new XMLHttpRequest()
    }
    return obj;
}
function showSuggestions(mod, name, elementName) {
	var link = getObjectByName(name, TAG_A);
	var widSize = 6;
	if (link) {
		var previewDiv = getObjectByName(elementName + DISPLAY_TAG, TAG_DIV);
		var sugsDiv = getObjectByName(name + "_" + elementName + SMENU_TAG, TAG_DIV);
		if (!sugsDiv) {
			sugsDiv = createSuggestDiv(link, name + "_" + elementName + SMENU_TAG, elementName);
			addChild(sugsDiv);
		}
		while(sugsDiv.childNodes.length>0)
			sugsDiv.removeChild(sugsDiv.childNodes[0]);
		for(var gs = 0; gs < mods[elementName][mod][SUGGESTS].length; gs++) {
			var itemName = mods[elementName][mod][SUGGESTS][gs].getAttribute("word");
			sugsDiv.appendChild(makeMenuItem(TEXT_MODE, mod, itemName));
			if (itemName.length > widSize)
				widSize = itemName.length;
		}
		
		var msg = getMessage('Edit...');
		if (msg.length > widSize)
			widSize = msg.length;
sugsDiv.appendChild(makeMenuItem(BOX_MODE, mod, "<i>" + msg + "</i>"));
		sugsDiv.style.left = grabOffsetLeft(link) + "px";
		sugsDiv.style.top = ((grabOffsetTop(link) + link.offsetHeight + 2) - previewDiv.scrollTop) + "px";
		sugsDiv.style.width = link.offsetWidth + "px";
		var menuItems = mods[elementName][mod][SUGGESTS].length + 1;
		var sHeight = (ITEM_HEIGHT * menuItems) + (SUGGEST_TOP_BORDER + SUGGEST_BOT_BORDER);
		if (navigator&&navigator.userAgent.toLowerCase().indexOf("msie") != -1) {
			sugsDiv.style.height = sHeight;
		} else {
			sugsDiv.style.height = sHeight - (SUGGEST_TOP_BORDER + SUGGEST_BOT_BORDER);
			sugsDiv.style.width = ((FONT_SIZE - 2) * widSize-1) + "px";
		}
		showDiv(sugsDiv);
	}
}
function makeMenuItem(mode, mNum, item) {
	var theDiv=document.createElement(TAG_DIV);
	var menuRow=document.createElement(TAG_SPAN);
	var itemInRow=document.createElement(TAG_SPAN);
	theDiv.onmousedown=spellClickedDropDown;
	theDiv.onmouseover=spellMouseOverDropDown;
	theDiv.onmouseout=spellMouseOutDropDown;
	theDiv.cmod = mNum;
	theDiv.cmode = mode;
	itemInRow.innerHTML = item;
	menuRow.appendChild(itemInRow);
	theDiv.appendChild(menuRow);
	setSpellStyle(menuRow,"dropDownRowStyle");
	setSpellStyle(itemInRow,"dropDownItemStyle");
	return theDiv;
}
function getObjectByName(name, type) {
	var objs = document.getElementsByTagName(type);
	for(var ca = 0; ca < objs.length; ca++) {
		var daObj = objs[ca];
		if (daObj && (daObj.id == name || daObj.name == name))
			return daObj;
	}
	return;
}
function setSpellStyle(child,styleName) {
	child.className=styleName;
	if (styleName == "nonSelectedItemStyle") {
		child.style.backgroundColor=MENU_BGCOLOR;
		child.style.color="black";
		if (child.displaySpan)
			child.displaySpan.style.color="green"
	} else if (styleName == "selectedItemStyle") {
		child.style.backgroundColor="#000070";
		child.style.color="white";
		child.style.cursor="pointer";
		if (child.displaySpan)
			child.displaySpan.style.color="white"
	} else if (styleName == "dropDownItemStyle") {
		child.style.width="100%";
		child.style.cssFloat="left";
	} else if (styleName == "dropDownRowStyle") {
		child.style.display="block";
		child.style.paddingLeft="5";
		child.style.paddingRight="5";
		child.style.height=ITEM_HEIGHT + "px";
		child.style.overflow="hidden";
	}
}
function updateTextBox(elementName) {
	var textField = getObjectByName(elementName, TAG_TEXTAREA);
	if (textField == null)
	   textField = getObjectByName(elementName, TAG_INPUT);
	var newValue = buildDisplayText(elementName, FLAT_TEXT);
	if (newValue != originalSpellValue[elementName]) {
		textField.value = newValue;
		multiModified(textField);
	}
}
var spellClickedDropDown=function() {
	var elementName = this.parentNode.elementName;
	var position = mods[elementName][this.cmod][POSITION];
	
	if (this.cmode == BOX_MODE) {
		mods[elementName][this.cmod][MODE] = BOX_MODE;
		mods[elementName][this.cmod][SETWORD] = mods[elementName][this.cmod][WORD];
	} else {
		mods[elementName][this.cmod][MODE] = TEXT_MODE;
		mods[elementName][this.cmod][SETWORD] = spellMenuInfo(this);
	}
	displaySpellText(elementName);
	
	if (this.cmode == BOX_MODE) {
		var fName = buildRefID(elementName, position);
		
		
		setTimeout("fieldFocus('" + fName + "')", 500);
	}
	
	hideDiv(this.parentNode);
}
function fieldFocus(fieldName) {
	var textField = getObjectByName(fieldName, TAG_INPUT);
	
	if (textField)
		textField.focus();
}
var spellMouseOverDropDown=function() {
    setSpellStyle(this,"selectedItemStyle");
}
var spellMouseOutDropDown=function() {
    setSpellStyle(this,"nonSelectedItemStyle");
}
function spellMenuInfo(j) {
    var theStyleType = "dropDownItemStyle";
    var spanTag=j.getElementsByTagName(TAG_SPAN);
    var spanInfo = new Array();
    if (spanTag) {
        for(var c=0;c<spanTag.length;++c) {
            if ( spanTag[c].className == theStyleType ) {
                var spanData=spanTag[c].innerHTML;
                if ( spanData != "&nbsp;" ) {
                    spanInfo = spanData;
                }
                break;
            }
        }
    }
    return spanInfo;
}
function setStatus(elementName, text) {
	var link = getObjectByName(elementName, TAG_A);
	if (link) {
		if (text && text.length > 0) {
link.innerHTML = "<b><u>" + text + "</u></b>";
		} else {
			link.innerHTML = link.savedHTML;
		}
		var realName = elementName.substring(5);
		var displayField = gel(realName + DISPLAY_TAG);
		if (displayField)
			adjustSpellCheckEditDiv(displayField, gel(realName));
	}
}
;
/*! RESOURCE: scripts/AJAXTextSearchCompleter.js */
var AJAXTextSearchCompleter = Class.create(AJAXTableCompleter, {
	
	
	PROCESSOR: "TSSuggestProcessor",
   
    initialize: function(name, elementName, horizontalAlign, searchContainer) {
		AJAXCompleter.prototype.initialize.call(this, name, elementName);
		this.className = "AJAXTextSearchCompleter";
		this.element = $(elementName);
		this.keyElement = this.element;
this.horizontalAlign = horizontalAlign;
this.enterSubmits = true;
this.searchContainer = searchContainer;
this.allowInvalid = true;
this.ieIFrameAdjust = 2;
this.oneMatchSelects = false;
		
		AJAXReferenceCompleter.prototype._commonSetup.call(this);
    },
	
	copyAttributes: function(node) {
		var text = node.childNodes[0].nodeValue;
		var attributes = new Array();
		attributes['label'] = text;
		attributes['name'] = text;
		return attributes;	
	},
	
	setTopLeft: function (style, top, left) {
		if (this.horizontalAlign == "right")
			this._rightAlign(style, parseInt(left, 10));
		else 
			style.left = left;
		style.top = top;
	},
	
	setInvalid: function() {
	},
	
	clearInvalid: function() {
	
	},
	onDisplayDropDown: function() {
		AJAXTableCompleter.prototype.onDisplayDropDown.call(this);
		if (this.horizontalAlign == "right") {
			var mLeft = grabOffsetLeft(this.element);
			var x = this._rightAlign(this.dropDown.style, mLeft);			
			this.iFrame.style.left = x;
		}
	},
	
	_rightAlign: function(style, left) {
		var containerWidth = this._getContainerWidth();
		var dropWidth = this.dropDown.getWidth();
		var adjust = 0;
		if (isWebKit)
			adjust = 2;
		this.log("_rightAlign: " + left + "+" + containerWidth + "-" + dropWidth + "-" + adjust);
		var x = left + containerWidth - dropWidth - adjust + "px";
		style.left = x;
		return	x;
	},
	_createTable: function() {
		AJAXTableCompleter.prototype._createTable.call(this);
		var tableWidth = this._getContainerWidth();
		if (!g_isInternetExplorer)
			tableWidth -= 2;
		this.table.style.width = tableWidth + "px";
	},
	
	_getContainerWidth: function() {
		var adjust = 1;
		if (!g_isInternetExplorer)
			adjust = 2;
		
		var width = 0;
		if (this.searchContainer)
			width = $(this.searchContainer).getWidth() - adjust;
		return width;
	}
});
;
/*! RESOURCE: scripts/CloudApiSCClient.js */
var CloudApiSCClient = {
	_fieldsInfo: {},
	validateCatItemParameterVariables: function(ajaxProcessor, variableSysId, oldValue, newValue, isLoading, g_form) {
		if (isLoading || oldValue == newValue)
			return;
		var parameters = {};
		parameters.variableSysId = variableSysId;
		parameters.parameterValue = newValue.trim();
		this.callAjax(ajaxProcessor, "validateVariableValue", parameters, function(answer) {
			var result = JSON.parse(answer);
			result.variableSysId = "IO:" + variableSysId;
			CloudApiSCClient._fieldsInfo[result["name"]] = result;
			CloudApiSCClient.showAllFieldMessages(g_form);
		});
	},
	callAjax: function(ajaxName, methodName, parameters, callback) {
		var glideAjax = new GlideAjax(ajaxName);
		glideAjax.addParam("sysparm_name", methodName);
		if (parameters) {
			for (var name in parameters) {
				glideAjax.addParam(name, parameters[name]);
			}
		}
		if (callback) {
			glideAjax.getXMLAnswer(callback);
		} else {
			glideAjax.getXMLWait();
			return glideAjax.getAnswer();
		}
	},
	beforeSubmitCloudRsrcTemplate: function(g_form) {
		if (this.isFormValid())
			return true;
		var msg = "Please correct errors to submit order";
		g_form.addErrorMessage(msg);
		this.showAllFieldMessages(g_form);
		return false;
	},
	isFormValid: function() {
		if (!this._fieldsInfo)
			return true;
		for (var name in this._fieldsInfo) {
			if (!this._fieldsInfo[name].isValid)
				return false;
		}
		return true;
	},
	showAllFieldMessages: function(g_form) {
		g_form.hideAllFieldMsgs("error");
g_form.hideAllFieldMsgs("error");
		g_form.clearMessages();
		for (var name in this._fieldsInfo) {
			var fieldInfo = this._fieldsInfo[name];
			if (fieldInfo.message.length > 0) {
				for (var i = 0; i < fieldInfo.message.length; i++) {
					g_form.showFieldMsg(fieldInfo.variableSysId, fieldInfo.message[i], fieldInfo.msgtype);
				}
			}
		}
	}
};
;
/*! RESOURCE: /scripts/doctype/html_class_setter.js */
(function () {
	if (window.NOW.htmlClassSetterInitialized)
		return;
	window.NOW.htmlClassSetterInitialized = true;
	var df = window.NOW.dateFormat;
	var shortDateFormat = window.NOW.shortDateFormat;
	var $h = $j('HTML');
	$j(function() {
		if (!df)
			return; 
		
		CustomEvent.observe('timeago_set', function(timeAgo) {
			df.timeAgo = timeAgo;
			df.dateBoth = false;
			setDateClass();
			setDateTimeVisibilityToSR();
		});
		
		CustomEvent.observe('shortdates_set', function(trueFalse) {
			shortDateFormat = trueFalse;
			setDateClass();
			setDateTimeVisibilityToSR();
		});
		
		CustomEvent.observe('date_both', function(trueFalse) {
			df.dateBoth = trueFalse;
			df.timeAgo = false;
			setDateClass();
			setDateTimeVisibilityToSR();
		})
	});
	
	function setDateClass() {
		$h.removeClass('date-timeago');
		$h.removeClass('date-calendar');
		$h.removeClass('date-calendar-short');
		$h.removeClass('date-both');
		if (df.dateBoth) {
			$h.addClass('date-both');
			if (shortDateFormat)
				$h.addClass('date-calendar-short');
			else 
				$h.addClass('date-calendar');
		} else if (df.timeAgo)
			$h.addClass('date-timeago');
		else {
			if (shortDateFormat)
				$h.addClass('date-calendar-short');
			else
				$h.addClass('date-calendar');
		}
	}
setDateClass();
	function _showDateCalender(dateCalendarLong, dateCalendarShort) {
		if (shortDateFormat) {
			_hideDateTimeFormat(dateCalendarLong);
			_showDateTimeFormat(dateCalendarShort);
		}
		else {
			_showDateTimeFormat(dateCalendarLong);
			_hideDateTimeFormat(dateCalendarShort);
		}
	}
	function _hideDateTimeFormat(element) {
		element.attr('aria-hidden', 'true');
	}
	function _showDateTimeFormat(element) {
		element.removeAttr('aria-hidden');
	}
	function setDateTimeVisibilityToSR() {
		if (!window.g_accessibility)
			return;
		var dateCalendarLong = $j(".datex.date-calendar"),
			dateCalendarShort = $j(".datex.date-calendar-short"),
			dateTimeAgo = $j(".datex.date-timeago");
		if (window.NOW.dateFormat.dateBoth) {
			_showDateCalender(dateCalendarLong, dateCalendarShort);
			_showDateTimeFormat(dateTimeAgo);
		}
		else if (window.NOW.dateFormat.timeAgo) {
			_hideDateTimeFormat(dateCalendarLong);
			_hideDateTimeFormat(dateCalendarShort);
			_showDateTimeFormat(dateTimeAgo);
		}
		else {
			_showDateCalender(dateCalendarLong, dateCalendarShort);
			_hideDateTimeFormat(dateTimeAgo);
		}
	}
	CustomEvent.observe('list.loaded', setDateTimeVisibilityToSR);
	var toggleTemplate = function(trueFalse){
		var bool = (typeof trueFalse !== "undefined") ? trueFalse : !window.NOW.templateToggle;
		window.NOW.templateToggle = bool;
		if (bool) document.body.style.paddingBottom = "100px";
		else document.body.style.paddingBottom = "";
		setPreference('glide.ui.templateToggle', bool);
		setTemplateToggle();
		if (CustomEvent.events.templateToggle.length > 1)
			CustomEvent.un('templateToggle', toggleTemplate);
		GlideUXMetrics && GlideUXMetrics.track('Toggle Template Bar', '');
	};
	CustomEvent.observe('templateToggle', toggleTemplate);
	CustomEvent.observe('compact', function(trueFalse) {
		window.NOW.compact = trueFalse;
		setCompact();
	});
	CustomEvent.observe('cc_listv3_tablerow_striped', function(bool) {
		if (bool) {
			$j('.table-container table.list-grid').addClass('table-striped');
		} else {
			$j('.table-container table.list-grid').removeClass('table-striped');
		}
	});
	function setTemplateToggle(){
		var toggleBtn = $j('#template-toggle-button'),
			ariaLiveEl = $j('#template-bar-aria-live');
		var ariaLiveMsg = '';
		if (window.NOW.templateToggle) {
			$h.addClass('templates');
			toggleBtn.attr('aria-expanded', 'true');
			ariaLiveMsg = getMessage('Added Template bar landmark to bottom of form.');
		}
		else {
			$h.removeClass('templates');
			toggleBtn.removeAttr('aria-expanded');
			ariaLiveMsg = getMessage('Removed Template bar landmark from bottom of form.');
		}
		ariaLiveEl.text(ariaLiveMsg);
	}
	CustomEvent.observe('form.loaded', setTemplateToggle);
	function setCompact() {
		try {
			var modalDiv = window.top.document.getElementById("settings_modal");
		} catch (e) {
		}
		if (modalDiv)
			modalDiv = modalDiv.childNodes[0];
		var $pH;
		if(parent.$j)
			$pH = parent.$j('HTML');
		if (window.NOW.compact) {
			$h.addClass('compact');
			if ($pH)
				$pH.addClass('compact');
			
			if (modalDiv && modalDiv.className.indexOf(' compact') == -1)
				modalDiv.className += ' compact';
		} else {
			$h.removeClass('compact');
			if ($pH)
				$pH.removeClass('compact');
			
			if (modalDiv && modalDiv.className.indexOf(' compact') > -1)
				modalDiv.className = modalDiv.className.replace(" compact", "");
		}
	}
setCompact();
	
	CustomEvent.observe('tabbed', function(trueFalse) {
		window.NOW.tabbed = trueFalse;
		setTabbed();
	});
	
	function setTabbed() {
		if (window.NOW.tabbed) 
			$h.addClass('tabbed');
		else
			$h.removeClass('tabbed');
	}
setTabbed();
	function setListTableWrap() {
		if (window.NOW.listTableWrap)
			$j('HTML').removeClass('list-nowrap-whitespace');
		else
			$j('HTML').addClass('list-nowrap-whitespace');
	}
	setListTableWrap();
	CustomEvent.observe('table_wrap', function (trueFalse) {
		window.NOW.listTableWrap = trueFalse;
		setListTableWrap();
		CustomEvent.fire('calculate_fixed_headers');
	});
})();
function printList(maxRows) {
	var mainWin = getMainWindow();
	if (mainWin && mainWin.CustomEvent && mainWin.CustomEvent.fire && mainWin.CustomEvent.fire("print", maxRows) === false)
		return false;
		
	var veryLargeNumber = "999999999";
	var print = true;
	var features = "resizable=yes,scrollbars=yes,status=yes,toolbar=no,menubar=yes,location=no";
	if (isChrome && isMacintosh)
		features = "";
	
	var href = "";
	var frame = top.gsft_main;
	if (!frame)
		frame = top;
	
	if (frame.document.getElementById("printURL") != null) {
		href = frame.document.getElementById("printURL").value;
	    href = printListURLDecode(href);
	}
	
	if (!href) {
		if (frame.document.getElementById("sysparm_total_rows") != null) {
			var mRows = parseInt(maxRows);
			if (mRows < 1)
				mRows = 5000;
			
			var totalrows = frame.document.getElementById("sysparm_total_rows").value;
			if (parseInt(totalrows) > parseInt(mRows))
				print = confirm(getMessage("Printing large lists may affect system performance. Continue?"));
		}
		
		var formTest;
		var f = 0;
var form = frame.document.forms['sys_personalize'];
		if (form && form.sysparm_referring_url) {
			href = form.sysparm_referring_url.value;
			if (href.indexOf("?sys_id=-1") != -1 && !href.startsWith('sys_report_template')) {
				alert(getMessage("Please save the current form before printing."));
				return false;
			}
			if (isMSIE) {
				var isFormPage = frame.document.getElementById("isFormPage");
				if (isFormPage != null && isFormPage.value == "true")
href = href.replace(/javascript%3A/gi, "_javascript_%3A");
			}
	    	href = printListURLDecode(href);
		} else
			href = document.getElementById("gsft_main").contentWindow.location.href;
	}
	if( href.indexOf("?") <0 )
		href += "?";
	else
		href += "&";
		
	href = href.replace("partial_page=", "syshint_unimportant=");
	href = href.replace("sysparm_media=", "syshint_unimportant=");
	href += "sysparm_stack=no&sysparm_force_row_count=" + veryLargeNumber + "&sysparm_media=print";
	if (print) {
		if (href != null && href != "") {
			win = window.open(href, "Printer_friendly_format", features);
			win.focus();
		} else {
			alert("Nothing to print");
		}
	}
	
	function printListURLDecode(href) {
href = href.replace(/@99@/g, "&");
href = href.replace(/@88@/g, "@99@");
href = href.replace(/@77@/g, "@88@");
href = href.replace(/@66@/g, "@77@");
		return href;	
	}
}
function clearCacheSniperly() {
	var aj = new GlideAjax("GlideSystemAjax");
	aj.addParam("sysparm_name", "cacheFlush");
	aj.getXML(clearCacheDone);
}
function clearCacheDone() {
	window.status = "Cache flushed";
}
;
/*! RESOURCE: /scripts/doctype/floating_scrollbar.min.js */
!function(t){function o(t){b.toggle(!!t)}function e(){s&&b.scrollLeft(s.scrollLeft())}function n(){var t=$j(".navbar-fixed-bottom");return t.length&&window.NOW.templateToggle?t.outerHeight():0}function i(){if(c=s,s=null,v.each(function(){var o=t(this).offset().top,e=o+t(this).height(),n=h.height();return n>o+u&&e>n?(s=t(this),!1):void 0}),!s)return void o();var i=s.scrollLeft(),l=s.scrollLeft(90019001).scrollLeft(),r=s.innerWidth(),a=r+l;return s.scrollLeft(i),r>=a?void o():(o(!0),c&&c[0]===s[0]||(c&&(c[0].onscroll=void 0),s[0].onscroll=e,s.after(b)),b.css({left:s.offset().left-f.scrollLeft(),width:r,bottom:n()}).scrollLeft(i),void g.width(a))}function l(){var o=t(".custom-form-group");o.length&&(a||(f=t(".section_header_content_no_scroll"),o.floatingScrollbar(),a=!0))}function r(t,o,e){function n(){clearTimeout(r),r=setTimeout(i.bind(null,arguments),s)}function i(o,e,n){l=o,t.apply(e,n)}var l,r,s=o||100;return function(){var t=e||this,o=+new Date,r=arguments;l&&l+s>o?n(o,t,r):i(o,t,r)}}if(!isMSIE9&&window.NOW.floatingScrollbars){var s,c,f,a,d=30,u=30,h=t(this),v=t([]),b=t('<div id="floating-scrollbar"><div/></div>'),g=b.children();b.hide().css({position:"fixed",bottom:n(),height:"30px","overflow-x":"auto","overflow-y":"hidden"}).scroll(function(){s&&s.scrollLeft(b.scrollLeft())}),g.css({border:"1px solid #fff",opacity:.01}),t.fn.floatingScrollbar=function(o){o===!1?(v=v.not(this),this.unbind("scroll",e),v.length||(b.detach(),h.unbind("resize",i),f.unbind("scroll",i))):this.length&&(v=v.add(this),isChrome&&v.each(function(){t(this).css({"-webkit-transform":"translate3d(0,0,0)"})})),h.bind("resize",r(i,d)),f.bind("scroll",r(i,d)),i()},CustomEvent.observe("list.loaded",l),CustomEvent.observe("tab.activated",i),CustomEvent.observe("partial.page.reload",l),CustomEvent.observe("related_lists.render",l),CustomEvent.observe("templateToggle",function(){b.css({bottom:n()})})}}(jQuery);
/*! RESOURCE: /scripts/doctype/page_title.js */
$j(function($) {
	var title = $('[data-form-title]').first().attr('data-form-title');
	if (!title || title == "null")
		title = $( ".tabs2_section" ).first().attr('tab_caption');
	if (!title || title == "null")
		title = $('.list_title').first().text();
	if (!title || title == "null")
		title = $('.properties_page_title').first().text();
	if (!title || title == "null")
		return;
	document.title = title + ' | ' + document.title;
});
;
/*! RESOURCE: /scripts/responsive_form_header.js */
(function($) {
	var cache = null;
	var MIN_HEADER_HEIGHT = 60;
	var DEFAULT_TIMEOUT_IN_MS = 100;
	addLoadEvent(initializeFormHeader);
	function initializeFormHeader() {
		if ($('.section_header_div_no_scroll').length === 0) {
			return;
		}
		setupCache();
		CustomEvent.observe("frame.resized", adjustFormHeaderElements);
		Event.observe(window, "resize", debounceAdjustFormHeaderElements);
	}
	function adjustFormHeaderElements() {
		if (!cache.hasLoaded && cache.$header.height() < MIN_HEADER_HEIGHT) {
			cache.hasLoaded = true;
			return;
		}
		if (cache.$navbar.is(":visible")) {
			recalculateDynamicHeaderElements();
			fitUiActions();
		}
		cache.$content.css({height: cache.$window.innerHeight() - cache.$header.height()});
	}
	function debounceAdjustFormHeaderElements() {
		clearTimeout(cache.timeout);
		cache.timeout = setTimeout(adjustFormHeaderElements, DEFAULT_TIMEOUT_IN_MS);
	}
	function setupCache() {
		if (cache == null) {
			cache = {};
			cache.timeout = null;
			cache.hasLoaded = false;
			cache.$window = $(window);
			cache.$header = $('.section_header_div_no_scroll');
			cache.$content = $('.section_header_content_no_scroll');
			cache.$spacer = $('div[data-position-below-header="true"]');
			cache.$navbar = $('nav.navbar-default').first();
			cache.$primaryContainer = cache.$navbar.find('.ui_action_container_primary');
			cache.$overflowContainer = cache.$navbar.find('.ui_action_container_overflow');
			cache.$uiActionContainer = cache.$primaryContainer.children(0);
			cache.$navbarDisplayValueElement = cache.$navbar.find('.navbar-header:first .navbar-title-display-value');
			cache.uiActionWidth = cache.$uiActionContainer.width();
			cache.navbarRightWidth = cache.$navbar.find('.navbar-right:first').width() - cache.uiActionWidth;
			cache.navbarTitleCaption = cache.$navbar.find('.navbar-header:first .navbar-title-caption').width();
			cache.$navbarWidth = cache.$navbar.width();
		}
	}
	function recalculateDynamicHeaderElements() {
		cache.navbarHeaderWidth = cache.$navbar.find('.navbar-header:first').width();
		cache.navbarDisplayWidth = cache.$navbar.find('.navbar-header .navbar-title-display-value').width();
		if((cache.$navbar.find('.navbar-right').width() - cache.uiActionWidth) <= 0 || cache.$navbarWidth <= 0) {
			cache.navbarRightWidth = cache.$navbar.find('.navbar-right').width();
		}
	}
	function fitUiActions() {
		cache.$navbarDisplayValueElement.css('max-width', '');
		recalculateDynamicHeaderElements();
		var navbarWidth = cache.$navbar.width();
		var headerSize = cache.navbarHeaderWidth + cache.navbarRightWidth + cache.uiActionWidth;
var btnOffset = 32 + 10 + 10;
		if ((cache.navbarHeaderWidth + cache.navbarRightWidth) > cache.$window.width()) {
			var maxWidth = cache.navbarDisplayWidth - (cache.navbarHeaderWidth - cache.$window.width()) - cache.navbarRightWidth - btnOffset;
			cache.$navbarDisplayValueElement.css('max-width', Math.max(maxWidth, cache.navbarTitleCaption));
			navbarWidth = cache.$navbar.width();
			recalculateDynamicHeaderElements();
		}
		headerSize = cache.navbarHeaderWidth + cache.navbarRightWidth + cache.uiActionWidth;
		if (headerSize > navbarWidth) {
			if (cache.$uiActionContainer.parent().get(0) === cache.$primaryContainer.get(0)) {
				cache.$overflowContainer.append(cache.$uiActionContainer.detach());
			}
		} else if (cache.$uiActionContainer.parent().get(0) === cache.$overflowContainer.get(0)) {
			cache.$primaryContainer.append(cache.$uiActionContainer.detach());
		}
	}
})(jQuery);
;
/*! RESOURCE: /scripts/classes/doctype/streamButton.js */
$j(function($) {
	"use strict";
	var closeButtonPadding = 32;
	var isOpen = false;
	var wrapperSelector = '.list_wrap_n_scroll';
	var $listStreamBtn = $('.list_stream_button');
	var $formStreamBtn = $('.form_stream_button');
	
	function toggleStream(shouldAutoFocus) {
		$listStreamBtn.attr("aria-expanded", !isOpen);
		if (!isOpen){
			isOpen = true;
			var table = $('table.list_table[data-list_id]');
			var listid = table.attr('data-list_id');
			var query = table.attr('query');
			query = encodeURIComponent(query);
			var url = "$stream.do?sysparm_table=" + listid + "&sysparm_nostack=yes&sysparm_query=" + query;
			var target = 'parent';
			if (shouldUseFormPane())
				target = 'form_pane';
			url += "&sysparm_link_target=" + target;
			createStreamReader(url, shouldAutoFocus);
		} else {
			isOpen = false;
			var $readerDiv = $('.list_stream_reader');
			closeStreamReader($readerDiv);
		}
	}
	if ($listStreamBtn.attr("aria-expanded") === "true")
setTimeout(function(){ toggleStream(false); }, 500);
	$listStreamBtn.click(function() {
		trackListMetrics();
		toggleStream(true);
	});
	function trackListMetrics() {
		if (!GlideList2)
			return;
		var table = $('table.list_table[data-list_id]');
		var listId = table.attr('data-list_id');
		var list = GlideList2.get(listId);
		GlideListUxMetricsUtils.track('Open List Activity Stream Flyout', list, {});
	};
	$(document).on('click', '.form_stream_button', function() {
		var url = "$stream.do?sysparm_table=" + g_form.getTableName();
		url += "&sysparm_sys_id=" + g_form.getUniqueValue();
		url += "&sysparm_stack=no";
		$formStreamBtn.attr("aria-expanded", true);
		createStreamReader(url, true);
	});
	function shouldUseFormPane() {
		try {
			if (self == top)
				return false;
			if (window.top.g_navManager)
				return !!window.top.g_navManager.options.formTarget;
		} catch (e) {}
		return false;
	}
	function createStreamReader(url, shouldAutoFocus) {
		if ($('.list_stream_reader').length)
			return;
			
		if (NOW && NOW.polaris_page_info && NOW.polaris_page_info.canUsePolarisCSS)
			url += "&sysparm_use_polaris=true";
var frame = '	<iframe src="' + url + '" id="list_stream_reader_frame"></iframe>';
		var closeActivityLabel = getMessage('Close Activity Stream');
		var activityStreamTitle = getMessage('Activity Stream');
		var $div = $('<div class="list_stream_reader" aria-labelledby="stream_header">' +
'<span tabindex="0" id="list_stream_focus_bumper_top"> </span>' +
			'<div class="list_stream_plank_header">'+
			'<span class="list_stream_reader_close"><button id="list_stream_reader_close_button" aria-label="' +
			closeActivityLabel +
'" class="plank_close_button icon-double-chevron-right"></button></span><h2 id="stream_header">'+
activityStreamTitle + '</h2>' +
'</div>' +
			frame +
'<span tabindex="0" id="list_stream_focus_bumper_bottom"> </span>' +
'</div>');
		$('body').append($div);
		$('#list_stream_reader_frame').bind('load', function() {
			if (NOW.compact) {
				$(this).contents().find('html').addClass('compact');
			}
			CustomEvent.observe('compact', function(newValue) {
				var method = newValue ? 'addClass' : 'removeClass';
				$('#list_stream_reader_frame').contents()
					.find('html')[method]('compact');
			})
		});
		var focusOnCloseButton = function() {
			$("#list_stream_reader_close_button")[0].focus();
		};
		var focusLastElementInPanel = function () {
			try {
				var frame = document.getElementById('list_stream_reader_frame');
				window.tabbable(frame.contentDocument.body).pop().focus();
			} catch (e) {
				focusOnCloseButton();
			}
		};
		$('#list_stream_focus_bumper_top').focus(focusLastElementInPanel);
		$('#list_stream_focus_bumper_bottom').focus(focusOnCloseButton);
		if (shouldAutoFocus)
			focusOnCloseButton();
			
		resizeStreamReader($div);
		$(window).bind('resize.streamreader', function() {
			unfreezeTableWidth();
			if ($div.parent().length === 0) {
				$(window).unbind('resize.streamreader');
				return;
			}
			resizeStreamReader($div);
		})
	}
	function setListWrapperStyles(stylesObject) {
		var $listWrapper = $(wrapperSelector);
		if ($listWrapper.length === 0){
			return;
		}
		$listWrapper.closest('body').css(stylesObject);
	}
	function setListStyles(stylesObject) {
		var $listWrapper = $(wrapperSelector);
		if ($listWrapper.length === 0){
			return;
		}
		$listWrapper.find('.list_div_parent').css(stylesObject);
	}
	function resizeStreamReader($div) {
		freezeTableWidth();
		if(isPolarisTemplate()) {
			var width = $div.outerWidth();
			var listWrapperStyles = {
				'padding-inline-end': width
			};
			setListStyles(listWrapperStyles);
		} else {
			var width = $div.outerWidth() + closeButtonPadding;
			var listWrapperStyles = {
				'position': 'absolute',
				'padding-right': width
			};
			setListWrapperStyles(listWrapperStyles);
		}
var top = 50;
		if (typeof g_form == 'undefined')
			top = $('.list_nav_spacer').offset().top;
		else
			top = $('.section_header_content_no_scroll').offset().top;
		$div.css('top', top);
		if ("ontouchstart" in window) {
			$div.css('absolute');
			window.scrollTo(0, top);
		}
	}
	$('body').on('click', '.list_stream_reader_close', function() {
		isOpen = false;
		var $readerDiv = $(this).closest('.list_stream_reader');
		closeStreamReader($readerDiv);
		if ($listStreamBtn.length > 0) {
			$listStreamBtn.attr("aria-expanded", isOpen);
			$listStreamBtn.focus();
		}
		else if ($formStreamBtn.length > 0) {
			$formStreamBtn.attr("aria-expanded", isOpen);
			$formStreamBtn.focus();
		}
	});
	function closeStreamReader($readerDiv) {
		unfreezeTableWidth();
		$readerDiv.remove();
		if(isPolarisTemplate()) {
			var listWrapperStyles = {
				'padding-inline-end': 0
			};
			setListStyles(listWrapperStyles);
		} else {
			var listWrapperStyles = {
				'position': '',
				'padding-right': 0
			};
			setListWrapperStyles(listWrapperStyles);
		}
	}
	function freezeTableWidth() {
		$('table.list_table').each(function(index, el) {
			var $el = $(el);
			var width = $el.width();
			$el.css('width', width);
		})
	}
	function unfreezeTableWidth() {
		$('table.list_table').each(function(index, el) {
			$(el).css('width', '');
		})
	}
});
;
/*! RESOURCE: /scripts/doctype/GlideWebAnalytics.js */
var GlideWebAnalytics = (function() {
		function subscribe() {
			
			window.snWebaConfig = window.snWebaConfig || {};
			
			if (window.snWebaConfig.subscribed && window.snWebaConfig.subscribed == true)
				return;
				
			var ambClient = getAMB();
		
			if (ambClient == undefined || ambClient == "")
				return;
			
var webaChannelId = "/weba/config";
			var webaCh = ambClient.getChannel(webaChannelId);
			webaCh.subscribe(function(response) {
	
				if (window.snWebaConfig == undefined || window.snWebaConfig == null)
					window.snWebaConfig = {};
	
				var oldConfig = {
					siteId : (window.snWebaConfig.siteId)? window.snWebaConfig.siteId: "0" ,
					trackerURL : (window.snWebaConfig.trackerURL)? window.snWebaConfig.trackerURL: ""
				};
	
				window.snWebaConfig.siteId = response.data.weba_site_id;
				window.snWebaConfig.trackerURL = response.data.weba_rx_url;
				window.snWebaConfig.webaScriptPath = response.data.weba_script_path;
	
				handleConfigUpdate(oldConfig, window.snWebaConfig);
			});
			ambClient.connect();
			window.snWebaConfig.subscribed = true;
		}
		
	function getAMB(){
		
		var ambClient = window.snWebaConfig.ambClient;
		if (ambClient)
			return ambClient;
		
		window.snWebaConfig.ambClient = (window.g_ambClient) ? window.g_ambClient : ((window.amb)? window.amb.getClient(): "");
		
		return window.snWebaConfig.ambClient;
	}
	
	function handleConfigUpdate(oldConfig, newConfig) {
		
		if (shouldRemoveTracker(oldConfig, newConfig))
			removeTracker();
		
		else if (shouldUpdateTracker(oldConfig, newConfig))
			updateTracker(oldConfig, newConfig);
		
		else if (shouldInsertTracker(oldConfig, newConfig))
			insertTracker(newConfig);
	}
	
	function shouldRemoveTracker(oldConfig, newConfig){
		if (newConfig.siteId == "0" || newConfig.trackerURL == "")
			return true;
		
		return false;
	}
	
	function shouldUpdateTracker(oldConfig, newConfig){
		
		if (oldConfig.siteId && oldConfig.siteId != "0" && oldConfig.siteId != newConfig.siteId)
			return true;
		
		if (oldConfig.trackerURL && oldConfig.trackerURL != newConfig.trackerURL)
			return true;
		
		return false;
	}
	
	function shouldInsertTracker(oldConfig, newConfig){
		
		if (oldConfig.siteId == undefined || oldConfig.siteId == "0")
			return true;
		
		if (oldConfig.trackerURL == undefined || oldConfig.trackerURL == "")
			return true;
		
		return false;
	}
	
	function removeTracker() {
		
		if (!trackerExists())
			return;
		
		removeWebaTracker();
		removeWebaScript();
		removeWebaElements();
	}
	
	function removeWebaTracker() {
		
		var document =  window.parent.document;
		
		var trackerScriptId = "webaTracker";
		var trackEle = document.getElementById(trackerScriptId);
		trackEle.parentNode.removeChild(trackEle);
	}
	
	function removeWebaScript() {
		
		var document =  window.parent.document;
		var asyncTrackEle = document.getElementById('webaScript');
		
		if (asyncTrackEle == undefined)
			return;
		
		var src = asyncTrackEle.src;
		
		if (src != undefined && src.indexOf("piwik") > 0) 
			asyncTrackEle.parentNode.removeChild(asyncTrackEle);
	}
	
	function removeWebaElements() {
		
		var document =  window.parent.document;
		var webaEle = document.getElementsByClassName("weba");
		var webaSize = webaEle.length - 1;
		
		while (webaSize >= 0){
			webaEle[webaSize].parentNode.removeChild(webaEle[webaSize]);
			webaSize--;
		}
	}
	
	function updateTracker(oldConfig, newConfig) {
		
		if (!trackerExists())
			return;
		
		var document =  window.parent.document;
		var head = document.head || document.getElementsByTagName('head')[0];
		
		var updateScript = "_paq.push(['setSiteId', " + newConfig.siteId + "]);" + "_paq.push(['setTrackerUrl', " + "'" + newConfig.trackerURL + "'" + "]);";
		var uEle = window.document.createElement("script");
		uEle.text = updateScript;
		uEle.className = "weba";
		head.appendChild(uEle);
	}
	
	function insertTracker(newConfig, additionalData) {
		
		var document =  window.parent.document;
		var head = document.head || document.getElementsByTagName('head')[0];
		
		if (trackerExists()) 
			return;
		
		if (!isConfigValid(newConfig))
			return;
		
		var trackerScript = generateTrackerScript(newConfig, additionalData);
		
		var trackerElement = getOrCreateTracker();
		trackerElement.text = trackerScript;
		
		head.appendChild(trackerElement);
	}
			
	function applyTracker(additionalData) {
		insertTracker(window.snWebaConfig, additionalData);
		subscribe();
	}
	function applyTrackEvent(category, key, value, additionalValue) {
		
		insertEventTracker(category, key, value, additionalValue);
		subscribe();
	}
	
	function insertEventTracker(category, key, value, additionalValue) {
		
		if (!isConfigValid(window.snWebaConfig))
			return;
		if (!trackerExists())
			insertTracker(window.snWebaConfig);
		
		if (typeof category != "string" || typeof key != "string" || typeof value != "string")
			return;
		
		if (additionalValue)
			additionalValue = (typeof additionalValue == "number")? additionalValue: 0;
		var eventItems = [ "trackEvent", category, key, value, additionalValue ];
		var eventScript = "_paq.push(" + JSON.stringify(eventItems) + ");";
		
		var document =  window.parent.document;
		var head = document.head || document.getElementsByTagName('head')[0];
		var scriptEle = window.document.createElement("script");
		scriptEle.className = "weba";
		scriptEle.text = eventScript;
		
		head.appendChild(scriptEle);
	}
	
	function trackerExists() {
		
		var document =  window.parent.document;
		
		var trackEle = document.getElementById("webaTracker");
		
		if (trackEle)
			return true;
		
		return false;
	}
	
	function isConfigValid(newConfig) {
		
		var zero = "0";		
		var webaSiteId = (newConfig && newConfig.siteId) ? newConfig.siteId : zero;
		var trackerURL = (newConfig && newConfig.trackerURL) ? newConfig.trackerURL : "";
	
		if (webaSiteId == null || webaSiteId == "")
			return false;
		
		if (webaSiteId == zero )
			return false;
		
		if (trackerURL == null || trackerURL == "")
			return false;
		
		return true;
	}
	
	function getOrCreateTracker() {
		
		var trackerScriptId = "webaTracker";
		
		var document = window.parent.document;
		
		var trackEle = document.getElementById(trackerScriptId);
		
		if (trackEle)
			return trackEle;
			
		trackEle = document.createElement("script");
		trackEle.id = trackerScriptId;
trackEle.type = "text/javascript";
		
		return trackEle;	
	}
	
	function getUserId(additionalData) {
		
		if (window.NOW && window.NOW.user_id && window.NOW.user_id != "")
			return window.NOW.user_id;
		
		else if (additionalData && additionalData.userId){
			
			return additionalData.userId;
		}
		
		else if (window.NOW && window.NOW.session_id)
			return window.NOW.session_id;
		
		else {
			
			var userObj = (window.NOW)? window.NOW.user: null;
			
			if (userObj && userObj.userID)
				return userObj.userID;
		}
		
		return "";
	}
	
	function generateTrackerScript(webaConfig, additionalData) {
		
		var trackerURL = webaConfig.trackerURL;
		
if (trackerURL.endsWith("/"))
			trackerURL = webaConfig.trackerURL.substring(0, trackerURL.length - 1);
		
		var userId = getUserId(additionalData);
			
		var script = "var _paq = _paq || [];";	
		
		if (userId && userId != ""){
			script += "_paq.push(['setUserId', '" + userId + "']);";
		}
		
		script += "_paq.push(['trackPageView']); _paq.push(['enableLinkTracking']);";		
		script += "(function() {_paq.push(['setTrackerUrl','" + trackerURL +  "']);" 
				+ "_paq.push(['setSiteId', " + webaConfig.siteId + "]);" 
+ "var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0]; g.type='text/javascript'; g.async=true; "
				+ "g.defer=true; g.src='" + webaConfig.webaScriptPath + "'; " 
				+ "g.id='webaScript';s.parentNode.insertBefore(g,s); })();";
		
		return script;
	}
	
	var api = {	
			
				trackPage: function(additionalData) {
										
					if (window.document.readyState == "complete") 
						applyTracker(additionalData);
					
					else
						window.addEventListener("load", function() {
							applyTracker(additionalData);
						},	false);
					
				},
			
				trackEvent: function(category, key, value, additionalValue, delayInMs) {
					if (delayInMs == undefined)
						delayInMs = 3000;
					
					window.setTimeout(function() {
						applyTrackEvent(category, key, value, additionalValue);
					}, delayInMs);
					
				}
	}
	
	return api;
})();
;
;
/*! RESOURCE: /scripts/js_includes_weba.js */
/*! RESOURCE: /scripts/now_ux_metrics.js */
var GlideUXMetrics = (function () {
	function setMetaData(eventName, data) {
		var data = data || {};
		if (eventName == 'USER_NAVIGATE'  || eventName == 'EXPERIENCE_START') {
			var meta = data.meta || {};
			meta.url =  meta.url || (meta.pageTitle ? meta.url : window.location.pathname + window.location.search);
meta.pageTitle = meta.pageTitle || (window.document.title || '').split(/\s\|\s/)[0];
			meta.selectedContent = meta.selectedContent || {};
			if (!meta.selectedContent.isSeismicApp)
				meta.selectedContent.isSeismicApp = false;
		}
		return data;
	}
	function track(eventName, data, config) {
		if (!eventName) return;
		var payload = {
			"eventName": eventName, "data": setMetaData(eventName, data), "config": config
		}
		window.top.dispatchEvent(new CustomEvent('GLIDE_UX_METRICS', {detail: payload}));
	}
	function trackPerformance(key, metrics) {
		if (!isPerformanceMonitoringEnabled()) return;
		if (!key || !metrics) return;
		metrics = metrics instanceof Array? metrics: [metrics];
		var payload = {
			eventName: '$PERF-DATA',
			data: {key, metrics},
			config: {level: 5, type: 'usage'}
		};
		window.top.dispatchEvent(new CustomEvent('GLIDE_UX_METRICS', {detail: payload}));
	}
	function isPerformanceMonitoringEnabled() {
		var isGlobalPerfEnabled = !!('true' === 'true');
		var isUi16PerfEnabled = !!('true' === 'true');
		return isGlobalPerfEnabled && isUi16PerfEnabled;
	}
	return {
		track: track,
		trackPerformance: trackPerformance
	};
})();
;
/*! RESOURCE: /scripts/classic/ux_metrics-bundle.js */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@devsnc/ux-metrics-client-interaction-subscriber")):"function"==typeof define&&define.amd?define(["@devsnc/ux-metrics-client-interaction-subscriber"],e):"object"==typeof exports?exports.nowUiClassic=e(require("@devsnc/ux-metrics-client-interaction-subscriber")):(t.nowUiClassic=t.nowUiClassic||{},t.nowUiClassic.ux_metrics_runtime=e(t["@devsnc/ux-metrics-client-interaction-subscriber"]))}(self,(t=>(()=>{var e,r,n={7510:(t,e,r)=>{"use strict";r.r(e),r.d(e,{DEFAULT_LEVEL:()=>o,markTypes:()=>n});const n={all:"all",usage:"usage",performance:"performance"},o=5},622:(t,e,r)=>{"use strict";var n,o,i;r.r(e),r.d(e,{handleMarks:()=>he,init:()=>ye,name:()=>Wt,type:()=>ge}),function(t){t[t.Page=0]="Page",t[t.Event=1]="Event",t[t.User=2]="User",t[t.PerformanceTrace=3]="PerformanceTrace"}(n||(n={})),function(t){t[t.debug=0]="debug",t[t.info=1]="info",t[t.warn=2]="warn",t[t.error=3]="error"}(o||(o={})),function(t){t.Disabled="Disabled",t.Basic="Basic",t.Full="Full"}(i||(i={})),r(6265),r(8436);const a=t=>void 0===t,u=t=>!a(t),s=t=>a(t)||null===t,c=t=>"string"==typeof t,f=t=>c(t)&&Boolean(t.trim()),l=t=>"number"==typeof t&&!Number.isNaN(t),p=t=>l(t)&&t%1==0,h=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return p(t)&&(t>0||e&&0===t)},d=t=>"boolean"==typeof t,v=t=>t instanceof Date,y=t=>t===Object(t)&&t.constructor===Object,g=t=>Array.isArray(t),m=t=>"function"==typeof t;function b(t,e){Object.setPrototypeOf(t,e.prototype),t.name=t.constructor.name}class _ extends Error{constructor(t){super("[SNAnalytics] ".concat(t)),b(this,_)}}class w extends _{constructor(t){super(t),b(this,w)}}class E extends _{constructor(t){super("Server call failed: ".concat(t)),b(this,E),this.errorCode=t}}r(7267),r(9211),r(8607),r(9943),r(1638),r(3356);const O=()=>[1e7,1e3,4e3,8e3,1e11].join("-").replace(/[018]/g,(t=>(Number(t)^(window.crypto?15&window.crypto.getRandomValues(new Uint8Array(1))[0]:16*Math.random())>>Number(t)/4).toString(16))).replace(/-/g,"").toLowerCase();class T{static set baseUrl(t){if(!f(t))throw new w("Server endpoint cannot be empty");this.baseServerUrl=t.replace(/\/+$/,"")}static get baseUrl(){return this.baseServerUrl}}T.baseServerUrl="https://api-appsee.service-now.com",T.IS_PRODUCTION=!0,T.VERSION="2.2.0",T.DEFAULT_CLIENT_ID="0",T.DEFAULT_LOG_LEVEL=T.IS_PRODUCTION?o.error:o.debug,T.DEFAULT_TRACKING_CONSENT=i.Disabled,T.MAX_HEARTBEAT_CALL_ATTEMPTS=2,T.SYSTEM_PROPERTY_PREFIX="SN_",T.LOGGER_PREFIX="[SNAnalytics]",r(5415);const S=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var n;const o=new Map,i=new Map;Object.entries(e).forEach((t=>{let[e,n]=t;l(parseInt(e,10))||(o.set(r?e.toLowerCase():e,n),i.set(r&&c(n)?n.toLowerCase():n,n))}));const a=r&&c(t)?t.toLowerCase():t;return null!==(n=o.get(a))&&void 0!==n?n:i.get(a)}catch{return}},x=(t,e,r)=>r(t)?t:e,R=(t,e,r,n,o)=>{if(m(r)&&n instanceof e)return r(n,t,o.toString());throw n},P=(t,e)=>(r,n,o)=>{const i=o.value;return o.value=function(){try{for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];const s=i.apply(this,o);return(u=s)&&m(u.then)&&m(u.catch)?s.catch((r=>R(this,t,e,r,n))):s}catch(r){return R(this,t,e,r,n)}var u},o},A=t=>P(Error,((e,r,n)=>(C.error("Fatal error in SNAnalytics:".concat(n,"."),e.message),t))),I=A(void 0);class j{constructor(){this.logMethods={0:["debug"],1:["info"],2:["warn"],3:["error"]},this.handleLogLevel(T.DEFAULT_LOG_LEVEL);try{this.channel=new BroadcastChannel("SNAnalytics.Logger"),this.channel.onmessage=this.onBroadcastMessage.bind(this)}catch{this.debug("Broadcast channel is not supported")}}onBroadcastMessage(t){this.handleLogLevel(t.data.logLevel)}notify(t){var e;return null===(e=this.channel)||void 0===e?void 0:e.postMessage({logLevel:t})}handleLogLevel(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=S(t,o,!0);if(a(r))this.warn("Ignoring invalid log level:",t);else if(this.logLevel!==r){for(const[t,e]of Object.entries(this.logMethods))for(const n of e)this[n]=parseInt(t,10)>=r?console[n].bind(console,T.LOGGER_PREFIX):()=>{};e&&this.notify(r),this.logLevel=r}}setDebugLevel(t){this.handleLogLevel(t,!0)}debug(t){}info(t){}warn(t){}error(t){}}!function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);i>3&&a&&Object.defineProperty(e,r,a)}([P(Error,(()=>{}))],j.prototype,"onBroadcastMessage",null);const C=new j;var L;!function(t){t.BrowserId="browser",t.ClientId="client",t.AppUserId="user",t.TrackingConsent="consent",t.MemoryBackup="all",t.Configuration="config",t.ServerResponseTime="srt",t.DataPoints="data",t.CurrentPage="page",t.TabId="tab",t.Domain="domain",t.AppContext="app"}(L||(L={}));class N{constructor(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.apiKey=t,this.storage=e,this.disableSerialization=r,!f(this.apiKey))throw new _("Must supply an API key to initialize a store instance");try{const t=this.getStoreKey("test");this.storage.setItem(t,"ok"),this.storage.removeItem(t)}catch{throw new _("Web storage is not supported")}}getStoreKey(t){return"".concat("sn",":").concat(this.apiKey,":").concat(t)}serializeItem(t){return this.disableSerialization?t:JSON.stringify(t)}deserializeItem(t){return this.disableSerialization?t:JSON.parse(t)}set(t,e){return s(e)?this.remove(t):this.storage.setItem(this.getStoreKey(t),this.serializeItem(e))}get(t){const e=this.storage.getItem(this.getStoreKey(t));return null===e?void 0:this.deserializeItem(e)}remove(t){this.storage.removeItem(this.getStoreKey(t))}}const k=t=>new Date(t).toISOString(),D=()=>(new Date).getTime();let U=D();const M=()=>{const t=D();return U=U>=t?U+1:t,U},B={ClientId:T.DEFAULT_CLIENT_ID,SessionId:"",LogLevel:void 0,MaxDataPointsPerHeartbeat:1e3,HeartbeatInterval:5e3,SessionTimeout:18e5,RecordMetadata:!0,RequestId:"",ConfigReceivedTime:0,AppUserId:void 0,IgnorePerformanceData:!1},H={ClientId:c,SessionId:c,LogLevel:((t,e)=>Object.values(t).includes(e)).bind(null,o),MaxDataPointsPerHeartbeat:h,HeartbeatInterval:h,SessionTimeout:h,RecordMetadata:d,RequestId:c,ConfigReceivedTime:p,AppUserId:c,IgnorePerformanceData:d};class F{constructor(t,e,r,n){this.store=t,this.apiKey=e,this.apiAuth=r,this.appUserIdProvider=n,this.configuration=this.buildConfiguration()}buildConfiguration(){return{...(t=this.store.get(L.Configuration)||{},e=B,r=H,((t,e)=>Object.fromEntries(Object.entries(t).map((t=>{let[r,n]=t;return[r,e(n,r)]}))))(e,((e,n)=>x(t[n],e,r[n])))),LastServerResponseTime:x(this.store.get(L.ServerResponseTime),0,p),ApiKey:this.apiKey,ApiAuth:this.apiAuth};var t,e,r}get(t){return this.configuration[t]}startNewSession(t){this.deleteData(),this.configuration.RequestId=t,this.configuration.AppUserId=this.appUserIdProvider.get()}isValidConfigResponse(t){const e=["SessionId","ClientId","HeartbeatInterval","SessionTimeout","MaxDataPointsPerHeartbeat"];for(const r of e)if(!(r in t))return!1;return!0}fillWithJson(t){const e={...t,RequestId:this.configuration.RequestId,AppUserId:this.configuration.AppUserId,ConfigReceivedTime:D()};this.store.set(L.Configuration,e),this.configuration=this.buildConfiguration()}updateServerResponseTime(){const t=D();this.configuration.LastServerResponseTime=t,this.store.set(L.ServerResponseTime,t)}deleteData(){this.store.remove(L.ServerResponseTime),this.store.remove(L.Configuration),this.configuration=this.buildConfiguration()}deleteSessionData(t){t===this.configuration.SessionId&&this.deleteData()}}var q;function G(t){return t[t.length-1]}!function(t){t.type="t",t.timestamp="d",t.name="n",t.properties="p"}(q||(q={}));const z=t=>t.startsWith(T.SYSTEM_PROPERTY_PREFIX),W=(t,e)=>null===t||(g(t)?e:l(t)?t!==1/0&&t!==-1/0:c(t)||v(t)||d(t)),V=t=>v(t)?t.toLocaleString("en-GB",{timeZone:"UTC"}).replace(/,/g,""):d(t)?t.toString():t,$=(t,e,r)=>{const n={};for(let[i,a]of Object.entries(t)){var o;if(f(i))if(z(i))C.error("Invalid property prefix for name:",i);else if(a=null!==(o=a)&&void 0!==o?o:r?null:"",W(a,e))if(g(a)){const t=[];for(const e of a)c(e)?t.push(e):C.error("Invalid value",e,"for list",i);n[i]=t}else n[i]=V(a);else C.error("Invalid value",a,"for property",i);else C.error("Invalid property name:",i)}return n};class Y{constructor(t,e,r){this.store=t,this.configurationProvider=e,this.appContextProvider=r}remove(){this.store.remove(L.DataPoints)}get(){return this.store.get(L.DataPoints)||[]}set(t){t.length?this.store.set(L.DataPoints,t):this.remove()}add(t,e){let{properties:r,systemProperties:n,timestamp:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={[q.type]:t,[q.timestamp]:null!=o?o:M(),[q.name]:e};var a,s;u(n)&&(n={...(a=n,s=(t,e)=>(t=>T.SYSTEM_PROPERTY_PREFIX+t)(e),Object.fromEntries(Object.entries(a).map((t=>{let[e,r]=t;return[s(0,e),r]}))))});const c={...n,...r};(t=>0===Object.keys(t).length)(c)||(i[q.properties]=c);const f=this.get();this.prepareQueueToInsert(f),G(G(f).ctx).data.push(i),this.set(f)}prepareQueueToInsert(t){const e=this.configurationProvider.get("RequestId"),r=this.configurationProvider.get("SessionId"),n=this.configurationProvider.get("ConfigReceivedTime"),o=this.appContextProvider.get();t.length&&G(t).rid===e||t.push({rid:e,sid:r,time:n,ctx:[]});const i=G(t),a=G(i.ctx);i.ctx.length&&a.id===o.id&&a.name===o.name||i.ctx.push({id:o.id,name:o.name,data:[]})}deleteByCount(t){var e,r,n,o,i,a,u,s;const c=this.get();var f,l;null===(e=c[0])||void 0===e||null===(r=e.ctx[0])||void 0===r||null===(n=r.data)||void 0===n||n.splice(0,t),null!==(o=c[0])&&void 0!==o&&null!==(i=o.ctx[0])&&void 0!==i&&null!==(a=i.data)&&void 0!==a&&a.length||null===(f=c[0])||void 0===f||null===(l=f.ctx)||void 0===l||l.shift(),null!==(u=c[0])&&void 0!==u&&null!==(s=u.ctx)&&void 0!==s&&s.length||null==c||c.shift(),this.set(c)}assignPreSessionItems(t,e,r){this.set(this.get().map((n=>(n.sid||n.rid!==t||(n.sid=e,n.time=r),n))))}deletePreSessionItems(t){this.set(this.get().filter((e=>t?e.rid!==t:e.sid)))}deleteBySessionId(t){this.set(this.get().filter((e=>e.sid!==t)))}select(t){var e,r,n;const o=this.get()[0];return null!=o&&o.sid?{sessionId:o.sid,configReceivedTime:o.time,appContextId:null===(e=o.ctx[0])||void 0===e?void 0:e.id,appContextName:null===(r=o.ctx[0])||void 0===r?void 0:r.name,dataPoints:(null===(n=o.ctx[0])||void 0===n?void 0:n.data.slice(0,t))||[]}:void 0}}const K=()=>{const t=Math.random();return t?t.toString(36).slice(2):K()},X=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((e=>setTimeout(e,t)))},J=new class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;if(this.key=t,this.expiry=e,this.id=K(),this.localStorage=window.localStorage,this.expiry<100)throw new Error("Lock should have a minimum expiry of ".concat(100,"ms"))}lockName(t){return"sn:".concat(this.key).concat(t)}get outerLock(){return this.lockName(":X")}get innerLock(){return this.lockName(":Y")}async tryGetLock(){return this.setLockHolder(this.outerLock),!this.getLockHolderIdAndRemoveExpired(this.innerLock)&&(this.setLockHolder(this.innerLock),await X(),this.getLockHolderIdAndRemoveExpired(this.outerLock)===this.id||(await X(50),this.getLockHolderIdAndRemoveExpired(this.innerLock)===this.id))}async acquire(){const t=D();for(;D()-t<this.expiry;){if(await this.tryGetLock())return C.debug("Lock '".concat(this.key,"' acquired")),{release:this.release.bind(this)};await X(25*Math.random())}throw new _("Lock could not be acquired within ".concat(this.expiry,"ms"))}release(){this.localStorage.removeItem(this.outerLock),this.localStorage.removeItem(this.innerLock),C.debug("Lock '".concat(this.key,"' released"))}setLockHolder(t){const e={id:this.id,expiresAt:D()+this.expiry};this.localStorage.setItem(t,JSON.stringify(e))}getLockHolderIdAndRemoveExpired(t){const e=this.localStorage.getItem(t);if(!e)return;const r=JSON.parse(e);if(!(D()>r.expiresAt))return r.id;this.localStorage.removeItem(t)}}("create-browser-id");class Q{constructor(t){this.store=t}get(){return this.store.get(L.BrowserId)}async getOrCreate(){let t=this.get();if(!t){const e=await J.acquire();t=this.get(),t||(t=O(),this.store.set(L.BrowserId,t)),e.release()}return t}}class Z{constructor(t){this.store=t}getOrCreate(){let t=this.store.get(L.TabId);return t||(t=O(),this.store.set(L.TabId,t)),t}}class tt extends N{constructor(t){super(t,window.localStorage)}}class et extends N{constructor(t){super(t,window.sessionStorage)}}const rt=new class{constructor(){this.store=new Map}get length(){return this.store.size}key(t){var e;return null!==(e=Array.from(this.store.keys())[t])&&void 0!==e?e:null}clear(){this.store.clear()}getItem(t){var e;return null!==(e=this.store.get(t))&&void 0!==e?e:null}removeItem(t){this.store.delete(t)}setItem(t,e){this.store.set(t,e)}getAllEntries(){return Array.from(this.store.entries())}loadEntries(t){if(t){C.info("Loading backup data to store");for(const e of t)this.store.set(e[0],e[1])}}};class nt extends N{constructor(t,e){super(t,rt,!0),this.backupStore=e,this.loadBackup(),this.registerBackupBeforeUnload()}loadBackup(){try{rt.loadEntries(this.backupStore.get(L.MemoryBackup))}catch(t){C.error("Unable to load backup from session storage",t)}this.backupStore.remove(L.MemoryBackup)}registerBackupBeforeUnload(){const t=()=>{try{this.backupStore.set(L.MemoryBackup,rt.getAllEntries())}catch(t){C.error("Unable to save backup on unload",t)}};["beforeunload","unload"].forEach((e=>{window.addEventListener(e,t,!0)}))}}const ot=(t,e,r)=>({set:r=>t.set(e,r),get:()=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:r},remove:()=>t.remove(e)}),it=new class{validate(t){if(!t)throw new _("Need to call setKeys with a valid apiKey");return t}setKeys(t,e){const r=new tt(t);this.appUserIdProvider=ot(r,L.AppUserId),this.browserIdProvider=new Q(r),this.clientIdProvider=ot(r,L.ClientId,T.DEFAULT_CLIENT_ID),this.trackingConsentProvider=ot(r,L.TrackingConsent,T.DEFAULT_TRACKING_CONSENT);const n=new et(t),o=new nt(t,n);this.configurationProvider=new F(o,t,e,this.appUserIdProvider),this.tabIdProvider=new Z(o),this.currentPageProvider=ot(o,L.CurrentPage,""),this.domainProvider=ot(o,L.Domain,{}),this.appContextProvider=ot(o,L.AppContext,{}),this.dataPointsProvider=new Y(o,this.configurationProvider,this.appContextProvider)}get appContext(){return this.validate(this.appContextProvider)}get appUserId(){return this.validate(this.appUserIdProvider)}get browserId(){return this.validate(this.browserIdProvider)}get clientId(){return this.validate(this.clientIdProvider)}get configuration(){return this.validate(this.configurationProvider)}get currentPage(){return this.validate(this.currentPageProvider)}get dataPoints(){return this.validate(this.dataPointsProvider)}get domain(){return this.validate(this.domainProvider)}get tabId(){return this.validate(this.tabIdProvider)}get trackingConsent(){return this.validate(this.trackingConsentProvider)}};class at{add(t,e,r){if(!f(t))throw new w("Invalid event name: ''");u(e)&&(y(e)?e=$(e,!1,!1):(e=void 0,C.error("Invalid event properties for event",t)));const o={Page:it.currentPage.get()};u(r)&&(c(r)?o.Type=r:C.error("Invalid type",r,"for event",t)),it.dataPoints.add(n.Event,t,{properties:e,systemProperties:o})}addConsentChange(t,e){this.add("SNAnalyticsTrackingTriggered",{Value:t,PreviousValue:e})}}class ut{start(t,e){var r;if(t=null!==(r=t)&&void 0!==r?r:"",!c(t))throw new w("Page name must be a string");const o={};u(e)&&(f(e)?e.length>100?C.error("Ignoring description too long (greater than ".concat(100,")")):o.Description=e:C.error("Ignoring empty page description")),it.currentPage.set(t),it.dataPoints.add(n.Page,t,{systemProperties:o})}}var st,ct;!function(t){t.Op="op",t.Val="val"}(st||(st={})),function(t){t.Inc="$inc",t.AppendToList="$appendToList"}(ct||(ct={}));class ft{getAppUserIdOrNull(){return it.appUserId.get()||null}setAppUserId(t){it.dataPoints.add(n.User,t||null)}removeProperty(t){this.setProperty(t,null)}setProperty(t,e){this.setProperties({[t]:e})}setProperties(t){y(t)?(t=$(t,!0,!0),it.dataPoints.add(n.User,this.getAppUserIdOrNull(),{properties:t})):C.error("Invalid user properties")}incProperty(t,e){if(!l(e))throw new w("Property value must be a number");e?this.operationToProperty(t,e,ct.Inc):C.debug("Ignoring inc user property by zero")}appendToProperty(t,e){if(!c(e))throw new w("Property value must be a string");this.operationToProperty(t,[e],ct.AppendToList)}operationToProperty(t,e,r){if(!f(t))throw new w("Property name must be a string");if(z(t))throw new w("Property name has invalid prefix");it.dataPoints.add(n.User,this.getAppUserIdOrNull(),{properties:{[t]:{[st.Op]:r,[st.Val]:e}}})}}const lt=144e5;function pt(t){if(lt<t)return C.warn("Duration exceeded maximum limit, it has been trimmed to ",lt,"milliseconds"),lt;const e=Math.round(t);return e!==t?(C.warn("Performance duration",t,"was given in decimal and it was rounded to",e),e):t}function ht(t,e){if(t.length>e){const r=t.substring(0,e);return C.warn("Maximum string length is",e,"but length is",t.length,". The string",t,"will be trimmed to",r),r}return t}class dt{constructor(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.key=t,this.type=e,this.startTime=r,this.duration=n,this.properties=o,this.key=ht(t,255),this.type=ht(e,100)}get traceEnded(){return-1!==this.duration}send(){if(it.configuration.get("IgnorePerformanceData"))return void C.info("Ignoring performance traces according to config");const t={Duration:this.duration,TraceType:this.type};it.dataPoints.add(n.PerformanceTrace,this.key,{properties:this.properties,systemProperties:t,timestamp:this.startTime})}end(){this.traceEnded?C.warn("Trace already ended"):(C.info("End Performance Trace:",this.key,"-",this.type,"-",this.duration,"-",this.properties),this.duration=pt(Date.now()-this.startTime),this.send())}setProperty(t,e){this.traceEnded?C.warn("Ignoring set property since trace already ended"):f(t)?s(e)?this.removeProperty(t):c(e)?(t=ht(t,255),e=ht(e,255),Object.keys(this.properties).length>=20&&!(t in this.properties)?C.error("Ignoring property",t,"since each trace is limited to",20,"properties"):(C.info("Setting performance property:",t,"with value:",e),this.properties[t]=e)):C.error("Invalid performance value",e,"for property with key",t):C.error("Invalid performance key",t)}setProperties(t){if(this.traceEnded)C.warn("Ignoring set properties since trace already ended");else for(const[e]of Object.entries(t))this.setProperty(e,t[e])}removeProperty(t){this.traceEnded?C.warn("Ignoring remove property since trace already ended"):(t=ht(t,255),delete this.properties[t])}}class vt{start(t,e){if(this.validateTrace(t,e))return new dt(t,e,Date.now())}add(t,e,r,n,o){var i;this.validateTrace(t,e)&&(!l(r)||r<0?C.error("Invalid durationMS for performance trace"):(r=pt(r),o=o instanceof Date?o.getTime():null!==(i=o)&&void 0!==i?i:Date.now()-r,h(o,!0)?new dt(t,e,o,r,n).send():C.error("Invalid startTime for performance trace")))}validateTrace(t,e){return f(t)?!!f(e)||(C.warn("Invalid type for performance trace"),!1):(C.warn("Invalid key for performance trace"),!1)}}class yt{constructor(){this.eventRecorder=new at,this.pageRecorder=new ut,this.userRecorder=new ft,this.performanceRecorder=new vt}get event(){return this.eventRecorder}get page(){return this.pageRecorder}get user(){return this.userRecorder}get performance(){return this.performanceRecorder}}class gt{static getScreenDimension(){const{height:t,width:e}=window.screen;return{height:t||0,width:e||0}}static getSystemLocale(){return window.navigator.language.toLowerCase()}}const mt=async()=>{return t={Version:T.VERSION,APIKey:it.configuration.get("ApiKey"),APIAuth:it.configuration.get("ApiAuth"),BrowserId:await it.browserId.getOrCreate(),ClientId:it.clientId.get()},Object.fromEntries(Object.entries(t).filter((t=>{let[,e]=t;return Boolean(e)})));var t},bt=async(t,e,r)=>{const n=D(),o=await(async(t,e,r)=>{let n=0;try{const o=new AbortController,{signal:i}=o,a=fetch("".concat(T.baseUrl,"/web/").concat(t),{method:"POST",mode:"cors",cache:"no-cache",headers:{...await mt(),"Content-Type":"application/json"},referrer:"no-referrer",body:JSON.stringify(e),signal:i});n=window.setTimeout((()=>o.abort()),r);const u=await a;try{const e=await u.json();return u.ok?e:(C.warn("Server call to '".concat(t,"' failed. Response is"),u.status,":",e.Error),Promise.reject(new E(e.ErrorCode)))}catch(e){return C.warn("Server call to '".concat(t,"' failed. Response is"),u.status,e),Promise.reject(new E)}}catch(e){return C.warn("Server call to '".concat(t,"' failed."),e),Promise.reject(new E)}finally{clearTimeout(n)}})(t,e,r);return C.debug("Profiler: '".concat(t,"' request took"),D()-n,"ms"),o};var _t,wt=function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};!function(t){t[t.SessionNotFound=1]="SessionNotFound"}(_t||(_t={}));const Et=(t,e)=>({ok:!1,errorCode:t,data:e}),Ot=6e4;class Tt{static async getConfiguration(t){const{height:e,width:r}=gt.getScreenDimension(),n=it.domain.get(),o=await bt("config",{RequestId:t,TabId:it.tabId.getOrCreate(),SystemLocale:gt.getSystemLocale(),AppUserId:it.appUserId.get(),ScreenHeight:e,ScreenWidth:r,ClientTime:k(D()),DomainId:null==n?void 0:n.id,DomainName:null==n?void 0:n.name,TrackingLevel:it.trackingConsent.get()},Ot);return it.configuration.isValidConfigResponse(o)?t!==it.configuration.get("RequestId")?(C.warn("Ignoring old configuration with request id",t,"and session id",o.SessionId),Et(_t.SessionNotFound,o.SessionId)):(it.configuration.fillWithJson(o),it.configuration.updateServerResponseTime(),C.debug("Networker got valid configuration response",o),{ok:!0}):(C.warn("Configuration response for request id",t,"is not valid:",o),Et())}static async sendHeartbeat(t){return await bt("heartbeat",{SessionId:t.sessionId,DataPoints:t.dataPoints,TabId:it.tabId.getOrCreate(),ClientTime:k(D()),ConfigReceivedTime:k(t.configReceivedTime),AppContextId:t.appContextId,AppContextName:t.appContextName},Ot),it.configuration.updateServerResponseTime(),C.debug("Networker sent heartbeat"),{ok:!0}}static async deleteUserData(t){return await bt("delete-data",{AppUserId:t},Ot),C.debug("Networker deleted user"),{ok:!0}}}var St;wt([P(Error,(()=>Et()))],Tt,"getConfiguration",null),wt([P(Error,(()=>Et())),P(E,(t=>Et(t.errorCode)))],Tt,"sendHeartbeat",null),wt([P(Error,(()=>Et()))],Tt,"deleteUserData",null),function(t){t[t.Created=0]="Created",t[t.Started=1]="Started",t[t.Ended=2]="Ended"}(St||(St={}));class xt{constructor(){this.isGettingCurrSessionConfig=!1}setIsGettingConfiguration(t,e){t===it.configuration.get("RequestId")&&(this.isGettingCurrSessionConfig=e)}isSessionTimedOut(){return D()-it.configuration.get("LastServerResponseTime")>it.configuration.get("SessionTimeout")}isUserChanged(){return it.configuration.get("AppUserId")!==it.appUserId.get()}isSessionIdExist(){return f(it.configuration.get("SessionId"))}getCurrentState(){let t;if(this.isUserChanged())C.debug("Session Lifecycle: User switched from",it.appUserId.get(),"to",it.configuration.get("AppUserId")),t=St.Ended;else if(this.isSessionIdExist()){const e=this.isSessionTimedOut();C.debug("Session Lifecycle: Session timed out - ",e),t=e?St.Ended:St.Started}else C.debug("Session Lifecycle: Getting config for current session - ",this.isGettingCurrSessionConfig),t=this.isGettingCurrSessionConfig?St.Created:St.Ended;return t}}class Rt{constructor(t){this.sessionLifecycleManager=t,this.heartbeatTimeoutId=0,this.heartbeatErrorCounter=0}startHeartbeats(){if(this.heartbeatTimeoutId)return;C.info("Starting heartbeats");const t=async()=>{try{await this.sendHeartbeat()}catch(t){C.warn("Heartbeat failed",t)}this.heartbeatTimeoutId=window.setTimeout(t,it.configuration.get("HeartbeatInterval"))};this.heartbeatTimeoutId=window.setTimeout(t)}stopHeartbeats(){C.info("Stop heartbeats"),clearTimeout(this.heartbeatTimeoutId),this.heartbeatTimeoutId=0}async sendHeartbeat(){const t=it.dataPoints.select(it.configuration.get("MaxDataPointsPerHeartbeat"));if(null==t||!t.dataPoints.length)return void C.debug("Heartbeat skipped: No data points to send");C.info("Send heartbeat:",t);const e=await Tt.sendHeartbeat(t);e.ok?(C.info("Heartbeat sent successfully"),it.dataPoints.deleteByCount(t.dataPoints.length),this.heartbeatErrorCounter=0):e.errorCode===_t.SessionNotFound?(C.info("Session ".concat(t.sessionId," not found for heartbeat, deleting session configuration and data")),it.configuration.deleteSessionData(t.sessionId),it.dataPoints.deleteBySessionId(t.sessionId),this.heartbeatErrorCounter=0):t.sessionId!==it.configuration.get("SessionId")||this.sessionLifecycleManager.getCurrentState()===St.Ended?this.heartbeatErrorCounter<T.MAX_HEARTBEAT_CALL_ATTEMPTS?(this.heartbeatErrorCounter++,C.info("Heartbeat failed for a session that was ended ".concat(t.sessionId,","),"will try again later (attempt ".concat(this.heartbeatErrorCounter,"/").concat(T.MAX_HEARTBEAT_CALL_ATTEMPTS,")"))):(C.info("Heartbeat failed for a session that was ended",t.sessionId,"deleting its data"),it.dataPoints.deleteBySessionId(t.sessionId),it.configuration.deleteSessionData(t.sessionId),this.heartbeatErrorCounter=0):C.info("Heartbeat failed for alive session, will try again later")}}function Pt(t){if(!s(t)&&!c(t))throw new w("User id must be a non empty string");return t||void 0}var At=function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a};class It{constructor(){this.isWired=!1,this.sessionLifecycleManager=new xt,this.heartbeatManager=new Rt(this.sessionLifecycleManager),this.metadataRecorder=new yt}start(t,e,r){if(C.info("Start session - API Key:",t,", API Auth:",e,", Options:",r),this.isWired){if(C.info("Session is already running"),t!==it.configuration.get("ApiKey")||e!==it.configuration.get("ApiAuth"))return void C.error("SDK already started with different API Key and Auth")}else{if(!f(t))throw new w('"apiKey" must be a string and cannot be empty');if(!f(e))throw new w('"apiAuth" must be a string and cannot be empty');if(u(r)){if(!y(r))throw new w('"options" must be an object');u(r.serverEndpoint)&&(T.baseUrl=r.serverEndpoint)}try{this.wire(t,e)}catch(t){return C.error("SDK wiring failed",t),void this.unwire()}}if(y(r)){if(u(r.userId))try{C.info("Set user id before config");const t=Pt(r.userId);it.appUserId.set(t)}catch(t){C.error(t instanceof Error?t.message:t)}this.saveDomain(r),this.saveAppContext(r),u(r.trackingConsent)&&this.setTrackingConsent(r.trackingConsent)}this.startNewSessionIfNeeded()}startPage(t,e){C.info("Start page - Name:",t,", Description:",e),this.metadataRecorder.page.start(t,e)}addEvent(t,e,r){C.info("Add event - Name:",t,", Properties:",e,", Type:",r),this.metadataRecorder.event.add(t,e,r)}setUserId(t){if(!this.validateSdkReady())return;C.info("Set user id:",t);const e=Pt(t);it.appUserId.set(e),this.startNewSessionIfNeeded()}setUserProperty(t,e){C.info("Set user property:",t,"-",e),this.metadataRecorder.user.setProperty(t,e)}setUserProperties(t){C.info("Set user properties:",t),this.metadataRecorder.user.setProperties(t)}removeUserProperty(t){C.info("Remove user property:",t),this.metadataRecorder.user.removeProperty(t)}incUserProperty(t,e){C.info("Increment user property:",t,"-",e),this.metadataRecorder.user.incProperty(t,e)}appendToUserProperty(t,e){C.info("Append to user property:",t,"-",e),this.metadataRecorder.user.appendToProperty(t,e)}startPerformanceTrace(t,e){return C.info("Started Performance Trace:",t,"-",e),this.metadataRecorder.performance.start(t,e)}addPerformanceTrace(t,e,r,n,o){C.info("Added Performance Trace:",t,"-",e),this.metadataRecorder.performance.add(t,e,r,n,o)}setTrackingConsent(t){C.info("Set tracking consent level to:",t);let e=S(t,i,!0);if(!u(e)){if(!d(t))throw new _("Tracking consent Level must be one of: ".concat(Object.keys(i).join(" | ")));e=t?i.Full:i.Disabled,C.warn("Boolean tracking consent level is deprecated")}const r=it.trackingConsent.get();if(e===r)return void C.info("Tracking consent level is the same:",e);it.trackingConsent.set(e),C.info("Tracking consent level is now:",e);const n=this.sessionLifecycleManager.getCurrentState();e===i.Basic||e===i.Full?this.startNewSessionIfNeeded()&&this.metadataRecorder.event.addConsentChange(e,r):n!==St.Created&&n!==St.Started||(this.metadataRecorder.event.addConsentChange(e,r),this.stopSession())}getTrackingConsent(){return C.info("Get tracking consent"),it.trackingConsent.get()}async deleteCurrentUserData(){C.info("Deleting current user data"),this.setTrackingConsent(i.Disabled);const t=it.clientId.get();if(!t||t===T.DEFAULT_CLIENT_ID)return C.warn("SNAnalytics was never started on the device"),!0;const e=it.appUserId.get();if(!(await Tt.deleteUserData(e)).ok)throw new _("Server could not delete user ".concat(e));return it.appUserId.remove(),this.stopSession(!0),!0}setDebugLevel(t){C.info("Set debug level:",t),C.setDebugLevel(t)}StartSession(t,e,r){const n=r.value;return r.value=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.startNewSessionIfNeeded()?n.apply(this,e):void 0},r}static get StartSession(){return It.prototype.StartSession}EnsureWired(t,e,r){const n=r.value;return r.value=function(){if(this.isWired){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return n.apply(this,e)}throw new _("Must call SNAnalytics.start beforehand")},r}static get EnsureWired(){return It.prototype.EnsureWired}validateSdkReady(){return this.isWired?it.trackingConsent.get()!==i.Disabled||(C.warn("No tracking consent given"),!1):(C.warn("Must call SNAnalytics.start beforehand"),!1)}startNewSessionIfNeeded(){try{return!!this.validateSdkReady()&&(this.sessionLifecycleManager.getCurrentState()===St.Ended&&(this.stopSession(),this.startNewSession()),it.configuration.get("RecordMetadata"))}catch(t){return C.error("Could not start a session:",t),!1}}wire(t,e){C.info("Wiring SDK..."),it.setKeys(t,e),it.dataPoints.deletePreSessionItems(),this.heartbeatManager.startHeartbeats(),this.isWired=!0,C.info("SDK is Wired")}unwire(){this.isWired=!1,this.heartbeatManager.stopHeartbeats()}stopSession(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&it.dataPoints.deleteBySessionId(it.configuration.get("SessionId")),it.configuration.deleteData()}async startNewSession(){const t=O();C.info("Starting new session with request id",t),it.configuration.startNewSession(t),this.sessionLifecycleManager.setIsGettingConfiguration(t,!0);const e=await Tt.getConfiguration(t);if(this.sessionLifecycleManager.setIsGettingConfiguration(t,!1),e.ok)this.gotConfiguration(t);else if(e.errorCode===_t.SessionNotFound){const r=e.data;C.warn("Got bad config response for request id",t,", session finished",r),it.dataPoints.assignPreSessionItems(t,r,D()),it.configuration.deleteSessionData(r)}else C.warn("Got bad config response for request id",t),it.dataPoints.deletePreSessionItems(t)}gotConfiguration(t){C.info("Got session id:",it.configuration.get("SessionId")),it.dataPoints.assignPreSessionItems(t,it.configuration.get("SessionId"),it.configuration.get("ConfigReceivedTime"));const e=it.configuration.get("LogLevel");u(e)&&(T.IS_PRODUCTION?C.setDebugLevel(e):C.warn("Log level can be changed from config response only in production")),it.clientId.set(it.configuration.get("ClientId")),it.configuration.get("RecordMetadata")?this.metadataRecorder.user.setAppUserId(it.configuration.get("AppUserId")):C.info("Record metadata is false so no data points will be collected")}saveDomain(t){if(a(t.domainId)&&a(t.domainName))it.domain.remove();else{if(u(t.domainId)&&!c(t.domainId))throw new w('"domainId" must be string');if(u(t.domainName)&&!c(t.domainName))throw new w('"domainName" must be string');it.domain.set({id:t.domainId,name:t.domainName})}}saveAppContext(t){if(a(t.appContextId)&&a(t.appContextName))it.appContext.remove();else{if(u(t.appContextId)&&!c(t.appContextId))throw new w('"appContextId" must be string');if(u(t.appContextName)&&!c(t.appContextName))throw new w('"appContextName" must be string');it.appContext.set({id:t.appContextId,name:t.appContextName})}}}At([I,It.StartSession],It.prototype,"startPage",null),At([I,It.StartSession],It.prototype,"addEvent",null),At([I],It.prototype,"setUserId",null),At([I,It.StartSession],It.prototype,"setUserProperty",null),At([I,It.StartSession],It.prototype,"setUserProperties",null),At([I,It.StartSession],It.prototype,"removeUserProperty",null),At([I,It.StartSession],It.prototype,"incUserProperty",null),At([I,It.StartSession],It.prototype,"appendToUserProperty",null),At([I,It.StartSession],It.prototype,"startPerformanceTrace",null),At([I,It.StartSession],It.prototype,"addPerformanceTrace",null),At([I,It.EnsureWired],It.prototype,"setTrackingConsent",null),At([A(i.Disabled),It.EnsureWired],It.prototype,"getTrackingConsent",null),At([A(!1),It.EnsureWired],It.prototype,"deleteCurrentUserData",null),At([I],It.prototype,"setDebugLevel",null),At([I],It.prototype,"unwire",null),At([I],It.prototype,"startNewSession",null);const jt=new It;class Ct{static start(t,e,r){jt.start(t,e,r)}static startPage(t,e){jt.startPage(t,e)}static addEvent(t,e,r){jt.addEvent(t,e,r)}static setUserId(t){jt.setUserId(t)}static setUserProperty(t,e){jt.setUserProperty(t,e)}static setUserProperties(t){jt.setUserProperties(t)}static removeUserProperty(t){jt.removeUserProperty(t)}static incUserProperty(t,e){jt.incUserProperty(t,e)}static appendToUserProperty(t,e){jt.appendToUserProperty(t,e)}static startPerformanceTrace(t,e){return jt.startPerformanceTrace(t,e)}static addPerformanceTrace(t,e,r,n,o){jt.addPerformanceTrace(t,e,r,n,o)}static setTrackingConsent(t){jt.setTrackingConsent(t)}static getTrackingConsent(){return jt.getTrackingConsent()}static async deleteCurrentUserData(){return jt.deleteCurrentUserData()}static setDebugLevel(t){jt.setDebugLevel(t)}}const Lt="UXF_USER_NAV_LOAD_COMPLETE",Nt="EXPERIENCE_START",kt="USER_NAVIGATE",Dt={[Nt]:"Page Navigate",[kt]:"Page Navigate"};var Ut=r(7361),Mt=r.n(Ut);const Bt=Mt()(window,["ux_globals","libuxf","sysprops"],{}),Ht=Mt()(Bt,"glide.uxf.lib.performance.trend.reporting.enabled","true"),Ft="***",qt="/params/",Gt="/sub/",zt=["sysparm_query","sysparm_view","sysparm_userpref_module","sys_id","sysparm_record_target","sysparm_dashboard"],Wt="appsee",Vt=Object.freeze({full:"Full",basic:"Basic",disabled:"Disabled",missing:"Needed"}),$t=["$PERF-DATA","UXF_DIRECT_LOAD_COMPLETE",Lt];let Yt={};function Kt(){const t=(Yt.channelType||"").trim();return"NowExperience"!==t&&"CoreUI"!==t&&"NextExperience"!==t}var Xt=r(7510),Jt=r(4061),Qt=r.n(Jt);function Zt(t,e){return t.replace(e,Ft)}function te(t,e,r){let n={},o="";if(e){const i=null==t?void 0:t.split(qt),a=function(t,e,r){const n=/^[a-z0-9]+$/i,o={};let i=t;for(const t in e)o[r+t]=e[t],32===e[t].length&&n.test(e[t])&&(i=Zt(i,e[t]));return{url:i,fields:o}}(null==i?void 0:i[0],e.fields,r);if(o=a.url,n={...a.fields},e.params&&i.length>1){const t=function(t,e,r){const n=r?"".concat(r,"param_"):"param_",o={};let i=t;for(const r in e){var a;o[n+r]=e[r];const u=null===(a=e[r])||void 0===a?void 0:a.toString(),s=u&&(t.includes(u)?u:encodeURIComponent(u));s&&(i=Zt(i,s))}return{url:i,params:o}}(i[1],e.params,r);o="".concat(o).concat(qt).concat(t.url),n={...n,...t.params}}e._timestamp&&(o=Zt(o,e._timestamp))}else o=t;return{maskedUrl:o,allUrlParams:n}}r(9307);const ee="record",re="classic";function ne(t){return t.route===re||!1===t.isSeismicApp}function oe(t,e){const{route:r,fields:n,parent:o}=null!=e?e:{},i=null==n?void 0:n.table,a=null==o?void 0:o.route;let u;return(r||a)&&(u=r===ee?t?t.includes("/sub/record/")?"".concat("sub","-").concat(ee,"-").concat(i):"".concat(ee,"-").concat(i):null:"".concat(a?"".concat("sub","-"):"").concat(r).concat(i?"-".concat(i):"")),u}function ie(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{url:e,selectedContent:r={}}=t,n=ne(r)?function(t){if(!t)return;const e=decodeURIComponent(t),r={},n=e.split("?"),o=t.startsWith("/nav_to.do")?t.split("%3F"):n;if(r.url=o[0],n.length>1){const t=new URLSearchParams(n[1]);zt.forEach((e=>{const n=t.get(e);n&&(r[e]=n)}))}return r}(e):function(t,e){const{url:r,workspaceParams:n}=function(t,e){let r="",n="";const o=null==t?void 0:t.split(Gt);if((null==o?void 0:o.length)>1){const t=te(o[0],e.parent,"parent_"),i=te(o[1],e,"");r="".concat(t.maskedUrl).concat(Gt).concat(i.maskedUrl);for(let t=2;t<=o.length-1;t++)r="".concat(r).concat(Gt).concat(o[t]);n={...t.allUrlParams,...i.allUrlParams}}else{const t=te(null==o?void 0:o[0],e,"");r=t.maskedUrl,n={...t.allUrlParams}}return{url:r,workspaceParams:n}}(t,e);return{url:r,...n}}(e,r);return n||[]}const ae=function(t){let{url:e="",selectedContent:r={},pageTitle:n}=t;return(ne(r)?function(t){const e=t?decodeURIComponent(t):null,r=e&&e.match(/[$\w\-]+(?=.do[?]*)/g);return r&&("nav_to"===r[0]?r[1]:r[0])}(e):oe(e,r))||n},ue=oe;function se(t){const{event:e,options:{meta:r,...n}={},markTime:o,interactionId:i,componentId:a,parentComponentId:u,type:s,componentName:c,...f}=t;let l={...n,...f};return e!==Nt&&e!==kt||(l={...l,...ie(r)},l["Entry Page"]=function(t){let{switched:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t===Nt&&!1===e}(e,r),l["Page Title"]=null==r?void 0:r.pageTitle,l=function(t,e){return Qt()(e,((e,r)=>(e[r]=t[r],e)),{})}(l,Yt.allowedPropsInPageNavigate)),function(t){Object.keys(t).forEach((e=>{var r;t[e]&&!(function(t){return"string"==typeof t||"boolean"==typeof t||"number"==typeof t&&!Number.isNaN(t)}(r=t[e])||r instanceof Date)&&(t[e]=JSON.stringify(t[e]))}))}(l),{eventName:Dt[e]||e,eventProps:l}}var ce=r(6486);let fe,le=!1,pe=[];function he(){let{marks:t=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=function(t){const e=Yt.trackingConsent;if(e===Vt.basic||e===Vt.full){let e=t;return pe.length&&(e=[...pe,...t],pe.length=0),e}return e===Vt.missing&&t&&t.length&&(pe=pe.length?[...pe,...t]:t),[]}(t);e.forEach((function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{options:{}};if(t.event===Nt){const{meta:{applicationContextId:e,applicationContextName:r,switched:n}={}}=t.options;if(le=function(t){const{restrictedApps:e=""}=Yt;return t&&e.indexOf(t)>-1}(e),!le&&ve(e,r),n)return}if(!le)if($t.includes(t.event)){if("true"!==Ht)return;const{options:{metrics:e,key:r,totalUiTime:n,screenRoute:o,screenFields:i,url:a="",screenParent:u}={}}=t;if(n){const e=t.event===Lt?"navigation":"direct load";return void Ct.addPerformanceTrace(ue(a,{route:o,fields:i,parent:u}),"Page Load Time",Math.round(n),{navigationType:e})}if(Array.isArray(e))return void t.options.metrics.forEach((t=>{var e;"Page Load Time"!==t.name||null!==(e=t.properties)&&void 0!==e&&e.navigationType||(t.properties||(t.properties={}),t.properties.navigationType="direct load"),Ct.addPerformanceTrace(r,t.name,Math.round(t.value),t.properties)}))}else!function(t){const{options:e={},event:r}=t;if((0,ce.isEmpty)(r))return;if(r===Nt||r===kt){var n,o;if(null!==(n=e.meta)&&void 0!==n&&n.url&&(e.meta.url=e.meta.url.replace(window.location.origin,""),e.meta.url===fe))return;fe=null===(o=e.meta)||void 0===o?void 0:o.url}const{eventName:i,eventProps:a}=se(t);(function(t,e){const r=function(t,e){const{meta:r={}}=e;return kt===t||Nt===t?ae(r)||e.pageTitle:null}(t,e);r&&Ct.startPage(r)})(r,e),Ct.addEvent(i,a)}(t)}))}let de=!1;function ve(t,e){const{apiAuth:r,apiKey:n,endpointURL:o,trackingConsent:i,user:{hashId:a,domainId:u,domainName:s,roles:c}}=Yt,f={serverEndpoint:o,trackingConsent:i,userId:a,appContextId:t,appContextName:e,domainId:u,domainName:s};Ct.start(n,r,f),function(t){if(!de){const e=(null==t?void 0:t.split(","))||[];de=!0,Ct.setUserProperty("roles",e)}}(c)}function ye(t){var e;de=!1,function(t){Yt=t;const{allowedPropsInPageNavigate:e=""}=Yt;Yt.allowedPropsInPageNavigate=e.split(","),Yt&&!Yt.trackingConsent&&(Yt.trackingConsent=Vt.basic)}(t),t.trackingConsent===Vt.missing?null===(e=window.userConsent)||void 0===e||e.subscribe(Wt,(t=>{var e;e="Y"===t?Vt.full:"N"===t?Vt.basic:Vt.disabled,Yt.trackingConsent=e,"Y"===t||"N"===t?(Kt()&&ve(),he()):pe.length=0})):Kt()&&ve()}const ge=Xt.markTypes.usage},3778:(t,e,r)=>{"use strict";r.r(e),r.d(e,{AsyncCompress:()=>Ct,AsyncDecompress:()=>Yt,AsyncDeflate:()=>Tt,AsyncGunzip:()=>Dt,AsyncGzip:()=>Ct,AsyncInflate:()=>Pt,AsyncUnzipInflate:()=>we,AsyncUnzlib:()=>zt,AsyncZipDeflate:()=>ve,AsyncZlib:()=>Ht,Compress:()=>jt,DecodeUTF8:()=>re,Decompress:()=>$t,Deflate:()=>Ot,EncodeUTF8:()=>ne,FlateErrorCode:()=>C,Gunzip:()=>kt,Gzip:()=>jt,Inflate:()=>Rt,Unzip:()=>Ee,UnzipInflate:()=>_e,UnzipPassThrough:()=>be,Unzlib:()=>Gt,Zip:()=>ye,ZipDeflate:()=>de,ZipPassThrough:()=>he,Zlib:()=>Bt,compress:()=>Lt,compressSync:()=>Nt,decompress:()=>Kt,decompressSync:()=>Xt,deflate:()=>St,deflateSync:()=>xt,gunzip:()=>Ut,gunzipSync:()=>Mt,gzip:()=>Lt,gzipSync:()=>Nt,inflate:()=>At,inflateSync:()=>It,strFromU8:()=>ie,strToU8:()=>oe,unzip:()=>Te,unzipSync:()=>Se,unzlib:()=>Wt,unzlibSync:()=>Vt,zip:()=>ge,zipSync:()=>me,zlib:()=>Ft,zlibSync:()=>qt});var n={},o=Uint8Array,i=Uint16Array,a=Uint32Array,u=new o([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new o([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),c=new o([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=function(t,e){for(var r=new i(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];var o=new a(r[30]);for(n=1;n<30;++n)for(var u=r[n];u<r[n+1];++u)o[u]=u-r[n]<<5|n;return[r,o]},l=f(u,2),p=l[0],h=l[1];p[28]=258,h[258]=28;for(var d=f(s,0),v=d[0],y=d[1],g=new i(32768),m=0;m<32768;++m){var b=(43690&m)>>>1|(21845&m)<<1;b=(61680&(b=(52428&b)>>>2|(13107&b)<<2))>>>4|(3855&b)<<4,g[m]=((65280&b)>>>8|(255&b)<<8)>>>1}var _=function(t,e,r){for(var n=t.length,o=0,a=new i(e);o<n;++o)++a[t[o]-1];var u,s=new i(e);for(o=0;o<e;++o)s[o]=s[o-1]+a[o-1]<<1;if(r){u=new i(1<<e);var c=15-e;for(o=0;o<n;++o)if(t[o])for(var f=o<<4|t[o],l=e-t[o],p=s[t[o]-1]++<<l,h=p|(1<<l)-1;p<=h;++p)u[g[p]>>>c]=f}else for(u=new i(n),o=0;o<n;++o)t[o]&&(u[o]=g[s[t[o]-1]++]>>>15-t[o]);return u},w=new o(288);for(m=0;m<144;++m)w[m]=8;for(m=144;m<256;++m)w[m]=9;for(m=256;m<280;++m)w[m]=7;for(m=280;m<288;++m)w[m]=8;var E=new o(32);for(m=0;m<32;++m)E[m]=5;var O=_(w,9,0),T=_(w,9,1),S=_(E,5,0),x=_(E,5,1),R=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},P=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(7&e)&r},A=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(7&e)},I=function(t){return(t+7)/8|0},j=function(t,e,r){(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length);var n=new(t instanceof i?i:t instanceof a?a:o)(r-e);return n.set(t.subarray(e,r)),n},C={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14},L=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],N=function(t,e,r){var n=new Error(e||L[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,N),!r)throw n;return n},k=function(t,e,r){var n=t.length;if(!n||r&&r.f&&!r.l)return e||new o(0);var i=!e||r,a=!r||r.i;r||(r={}),e||(e=new o(3*n));var f=function(t){var r=e.length;if(t>r){var n=new o(Math.max(2*r,t));n.set(e),e=n}},l=r.f||0,h=r.p||0,d=r.b||0,y=r.l,g=r.d,m=r.m,b=r.n,w=8*n;do{if(!y){l=P(t,h,1);var E=P(t,h+1,3);if(h+=3,!E){var O=t[(q=I(h)+4)-4]|t[q-3]<<8,S=q+O;if(S>n){a&&N(0);break}i&&f(d+O),e.set(t.subarray(q,S),d),r.b=d+=O,r.p=h=8*S,r.f=l;continue}if(1==E)y=T,g=x,m=9,b=5;else if(2==E){var C=P(t,h,31)+257,L=P(t,h+10,15)+4,k=C+P(t,h+5,31)+1;h+=14;for(var D=new o(k),U=new o(19),M=0;M<L;++M)U[c[M]]=P(t,h+3*M,7);h+=3*L;var B=R(U),H=(1<<B)-1,F=_(U,B,1);for(M=0;M<k;){var q,G=F[P(t,h,H)];if(h+=15&G,(q=G>>>4)<16)D[M++]=q;else{var z=0,W=0;for(16==q?(W=3+P(t,h,3),h+=2,z=D[M-1]):17==q?(W=3+P(t,h,7),h+=3):18==q&&(W=11+P(t,h,127),h+=7);W--;)D[M++]=z}}var V=D.subarray(0,C),$=D.subarray(C);m=R(V),b=R($),y=_(V,m,1),g=_($,b,1)}else N(1);if(h>w){a&&N(0);break}}i&&f(d+131072);for(var Y=(1<<m)-1,K=(1<<b)-1,X=h;;X=h){var J=(z=y[A(t,h)&Y])>>>4;if((h+=15&z)>w){a&&N(0);break}if(z||N(2),J<256)e[d++]=J;else{if(256==J){X=h,y=null;break}var Q=J-254;if(J>264){var Z=u[M=J-257];Q=P(t,h,(1<<Z)-1)+p[M],h+=Z}var tt=g[A(t,h)&K],et=tt>>>4;if(tt||N(3),h+=15&tt,$=v[et],et>3&&(Z=s[et],$+=A(t,h)&(1<<Z)-1,h+=Z),h>w){a&&N(0);break}i&&f(d+131072);for(var rt=d+Q;d<rt;d+=4)e[d]=e[d-$],e[d+1]=e[d+1-$],e[d+2]=e[d+2-$],e[d+3]=e[d+3-$];d=rt}}r.l=y,r.p=X,r.b=d,r.f=l,y&&(l=1,r.m=m,r.d=g,r.n=b)}while(!l);return d==e.length?e:j(e,0,d)},D=function(t,e,r){r<<=7&e;var n=e/8|0;t[n]|=r,t[n+1]|=r>>>8},U=function(t,e,r){r<<=7&e;var n=e/8|0;t[n]|=r,t[n+1]|=r>>>8,t[n+2]|=r>>>16},M=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var a=r.length,u=r.slice();if(!a)return[W,0];if(1==a){var s=new o(r[0].s+1);return s[r[0].s]=1,[s,1]}r.sort((function(t,e){return t.f-e.f})),r.push({s:-1,f:25001});var c=r[0],f=r[1],l=0,p=1,h=2;for(r[0]={s:-1,f:c.f+f.f,l:c,r:f};p!=a-1;)c=r[r[l].f<r[h].f?l++:h++],f=r[l!=p&&r[l].f<r[h].f?l++:h++],r[p++]={s:-1,f:c.f+f.f,l:c,r:f};var d=u[0].s;for(n=1;n<a;++n)u[n].s>d&&(d=u[n].s);var v=new i(d+1),y=B(r[p-1],v,0);if(y>e){n=0;var g=0,m=y-e,b=1<<m;for(u.sort((function(t,e){return v[e.s]-v[t.s]||t.f-e.f}));n<a;++n){var _=u[n].s;if(!(v[_]>e))break;g+=b-(1<<y-v[_]),v[_]=e}for(g>>>=m;g>0;){var w=u[n].s;v[w]<e?g-=1<<e-v[w]++-1:++n}for(;n>=0&&g;--n){var E=u[n].s;v[E]==e&&(--v[E],++g)}y=e}return[new o(v),y]},B=function(t,e,r){return-1==t.s?Math.max(B(t.l,e,r+1),B(t.r,e,r+1)):e[t.s]=r},H=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new i(++e),n=0,o=t[0],a=1,u=function(t){r[n++]=t},s=1;s<=e;++s)if(t[s]==o&&s!=e)++a;else{if(!o&&a>2){for(;a>138;a-=138)u(32754);a>2&&(u(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(u(o),--a;a>6;a-=6)u(8304);a>2&&(u(a-3<<5|8208),a=0)}for(;a--;)u(o);a=1,o=t[s]}return[r.subarray(0,n),e]},F=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},q=function(t,e,r){var n=r.length,o=I(e+2);t[o]=255&n,t[o+1]=n>>>8,t[o+2]=255^t[o],t[o+3]=255^t[o+1];for(var i=0;i<n;++i)t[o+i+4]=r[i];return 8*(o+4+n)},G=function(t,e,r,n,o,a,f,l,p,h,d){D(e,d++,r),++o[256];for(var v=M(o,15),y=v[0],g=v[1],m=M(a,15),b=m[0],T=m[1],x=H(y),R=x[0],P=x[1],A=H(b),I=A[0],j=A[1],C=new i(19),L=0;L<R.length;++L)C[31&R[L]]++;for(L=0;L<I.length;++L)C[31&I[L]]++;for(var N=M(C,7),k=N[0],B=N[1],G=19;G>4&&!k[c[G-1]];--G);var z,W,V,$,Y=h+5<<3,K=F(o,w)+F(a,E)+f,X=F(o,y)+F(a,b)+f+14+3*G+F(C,k)+(2*C[16]+3*C[17]+7*C[18]);if(Y<=K&&Y<=X)return q(e,d,t.subarray(p,p+h));if(D(e,d,1+(X<K)),d+=2,X<K){z=_(y,g,0),W=y,V=_(b,T,0),$=b;var J=_(k,B,0);for(D(e,d,P-257),D(e,d+5,j-1),D(e,d+10,G-4),d+=14,L=0;L<G;++L)D(e,d+3*L,k[c[L]]);d+=3*G;for(var Q=[R,I],Z=0;Z<2;++Z){var tt=Q[Z];for(L=0;L<tt.length;++L){var et=31&tt[L];D(e,d,J[et]),d+=k[et],et>15&&(D(e,d,tt[L]>>>5&127),d+=tt[L]>>>12)}}}else z=O,W=w,V=S,$=E;for(L=0;L<l;++L)if(n[L]>255){et=n[L]>>>18&31,U(e,d,z[et+257]),d+=W[et+257],et>7&&(D(e,d,n[L]>>>23&31),d+=u[et]);var rt=31&n[L];U(e,d,V[rt]),d+=$[rt],rt>3&&(U(e,d,n[L]>>>5&8191),d+=s[rt])}else U(e,d,z[n[L]]),d+=W[n[L]];return U(e,d,z[256]),d+W[256]},z=new a([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),W=new o(0),V=function(t,e,r,n,c,f){var l=t.length,p=new o(n+l+5*(1+Math.ceil(l/7e3))+c),d=p.subarray(n,p.length-c),v=0;if(!e||l<8)for(var g=0;g<=l;g+=65535){var m=g+65535;m<l?v=q(d,v,t.subarray(g,m)):(d[g]=f,v=q(d,v,t.subarray(g,l)))}else{for(var b=z[e-1],_=b>>>13,w=8191&b,E=(1<<r)-1,O=new i(32768),T=new i(E+1),S=Math.ceil(r/3),x=2*S,R=function(e){return(t[e]^t[e+1]<<S^t[e+2]<<x)&E},P=new a(25e3),A=new i(288),C=new i(32),L=0,N=0,k=(g=0,0),D=0,U=0;g<l;++g){var M=R(g),B=32767&g,H=T[M];if(O[B]=H,T[M]=B,D<=g){var F=l-g;if((L>7e3||k>24576)&&F>423){v=G(t,d,0,P,A,C,N,k,U,g-U,v),k=L=N=0,U=g;for(var V=0;V<286;++V)A[V]=0;for(V=0;V<30;++V)C[V]=0}var $=2,Y=0,K=w,X=B-H&32767;if(F>2&&M==R(g-X))for(var J=Math.min(_,F)-1,Q=Math.min(32767,g),Z=Math.min(258,F);X<=Q&&--K&&B!=H;){if(t[g+$]==t[g+$-X]){for(var tt=0;tt<Z&&t[g+tt]==t[g+tt-X];++tt);if(tt>$){if($=tt,Y=X,tt>J)break;var et=Math.min(X,tt-2),rt=0;for(V=0;V<et;++V){var nt=g-X+V+32768&32767,ot=nt-O[nt]+32768&32767;ot>rt&&(rt=ot,H=nt)}}}X+=(B=H)-(H=O[B])+32768&32767}if(Y){P[k++]=268435456|h[$]<<18|y[Y];var it=31&h[$],at=31&y[Y];N+=u[it]+s[at],++A[257+it],++C[at],D=g+$,++L}else P[k++]=t[g],++A[t[g]]}}v=G(t,d,f,P,A,C,N,k,U,g-U,v),!f&&7&v&&(v=q(d,v+1,W))}return j(p,0,n+I(v)+c)},$=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,n=9;--n;)r=(1&r&&-306674912)^r>>>1;t[e]=r}return t}(),Y=function(){var t=-1;return{p:function(e){for(var r=t,n=0;n<e.length;++n)r=$[255&r^e[n]]^r>>>8;t=r},d:function(){return~t}}},K=function(){var t=1,e=0;return{p:function(r){for(var n=t,o=e,i=0|r.length,a=0;a!=i;){for(var u=Math.min(a+2655,i);a<u;++a)o+=n+=r[a];n=(65535&n)+15*(n>>16),o=(65535&o)+15*(o>>16)}t=n,e=o},d:function(){return(255&(t%=65521))<<24|t>>>8<<16|(255&(e%=65521))<<8|e>>>8}}},X=function(t,e,r,n,o){return V(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,r,n,!o)},J=function(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r},Q=function(t,e,r){for(var n=t(),o=t.toString(),i=o.slice(o.indexOf("[")+1,o.lastIndexOf("]")).replace(/ /g,"").split(","),a=0;a<n.length;++a){var u=n[a],s=i[a];if("function"==typeof u){e+=";"+s+"=";var c=u.toString();if(u.prototype)if(-1!=c.indexOf("[native code]")){var f=c.indexOf(" ",8)+1;e+=c.slice(f,c.indexOf("(",f))}else for(var l in e+=c,u.prototype)e+=";"+s+".prototype."+l+"="+u.prototype[l].toString();else e+=c}else r[s]=u}return[e,r]},Z=[],tt=function(t,e,r,u){var s;if(!Z[r]){for(var c="",f={},l=t.length-1,p=0;p<l;++p)c=(s=Q(t[p],c,f))[0],f=s[1];Z[r]=Q(t[l],c,f)}var h=J({},Z[r][1]);return function(t,e,r,o,i){var a=new Worker(n[e]||(n[e]=URL.createObjectURL(new Blob([t+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return a.onmessage=function(t){var e=t.data,r=e.$e$;if(r){var n=new Error(r[0]);n.code=r[1],n.stack=r[2],i(n,null)}else i(null,e)},a.postMessage(r,o),a}(Z[r][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",r,h,function(t){var e=[];for(var r in t)(t[r]instanceof o||t[r]instanceof i||t[r]instanceof a)&&e.push((t[r]=new t[r].constructor(t[r])).buffer);return e}(h),u)},et=function(){return[o,i,a,u,s,c,p,v,T,x,g,L,_,R,P,A,I,j,N,k,It,ut,st]},rt=function(){return[o,i,a,u,s,c,h,y,O,w,S,E,g,z,W,_,D,U,M,B,H,F,q,G,I,j,V,X,xt,ut]},nt=function(){return[yt,bt,vt,Y,$]},ot=function(){return[gt,mt]},it=function(){return[_t,vt,K]},at=function(){return[wt]},ut=function(t){return postMessage(t,[t.buffer])},st=function(t){return t&&t.size&&new o(t.size)},ct=function(t,e,r,n,o,i){var a=tt(r,n,o,(function(t,e){a.terminate(),i(t,e)}));return a.postMessage([t,e],e.consume?[t.buffer]:[]),function(){a.terminate()}},ft=function(t){return t.ondata=function(t,e){return postMessage([t,e],[t.buffer])},function(e){return t.push(e.data[0],e.data[1])}},lt=function(t,e,r,n,o){var i,a=tt(t,n,o,(function(t,r){t?(a.terminate(),e.ondata.call(e,t)):(r[1]&&a.terminate(),e.ondata.call(e,t,r[0],r[1]))}));a.postMessage(r),e.push=function(t,r){e.ondata||N(5),i&&e.ondata(N(4,0,1),null,!!r),a.postMessage([t,i=r],[t.buffer])},e.terminate=function(){a.terminate()}},pt=function(t,e){return t[e]|t[e+1]<<8},ht=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},dt=function(t,e){return ht(t,e)+4294967296*ht(t,e+4)},vt=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},yt=function(t,e){var r=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:9==e.level?2:0,t[9]=3,0!=e.mtime&&vt(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),r){t[3]=8;for(var n=0;n<=r.length;++n)t[n+10]=r.charCodeAt(n)}},gt=function(t){31==t[0]&&139==t[1]&&8==t[2]||N(6,"invalid gzip data");var e=t[3],r=10;4&e&&(r+=t[10]|2+(t[11]<<8));for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!t[r++]);return r+(2&e)},mt=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},bt=function(t){return 10+(t.filename&&t.filename.length+1||0)},_t=function(t,e){var r=e.level,n=0==r?0:r<6?1:9==r?3:2;t[0]=120,t[1]=n<<6|(n?32-2*n:1)},wt=function(t){(8!=(15&t[0])||t[0]>>>4>7||(t[0]<<8|t[1])%31)&&N(6,"invalid zlib data"),32&t[1]&&N(6,"invalid zlib data: preset dictionaries not supported")};function Et(t,e){return e||"function"!=typeof t||(e=t,t={}),this.ondata=e,t}var Ot=function(){function t(t,e){e||"function"!=typeof t||(e=t,t={}),this.ondata=e,this.o=t||{}}return t.prototype.p=function(t,e){this.ondata(X(t,this.o,0,0,!e),e)},t.prototype.push=function(t,e){this.ondata||N(5),this.d&&N(4),this.d=e,this.p(t,e||!1)},t}(),Tt=function(){return function(t,e){lt([rt,function(){return[ft,Ot]}],this,Et.call(this,t,e),(function(t){var e=new Ot(t.data);onmessage=ft(e)}),6)}}();function St(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&N(7),ct(t,e,[rt],(function(t){return ut(xt(t.data[0],t.data[1]))}),0,r)}function xt(t,e){return X(t,e||{},0,0)}var Rt=function(){function t(t){this.s={},this.p=new o(0),this.ondata=t}return t.prototype.e=function(t){this.ondata||N(5),this.d&&N(4);var e=this.p.length,r=new o(e+t.length);r.set(this.p),r.set(t,e),this.p=r},t.prototype.c=function(t){this.d=this.s.i=t||!1;var e=this.s.b,r=k(this.p,this.o,this.s);this.ondata(j(r,e,this.s.b),this.d),this.o=j(r,this.s.b-32768),this.s.b=this.o.length,this.p=j(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(t,e){this.e(t),this.c(e)},t}(),Pt=function(){return function(t){this.ondata=t,lt([et,function(){return[ft,Rt]}],this,0,(function(){var t=new Rt;onmessage=ft(t)}),7)}}();function At(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&N(7),ct(t,e,[et],(function(t){return ut(It(t.data[0],st(t.data[1])))}),1,r)}function It(t,e){return k(t,e)}var jt=function(){function t(t,e){this.c=Y(),this.l=0,this.v=1,Ot.call(this,t,e)}return t.prototype.push=function(t,e){Ot.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t),this.l+=t.length;var r=X(t,this.o,this.v&&bt(this.o),e&&8,!e);this.v&&(yt(r,this.o),this.v=0),e&&(vt(r,r.length-8,this.c.d()),vt(r,r.length-4,this.l)),this.ondata(r,e)},t}(),Ct=function(){return function(t,e){lt([rt,nt,function(){return[ft,Ot,jt]}],this,Et.call(this,t,e),(function(t){var e=new jt(t.data);onmessage=ft(e)}),8)}}();function Lt(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&N(7),ct(t,e,[rt,nt,function(){return[Nt]}],(function(t){return ut(Nt(t.data[0],t.data[1]))}),2,r)}function Nt(t,e){e||(e={});var r=Y(),n=t.length;r.p(t);var o=X(t,e,bt(e),8),i=o.length;return yt(o,e),vt(o,i-8,r.d()),vt(o,i-4,n),o}var kt=function(){function t(t){this.v=1,Rt.call(this,t)}return t.prototype.push=function(t,e){if(Rt.prototype.e.call(this,t),this.v){var r=this.p.length>3?gt(this.p):4;if(r>=this.p.length&&!e)return;this.p=this.p.subarray(r),this.v=0}e&&(this.p.length<8&&N(6,"invalid gzip data"),this.p=this.p.subarray(0,-8)),Rt.prototype.c.call(this,e)},t}(),Dt=function(){return function(t){this.ondata=t,lt([et,ot,function(){return[ft,Rt,kt]}],this,0,(function(){var t=new kt;onmessage=ft(t)}),9)}}();function Ut(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&N(7),ct(t,e,[et,ot,function(){return[Mt]}],(function(t){return ut(Mt(t.data[0]))}),3,r)}function Mt(t,e){return k(t.subarray(gt(t),-8),e||new o(mt(t)))}var Bt=function(){function t(t,e){this.c=K(),this.v=1,Ot.call(this,t,e)}return t.prototype.push=function(t,e){Ot.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){this.c.p(t);var r=X(t,this.o,this.v&&2,e&&4,!e);this.v&&(_t(r,this.o),this.v=0),e&&vt(r,r.length-4,this.c.d()),this.ondata(r,e)},t}(),Ht=function(){return function(t,e){lt([rt,it,function(){return[ft,Ot,Bt]}],this,Et.call(this,t,e),(function(t){var e=new Bt(t.data);onmessage=ft(e)}),10)}}();function Ft(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&N(7),ct(t,e,[rt,it,function(){return[qt]}],(function(t){return ut(qt(t.data[0],t.data[1]))}),4,r)}function qt(t,e){e||(e={});var r=K();r.p(t);var n=X(t,e,2,4);return _t(n,e),vt(n,n.length-4,r.d()),n}var Gt=function(){function t(t){this.v=1,Rt.call(this,t)}return t.prototype.push=function(t,e){if(Rt.prototype.e.call(this,t),this.v){if(this.p.length<2&&!e)return;this.p=this.p.subarray(2),this.v=0}e&&(this.p.length<4&&N(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Rt.prototype.c.call(this,e)},t}(),zt=function(){return function(t){this.ondata=t,lt([et,at,function(){return[ft,Rt,Gt]}],this,0,(function(){var t=new Gt;onmessage=ft(t)}),11)}}();function Wt(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&N(7),ct(t,e,[et,at,function(){return[Vt]}],(function(t){return ut(Vt(t.data[0],st(t.data[1])))}),5,r)}function Vt(t,e){return k((wt(t),t.subarray(2,-4)),e)}var $t=function(){function t(t){this.G=kt,this.I=Rt,this.Z=Gt,this.ondata=t}return t.prototype.push=function(t,e){if(this.ondata||N(5),this.s)this.s.push(t,e);else{if(this.p&&this.p.length){var r=new o(this.p.length+t.length);r.set(this.p),r.set(t,this.p.length)}else this.p=t;if(this.p.length>2){var n=this,i=function(){n.ondata.apply(n,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(i):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(i):new this.Z(i),this.s.push(this.p,e),this.p=null}}},t}(),Yt=function(){function t(t){this.G=Dt,this.I=Pt,this.Z=zt,this.ondata=t}return t.prototype.push=function(t,e){$t.prototype.push.call(this,t,e)},t}();function Kt(t,e,r){return r||(r=e,e={}),"function"!=typeof r&&N(7),31==t[0]&&139==t[1]&&8==t[2]?Ut(t,e,r):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?At(t,e,r):Wt(t,e,r)}function Xt(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?Mt(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?It(t,e):Vt(t,e)}var Jt=function(t,e,r,n){for(var i in t){var a=t[i],u=e+i;a instanceof o?r[u]=[a,n]:Array.isArray(a)?r[u]=[a[0],J(n,a[1])]:Jt(a,u+"/",r,n)}},Qt="undefined"!=typeof TextEncoder&&new TextEncoder,Zt="undefined"!=typeof TextDecoder&&new TextDecoder,te=0;try{Zt.decode(W,{stream:!0}),te=1}catch(t){}var ee=function(t){for(var e="",r=0;;){var n=t[r++],o=(n>127)+(n>223)+(n>239);if(r+o>t.length)return[e,j(t,r-1)];o?3==o?(n=((15&n)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536,e+=String.fromCharCode(55296|n>>10,56320|1023&n)):e+=1&o?String.fromCharCode((31&n)<<6|63&t[r++]):String.fromCharCode((15&n)<<12|(63&t[r++])<<6|63&t[r++]):e+=String.fromCharCode(n)}},re=function(){function t(t){this.ondata=t,te?this.t=new TextDecoder:this.p=W}return t.prototype.push=function(t,e){if(this.ondata||N(5),e=!!e,this.t)return this.ondata(this.t.decode(t,{stream:!0}),e),void(e&&(this.t.decode().length&&N(8),this.t=null));this.p||N(4);var r=new o(this.p.length+t.length);r.set(this.p),r.set(t,this.p.length);var n=ee(r),i=n[0],a=n[1];e?(a.length&&N(8),this.p=null):this.p=a,this.ondata(i,e)},t}(),ne=function(){function t(t){this.ondata=t}return t.prototype.push=function(t,e){this.ondata||N(5),this.d&&N(4),this.ondata(oe(t),this.d=e||!1)},t}();function oe(t,e){if(e){for(var r=new o(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}if(Qt)return Qt.encode(t);var i=t.length,a=new o(t.length+(t.length>>1)),u=0,s=function(t){a[u++]=t};for(n=0;n<i;++n){if(u+5>a.length){var c=new o(u+8+(i-n<<1));c.set(a),a=c}var f=t.charCodeAt(n);f<128||e?s(f):f<2048?(s(192|f>>6),s(128|63&f)):f>55295&&f<57344?(s(240|(f=65536+(1047552&f)|1023&t.charCodeAt(++n))>>18),s(128|f>>12&63),s(128|f>>6&63),s(128|63&f)):(s(224|f>>12),s(128|f>>6&63),s(128|63&f))}return j(a,0,u)}function ie(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}if(Zt)return Zt.decode(t);var o=ee(t),i=o[0];return o[1].length&&N(8),i}var ae=function(t){return 1==t?3:t<6?2:9==t?1:0},ue=function(t,e){return e+30+pt(t,e+26)+pt(t,e+28)},se=function(t,e,r){var n=pt(t,e+28),o=ie(t.subarray(e+46,e+46+n),!(2048&pt(t,e+8))),i=e+46+n,a=ht(t,e+20),u=r&&4294967295==a?ce(t,i):[a,ht(t,e+24),ht(t,e+42)],s=u[0],c=u[1],f=u[2];return[pt(t,e+10),s,c,o,i+pt(t,e+30)+pt(t,e+32),f]},ce=function(t,e){for(;1!=pt(t,e);e+=4+pt(t,e+2));return[dt(t,e+12),dt(t,e+4),dt(t,e+20)]},fe=function(t){var e=0;if(t)for(var r in t){var n=t[r].length;n>65535&&N(9),e+=n+4}return e},le=function(t,e,r,n,o,i,a,u){var s=n.length,c=r.extra,f=u&&u.length,l=fe(c);vt(t,e,null!=a?33639248:67324752),e+=4,null!=a&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(null==i&&8),t[e++]=o&&8,t[e++]=255&r.compression,t[e++]=r.compression>>8;var p=new Date(null==r.mtime?Date.now():r.mtime),h=p.getFullYear()-1980;if((h<0||h>119)&&N(10),vt(t,e,h<<25|p.getMonth()+1<<21|p.getDate()<<16|p.getHours()<<11|p.getMinutes()<<5|p.getSeconds()>>>1),e+=4,null!=i&&(vt(t,e,r.crc),vt(t,e+4,i),vt(t,e+8,r.size)),vt(t,e+12,s),vt(t,e+14,l),e+=16,null!=a&&(vt(t,e,f),vt(t,e+6,r.attrs),vt(t,e+10,a),e+=14),t.set(n,e),e+=s,l)for(var d in c){var v=c[d],y=v.length;vt(t,e,+d),vt(t,e+2,y),t.set(v,e+4),e+=4+y}return f&&(t.set(u,e),e+=f),e},pe=function(t,e,r,n,o){vt(t,e,101010256),vt(t,e+8,r),vt(t,e+10,r),vt(t,e+12,n),vt(t,e+16,o)},he=function(){function t(t){this.filename=t,this.c=Y(),this.size=0,this.compression=0}return t.prototype.process=function(t,e){this.ondata(null,t,e)},t.prototype.push=function(t,e){this.ondata||N(5),this.c.p(t),this.size+=t.length,e&&(this.crc=this.c.d()),this.process(t,e||!1)},t}(),de=function(){function t(t,e){var r=this;e||(e={}),he.call(this,t),this.d=new Ot(e,(function(t,e){r.ondata(null,t,e)})),this.compression=8,this.flag=ae(e.level)}return t.prototype.process=function(t,e){try{this.d.push(t,e)}catch(t){this.ondata(t,null,e)}},t.prototype.push=function(t,e){he.prototype.push.call(this,t,e)},t}(),ve=function(){function t(t,e){var r=this;e||(e={}),he.call(this,t),this.d=new Tt(e,(function(t,e,n){r.ondata(t,e,n)})),this.compression=8,this.flag=ae(e.level),this.terminate=this.d.terminate}return t.prototype.process=function(t,e){this.d.push(t,e)},t.prototype.push=function(t,e){he.prototype.push.call(this,t,e)},t}(),ye=function(){function t(t){this.ondata=t,this.u=[],this.d=1}return t.prototype.add=function(t){var e=this;if(this.ondata||N(5),2&this.d)this.ondata(N(4+8*(1&this.d),0,1),null,!1);else{var r=oe(t.filename),n=r.length,i=t.comment,a=i&&oe(i),u=n!=t.filename.length||a&&i.length!=a.length,s=n+fe(t.extra)+30;n>65535&&this.ondata(N(11,0,1),null,!1);var c=new o(s);le(c,0,t,r,u);var f=[c],l=function(){for(var t=0,r=f;t<r.length;t++){var n=r[t];e.ondata(null,n,!1)}f=[]},p=this.d;this.d=0;var h=this.u.length,d=J(t,{f:r,u,o:a,t:function(){t.terminate&&t.terminate()},r:function(){if(l(),p){var t=e.u[h+1];t?t.r():e.d=1}p=1}}),v=0;t.ondata=function(r,n,i){if(r)e.ondata(r,n,i),e.terminate();else if(v+=n.length,f.push(n),i){var a=new o(16);vt(a,0,134695760),vt(a,4,t.crc),vt(a,8,v),vt(a,12,t.size),f.push(a),d.c=v,d.b=s+v+16,d.crc=t.crc,d.size=t.size,p&&d.r(),p=1}else p&&l()},this.u.push(d)}},t.prototype.end=function(){var t=this;2&this.d?this.ondata(N(4+8*(1&this.d),0,1),null,!0):(this.d?this.e():this.u.push({r:function(){1&t.d&&(t.u.splice(-1,1),t.e())},t:function(){}}),this.d=3)},t.prototype.e=function(){for(var t=0,e=0,r=0,n=0,i=this.u;n<i.length;n++)r+=46+(c=i[n]).f.length+fe(c.extra)+(c.o?c.o.length:0);for(var a=new o(r+22),u=0,s=this.u;u<s.length;u++){var c=s[u];le(a,t,c,c.f,c.u,c.c,e,c.o),t+=46+c.f.length+fe(c.extra)+(c.o?c.o.length:0),e+=c.b}pe(a,t,this.u.length,r,e),this.ondata(null,a,!0),this.d=2},t.prototype.terminate=function(){for(var t=0,e=this.u;t<e.length;t++)e[t].t();this.d=2},t}();function ge(t,e,r){r||(r=e,e={}),"function"!=typeof r&&N(7);var n={};Jt(t,"",n,e);var i=Object.keys(n),a=i.length,u=0,s=0,c=a,f=new Array(a),l=[],p=function(){for(var t=0;t<l.length;++t)l[t]()},h=function(t,e){Oe((function(){r(t,e)}))};Oe((function(){h=r}));var d=function(){var t=new o(s+22),e=u,r=s-u;s=0;for(var n=0;n<c;++n){var i=f[n];try{var a=i.c.length;le(t,s,i,i.f,i.u,a);var l=30+i.f.length+fe(i.extra),p=s+l;t.set(i.c,p),le(t,u,i,i.f,i.u,a,s,i.m),u+=16+l+(i.m?i.m.length:0),s=p+a}catch(t){return h(t,null)}}pe(t,u,f.length,r,e),h(null,t)};a||d();for(var v=function(t){var e=i[t],r=n[e],o=r[0],c=r[1],v=Y(),y=o.length;v.p(o);var g=oe(e),m=g.length,b=c.comment,_=b&&oe(b),w=_&&_.length,E=fe(c.extra),O=0==c.level?0:8,T=function(r,n){if(r)p(),h(r,null);else{var o=n.length;f[t]=J(c,{size:y,crc:v.d(),c:n,f:g,m:_,u:m!=e.length||_&&b.length!=w,compression:O}),u+=30+m+E+o,s+=76+2*(m+E)+(w||0)+o,--a||d()}};if(m>65535&&T(N(11,0,1),null),O)if(y<16e4)try{T(null,xt(o,c))}catch(t){T(t,null)}else l.push(St(o,c,T));else T(null,o)},y=0;y<c;++y)v(y);return p}function me(t,e){e||(e={});var r={},n=[];Jt(t,"",r,e);var i=0,a=0;for(var u in r){var s=r[u],c=s[0],f=s[1],l=0==f.level?0:8,p=(T=oe(u)).length,h=f.comment,d=h&&oe(h),v=d&&d.length,y=fe(f.extra);p>65535&&N(11);var g=l?xt(c,f):c,m=g.length,b=Y();b.p(c),n.push(J(f,{size:c.length,crc:b.d(),c:g,f:T,m:d,u:p!=u.length||d&&h.length!=v,o:i,compression:l})),i+=30+p+y+m,a+=76+2*(p+y)+(v||0)+m}for(var _=new o(a+22),w=i,E=a-i,O=0;O<n.length;++O){var T=n[O];le(_,T.o,T,T.f,T.u,T.c.length);var S=30+T.f.length+fe(T.extra);_.set(T.c,T.o+S),le(_,i,T,T.f,T.u,T.c.length,T.o,T.m),i+=16+S+(T.m?T.m.length:0)}return pe(_,i,n.length,E,w),_}var be=function(){function t(){}return t.prototype.push=function(t,e){this.ondata(null,t,e)},t.compression=0,t}(),_e=function(){function t(){var t=this;this.i=new Rt((function(e,r){t.ondata(null,e,r)}))}return t.prototype.push=function(t,e){try{this.i.push(t,e)}catch(t){this.ondata(t,null,e)}},t.compression=8,t}(),we=function(){function t(t,e){var r=this;e<32e4?this.i=new Rt((function(t,e){r.ondata(null,t,e)})):(this.i=new Pt((function(t,e,n){r.ondata(t,e,n)})),this.terminate=this.i.terminate)}return t.prototype.push=function(t,e){this.i.terminate&&(t=j(t,0)),this.i.push(t,e)},t.compression=8,t}(),Ee=function(){function t(t){this.onfile=t,this.k=[],this.o={0:be},this.p=W}return t.prototype.push=function(t,e){var r=this;if(this.onfile||N(5),this.p||N(4),this.c>0){var n=Math.min(this.c,t.length),i=t.subarray(0,n);if(this.c-=n,this.d?this.d.push(i,!this.c):this.k[0].push(i),(t=t.subarray(n)).length)return this.push(t,e)}else{var a=0,u=0,s=void 0,c=void 0;this.p.length?t.length?((c=new o(this.p.length+t.length)).set(this.p),c.set(t,this.p.length)):c=this.p:c=t;for(var f=c.length,l=this.c,p=l&&this.d,h=function(){var t,e=ht(c,u);if(67324752==e){a=1,s=u,d.d=null,d.c=0;var n=pt(c,u+6),o=pt(c,u+8),i=2048&n,p=8&n,h=pt(c,u+26),v=pt(c,u+28);if(f>u+30+h+v){var y=[];d.k.unshift(y),a=2;var g,m=ht(c,u+18),b=ht(c,u+22),_=ie(c.subarray(u+30,u+=30+h),!i);4294967295==m?(t=p?[-2]:ce(c,u),m=t[0],b=t[1]):p&&(m=-1),u+=v,d.c=m;var w={name:_,compression:o,start:function(){if(w.ondata||N(5),m){var t=r.o[o];t||w.ondata(N(14,"unknown compression type "+o,1),null,!1),(g=m<0?new t(_):new t(_,m,b)).ondata=function(t,e,r){w.ondata(t,e,r)};for(var e=0,n=y;e<n.length;e++){var i=n[e];g.push(i,!1)}r.k[0]==y&&r.c?r.d=g:g.push(W,!0)}else w.ondata(null,W,!0)},terminate:function(){g&&g.terminate&&g.terminate()}};m>=0&&(w.size=m,w.originalSize=b),d.onfile(w)}return"break"}if(l){if(134695760==e)return s=u+=12+(-2==l&&8),a=3,d.c=0,"break";if(33639248==e)return s=u-=4,a=3,d.c=0,"break"}},d=this;u<f-4&&"break"!==h();++u);if(this.p=W,l<0){var v=a?c.subarray(0,s-12-(-2==l&&8)-(134695760==ht(c,s-16)&&4)):c.subarray(0,u);p?p.push(v,!!a):this.k[+(2==a)].push(v)}if(2&a)return this.push(c.subarray(u),e);this.p=c.subarray(u)}e&&(this.c&&N(13),this.p=null)},t.prototype.register=function(t){this.o[t.compression]=t},t}(),Oe="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(t){t()};function Te(t,e,r){r||(r=e,e={}),"function"!=typeof r&&N(7);var n=[],i=function(){for(var t=0;t<n.length;++t)n[t]()},a={},u=function(t,e){Oe((function(){r(t,e)}))};Oe((function(){u=r}));for(var s=t.length-22;101010256!=ht(t,s);--s)if(!s||t.length-s>65558)return u(N(13,0,1),null),i;var c=pt(t,s+8);if(c){var f=c,l=ht(t,s+16),p=4294967295==l;if(p){if(s=ht(t,s-12),101075792!=ht(t,s))return u(N(13,0,1),null),i;f=c=ht(t,s+32),l=ht(t,s+48)}for(var h=e&&e.filter,d=function(e){var r=se(t,l,p),s=r[0],f=r[1],d=r[2],v=r[3],y=r[4],g=r[5],m=ue(t,g);l=y;var b=function(t,e){t?(i(),u(t,null)):(e&&(a[v]=e),--c||u(null,a))};if(!h||h({name:v,size:f,originalSize:d,compression:s}))if(s)if(8==s){var _=t.subarray(m,m+f);if(f<32e4)try{b(null,It(_,new o(d)))}catch(t){b(t,null)}else n.push(At(_,{size:d},b))}else b(N(14,"unknown compression type "+s,1),null);else b(null,j(t,m,m+f));else b(null,null)},v=0;v<f;++v)d()}else u(null,{});return i}function Se(t,e){for(var r={},n=t.length-22;101010256!=ht(t,n);--n)(!n||t.length-n>65558)&&N(13);var i=pt(t,n+8);if(!i)return{};var a=ht(t,n+16),u=4294967295==a;u&&(n=ht(t,n-12),101075792!=ht(t,n)&&N(13),i=ht(t,n+32),a=ht(t,n+48));for(var s=e&&e.filter,c=0;c<i;++c){var f=se(t,a,u),l=f[0],p=f[1],h=f[2],d=f[3],v=f[4],y=f[5],g=ue(t,y);a=v,s&&!s({name:d,size:p,originalSize:h,compression:l})||(l?8==l?r[d]=It(t.subarray(g,g+p),new o(h)):N(14,"unknown compression type "+l):r[d]=j(t,g,g+p))}return r}},1143:t=>{"use strict";t.exports=function(t,e,r,n,o,i,a,u){if(!t){var s;if(void 0===e)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,o,i,a,u],f=0;(s=new Error(e.replace(/%s/g,(function(){return c[f++]})))).name="Invariant Violation"}throw s.framesToPop=1,s}}},8552:(t,e,r)=>{var n=r(852)(r(5639),"DataView");t.exports=n},1989:(t,e,r)=>{var n=r(1789),o=r(401),i=r(7667),a=r(1327),u=r(1866);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},8407:(t,e,r)=>{var n=r(7040),o=r(4125),i=r(2117),a=r(7529),u=r(4705);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},7071:(t,e,r)=>{var n=r(852)(r(5639),"Map");t.exports=n},3369:(t,e,r)=>{var n=r(4785),o=r(1285),i=r(6e3),a=r(9916),u=r(5265);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},3818:(t,e,r)=>{var n=r(852)(r(5639),"Promise");t.exports=n},8525:(t,e,r)=>{var n=r(852)(r(5639),"Set");t.exports=n},8668:(t,e,r)=>{var n=r(3369),o=r(619),i=r(2385);function a(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new n;++e<r;)this.add(t[e])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,t.exports=a},6384:(t,e,r)=>{var n=r(8407),o=r(7465),i=r(3779),a=r(7599),u=r(4758),s=r(4309);function c(t){var e=this.__data__=new n(t);this.size=e.size}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=u,c.prototype.set=s,t.exports=c},2705:(t,e,r)=>{var n=r(5639).Symbol;t.exports=n},1149:(t,e,r)=>{var n=r(5639).Uint8Array;t.exports=n},577:(t,e,r)=>{var n=r(852)(r(5639),"WeakMap");t.exports=n},4963:t=>{t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i}},4636:(t,e,r)=>{var n=r(2545),o=r(5694),i=r(1469),a=r(4144),u=r(5776),s=r(6719),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r=i(t),f=!r&&o(t),l=!r&&!f&&a(t),p=!r&&!f&&!l&&s(t),h=r||f||l||p,d=h?n(t.length,String):[],v=d.length;for(var y in t)!e&&!c.call(t,y)||h&&("length"==y||l&&("offset"==y||"parent"==y)||p&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||u(y,v))||d.push(y);return d}},9932:t=>{t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}},2488:t=>{t.exports=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}},2663:t=>{t.exports=function(t,e,r,n){var o=-1,i=null==t?0:t.length;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}},2908:t=>{t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}},8470:(t,e,r)=>{var n=r(7813);t.exports=function(t,e){for(var r=t.length;r--;)if(n(t[r][0],e))return r;return-1}},4140:(t,e,r)=>{var n=r(7816),o=r(9291)(n);t.exports=o},8483:(t,e,r)=>{var n=r(5063)();t.exports=n},7816:(t,e,r)=>{var n=r(8483),o=r(3674);t.exports=function(t,e){return t&&n(t,e,o)}},7786:(t,e,r)=>{var n=r(1811),o=r(327);t.exports=function(t,e){for(var r=0,i=(e=n(e,t)).length;null!=t&&r<i;)t=t[o(e[r++])];return r&&r==i?t:void 0}},8866:(t,e,r)=>{var n=r(2488),o=r(1469);t.exports=function(t,e,r){var i=e(t);return o(t)?i:n(i,r(t))}},4239:(t,e,r)=>{var n=r(2705),o=r(9607),i=r(2333),a=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?o(t):i(t)}},13:t=>{t.exports=function(t,e){return null!=t&&e in Object(t)}},9454:(t,e,r)=>{var n=r(4239),o=r(7005);t.exports=function(t){return o(t)&&"[object Arguments]"==n(t)}},939:(t,e,r)=>{var n=r(2492),o=r(7005);t.exports=function t(e,r,i,a,u){return e===r||(null==e||null==r||!o(e)&&!o(r)?e!=e&&r!=r:n(e,r,i,a,t,u))}},2492:(t,e,r)=>{var n=r(6384),o=r(7114),i=r(8351),a=r(6096),u=r(4160),s=r(1469),c=r(4144),f=r(6719),l="[object Arguments]",p="[object Array]",h="[object Object]",d=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,v,y,g){var m=s(t),b=s(e),_=m?p:u(t),w=b?p:u(e),E=(_=_==l?h:_)==h,O=(w=w==l?h:w)==h,T=_==w;if(T&&c(t)){if(!c(e))return!1;m=!0,E=!1}if(T&&!E)return g||(g=new n),m||f(t)?o(t,e,r,v,y,g):i(t,e,_,r,v,y,g);if(!(1&r)){var S=E&&d.call(t,"__wrapped__"),x=O&&d.call(e,"__wrapped__");if(S||x){var R=S?t.value():t,P=x?e.value():e;return g||(g=new n),y(R,P,r,v,g)}}return!!T&&(g||(g=new n),a(t,e,r,v,y,g))}},2958:(t,e,r)=>{var n=r(6384),o=r(939);t.exports=function(t,e,r,i){var a=r.length,u=a,s=!i;if(null==t)return!u;for(t=Object(t);a--;){var c=r[a];if(s&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++a<u;){var f=(c=r[a])[0],l=t[f],p=c[1];if(s&&c[2]){if(void 0===l&&!(f in t))return!1}else{var h=new n;if(i)var d=i(l,p,f,t,e,h);if(!(void 0===d?o(p,l,3,i,h):d))return!1}}return!0}},8458:(t,e,r)=>{var n=r(3560),o=r(5346),i=r(3218),a=r(346),u=/^\[object .+?Constructor\]$/,s=Function.prototype,c=Object.prototype,f=s.toString,l=c.hasOwnProperty,p=RegExp("^"+f.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||o(t))&&(n(t)?p:u).test(a(t))}},8749:(t,e,r)=>{var n=r(4239),o=r(1780),i=r(7005),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&o(t.length)&&!!a[n(t)]}},7206:(t,e,r)=>{var n=r(1573),o=r(6432),i=r(6557),a=r(1469),u=r(9601);t.exports=function(t){return"function"==typeof t?t:null==t?i:"object"==typeof t?a(t)?o(t[0],t[1]):n(t):u(t)}},280:(t,e,r)=>{var n=r(5726),o=r(6916),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return o(t);var e=[];for(var r in Object(t))i.call(t,r)&&"constructor"!=r&&e.push(r);return e}},1573:(t,e,r)=>{var n=r(2958),o=r(1499),i=r(2634);t.exports=function(t){var e=o(t);return 1==e.length&&e[0][2]?i(e[0][0],e[0][1]):function(r){return r===t||n(r,t,e)}}},6432:(t,e,r)=>{var n=r(939),o=r(7361),i=r(9095),a=r(5403),u=r(9162),s=r(2634),c=r(327);t.exports=function(t,e){return a(t)&&u(e)?s(c(t),e):function(r){var a=o(r,t);return void 0===a&&a===e?i(r,t):n(e,a,3)}}},371:t=>{t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},6374:(t,e,r)=>{var n=r(7786);t.exports=function(t){return function(e){return n(e,t)}}},107:t=>{t.exports=function(t,e,r,n,o){return o(t,(function(t,o,i){r=n?(n=!1,t):e(r,t,o,i)})),r}},2545:t=>{t.exports=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}},531:(t,e,r)=>{var n=r(2705),o=r(9932),i=r(1469),a=r(3448),u=n?n.prototype:void 0,s=u?u.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(i(e))return o(e,t)+"";if(a(e))return s?s.call(e):"";var r=e+"";return"0"==r&&1/e==-1/0?"-0":r}},1717:t=>{t.exports=function(t){return function(e){return t(e)}}},4757:t=>{t.exports=function(t,e){return t.has(e)}},1811:(t,e,r)=>{var n=r(1469),o=r(5403),i=r(5514),a=r(9833);t.exports=function(t,e){return n(t)?t:o(t,e)?[t]:i(a(t))}},4429:(t,e,r)=>{var n=r(5639)["__core-js_shared__"];t.exports=n},9291:(t,e,r)=>{var n=r(8612);t.exports=function(t,e){return function(r,o){if(null==r)return r;if(!n(r))return t(r,o);for(var i=r.length,a=e?i:-1,u=Object(r);(e?a--:++a<i)&&!1!==o(u[a],a,u););return r}}},5063:t=>{t.exports=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var s=a[t?u:++o];if(!1===r(i[s],s,i))break}return e}}},7114:(t,e,r)=>{var n=r(8668),o=r(2908),i=r(4757);t.exports=function(t,e,r,a,u,s){var c=1&r,f=t.length,l=e.length;if(f!=l&&!(c&&l>f))return!1;var p=s.get(t),h=s.get(e);if(p&&h)return p==e&&h==t;var d=-1,v=!0,y=2&r?new n:void 0;for(s.set(t,e),s.set(e,t);++d<f;){var g=t[d],m=e[d];if(a)var b=c?a(m,g,d,e,t,s):a(g,m,d,t,e,s);if(void 0!==b){if(b)continue;v=!1;break}if(y){if(!o(e,(function(t,e){if(!i(y,e)&&(g===t||u(g,t,r,a,s)))return y.push(e)}))){v=!1;break}}else if(g!==m&&!u(g,m,r,a,s)){v=!1;break}}return s.delete(t),s.delete(e),v}},8351:(t,e,r)=>{var n=r(2705),o=r(1149),i=r(7813),a=r(7114),u=r(8776),s=r(1814),c=n?n.prototype:void 0,f=c?c.valueOf:void 0;t.exports=function(t,e,r,n,c,l,p){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!l(new o(t),new o(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var h=u;case"[object Set]":var d=1&n;if(h||(h=s),t.size!=e.size&&!d)return!1;var v=p.get(t);if(v)return v==e;n|=2,p.set(t,e);var y=a(h(t),h(e),n,c,l,p);return p.delete(t),y;case"[object Symbol]":if(f)return f.call(t)==f.call(e)}return!1}},6096:(t,e,r)=>{var n=r(8234),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,i,a,u){var s=1&r,c=n(t),f=c.length;if(f!=n(e).length&&!s)return!1;for(var l=f;l--;){var p=c[l];if(!(s?p in e:o.call(e,p)))return!1}var h=u.get(t),d=u.get(e);if(h&&d)return h==e&&d==t;var v=!0;u.set(t,e),u.set(e,t);for(var y=s;++l<f;){var g=t[p=c[l]],m=e[p];if(i)var b=s?i(m,g,p,e,t,u):i(g,m,p,t,e,u);if(!(void 0===b?g===m||a(g,m,r,i,u):b)){v=!1;break}y||(y="constructor"==p)}if(v&&!y){var _=t.constructor,w=e.constructor;_==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w||(v=!1)}return u.delete(t),u.delete(e),v}},1957:(t,e,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;t.exports=n},8234:(t,e,r)=>{var n=r(8866),o=r(9551),i=r(3674);t.exports=function(t){return n(t,i,o)}},5050:(t,e,r)=>{var n=r(7019);t.exports=function(t,e){var r=t.__data__;return n(e)?r["string"==typeof e?"string":"hash"]:r.map}},1499:(t,e,r)=>{var n=r(9162),o=r(3674);t.exports=function(t){for(var e=o(t),r=e.length;r--;){var i=e[r],a=t[i];e[r]=[i,a,n(a)]}return e}},852:(t,e,r)=>{var n=r(8458),o=r(7801);t.exports=function(t,e){var r=o(t,e);return n(r)?r:void 0}},9607:(t,e,r)=>{var n=r(2705),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,u=n?n.toStringTag:void 0;t.exports=function(t){var e=i.call(t,u),r=t[u];try{t[u]=void 0;var n=!0}catch(t){}var o=a.call(t);return n&&(e?t[u]=r:delete t[u]),o}},9551:(t,e,r)=>{var n=r(4963),o=r(479),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,u=a?function(t){return null==t?[]:(t=Object(t),n(a(t),(function(e){return i.call(t,e)})))}:o;t.exports=u},4160:(t,e,r)=>{var n=r(8552),o=r(7071),i=r(3818),a=r(8525),u=r(577),s=r(4239),c=r(346),f="[object Map]",l="[object Promise]",p="[object Set]",h="[object WeakMap]",d="[object DataView]",v=c(n),y=c(o),g=c(i),m=c(a),b=c(u),_=s;(n&&_(new n(new ArrayBuffer(1)))!=d||o&&_(new o)!=f||i&&_(i.resolve())!=l||a&&_(new a)!=p||u&&_(new u)!=h)&&(_=function(t){var e=s(t),r="[object Object]"==e?t.constructor:void 0,n=r?c(r):"";if(n)switch(n){case v:return d;case y:return f;case g:return l;case m:return p;case b:return h}return e}),t.exports=_},7801:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},222:(t,e,r)=>{var n=r(1811),o=r(5694),i=r(1469),a=r(5776),u=r(1780),s=r(327);t.exports=function(t,e,r){for(var c=-1,f=(e=n(e,t)).length,l=!1;++c<f;){var p=s(e[c]);if(!(l=null!=t&&r(t,p)))break;t=t[p]}return l||++c!=f?l:!!(f=null==t?0:t.length)&&u(f)&&a(p,f)&&(i(t)||o(t))}},1789:(t,e,r)=>{var n=r(4536);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},401:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},7667:(t,e,r)=>{var n=r(4536),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(e,t)?e[t]:void 0}},1327:(t,e,r)=>{var n=r(4536),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:o.call(e,t)}},1866:(t,e,r)=>{var n=r(4536);t.exports=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=n&&void 0===e?"__lodash_hash_undefined__":e,this}},5776:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,r){var n=typeof t;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&e.test(t))&&t>-1&&t%1==0&&t<r}},5403:(t,e,r)=>{var n=r(1469),o=r(3448),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!o(t))||a.test(t)||!i.test(t)||null!=e&&t in Object(e)}},7019:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},5346:(t,e,r)=>{var n,o=r(4429),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!i&&i in t}},5726:t=>{var e=Object.prototype;t.exports=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||e)}},9162:(t,e,r)=>{var n=r(3218);t.exports=function(t){return t==t&&!n(t)}},7040:t=>{t.exports=function(){this.__data__=[],this.size=0}},4125:(t,e,r)=>{var n=r(8470),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,r=n(e,t);return!(r<0||(r==e.length-1?e.pop():o.call(e,r,1),--this.size,0))}},2117:(t,e,r)=>{var n=r(8470);t.exports=function(t){var e=this.__data__,r=n(e,t);return r<0?void 0:e[r][1]}},7529:(t,e,r)=>{var n=r(8470);t.exports=function(t){return n(this.__data__,t)>-1}},4705:(t,e,r)=>{var n=r(8470);t.exports=function(t,e){var r=this.__data__,o=n(r,t);return o<0?(++this.size,r.push([t,e])):r[o][1]=e,this}},4785:(t,e,r)=>{var n=r(1989),o=r(8407),i=r(7071);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},1285:(t,e,r)=>{var n=r(5050);t.exports=function(t){var e=n(this,t).delete(t);return this.size-=e?1:0,e}},6e3:(t,e,r)=>{var n=r(5050);t.exports=function(t){return n(this,t).get(t)}},9916:(t,e,r)=>{var n=r(5050);t.exports=function(t){return n(this,t).has(t)}},5265:(t,e,r)=>{var n=r(5050);t.exports=function(t,e){var r=n(this,t),o=r.size;return r.set(t,e),this.size+=r.size==o?0:1,this}},8776:t=>{t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}},2634:t=>{t.exports=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}}},4523:(t,e,r)=>{var n=r(8306);t.exports=function(t){var e=n(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}},4536:(t,e,r)=>{var n=r(852)(Object,"create");t.exports=n},6916:(t,e,r)=>{var n=r(5569)(Object.keys,Object);t.exports=n},1167:(t,e,r)=>{t=r.nmd(t);var n=r(1957),o=e&&!e.nodeType&&e,i=o&&t&&!t.nodeType&&t,a=i&&i.exports===o&&n.process,u=function(){try{return i&&i.require&&i.require("util").types||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=u},2333:t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},5569:t=>{t.exports=function(t,e){return function(r){return t(e(r))}}},5639:(t,e,r)=>{var n=r(1957),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();t.exports=i},619:t=>{t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},2385:t=>{t.exports=function(t){return this.__data__.has(t)}},1814:t=>{t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}},7465:(t,e,r)=>{var n=r(8407);t.exports=function(){this.__data__=new n,this.size=0}},3779:t=>{t.exports=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}},7599:t=>{t.exports=function(t){return this.__data__.get(t)}},4758:t=>{t.exports=function(t){return this.__data__.has(t)}},4309:(t,e,r)=>{var n=r(8407),o=r(7071),i=r(3369);t.exports=function(t,e){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!o||a.length<199)return a.push([t,e]),this.size=++r.size,this;r=this.__data__=new i(a)}return r.set(t,e),this.size=r.size,this}},5514:(t,e,r)=>{var n=r(4523),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=n((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(o,(function(t,r,n,o){e.push(n?o.replace(i,"$1"):r||t)})),e}));t.exports=a},327:(t,e,r)=>{var n=r(3448);t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},346:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},7813:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},7361:(t,e,r)=>{var n=r(7786);t.exports=function(t,e,r){var o=null==t?void 0:n(t,e);return void 0===o?r:o}},9095:(t,e,r)=>{var n=r(13),o=r(222);t.exports=function(t,e){return null!=t&&o(t,e,n)}},6557:t=>{t.exports=function(t){return t}},5694:(t,e,r)=>{var n=r(9454),o=r(7005),i=Object.prototype,a=i.hasOwnProperty,u=i.propertyIsEnumerable,s=n(function(){return arguments}())?n:function(t){return o(t)&&a.call(t,"callee")&&!u.call(t,"callee")};t.exports=s},1469:t=>{var e=Array.isArray;t.exports=e},8612:(t,e,r)=>{var n=r(3560),o=r(1780);t.exports=function(t){return null!=t&&o(t.length)&&!n(t)}},4144:(t,e,r)=>{t=r.nmd(t);var n=r(5639),o=r(5062),i=e&&!e.nodeType&&e,a=i&&t&&!t.nodeType&&t,u=a&&a.exports===i?n.Buffer:void 0,s=(u?u.isBuffer:void 0)||o;t.exports=s},3560:(t,e,r)=>{var n=r(4239),o=r(3218);t.exports=function(t){if(!o(t))return!1;var e=n(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},1780:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},3218:t=>{t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},7005:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},3448:(t,e,r)=>{var n=r(4239),o=r(7005);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==n(t)}},6719:(t,e,r)=>{var n=r(8749),o=r(1717),i=r(1167),a=i&&i.isTypedArray,u=a?o(a):n;t.exports=u},3674:(t,e,r)=>{var n=r(4636),o=r(280),i=r(8612);t.exports=function(t){return i(t)?n(t):o(t)}},6486:function(t,e,r){var n;t=r.nmd(t),function(){var o,i="Expected a function",a="__lodash_hash_undefined__",u="__lodash_placeholder__",s=32,c=128,f=1/0,l=9007199254740991,p=NaN,h=4294967295,d=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",s],["partialRight",64],["rearg",256]],v="[object Arguments]",y="[object Array]",g="[object Boolean]",m="[object Date]",b="[object Error]",_="[object Function]",w="[object GeneratorFunction]",E="[object Map]",O="[object Number]",T="[object Object]",S="[object Promise]",x="[object RegExp]",R="[object Set]",P="[object String]",A="[object Symbol]",I="[object WeakMap]",j="[object ArrayBuffer]",C="[object DataView]",L="[object Float32Array]",N="[object Float64Array]",k="[object Int8Array]",D="[object Int16Array]",U="[object Int32Array]",M="[object Uint8Array]",B="[object Uint8ClampedArray]",H="[object Uint16Array]",F="[object Uint32Array]",q=/\b__p \+= '';/g,G=/\b(__p \+=) '' \+/g,z=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,V=/[&<>"']/g,$=RegExp(W.source),Y=RegExp(V.source),K=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,rt=RegExp(et.source),nt=/^\s+/,ot=/\s/,it=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,at=/\{\n\/\* \[wrapped with (.+)\] \*/,ut=/,? & /,st=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ct=/[()=,{}\[\]\/\s]/,ft=/\\(\\)?/g,lt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pt=/\w*$/,ht=/^[-+]0x[0-9a-f]+$/i,dt=/^0b[01]+$/i,vt=/^\[object .+?Constructor\]$/,yt=/^0o[0-7]+$/i,gt=/^(?:0|[1-9]\d*)$/,mt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,bt=/($^)/,_t=/['\n\r\u2028\u2029\\]/g,wt="\\ud800-\\udfff",Et="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ot="\\u2700-\\u27bf",Tt="a-z\\xdf-\\xf6\\xf8-\\xff",St="A-Z\\xc0-\\xd6\\xd8-\\xde",xt="\\ufe0e\\ufe0f",Rt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Pt="["+wt+"]",At="["+Rt+"]",It="["+Et+"]",jt="\\d+",Ct="["+Ot+"]",Lt="["+Tt+"]",Nt="[^"+wt+Rt+jt+Ot+Tt+St+"]",kt="\\ud83c[\\udffb-\\udfff]",Dt="[^"+wt+"]",Ut="(?:\\ud83c[\\udde6-\\uddff]){2}",Mt="[\\ud800-\\udbff][\\udc00-\\udfff]",Bt="["+St+"]",Ht="\\u200d",Ft="(?:"+Lt+"|"+Nt+")",qt="(?:"+Bt+"|"+Nt+")",Gt="(?:['’](?:d|ll|m|re|s|t|ve))?",zt="(?:['’](?:D|LL|M|RE|S|T|VE))?",Wt="(?:"+It+"|"+kt+")?",Vt="["+xt+"]?",$t=Vt+Wt+"(?:"+Ht+"(?:"+[Dt,Ut,Mt].join("|")+")"+Vt+Wt+")*",Yt="(?:"+[Ct,Ut,Mt].join("|")+")"+$t,Kt="(?:"+[Dt+It+"?",It,Ut,Mt,Pt].join("|")+")",Xt=RegExp("['’]","g"),Jt=RegExp(It,"g"),Qt=RegExp(kt+"(?="+kt+")|"+Kt+$t,"g"),Zt=RegExp([Bt+"?"+Lt+"+"+Gt+"(?="+[At,Bt,"$"].join("|")+")",qt+"+"+zt+"(?="+[At,Bt+Ft,"$"].join("|")+")",Bt+"?"+Ft+"+"+Gt,Bt+"+"+zt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",jt,Yt].join("|"),"g"),te=RegExp("["+Ht+wt+Et+xt+"]"),ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,re=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ne=-1,oe={};oe[L]=oe[N]=oe[k]=oe[D]=oe[U]=oe[M]=oe[B]=oe[H]=oe[F]=!0,oe[v]=oe[y]=oe[j]=oe[g]=oe[C]=oe[m]=oe[b]=oe[_]=oe[E]=oe[O]=oe[T]=oe[x]=oe[R]=oe[P]=oe[I]=!1;var ie={};ie[v]=ie[y]=ie[j]=ie[C]=ie[g]=ie[m]=ie[L]=ie[N]=ie[k]=ie[D]=ie[U]=ie[E]=ie[O]=ie[T]=ie[x]=ie[R]=ie[P]=ie[A]=ie[M]=ie[B]=ie[H]=ie[F]=!0,ie[b]=ie[_]=ie[I]=!1;var ae={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ue=parseFloat,se=parseInt,ce="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,fe="object"==typeof self&&self&&self.Object===Object&&self,le=ce||fe||Function("return this")(),pe=e&&!e.nodeType&&e,he=pe&&t&&!t.nodeType&&t,de=he&&he.exports===pe,ve=de&&ce.process,ye=function(){try{return he&&he.require&&he.require("util").types||ve&&ve.binding&&ve.binding("util")}catch(t){}}(),ge=ye&&ye.isArrayBuffer,me=ye&&ye.isDate,be=ye&&ye.isMap,_e=ye&&ye.isRegExp,we=ye&&ye.isSet,Ee=ye&&ye.isTypedArray;function Oe(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Te(t,e,r,n){for(var o=-1,i=null==t?0:t.length;++o<i;){var a=t[o];e(n,a,r(a),t)}return n}function Se(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}function xe(t,e){for(var r=null==t?0:t.length;r--&&!1!==e(t[r],r,t););return t}function Re(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function Pe(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i}function Ae(t,e){return!(null==t||!t.length)&&Be(t,e,0)>-1}function Ie(t,e,r){for(var n=-1,o=null==t?0:t.length;++n<o;)if(r(e,t[n]))return!0;return!1}function je(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}function Ce(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}function Le(t,e,r,n){var o=-1,i=null==t?0:t.length;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function Ne(t,e,r,n){var o=null==t?0:t.length;for(n&&o&&(r=t[--o]);o--;)r=e(r,t[o],o,t);return r}function ke(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var De=Ge("length");function Ue(t,e,r){var n;return r(t,(function(t,r,o){if(e(t,r,o))return n=r,!1})),n}function Me(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}function Be(t,e,r){return e==e?function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,r):Me(t,Fe,r)}function He(t,e,r,n){for(var o=r-1,i=t.length;++o<i;)if(n(t[o],e))return o;return-1}function Fe(t){return t!=t}function qe(t,e){var r=null==t?0:t.length;return r?Ve(t,e)/r:p}function Ge(t){return function(e){return null==e?o:e[t]}}function ze(t){return function(e){return null==t?o:t[e]}}function We(t,e,r,n,o){return o(t,(function(t,o,i){r=n?(n=!1,t):e(r,t,o,i)})),r}function Ve(t,e){for(var r,n=-1,i=t.length;++n<i;){var a=e(t[n]);a!==o&&(r=r===o?a:r+a)}return r}function $e(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function Ye(t){return t?t.slice(0,lr(t)+1).replace(nt,""):t}function Ke(t){return function(e){return t(e)}}function Xe(t,e){return je(e,(function(e){return t[e]}))}function Je(t,e){return t.has(e)}function Qe(t,e){for(var r=-1,n=t.length;++r<n&&Be(e,t[r],0)>-1;);return r}function Ze(t,e){for(var r=t.length;r--&&Be(e,t[r],0)>-1;);return r}var tr=ze({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),er=ze({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function rr(t){return"\\"+ae[t]}function nr(t){return te.test(t)}function or(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function ir(t,e){return function(r){return t(e(r))}}function ar(t,e){for(var r=-1,n=t.length,o=0,i=[];++r<n;){var a=t[r];a!==e&&a!==u||(t[r]=u,i[o++]=r)}return i}function ur(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}function sr(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=[t,t]})),r}function cr(t){return nr(t)?function(t){for(var e=Qt.lastIndex=0;Qt.test(t);)++e;return e}(t):De(t)}function fr(t){return nr(t)?function(t){return t.match(Qt)||[]}(t):function(t){return t.split("")}(t)}function lr(t){for(var e=t.length;e--&&ot.test(t.charAt(e)););return e}var pr=ze({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),hr=function t(e){var r,n=(e=null==e?le:hr.defaults(le.Object(),e,hr.pick(le,re))).Array,ot=e.Date,wt=e.Error,Et=e.Function,Ot=e.Math,Tt=e.Object,St=e.RegExp,xt=e.String,Rt=e.TypeError,Pt=n.prototype,At=Et.prototype,It=Tt.prototype,jt=e["__core-js_shared__"],Ct=At.toString,Lt=It.hasOwnProperty,Nt=0,kt=(r=/[^.]+$/.exec(jt&&jt.keys&&jt.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",Dt=It.toString,Ut=Ct.call(Tt),Mt=le._,Bt=St("^"+Ct.call(Lt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=de?e.Buffer:o,Ft=e.Symbol,qt=e.Uint8Array,Gt=Ht?Ht.allocUnsafe:o,zt=ir(Tt.getPrototypeOf,Tt),Wt=Tt.create,Vt=It.propertyIsEnumerable,$t=Pt.splice,Yt=Ft?Ft.isConcatSpreadable:o,Kt=Ft?Ft.iterator:o,Qt=Ft?Ft.toStringTag:o,te=function(){try{var t=ci(Tt,"defineProperty");return t({},"",{}),t}catch(t){}}(),ae=e.clearTimeout!==le.clearTimeout&&e.clearTimeout,ce=ot&&ot.now!==le.Date.now&&ot.now,fe=e.setTimeout!==le.setTimeout&&e.setTimeout,pe=Ot.ceil,he=Ot.floor,ve=Tt.getOwnPropertySymbols,ye=Ht?Ht.isBuffer:o,De=e.isFinite,ze=Pt.join,dr=ir(Tt.keys,Tt),vr=Ot.max,yr=Ot.min,gr=ot.now,mr=e.parseInt,br=Ot.random,_r=Pt.reverse,wr=ci(e,"DataView"),Er=ci(e,"Map"),Or=ci(e,"Promise"),Tr=ci(e,"Set"),Sr=ci(e,"WeakMap"),xr=ci(Tt,"create"),Rr=Sr&&new Sr,Pr={},Ar=Ui(wr),Ir=Ui(Er),jr=Ui(Or),Cr=Ui(Tr),Lr=Ui(Sr),Nr=Ft?Ft.prototype:o,kr=Nr?Nr.valueOf:o,Dr=Nr?Nr.toString:o;function Ur(t){if(tu(t)&&!Ga(t)&&!(t instanceof Fr)){if(t instanceof Hr)return t;if(Lt.call(t,"__wrapped__"))return Mi(t)}return new Hr(t)}var Mr=function(){function t(){}return function(e){if(!Za(e))return{};if(Wt)return Wt(e);t.prototype=e;var r=new t;return t.prototype=o,r}}();function Br(){}function Hr(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function Fr(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function qr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Gr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function zr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Wr(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new zr;++e<r;)this.add(t[e])}function Vr(t){var e=this.__data__=new Gr(t);this.size=e.size}function $r(t,e){var r=Ga(t),n=!r&&qa(t),o=!r&&!n&&$a(t),i=!r&&!n&&!o&&su(t),a=r||n||o||i,u=a?$e(t.length,xt):[],s=u.length;for(var c in t)!e&&!Lt.call(t,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||yi(c,s))||u.push(c);return u}function Yr(t){var e=t.length;return e?t[Wn(0,e-1)]:o}function Kr(t,e){return Ci(Ro(t),on(e,0,t.length))}function Xr(t){return Ci(Ro(t))}function Jr(t,e,r){(r!==o&&!Ba(t[e],r)||r===o&&!(e in t))&&rn(t,e,r)}function Qr(t,e,r){var n=t[e];Lt.call(t,e)&&Ba(n,r)&&(r!==o||e in t)||rn(t,e,r)}function Zr(t,e){for(var r=t.length;r--;)if(Ba(t[r][0],e))return r;return-1}function tn(t,e,r,n){return fn(t,(function(t,o,i){e(n,t,r(t),i)})),n}function en(t,e){return t&&Po(e,Iu(e),t)}function rn(t,e,r){"__proto__"==e&&te?te(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function nn(t,e){for(var r=-1,i=e.length,a=n(i),u=null==t;++r<i;)a[r]=u?o:Su(t,e[r]);return a}function on(t,e,r){return t==t&&(r!==o&&(t=t<=r?t:r),e!==o&&(t=t>=e?t:e)),t}function an(t,e,r,n,i,a){var u,s=1&e,c=2&e,f=4&e;if(r&&(u=i?r(t,n,i,a):r(t)),u!==o)return u;if(!Za(t))return t;var l=Ga(t);if(l){if(u=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&Lt.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!s)return Ro(t,u)}else{var p=pi(t),h=p==_||p==w;if($a(t))return wo(t,s);if(p==T||p==v||h&&!i){if(u=c||h?{}:di(t),!s)return c?function(t,e){return Po(t,li(t),e)}(t,function(t,e){return t&&Po(e,ju(e),t)}(u,t)):function(t,e){return Po(t,fi(t),e)}(t,en(u,t))}else{if(!ie[p])return i?t:{};u=function(t,e,r){var n,o=t.constructor;switch(e){case j:return Eo(t);case g:case m:return new o(+t);case C:return function(t,e){var r=e?Eo(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case L:case N:case k:case D:case U:case M:case B:case H:case F:return Oo(t,r);case E:return new o;case O:case P:return new o(t);case x:return function(t){var e=new t.constructor(t.source,pt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case R:return new o;case A:return n=t,kr?Tt(kr.call(n)):{}}}(t,p,s)}}a||(a=new Vr);var d=a.get(t);if(d)return d;a.set(t,u),iu(t)?t.forEach((function(n){u.add(an(n,e,r,n,t,a))})):eu(t)&&t.forEach((function(n,o){u.set(o,an(n,e,r,o,t,a))}));var y=l?o:(f?c?ri:ei:c?ju:Iu)(t);return Se(y||t,(function(n,o){y&&(n=t[o=n]),Qr(u,o,an(n,e,r,o,t,a))})),u}function un(t,e,r){var n=r.length;if(null==t)return!n;for(t=Tt(t);n--;){var i=r[n],a=e[i],u=t[i];if(u===o&&!(i in t)||!a(u))return!1}return!0}function sn(t,e,r){if("function"!=typeof t)throw new Rt(i);return Pi((function(){t.apply(o,r)}),e)}function cn(t,e,r,n){var o=-1,i=Ae,a=!0,u=t.length,s=[],c=e.length;if(!u)return s;r&&(e=je(e,Ke(r))),n?(i=Ie,a=!1):e.length>=200&&(i=Je,a=!1,e=new Wr(e));t:for(;++o<u;){var f=t[o],l=null==r?f:r(f);if(f=n||0!==f?f:0,a&&l==l){for(var p=c;p--;)if(e[p]===l)continue t;s.push(f)}else i(e,l,n)||s.push(f)}return s}Ur.templateSettings={escape:K,evaluate:X,interpolate:J,variable:"",imports:{_:Ur}},Ur.prototype=Br.prototype,Ur.prototype.constructor=Ur,Hr.prototype=Mr(Br.prototype),Hr.prototype.constructor=Hr,Fr.prototype=Mr(Br.prototype),Fr.prototype.constructor=Fr,qr.prototype.clear=function(){this.__data__=xr?xr(null):{},this.size=0},qr.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},qr.prototype.get=function(t){var e=this.__data__;if(xr){var r=e[t];return r===a?o:r}return Lt.call(e,t)?e[t]:o},qr.prototype.has=function(t){var e=this.__data__;return xr?e[t]!==o:Lt.call(e,t)},qr.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=xr&&e===o?a:e,this},Gr.prototype.clear=function(){this.__data__=[],this.size=0},Gr.prototype.delete=function(t){var e=this.__data__,r=Zr(e,t);return!(r<0||(r==e.length-1?e.pop():$t.call(e,r,1),--this.size,0))},Gr.prototype.get=function(t){var e=this.__data__,r=Zr(e,t);return r<0?o:e[r][1]},Gr.prototype.has=function(t){return Zr(this.__data__,t)>-1},Gr.prototype.set=function(t,e){var r=this.__data__,n=Zr(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},zr.prototype.clear=function(){this.size=0,this.__data__={hash:new qr,map:new(Er||Gr),string:new qr}},zr.prototype.delete=function(t){var e=ui(this,t).delete(t);return this.size-=e?1:0,e},zr.prototype.get=function(t){return ui(this,t).get(t)},zr.prototype.has=function(t){return ui(this,t).has(t)},zr.prototype.set=function(t,e){var r=ui(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},Wr.prototype.add=Wr.prototype.push=function(t){return this.__data__.set(t,a),this},Wr.prototype.has=function(t){return this.__data__.has(t)},Vr.prototype.clear=function(){this.__data__=new Gr,this.size=0},Vr.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Vr.prototype.get=function(t){return this.__data__.get(t)},Vr.prototype.has=function(t){return this.__data__.has(t)},Vr.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Gr){var n=r.__data__;if(!Er||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new zr(n)}return r.set(t,e),this.size=r.size,this};var fn=jo(mn),ln=jo(bn,!0);function pn(t,e){var r=!0;return fn(t,(function(t,n,o){return r=!!e(t,n,o)})),r}function hn(t,e,r){for(var n=-1,i=t.length;++n<i;){var a=t[n],u=e(a);if(null!=u&&(s===o?u==u&&!uu(u):r(u,s)))var s=u,c=a}return c}function dn(t,e){var r=[];return fn(t,(function(t,n,o){e(t,n,o)&&r.push(t)})),r}function vn(t,e,r,n,o){var i=-1,a=t.length;for(r||(r=vi),o||(o=[]);++i<a;){var u=t[i];e>0&&r(u)?e>1?vn(u,e-1,r,n,o):Ce(o,u):n||(o[o.length]=u)}return o}var yn=Co(),gn=Co(!0);function mn(t,e){return t&&yn(t,e,Iu)}function bn(t,e){return t&&gn(t,e,Iu)}function _n(t,e){return Pe(e,(function(e){return Xa(t[e])}))}function wn(t,e){for(var r=0,n=(e=go(e,t)).length;null!=t&&r<n;)t=t[Di(e[r++])];return r&&r==n?t:o}function En(t,e,r){var n=e(t);return Ga(t)?n:Ce(n,r(t))}function On(t){return null==t?t===o?"[object Undefined]":"[object Null]":Qt&&Qt in Tt(t)?function(t){var e=Lt.call(t,Qt),r=t[Qt];try{t[Qt]=o;var n=!0}catch(t){}var i=Dt.call(t);return n&&(e?t[Qt]=r:delete t[Qt]),i}(t):function(t){return Dt.call(t)}(t)}function Tn(t,e){return t>e}function Sn(t,e){return null!=t&&Lt.call(t,e)}function xn(t,e){return null!=t&&e in Tt(t)}function Rn(t,e,r){for(var i=r?Ie:Ae,a=t[0].length,u=t.length,s=u,c=n(u),f=1/0,l=[];s--;){var p=t[s];s&&e&&(p=je(p,Ke(e))),f=yr(p.length,f),c[s]=!r&&(e||a>=120&&p.length>=120)?new Wr(s&&p):o}p=t[0];var h=-1,d=c[0];t:for(;++h<a&&l.length<f;){var v=p[h],y=e?e(v):v;if(v=r||0!==v?v:0,!(d?Je(d,y):i(l,y,r))){for(s=u;--s;){var g=c[s];if(!(g?Je(g,y):i(t[s],y,r)))continue t}d&&d.push(y),l.push(v)}}return l}function Pn(t,e,r){var n=null==(t=Si(t,e=go(e,t)))?t:t[Di(Ki(e))];return null==n?o:Oe(n,t,r)}function An(t){return tu(t)&&On(t)==v}function In(t,e,r,n,i){return t===e||(null==t||null==e||!tu(t)&&!tu(e)?t!=t&&e!=e:function(t,e,r,n,i,a){var u=Ga(t),s=Ga(e),c=u?y:pi(t),f=s?y:pi(e),l=(c=c==v?T:c)==T,p=(f=f==v?T:f)==T,h=c==f;if(h&&$a(t)){if(!$a(e))return!1;u=!0,l=!1}if(h&&!l)return a||(a=new Vr),u||su(t)?Zo(t,e,r,n,i,a):function(t,e,r,n,o,i,a){switch(r){case C:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case j:return!(t.byteLength!=e.byteLength||!i(new qt(t),new qt(e)));case g:case m:case O:return Ba(+t,+e);case b:return t.name==e.name&&t.message==e.message;case x:case P:return t==e+"";case E:var u=or;case R:var s=1&n;if(u||(u=ur),t.size!=e.size&&!s)return!1;var c=a.get(t);if(c)return c==e;n|=2,a.set(t,e);var f=Zo(u(t),u(e),n,o,i,a);return a.delete(t),f;case A:if(kr)return kr.call(t)==kr.call(e)}return!1}(t,e,c,r,n,i,a);if(!(1&r)){var d=l&&Lt.call(t,"__wrapped__"),_=p&&Lt.call(e,"__wrapped__");if(d||_){var w=d?t.value():t,S=_?e.value():e;return a||(a=new Vr),i(w,S,r,n,a)}}return!!h&&(a||(a=new Vr),function(t,e,r,n,i,a){var u=1&r,s=ei(t),c=s.length;if(c!=ei(e).length&&!u)return!1;for(var f=c;f--;){var l=s[f];if(!(u?l in e:Lt.call(e,l)))return!1}var p=a.get(t),h=a.get(e);if(p&&h)return p==e&&h==t;var d=!0;a.set(t,e),a.set(e,t);for(var v=u;++f<c;){var y=t[l=s[f]],g=e[l];if(n)var m=u?n(g,y,l,e,t,a):n(y,g,l,t,e,a);if(!(m===o?y===g||i(y,g,r,n,a):m)){d=!1;break}v||(v="constructor"==l)}if(d&&!v){var b=t.constructor,_=e.constructor;b==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _||(d=!1)}return a.delete(t),a.delete(e),d}(t,e,r,n,i,a))}(t,e,r,n,In,i))}function jn(t,e,r,n){var i=r.length,a=i,u=!n;if(null==t)return!a;for(t=Tt(t);i--;){var s=r[i];if(u&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<a;){var c=(s=r[i])[0],f=t[c],l=s[1];if(u&&s[2]){if(f===o&&!(c in t))return!1}else{var p=new Vr;if(n)var h=n(f,l,c,t,e,p);if(!(h===o?In(l,f,3,n,p):h))return!1}}return!0}function Cn(t){return!(!Za(t)||(e=t,kt&&kt in e))&&(Xa(t)?Bt:vt).test(Ui(t));var e}function Ln(t){return"function"==typeof t?t:null==t?rs:"object"==typeof t?Ga(t)?Mn(t[0],t[1]):Un(t):ls(t)}function Nn(t){if(!wi(t))return dr(t);var e=[];for(var r in Tt(t))Lt.call(t,r)&&"constructor"!=r&&e.push(r);return e}function kn(t,e){return t<e}function Dn(t,e){var r=-1,o=Wa(t)?n(t.length):[];return fn(t,(function(t,n,i){o[++r]=e(t,n,i)})),o}function Un(t){var e=si(t);return 1==e.length&&e[0][2]?Oi(e[0][0],e[0][1]):function(r){return r===t||jn(r,t,e)}}function Mn(t,e){return mi(t)&&Ei(e)?Oi(Di(t),e):function(r){var n=Su(r,t);return n===o&&n===e?xu(r,t):In(e,n,3)}}function Bn(t,e,r,n,i){t!==e&&yn(e,(function(a,u){if(i||(i=new Vr),Za(a))!function(t,e,r,n,i,a,u){var s=xi(t,r),c=xi(e,r),f=u.get(c);if(f)Jr(t,r,f);else{var l=a?a(s,c,r+"",t,e,u):o,p=l===o;if(p){var h=Ga(c),d=!h&&$a(c),v=!h&&!d&&su(c);l=c,h||d||v?Ga(s)?l=s:Va(s)?l=Ro(s):d?(p=!1,l=wo(c,!0)):v?(p=!1,l=Oo(c,!0)):l=[]:nu(c)||qa(c)?(l=s,qa(s)?l=yu(s):Za(s)&&!Xa(s)||(l=di(c))):p=!1}p&&(u.set(c,l),i(l,c,n,a,u),u.delete(c)),Jr(t,r,l)}}(t,e,u,r,Bn,n,i);else{var s=n?n(xi(t,u),a,u+"",t,e,i):o;s===o&&(s=a),Jr(t,u,s)}}),ju)}function Hn(t,e){var r=t.length;if(r)return yi(e+=e<0?r:0,r)?t[e]:o}function Fn(t,e,r){e=e.length?je(e,(function(t){return Ga(t)?function(e){return wn(e,1===t.length?t[0]:t)}:t})):[rs];var n=-1;e=je(e,Ke(ai()));var o=Dn(t,(function(t,r,o){var i=je(e,(function(e){return e(t)}));return{criteria:i,index:++n,value:t}}));return function(t,e){var n=t.length;for(t.sort((function(t,e){return function(t,e,r){for(var n=-1,o=t.criteria,i=e.criteria,a=o.length,u=r.length;++n<a;){var s=To(o[n],i[n]);if(s)return n>=u?s:s*("desc"==r[n]?-1:1)}return t.index-e.index}(t,e,r)}));n--;)t[n]=t[n].value;return t}(o)}function qn(t,e,r){for(var n=-1,o=e.length,i={};++n<o;){var a=e[n],u=wn(t,a);r(u,a)&&Xn(i,go(a,t),u)}return i}function Gn(t,e,r,n){var o=n?He:Be,i=-1,a=e.length,u=t;for(t===e&&(e=Ro(e)),r&&(u=je(t,Ke(r)));++i<a;)for(var s=0,c=e[i],f=r?r(c):c;(s=o(u,f,s,n))>-1;)u!==t&&$t.call(u,s,1),$t.call(t,s,1);return t}function zn(t,e){for(var r=t?e.length:0,n=r-1;r--;){var o=e[r];if(r==n||o!==i){var i=o;yi(o)?$t.call(t,o,1):so(t,o)}}return t}function Wn(t,e){return t+he(br()*(e-t+1))}function Vn(t,e){var r="";if(!t||e<1||e>l)return r;do{e%2&&(r+=t),(e=he(e/2))&&(t+=t)}while(e);return r}function $n(t,e){return Ai(Ti(t,e,rs),t+"")}function Yn(t){return Yr(Bu(t))}function Kn(t,e){var r=Bu(t);return Ci(r,on(e,0,r.length))}function Xn(t,e,r,n){if(!Za(t))return t;for(var i=-1,a=(e=go(e,t)).length,u=a-1,s=t;null!=s&&++i<a;){var c=Di(e[i]),f=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(i!=u){var l=s[c];(f=n?n(l,c,s):o)===o&&(f=Za(l)?l:yi(e[i+1])?[]:{})}Qr(s,c,f),s=s[c]}return t}var Jn=Rr?function(t,e){return Rr.set(t,e),t}:rs,Qn=te?function(t,e){return te(t,"toString",{configurable:!0,enumerable:!1,value:Zu(e),writable:!0})}:rs;function Zn(t){return Ci(Bu(t))}function to(t,e,r){var o=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var a=n(i);++o<i;)a[o]=t[o+e];return a}function eo(t,e){var r;return fn(t,(function(t,n,o){return!(r=e(t,n,o))})),!!r}function ro(t,e,r){var n=0,o=null==t?n:t.length;if("number"==typeof e&&e==e&&o<=2147483647){for(;n<o;){var i=n+o>>>1,a=t[i];null!==a&&!uu(a)&&(r?a<=e:a<e)?n=i+1:o=i}return o}return no(t,e,rs,r)}function no(t,e,r,n){var i=0,a=null==t?0:t.length;if(0===a)return 0;for(var u=(e=r(e))!=e,s=null===e,c=uu(e),f=e===o;i<a;){var l=he((i+a)/2),p=r(t[l]),h=p!==o,d=null===p,v=p==p,y=uu(p);if(u)var g=n||v;else g=f?v&&(n||h):s?v&&h&&(n||!d):c?v&&h&&!d&&(n||!y):!d&&!y&&(n?p<=e:p<e);g?i=l+1:a=l}return yr(a,4294967294)}function oo(t,e){for(var r=-1,n=t.length,o=0,i=[];++r<n;){var a=t[r],u=e?e(a):a;if(!r||!Ba(u,s)){var s=u;i[o++]=0===a?0:a}}return i}function io(t){return"number"==typeof t?t:uu(t)?p:+t}function ao(t){if("string"==typeof t)return t;if(Ga(t))return je(t,ao)+"";if(uu(t))return Dr?Dr.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function uo(t,e,r){var n=-1,o=Ae,i=t.length,a=!0,u=[],s=u;if(r)a=!1,o=Ie;else if(i>=200){var c=e?null:$o(t);if(c)return ur(c);a=!1,o=Je,s=new Wr}else s=e?[]:u;t:for(;++n<i;){var f=t[n],l=e?e(f):f;if(f=r||0!==f?f:0,a&&l==l){for(var p=s.length;p--;)if(s[p]===l)continue t;e&&s.push(l),u.push(f)}else o(s,l,r)||(s!==u&&s.push(l),u.push(f))}return u}function so(t,e){return null==(t=Si(t,e=go(e,t)))||delete t[Di(Ki(e))]}function co(t,e,r,n){return Xn(t,e,r(wn(t,e)),n)}function fo(t,e,r,n){for(var o=t.length,i=n?o:-1;(n?i--:++i<o)&&e(t[i],i,t););return r?to(t,n?0:i,n?i+1:o):to(t,n?i+1:0,n?o:i)}function lo(t,e){var r=t;return r instanceof Fr&&(r=r.value()),Le(e,(function(t,e){return e.func.apply(e.thisArg,Ce([t],e.args))}),r)}function po(t,e,r){var o=t.length;if(o<2)return o?uo(t[0]):[];for(var i=-1,a=n(o);++i<o;)for(var u=t[i],s=-1;++s<o;)s!=i&&(a[i]=cn(a[i]||u,t[s],e,r));return uo(vn(a,1),e,r)}function ho(t,e,r){for(var n=-1,i=t.length,a=e.length,u={};++n<i;){var s=n<a?e[n]:o;r(u,t[n],s)}return u}function vo(t){return Va(t)?t:[]}function yo(t){return"function"==typeof t?t:rs}function go(t,e){return Ga(t)?t:mi(t,e)?[t]:ki(gu(t))}var mo=$n;function bo(t,e,r){var n=t.length;return r=r===o?n:r,!e&&r>=n?t:to(t,e,r)}var _o=ae||function(t){return le.clearTimeout(t)};function wo(t,e){if(e)return t.slice();var r=t.length,n=Gt?Gt(r):new t.constructor(r);return t.copy(n),n}function Eo(t){var e=new t.constructor(t.byteLength);return new qt(e).set(new qt(t)),e}function Oo(t,e){var r=e?Eo(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function To(t,e){if(t!==e){var r=t!==o,n=null===t,i=t==t,a=uu(t),u=e!==o,s=null===e,c=e==e,f=uu(e);if(!s&&!f&&!a&&t>e||a&&u&&c&&!s&&!f||n&&u&&c||!r&&c||!i)return 1;if(!n&&!a&&!f&&t<e||f&&r&&i&&!n&&!a||s&&r&&i||!u&&i||!c)return-1}return 0}function So(t,e,r,o){for(var i=-1,a=t.length,u=r.length,s=-1,c=e.length,f=vr(a-u,0),l=n(c+f),p=!o;++s<c;)l[s]=e[s];for(;++i<u;)(p||i<a)&&(l[r[i]]=t[i]);for(;f--;)l[s++]=t[i++];return l}function xo(t,e,r,o){for(var i=-1,a=t.length,u=-1,s=r.length,c=-1,f=e.length,l=vr(a-s,0),p=n(l+f),h=!o;++i<l;)p[i]=t[i];for(var d=i;++c<f;)p[d+c]=e[c];for(;++u<s;)(h||i<a)&&(p[d+r[u]]=t[i++]);return p}function Ro(t,e){var r=-1,o=t.length;for(e||(e=n(o));++r<o;)e[r]=t[r];return e}function Po(t,e,r,n){var i=!r;r||(r={});for(var a=-1,u=e.length;++a<u;){var s=e[a],c=n?n(r[s],t[s],s,r,t):o;c===o&&(c=t[s]),i?rn(r,s,c):Qr(r,s,c)}return r}function Ao(t,e){return function(r,n){var o=Ga(r)?Te:tn,i=e?e():{};return o(r,t,ai(n,2),i)}}function Io(t){return $n((function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:o,u=i>2?r[2]:o;for(a=t.length>3&&"function"==typeof a?(i--,a):o,u&&gi(r[0],r[1],u)&&(a=i<3?o:a,i=1),e=Tt(e);++n<i;){var s=r[n];s&&t(e,s,n,a)}return e}))}function jo(t,e){return function(r,n){if(null==r)return r;if(!Wa(r))return t(r,n);for(var o=r.length,i=e?o:-1,a=Tt(r);(e?i--:++i<o)&&!1!==n(a[i],i,a););return r}}function Co(t){return function(e,r,n){for(var o=-1,i=Tt(e),a=n(e),u=a.length;u--;){var s=a[t?u:++o];if(!1===r(i[s],s,i))break}return e}}function Lo(t){return function(e){var r=nr(e=gu(e))?fr(e):o,n=r?r[0]:e.charAt(0),i=r?bo(r,1).join(""):e.slice(1);return n[t]()+i}}function No(t){return function(e){return Le(Xu(qu(e).replace(Xt,"")),t,"")}}function ko(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=Mr(t.prototype),n=t.apply(r,e);return Za(n)?n:r}}function Do(t){return function(e,r,n){var i=Tt(e);if(!Wa(e)){var a=ai(r,3);e=Iu(e),r=function(t){return a(i[t],t,i)}}var u=t(e,r,n);return u>-1?i[a?e[u]:u]:o}}function Uo(t){return ti((function(e){var r=e.length,n=r,a=Hr.prototype.thru;for(t&&e.reverse();n--;){var u=e[n];if("function"!=typeof u)throw new Rt(i);if(a&&!s&&"wrapper"==oi(u))var s=new Hr([],!0)}for(n=s?n:r;++n<r;){var c=oi(u=e[n]),f="wrapper"==c?ni(u):o;s=f&&bi(f[0])&&424==f[1]&&!f[4].length&&1==f[9]?s[oi(f[0])].apply(s,f[3]):1==u.length&&bi(u)?s[c]():s.thru(u)}return function(){var t=arguments,n=t[0];if(s&&1==t.length&&Ga(n))return s.plant(n).value();for(var o=0,i=r?e[o].apply(this,t):n;++o<r;)i=e[o].call(this,i);return i}}))}function Mo(t,e,r,i,a,u,s,f,l,p){var h=e&c,d=1&e,v=2&e,y=24&e,g=512&e,m=v?o:ko(t);return function c(){for(var b=arguments.length,_=n(b),w=b;w--;)_[w]=arguments[w];if(y)var E=ii(c),O=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n}(_,E);if(i&&(_=So(_,i,a,y)),u&&(_=xo(_,u,s,y)),b-=O,y&&b<p){var T=ar(_,E);return Wo(t,e,Mo,c.placeholder,r,_,T,f,l,p-b)}var S=d?r:this,x=v?S[t]:t;return b=_.length,f?_=function(t,e){for(var r=t.length,n=yr(e.length,r),i=Ro(t);n--;){var a=e[n];t[n]=yi(a,r)?i[a]:o}return t}(_,f):g&&b>1&&_.reverse(),h&&l<b&&(_.length=l),this&&this!==le&&this instanceof c&&(x=m||ko(x)),x.apply(S,_)}}function Bo(t,e){return function(r,n){return function(t,e,r,n){return mn(t,(function(t,o,i){e(n,r(t),o,i)})),n}(r,t,e(n),{})}}function Ho(t,e){return function(r,n){var i;if(r===o&&n===o)return e;if(r!==o&&(i=r),n!==o){if(i===o)return n;"string"==typeof r||"string"==typeof n?(r=ao(r),n=ao(n)):(r=io(r),n=io(n)),i=t(r,n)}return i}}function Fo(t){return ti((function(e){return e=je(e,Ke(ai())),$n((function(r){var n=this;return t(e,(function(t){return Oe(t,n,r)}))}))}))}function qo(t,e){var r=(e=e===o?" ":ao(e)).length;if(r<2)return r?Vn(e,t):e;var n=Vn(e,pe(t/cr(e)));return nr(e)?bo(fr(n),0,t).join(""):n.slice(0,t)}function Go(t){return function(e,r,i){return i&&"number"!=typeof i&&gi(e,r,i)&&(r=i=o),e=pu(e),r===o?(r=e,e=0):r=pu(r),function(t,e,r,o){for(var i=-1,a=vr(pe((e-t)/(r||1)),0),u=n(a);a--;)u[o?a:++i]=t,t+=r;return u}(e,r,i=i===o?e<r?1:-1:pu(i),t)}}function zo(t){return function(e,r){return"string"==typeof e&&"string"==typeof r||(e=vu(e),r=vu(r)),t(e,r)}}function Wo(t,e,r,n,i,a,u,c,f,l){var p=8&e;e|=p?s:64,4&(e&=~(p?64:s))||(e&=-4);var h=[t,e,i,p?a:o,p?u:o,p?o:a,p?o:u,c,f,l],d=r.apply(o,h);return bi(t)&&Ri(d,h),d.placeholder=n,Ii(d,t,e)}function Vo(t){var e=Ot[t];return function(t,r){if(t=vu(t),(r=null==r?0:yr(hu(r),292))&&De(t)){var n=(gu(t)+"e").split("e");return+((n=(gu(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}var $o=Tr&&1/ur(new Tr([,-0]))[1]==f?function(t){return new Tr(t)}:us;function Yo(t){return function(e){var r=pi(e);return r==E?or(e):r==R?sr(e):function(t,e){return je(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Ko(t,e,r,a,f,l,p,h){var d=2&e;if(!d&&"function"!=typeof t)throw new Rt(i);var v=a?a.length:0;if(v||(e&=-97,a=f=o),p=p===o?p:vr(hu(p),0),h=h===o?h:hu(h),v-=f?f.length:0,64&e){var y=a,g=f;a=f=o}var m=d?o:ni(t),b=[t,e,r,a,f,y,g,l,p,h];if(m&&function(t,e){var r=t[1],n=e[1],o=r|n,i=o<131,a=n==c&&8==r||n==c&&256==r&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==r;if(!i&&!a)return t;1&n&&(t[2]=e[2],o|=1&r?0:4);var s=e[3];if(s){var f=t[3];t[3]=f?So(f,s,e[4]):s,t[4]=f?ar(t[3],u):e[4]}(s=e[5])&&(f=t[5],t[5]=f?xo(f,s,e[6]):s,t[6]=f?ar(t[5],u):e[6]),(s=e[7])&&(t[7]=s),n&c&&(t[8]=null==t[8]?e[8]:yr(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=o}(b,m),t=b[0],e=b[1],r=b[2],a=b[3],f=b[4],!(h=b[9]=b[9]===o?d?0:t.length:vr(b[9]-v,0))&&24&e&&(e&=-25),e&&1!=e)_=8==e||16==e?function(t,e,r){var i=ko(t);return function a(){for(var u=arguments.length,s=n(u),c=u,f=ii(a);c--;)s[c]=arguments[c];var l=u<3&&s[0]!==f&&s[u-1]!==f?[]:ar(s,f);return(u-=l.length)<r?Wo(t,e,Mo,a.placeholder,o,s,l,o,o,r-u):Oe(this&&this!==le&&this instanceof a?i:t,this,s)}}(t,e,h):e!=s&&33!=e||f.length?Mo.apply(o,b):function(t,e,r,o){var i=1&e,a=ko(t);return function e(){for(var u=-1,s=arguments.length,c=-1,f=o.length,l=n(f+s),p=this&&this!==le&&this instanceof e?a:t;++c<f;)l[c]=o[c];for(;s--;)l[c++]=arguments[++u];return Oe(p,i?r:this,l)}}(t,e,r,a);else var _=function(t,e,r){var n=1&e,o=ko(t);return function e(){return(this&&this!==le&&this instanceof e?o:t).apply(n?r:this,arguments)}}(t,e,r);return Ii((m?Jn:Ri)(_,b),t,e)}function Xo(t,e,r,n){return t===o||Ba(t,It[r])&&!Lt.call(n,r)?e:t}function Jo(t,e,r,n,i,a){return Za(t)&&Za(e)&&(a.set(e,t),Bn(t,e,o,Jo,a),a.delete(e)),t}function Qo(t){return nu(t)?o:t}function Zo(t,e,r,n,i,a){var u=1&r,s=t.length,c=e.length;if(s!=c&&!(u&&c>s))return!1;var f=a.get(t),l=a.get(e);if(f&&l)return f==e&&l==t;var p=-1,h=!0,d=2&r?new Wr:o;for(a.set(t,e),a.set(e,t);++p<s;){var v=t[p],y=e[p];if(n)var g=u?n(y,v,p,e,t,a):n(v,y,p,t,e,a);if(g!==o){if(g)continue;h=!1;break}if(d){if(!ke(e,(function(t,e){if(!Je(d,e)&&(v===t||i(v,t,r,n,a)))return d.push(e)}))){h=!1;break}}else if(v!==y&&!i(v,y,r,n,a)){h=!1;break}}return a.delete(t),a.delete(e),h}function ti(t){return Ai(Ti(t,o,zi),t+"")}function ei(t){return En(t,Iu,fi)}function ri(t){return En(t,ju,li)}var ni=Rr?function(t){return Rr.get(t)}:us;function oi(t){for(var e=t.name+"",r=Pr[e],n=Lt.call(Pr,e)?r.length:0;n--;){var o=r[n],i=o.func;if(null==i||i==t)return o.name}return e}function ii(t){return(Lt.call(Ur,"placeholder")?Ur:t).placeholder}function ai(){var t=Ur.iteratee||ns;return t=t===ns?Ln:t,arguments.length?t(arguments[0],arguments[1]):t}function ui(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function si(t){for(var e=Iu(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Ei(o)]}return e}function ci(t,e){var r=function(t,e){return null==t?o:t[e]}(t,e);return Cn(r)?r:o}var fi=ve?function(t){return null==t?[]:(t=Tt(t),Pe(ve(t),(function(e){return Vt.call(t,e)})))}:ds,li=ve?function(t){for(var e=[];t;)Ce(e,fi(t)),t=zt(t);return e}:ds,pi=On;function hi(t,e,r){for(var n=-1,o=(e=go(e,t)).length,i=!1;++n<o;){var a=Di(e[n]);if(!(i=null!=t&&r(t,a)))break;t=t[a]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&Qa(o)&&yi(a,o)&&(Ga(t)||qa(t))}function di(t){return"function"!=typeof t.constructor||wi(t)?{}:Mr(zt(t))}function vi(t){return Ga(t)||qa(t)||!!(Yt&&t&&t[Yt])}function yi(t,e){var r=typeof t;return!!(e=null==e?l:e)&&("number"==r||"symbol"!=r&&gt.test(t))&&t>-1&&t%1==0&&t<e}function gi(t,e,r){if(!Za(r))return!1;var n=typeof e;return!!("number"==n?Wa(r)&&yi(e,r.length):"string"==n&&e in r)&&Ba(r[e],t)}function mi(t,e){if(Ga(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!uu(t))||Z.test(t)||!Q.test(t)||null!=e&&t in Tt(e)}function bi(t){var e=oi(t),r=Ur[e];if("function"!=typeof r||!(e in Fr.prototype))return!1;if(t===r)return!0;var n=ni(r);return!!n&&t===n[0]}(wr&&pi(new wr(new ArrayBuffer(1)))!=C||Er&&pi(new Er)!=E||Or&&pi(Or.resolve())!=S||Tr&&pi(new Tr)!=R||Sr&&pi(new Sr)!=I)&&(pi=function(t){var e=On(t),r=e==T?t.constructor:o,n=r?Ui(r):"";if(n)switch(n){case Ar:return C;case Ir:return E;case jr:return S;case Cr:return R;case Lr:return I}return e});var _i=jt?Xa:vs;function wi(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||It)}function Ei(t){return t==t&&!Za(t)}function Oi(t,e){return function(r){return null!=r&&r[t]===e&&(e!==o||t in Tt(r))}}function Ti(t,e,r){return e=vr(e===o?t.length-1:e,0),function(){for(var o=arguments,i=-1,a=vr(o.length-e,0),u=n(a);++i<a;)u[i]=o[e+i];i=-1;for(var s=n(e+1);++i<e;)s[i]=o[i];return s[e]=r(u),Oe(t,this,s)}}function Si(t,e){return e.length<2?t:wn(t,to(e,0,-1))}function xi(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Ri=ji(Jn),Pi=fe||function(t,e){return le.setTimeout(t,e)},Ai=ji(Qn);function Ii(t,e,r){var n=e+"";return Ai(t,function(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(it,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return Se(d,(function(r){var n="_."+r[0];e&r[1]&&!Ae(t,n)&&t.push(n)})),t.sort()}(function(t){var e=t.match(at);return e?e[1].split(ut):[]}(n),r)))}function ji(t){var e=0,r=0;return function(){var n=gr(),i=16-(n-r);if(r=n,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(o,arguments)}}function Ci(t,e){var r=-1,n=t.length,i=n-1;for(e=e===o?n:e;++r<e;){var a=Wn(r,i),u=t[a];t[a]=t[r],t[r]=u}return t.length=e,t}var Li,Ni,ki=(Li=La((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,r,n,o){e.push(n?o.replace(ft,"$1"):r||t)})),e}),(function(t){return 500===Ni.size&&Ni.clear(),t})),Ni=Li.cache,Li);function Di(t){if("string"==typeof t||uu(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ui(t){if(null!=t){try{return Ct.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Mi(t){if(t instanceof Fr)return t.clone();var e=new Hr(t.__wrapped__,t.__chain__);return e.__actions__=Ro(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Bi=$n((function(t,e){return Va(t)?cn(t,vn(e,1,Va,!0)):[]})),Hi=$n((function(t,e){var r=Ki(e);return Va(r)&&(r=o),Va(t)?cn(t,vn(e,1,Va,!0),ai(r,2)):[]})),Fi=$n((function(t,e){var r=Ki(e);return Va(r)&&(r=o),Va(t)?cn(t,vn(e,1,Va,!0),o,r):[]}));function qi(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var o=null==r?0:hu(r);return o<0&&(o=vr(n+o,0)),Me(t,ai(e,3),o)}function Gi(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=n-1;return r!==o&&(i=hu(r),i=r<0?vr(n+i,0):yr(i,n-1)),Me(t,ai(e,3),i,!0)}function zi(t){return null!=t&&t.length?vn(t,1):[]}function Wi(t){return t&&t.length?t[0]:o}var Vi=$n((function(t){var e=je(t,vo);return e.length&&e[0]===t[0]?Rn(e):[]})),$i=$n((function(t){var e=Ki(t),r=je(t,vo);return e===Ki(r)?e=o:r.pop(),r.length&&r[0]===t[0]?Rn(r,ai(e,2)):[]})),Yi=$n((function(t){var e=Ki(t),r=je(t,vo);return(e="function"==typeof e?e:o)&&r.pop(),r.length&&r[0]===t[0]?Rn(r,o,e):[]}));function Ki(t){var e=null==t?0:t.length;return e?t[e-1]:o}var Xi=$n(Ji);function Ji(t,e){return t&&t.length&&e&&e.length?Gn(t,e):t}var Qi=ti((function(t,e){var r=null==t?0:t.length,n=nn(t,e);return zn(t,je(e,(function(t){return yi(t,r)?+t:t})).sort(To)),n}));function Zi(t){return null==t?t:_r.call(t)}var ta=$n((function(t){return uo(vn(t,1,Va,!0))})),ea=$n((function(t){var e=Ki(t);return Va(e)&&(e=o),uo(vn(t,1,Va,!0),ai(e,2))})),ra=$n((function(t){var e=Ki(t);return e="function"==typeof e?e:o,uo(vn(t,1,Va,!0),o,e)}));function na(t){if(!t||!t.length)return[];var e=0;return t=Pe(t,(function(t){if(Va(t))return e=vr(t.length,e),!0})),$e(e,(function(e){return je(t,Ge(e))}))}function oa(t,e){if(!t||!t.length)return[];var r=na(t);return null==e?r:je(r,(function(t){return Oe(e,o,t)}))}var ia=$n((function(t,e){return Va(t)?cn(t,e):[]})),aa=$n((function(t){return po(Pe(t,Va))})),ua=$n((function(t){var e=Ki(t);return Va(e)&&(e=o),po(Pe(t,Va),ai(e,2))})),sa=$n((function(t){var e=Ki(t);return e="function"==typeof e?e:o,po(Pe(t,Va),o,e)})),ca=$n(na),fa=$n((function(t){var e=t.length,r=e>1?t[e-1]:o;return r="function"==typeof r?(t.pop(),r):o,oa(t,r)}));function la(t){var e=Ur(t);return e.__chain__=!0,e}function pa(t,e){return e(t)}var ha=ti((function(t){var e=t.length,r=e?t[0]:0,n=this.__wrapped__,i=function(e){return nn(e,t)};return!(e>1||this.__actions__.length)&&n instanceof Fr&&yi(r)?((n=n.slice(r,+r+(e?1:0))).__actions__.push({func:pa,args:[i],thisArg:o}),new Hr(n,this.__chain__).thru((function(t){return e&&!t.length&&t.push(o),t}))):this.thru(i)})),da=Ao((function(t,e,r){Lt.call(t,r)?++t[r]:rn(t,r,1)})),va=Do(qi),ya=Do(Gi);function ga(t,e){return(Ga(t)?Se:fn)(t,ai(e,3))}function ma(t,e){return(Ga(t)?xe:ln)(t,ai(e,3))}var ba=Ao((function(t,e,r){Lt.call(t,r)?t[r].push(e):rn(t,r,[e])})),_a=$n((function(t,e,r){var o=-1,i="function"==typeof e,a=Wa(t)?n(t.length):[];return fn(t,(function(t){a[++o]=i?Oe(e,t,r):Pn(t,e,r)})),a})),wa=Ao((function(t,e,r){rn(t,r,e)}));function Ea(t,e){return(Ga(t)?je:Dn)(t,ai(e,3))}var Oa=Ao((function(t,e,r){t[r?0:1].push(e)}),(function(){return[[],[]]})),Ta=$n((function(t,e){if(null==t)return[];var r=e.length;return r>1&&gi(t,e[0],e[1])?e=[]:r>2&&gi(e[0],e[1],e[2])&&(e=[e[0]]),Fn(t,vn(e,1),[])})),Sa=ce||function(){return le.Date.now()};function xa(t,e,r){return e=r?o:e,e=t&&null==e?t.length:e,Ko(t,c,o,o,o,o,e)}function Ra(t,e){var r;if("function"!=typeof e)throw new Rt(i);return t=hu(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=o),r}}var Pa=$n((function(t,e,r){var n=1;if(r.length){var o=ar(r,ii(Pa));n|=s}return Ko(t,n,e,r,o)})),Aa=$n((function(t,e,r){var n=3;if(r.length){var o=ar(r,ii(Aa));n|=s}return Ko(e,n,t,r,o)}));function Ia(t,e,r){var n,a,u,s,c,f,l=0,p=!1,h=!1,d=!0;if("function"!=typeof t)throw new Rt(i);function v(e){var r=n,i=a;return n=a=o,l=e,s=t.apply(i,r)}function y(t){var r=t-f;return f===o||r>=e||r<0||h&&t-l>=u}function g(){var t=Sa();if(y(t))return m(t);c=Pi(g,function(t){var r=e-(t-f);return h?yr(r,u-(t-l)):r}(t))}function m(t){return c=o,d&&n?v(t):(n=a=o,s)}function b(){var t=Sa(),r=y(t);if(n=arguments,a=this,f=t,r){if(c===o)return function(t){return l=t,c=Pi(g,e),p?v(t):s}(f);if(h)return _o(c),c=Pi(g,e),v(f)}return c===o&&(c=Pi(g,e)),s}return e=vu(e)||0,Za(r)&&(p=!!r.leading,u=(h="maxWait"in r)?vr(vu(r.maxWait)||0,e):u,d="trailing"in r?!!r.trailing:d),b.cancel=function(){c!==o&&_o(c),l=0,n=f=a=c=o},b.flush=function(){return c===o?s:m(Sa())},b}var ja=$n((function(t,e){return sn(t,1,e)})),Ca=$n((function(t,e,r){return sn(t,vu(e)||0,r)}));function La(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Rt(i);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(La.Cache||zr),r}function Na(t){if("function"!=typeof t)throw new Rt(i);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}La.Cache=zr;var ka=mo((function(t,e){var r=(e=1==e.length&&Ga(e[0])?je(e[0],Ke(ai())):je(vn(e,1),Ke(ai()))).length;return $n((function(n){for(var o=-1,i=yr(n.length,r);++o<i;)n[o]=e[o].call(this,n[o]);return Oe(t,this,n)}))})),Da=$n((function(t,e){var r=ar(e,ii(Da));return Ko(t,s,o,e,r)})),Ua=$n((function(t,e){var r=ar(e,ii(Ua));return Ko(t,64,o,e,r)})),Ma=ti((function(t,e){return Ko(t,256,o,o,o,e)}));function Ba(t,e){return t===e||t!=t&&e!=e}var Ha=zo(Tn),Fa=zo((function(t,e){return t>=e})),qa=An(function(){return arguments}())?An:function(t){return tu(t)&&Lt.call(t,"callee")&&!Vt.call(t,"callee")},Ga=n.isArray,za=ge?Ke(ge):function(t){return tu(t)&&On(t)==j};function Wa(t){return null!=t&&Qa(t.length)&&!Xa(t)}function Va(t){return tu(t)&&Wa(t)}var $a=ye||vs,Ya=me?Ke(me):function(t){return tu(t)&&On(t)==m};function Ka(t){if(!tu(t))return!1;var e=On(t);return e==b||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!nu(t)}function Xa(t){if(!Za(t))return!1;var e=On(t);return e==_||e==w||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Ja(t){return"number"==typeof t&&t==hu(t)}function Qa(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=l}function Za(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function tu(t){return null!=t&&"object"==typeof t}var eu=be?Ke(be):function(t){return tu(t)&&pi(t)==E};function ru(t){return"number"==typeof t||tu(t)&&On(t)==O}function nu(t){if(!tu(t)||On(t)!=T)return!1;var e=zt(t);if(null===e)return!0;var r=Lt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Ct.call(r)==Ut}var ou=_e?Ke(_e):function(t){return tu(t)&&On(t)==x},iu=we?Ke(we):function(t){return tu(t)&&pi(t)==R};function au(t){return"string"==typeof t||!Ga(t)&&tu(t)&&On(t)==P}function uu(t){return"symbol"==typeof t||tu(t)&&On(t)==A}var su=Ee?Ke(Ee):function(t){return tu(t)&&Qa(t.length)&&!!oe[On(t)]},cu=zo(kn),fu=zo((function(t,e){return t<=e}));function lu(t){if(!t)return[];if(Wa(t))return au(t)?fr(t):Ro(t);if(Kt&&t[Kt])return function(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}(t[Kt]());var e=pi(t);return(e==E?or:e==R?ur:Bu)(t)}function pu(t){return t?(t=vu(t))===f||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function hu(t){var e=pu(t),r=e%1;return e==e?r?e-r:e:0}function du(t){return t?on(hu(t),0,h):0}function vu(t){if("number"==typeof t)return t;if(uu(t))return p;if(Za(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Za(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ye(t);var r=dt.test(t);return r||yt.test(t)?se(t.slice(2),r?2:8):ht.test(t)?p:+t}function yu(t){return Po(t,ju(t))}function gu(t){return null==t?"":ao(t)}var mu=Io((function(t,e){if(wi(e)||Wa(e))Po(e,Iu(e),t);else for(var r in e)Lt.call(e,r)&&Qr(t,r,e[r])})),bu=Io((function(t,e){Po(e,ju(e),t)})),_u=Io((function(t,e,r,n){Po(e,ju(e),t,n)})),wu=Io((function(t,e,r,n){Po(e,Iu(e),t,n)})),Eu=ti(nn),Ou=$n((function(t,e){t=Tt(t);var r=-1,n=e.length,i=n>2?e[2]:o;for(i&&gi(e[0],e[1],i)&&(n=1);++r<n;)for(var a=e[r],u=ju(a),s=-1,c=u.length;++s<c;){var f=u[s],l=t[f];(l===o||Ba(l,It[f])&&!Lt.call(t,f))&&(t[f]=a[f])}return t})),Tu=$n((function(t){return t.push(o,Jo),Oe(Lu,o,t)}));function Su(t,e,r){var n=null==t?o:wn(t,e);return n===o?r:n}function xu(t,e){return null!=t&&hi(t,e,xn)}var Ru=Bo((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=Dt.call(e)),t[e]=r}),Zu(rs)),Pu=Bo((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=Dt.call(e)),Lt.call(t,e)?t[e].push(r):t[e]=[r]}),ai),Au=$n(Pn);function Iu(t){return Wa(t)?$r(t):Nn(t)}function ju(t){return Wa(t)?$r(t,!0):function(t){if(!Za(t))return function(t){var e=[];if(null!=t)for(var r in Tt(t))e.push(r);return e}(t);var e=wi(t),r=[];for(var n in t)("constructor"!=n||!e&&Lt.call(t,n))&&r.push(n);return r}(t)}var Cu=Io((function(t,e,r){Bn(t,e,r)})),Lu=Io((function(t,e,r,n){Bn(t,e,r,n)})),Nu=ti((function(t,e){var r={};if(null==t)return r;var n=!1;e=je(e,(function(e){return e=go(e,t),n||(n=e.length>1),e})),Po(t,ri(t),r),n&&(r=an(r,7,Qo));for(var o=e.length;o--;)so(r,e[o]);return r})),ku=ti((function(t,e){return null==t?{}:function(t,e){return qn(t,e,(function(e,r){return xu(t,r)}))}(t,e)}));function Du(t,e){if(null==t)return{};var r=je(ri(t),(function(t){return[t]}));return e=ai(e),qn(t,r,(function(t,r){return e(t,r[0])}))}var Uu=Yo(Iu),Mu=Yo(ju);function Bu(t){return null==t?[]:Xe(t,Iu(t))}var Hu=No((function(t,e,r){return e=e.toLowerCase(),t+(r?Fu(e):e)}));function Fu(t){return Ku(gu(t).toLowerCase())}function qu(t){return(t=gu(t))&&t.replace(mt,tr).replace(Jt,"")}var Gu=No((function(t,e,r){return t+(r?"-":"")+e.toLowerCase()})),zu=No((function(t,e,r){return t+(r?" ":"")+e.toLowerCase()})),Wu=Lo("toLowerCase"),Vu=No((function(t,e,r){return t+(r?"_":"")+e.toLowerCase()})),$u=No((function(t,e,r){return t+(r?" ":"")+Ku(e)})),Yu=No((function(t,e,r){return t+(r?" ":"")+e.toUpperCase()})),Ku=Lo("toUpperCase");function Xu(t,e,r){return t=gu(t),(e=r?o:e)===o?function(t){return ee.test(t)}(t)?function(t){return t.match(Zt)||[]}(t):function(t){return t.match(st)||[]}(t):t.match(e)||[]}var Ju=$n((function(t,e){try{return Oe(t,o,e)}catch(t){return Ka(t)?t:new wt(t)}})),Qu=ti((function(t,e){return Se(e,(function(e){e=Di(e),rn(t,e,Pa(t[e],t))})),t}));function Zu(t){return function(){return t}}var ts=Uo(),es=Uo(!0);function rs(t){return t}function ns(t){return Ln("function"==typeof t?t:an(t,1))}var os=$n((function(t,e){return function(r){return Pn(r,t,e)}})),is=$n((function(t,e){return function(r){return Pn(t,r,e)}}));function as(t,e,r){var n=Iu(e),o=_n(e,n);null!=r||Za(e)&&(o.length||!n.length)||(r=e,e=t,t=this,o=_n(e,Iu(e)));var i=!(Za(r)&&"chain"in r&&!r.chain),a=Xa(t);return Se(o,(function(r){var n=e[r];t[r]=n,a&&(t.prototype[r]=function(){var e=this.__chain__;if(i||e){var r=t(this.__wrapped__);return(r.__actions__=Ro(this.__actions__)).push({func:n,args:arguments,thisArg:t}),r.__chain__=e,r}return n.apply(t,Ce([this.value()],arguments))})})),t}function us(){}var ss=Fo(je),cs=Fo(Re),fs=Fo(ke);function ls(t){return mi(t)?Ge(Di(t)):function(t){return function(e){return wn(e,t)}}(t)}var ps=Go(),hs=Go(!0);function ds(){return[]}function vs(){return!1}var ys,gs=Ho((function(t,e){return t+e}),0),ms=Vo("ceil"),bs=Ho((function(t,e){return t/e}),1),_s=Vo("floor"),ws=Ho((function(t,e){return t*e}),1),Es=Vo("round"),Os=Ho((function(t,e){return t-e}),0);return Ur.after=function(t,e){if("function"!=typeof e)throw new Rt(i);return t=hu(t),function(){if(--t<1)return e.apply(this,arguments)}},Ur.ary=xa,Ur.assign=mu,Ur.assignIn=bu,Ur.assignInWith=_u,Ur.assignWith=wu,Ur.at=Eu,Ur.before=Ra,Ur.bind=Pa,Ur.bindAll=Qu,Ur.bindKey=Aa,Ur.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ga(t)?t:[t]},Ur.chain=la,Ur.chunk=function(t,e,r){e=(r?gi(t,e,r):e===o)?1:vr(hu(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var a=0,u=0,s=n(pe(i/e));a<i;)s[u++]=to(t,a,a+=e);return s},Ur.compact=function(t){for(var e=-1,r=null==t?0:t.length,n=0,o=[];++e<r;){var i=t[e];i&&(o[n++]=i)}return o},Ur.concat=function(){var t=arguments.length;if(!t)return[];for(var e=n(t-1),r=arguments[0],o=t;o--;)e[o-1]=arguments[o];return Ce(Ga(r)?Ro(r):[r],vn(e,1))},Ur.cond=function(t){var e=null==t?0:t.length,r=ai();return t=e?je(t,(function(t){if("function"!=typeof t[1])throw new Rt(i);return[r(t[0]),t[1]]})):[],$n((function(r){for(var n=-1;++n<e;){var o=t[n];if(Oe(o[0],this,r))return Oe(o[1],this,r)}}))},Ur.conforms=function(t){return function(t){var e=Iu(t);return function(r){return un(r,t,e)}}(an(t,1))},Ur.constant=Zu,Ur.countBy=da,Ur.create=function(t,e){var r=Mr(t);return null==e?r:en(r,e)},Ur.curry=function t(e,r,n){var i=Ko(e,8,o,o,o,o,o,r=n?o:r);return i.placeholder=t.placeholder,i},Ur.curryRight=function t(e,r,n){var i=Ko(e,16,o,o,o,o,o,r=n?o:r);return i.placeholder=t.placeholder,i},Ur.debounce=Ia,Ur.defaults=Ou,Ur.defaultsDeep=Tu,Ur.defer=ja,Ur.delay=Ca,Ur.difference=Bi,Ur.differenceBy=Hi,Ur.differenceWith=Fi,Ur.drop=function(t,e,r){var n=null==t?0:t.length;return n?to(t,(e=r||e===o?1:hu(e))<0?0:e,n):[]},Ur.dropRight=function(t,e,r){var n=null==t?0:t.length;return n?to(t,0,(e=n-(e=r||e===o?1:hu(e)))<0?0:e):[]},Ur.dropRightWhile=function(t,e){return t&&t.length?fo(t,ai(e,3),!0,!0):[]},Ur.dropWhile=function(t,e){return t&&t.length?fo(t,ai(e,3),!0):[]},Ur.fill=function(t,e,r,n){var i=null==t?0:t.length;return i?(r&&"number"!=typeof r&&gi(t,e,r)&&(r=0,n=i),function(t,e,r,n){var i=t.length;for((r=hu(r))<0&&(r=-r>i?0:i+r),(n=n===o||n>i?i:hu(n))<0&&(n+=i),n=r>n?0:du(n);r<n;)t[r++]=e;return t}(t,e,r,n)):[]},Ur.filter=function(t,e){return(Ga(t)?Pe:dn)(t,ai(e,3))},Ur.flatMap=function(t,e){return vn(Ea(t,e),1)},Ur.flatMapDeep=function(t,e){return vn(Ea(t,e),f)},Ur.flatMapDepth=function(t,e,r){return r=r===o?1:hu(r),vn(Ea(t,e),r)},Ur.flatten=zi,Ur.flattenDeep=function(t){return null!=t&&t.length?vn(t,f):[]},Ur.flattenDepth=function(t,e){return null!=t&&t.length?vn(t,e=e===o?1:hu(e)):[]},Ur.flip=function(t){return Ko(t,512)},Ur.flow=ts,Ur.flowRight=es,Ur.fromPairs=function(t){for(var e=-1,r=null==t?0:t.length,n={};++e<r;){var o=t[e];n[o[0]]=o[1]}return n},Ur.functions=function(t){return null==t?[]:_n(t,Iu(t))},Ur.functionsIn=function(t){return null==t?[]:_n(t,ju(t))},Ur.groupBy=ba,Ur.initial=function(t){return null!=t&&t.length?to(t,0,-1):[]},Ur.intersection=Vi,Ur.intersectionBy=$i,Ur.intersectionWith=Yi,Ur.invert=Ru,Ur.invertBy=Pu,Ur.invokeMap=_a,Ur.iteratee=ns,Ur.keyBy=wa,Ur.keys=Iu,Ur.keysIn=ju,Ur.map=Ea,Ur.mapKeys=function(t,e){var r={};return e=ai(e,3),mn(t,(function(t,n,o){rn(r,e(t,n,o),t)})),r},Ur.mapValues=function(t,e){var r={};return e=ai(e,3),mn(t,(function(t,n,o){rn(r,n,e(t,n,o))})),r},Ur.matches=function(t){return Un(an(t,1))},Ur.matchesProperty=function(t,e){return Mn(t,an(e,1))},Ur.memoize=La,Ur.merge=Cu,Ur.mergeWith=Lu,Ur.method=os,Ur.methodOf=is,Ur.mixin=as,Ur.negate=Na,Ur.nthArg=function(t){return t=hu(t),$n((function(e){return Hn(e,t)}))},Ur.omit=Nu,Ur.omitBy=function(t,e){return Du(t,Na(ai(e)))},Ur.once=function(t){return Ra(2,t)},Ur.orderBy=function(t,e,r,n){return null==t?[]:(Ga(e)||(e=null==e?[]:[e]),Ga(r=n?o:r)||(r=null==r?[]:[r]),Fn(t,e,r))},Ur.over=ss,Ur.overArgs=ka,Ur.overEvery=cs,Ur.overSome=fs,Ur.partial=Da,Ur.partialRight=Ua,Ur.partition=Oa,Ur.pick=ku,Ur.pickBy=Du,Ur.property=ls,Ur.propertyOf=function(t){return function(e){return null==t?o:wn(t,e)}},Ur.pull=Xi,Ur.pullAll=Ji,Ur.pullAllBy=function(t,e,r){return t&&t.length&&e&&e.length?Gn(t,e,ai(r,2)):t},Ur.pullAllWith=function(t,e,r){return t&&t.length&&e&&e.length?Gn(t,e,o,r):t},Ur.pullAt=Qi,Ur.range=ps,Ur.rangeRight=hs,Ur.rearg=Ma,Ur.reject=function(t,e){return(Ga(t)?Pe:dn)(t,Na(ai(e,3)))},Ur.remove=function(t,e){var r=[];if(!t||!t.length)return r;var n=-1,o=[],i=t.length;for(e=ai(e,3);++n<i;){var a=t[n];e(a,n,t)&&(r.push(a),o.push(n))}return zn(t,o),r},Ur.rest=function(t,e){if("function"!=typeof t)throw new Rt(i);return $n(t,e=e===o?e:hu(e))},Ur.reverse=Zi,Ur.sampleSize=function(t,e,r){return e=(r?gi(t,e,r):e===o)?1:hu(e),(Ga(t)?Kr:Kn)(t,e)},Ur.set=function(t,e,r){return null==t?t:Xn(t,e,r)},Ur.setWith=function(t,e,r,n){return n="function"==typeof n?n:o,null==t?t:Xn(t,e,r,n)},Ur.shuffle=function(t){return(Ga(t)?Xr:Zn)(t)},Ur.slice=function(t,e,r){var n=null==t?0:t.length;return n?(r&&"number"!=typeof r&&gi(t,e,r)?(e=0,r=n):(e=null==e?0:hu(e),r=r===o?n:hu(r)),to(t,e,r)):[]},Ur.sortBy=Ta,Ur.sortedUniq=function(t){return t&&t.length?oo(t):[]},Ur.sortedUniqBy=function(t,e){return t&&t.length?oo(t,ai(e,2)):[]},Ur.split=function(t,e,r){return r&&"number"!=typeof r&&gi(t,e,r)&&(e=r=o),(r=r===o?h:r>>>0)?(t=gu(t))&&("string"==typeof e||null!=e&&!ou(e))&&!(e=ao(e))&&nr(t)?bo(fr(t),0,r):t.split(e,r):[]},Ur.spread=function(t,e){if("function"!=typeof t)throw new Rt(i);return e=null==e?0:vr(hu(e),0),$n((function(r){var n=r[e],o=bo(r,0,e);return n&&Ce(o,n),Oe(t,this,o)}))},Ur.tail=function(t){var e=null==t?0:t.length;return e?to(t,1,e):[]},Ur.take=function(t,e,r){return t&&t.length?to(t,0,(e=r||e===o?1:hu(e))<0?0:e):[]},Ur.takeRight=function(t,e,r){var n=null==t?0:t.length;return n?to(t,(e=n-(e=r||e===o?1:hu(e)))<0?0:e,n):[]},Ur.takeRightWhile=function(t,e){return t&&t.length?fo(t,ai(e,3),!1,!0):[]},Ur.takeWhile=function(t,e){return t&&t.length?fo(t,ai(e,3)):[]},Ur.tap=function(t,e){return e(t),t},Ur.throttle=function(t,e,r){var n=!0,o=!0;if("function"!=typeof t)throw new Rt(i);return Za(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),Ia(t,e,{leading:n,maxWait:e,trailing:o})},Ur.thru=pa,Ur.toArray=lu,Ur.toPairs=Uu,Ur.toPairsIn=Mu,Ur.toPath=function(t){return Ga(t)?je(t,Di):uu(t)?[t]:Ro(ki(gu(t)))},Ur.toPlainObject=yu,Ur.transform=function(t,e,r){var n=Ga(t),o=n||$a(t)||su(t);if(e=ai(e,4),null==r){var i=t&&t.constructor;r=o?n?new i:[]:Za(t)&&Xa(i)?Mr(zt(t)):{}}return(o?Se:mn)(t,(function(t,n,o){return e(r,t,n,o)})),r},Ur.unary=function(t){return xa(t,1)},Ur.union=ta,Ur.unionBy=ea,Ur.unionWith=ra,Ur.uniq=function(t){return t&&t.length?uo(t):[]},Ur.uniqBy=function(t,e){return t&&t.length?uo(t,ai(e,2)):[]},Ur.uniqWith=function(t,e){return e="function"==typeof e?e:o,t&&t.length?uo(t,o,e):[]},Ur.unset=function(t,e){return null==t||so(t,e)},Ur.unzip=na,Ur.unzipWith=oa,Ur.update=function(t,e,r){return null==t?t:co(t,e,yo(r))},Ur.updateWith=function(t,e,r,n){return n="function"==typeof n?n:o,null==t?t:co(t,e,yo(r),n)},Ur.values=Bu,Ur.valuesIn=function(t){return null==t?[]:Xe(t,ju(t))},Ur.without=ia,Ur.words=Xu,Ur.wrap=function(t,e){return Da(yo(e),t)},Ur.xor=aa,Ur.xorBy=ua,Ur.xorWith=sa,Ur.zip=ca,Ur.zipObject=function(t,e){return ho(t||[],e||[],Qr)},Ur.zipObjectDeep=function(t,e){return ho(t||[],e||[],Xn)},Ur.zipWith=fa,Ur.entries=Uu,Ur.entriesIn=Mu,Ur.extend=bu,Ur.extendWith=_u,as(Ur,Ur),Ur.add=gs,Ur.attempt=Ju,Ur.camelCase=Hu,Ur.capitalize=Fu,Ur.ceil=ms,Ur.clamp=function(t,e,r){return r===o&&(r=e,e=o),r!==o&&(r=(r=vu(r))==r?r:0),e!==o&&(e=(e=vu(e))==e?e:0),on(vu(t),e,r)},Ur.clone=function(t){return an(t,4)},Ur.cloneDeep=function(t){return an(t,5)},Ur.cloneDeepWith=function(t,e){return an(t,5,e="function"==typeof e?e:o)},Ur.cloneWith=function(t,e){return an(t,4,e="function"==typeof e?e:o)},Ur.conformsTo=function(t,e){return null==e||un(t,e,Iu(e))},Ur.deburr=qu,Ur.defaultTo=function(t,e){return null==t||t!=t?e:t},Ur.divide=bs,Ur.endsWith=function(t,e,r){t=gu(t),e=ao(e);var n=t.length,i=r=r===o?n:on(hu(r),0,n);return(r-=e.length)>=0&&t.slice(r,i)==e},Ur.eq=Ba,Ur.escape=function(t){return(t=gu(t))&&Y.test(t)?t.replace(V,er):t},Ur.escapeRegExp=function(t){return(t=gu(t))&&rt.test(t)?t.replace(et,"\\$&"):t},Ur.every=function(t,e,r){var n=Ga(t)?Re:pn;return r&&gi(t,e,r)&&(e=o),n(t,ai(e,3))},Ur.find=va,Ur.findIndex=qi,Ur.findKey=function(t,e){return Ue(t,ai(e,3),mn)},Ur.findLast=ya,Ur.findLastIndex=Gi,Ur.findLastKey=function(t,e){return Ue(t,ai(e,3),bn)},Ur.floor=_s,Ur.forEach=ga,Ur.forEachRight=ma,Ur.forIn=function(t,e){return null==t?t:yn(t,ai(e,3),ju)},Ur.forInRight=function(t,e){return null==t?t:gn(t,ai(e,3),ju)},Ur.forOwn=function(t,e){return t&&mn(t,ai(e,3))},Ur.forOwnRight=function(t,e){return t&&bn(t,ai(e,3))},Ur.get=Su,Ur.gt=Ha,Ur.gte=Fa,Ur.has=function(t,e){return null!=t&&hi(t,e,Sn)},Ur.hasIn=xu,Ur.head=Wi,Ur.identity=rs,Ur.includes=function(t,e,r,n){t=Wa(t)?t:Bu(t),r=r&&!n?hu(r):0;var o=t.length;return r<0&&(r=vr(o+r,0)),au(t)?r<=o&&t.indexOf(e,r)>-1:!!o&&Be(t,e,r)>-1},Ur.indexOf=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var o=null==r?0:hu(r);return o<0&&(o=vr(n+o,0)),Be(t,e,o)},Ur.inRange=function(t,e,r){return e=pu(e),r===o?(r=e,e=0):r=pu(r),function(t,e,r){return t>=yr(e,r)&&t<vr(e,r)}(t=vu(t),e,r)},Ur.invoke=Au,Ur.isArguments=qa,Ur.isArray=Ga,Ur.isArrayBuffer=za,Ur.isArrayLike=Wa,Ur.isArrayLikeObject=Va,Ur.isBoolean=function(t){return!0===t||!1===t||tu(t)&&On(t)==g},Ur.isBuffer=$a,Ur.isDate=Ya,Ur.isElement=function(t){return tu(t)&&1===t.nodeType&&!nu(t)},Ur.isEmpty=function(t){if(null==t)return!0;if(Wa(t)&&(Ga(t)||"string"==typeof t||"function"==typeof t.splice||$a(t)||su(t)||qa(t)))return!t.length;var e=pi(t);if(e==E||e==R)return!t.size;if(wi(t))return!Nn(t).length;for(var r in t)if(Lt.call(t,r))return!1;return!0},Ur.isEqual=function(t,e){return In(t,e)},Ur.isEqualWith=function(t,e,r){var n=(r="function"==typeof r?r:o)?r(t,e):o;return n===o?In(t,e,o,r):!!n},Ur.isError=Ka,Ur.isFinite=function(t){return"number"==typeof t&&De(t)},Ur.isFunction=Xa,Ur.isInteger=Ja,Ur.isLength=Qa,Ur.isMap=eu,Ur.isMatch=function(t,e){return t===e||jn(t,e,si(e))},Ur.isMatchWith=function(t,e,r){return r="function"==typeof r?r:o,jn(t,e,si(e),r)},Ur.isNaN=function(t){return ru(t)&&t!=+t},Ur.isNative=function(t){if(_i(t))throw new wt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Cn(t)},Ur.isNil=function(t){return null==t},Ur.isNull=function(t){return null===t},Ur.isNumber=ru,Ur.isObject=Za,Ur.isObjectLike=tu,Ur.isPlainObject=nu,Ur.isRegExp=ou,Ur.isSafeInteger=function(t){return Ja(t)&&t>=-9007199254740991&&t<=l},Ur.isSet=iu,Ur.isString=au,Ur.isSymbol=uu,Ur.isTypedArray=su,Ur.isUndefined=function(t){return t===o},Ur.isWeakMap=function(t){return tu(t)&&pi(t)==I},Ur.isWeakSet=function(t){return tu(t)&&"[object WeakSet]"==On(t)},Ur.join=function(t,e){return null==t?"":ze.call(t,e)},Ur.kebabCase=Gu,Ur.last=Ki,Ur.lastIndexOf=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=n;return r!==o&&(i=(i=hu(r))<0?vr(n+i,0):yr(i,n-1)),e==e?function(t,e,r){for(var n=r+1;n--;)if(t[n]===e)return n;return n}(t,e,i):Me(t,Fe,i,!0)},Ur.lowerCase=zu,Ur.lowerFirst=Wu,Ur.lt=cu,Ur.lte=fu,Ur.max=function(t){return t&&t.length?hn(t,rs,Tn):o},Ur.maxBy=function(t,e){return t&&t.length?hn(t,ai(e,2),Tn):o},Ur.mean=function(t){return qe(t,rs)},Ur.meanBy=function(t,e){return qe(t,ai(e,2))},Ur.min=function(t){return t&&t.length?hn(t,rs,kn):o},Ur.minBy=function(t,e){return t&&t.length?hn(t,ai(e,2),kn):o},Ur.stubArray=ds,Ur.stubFalse=vs,Ur.stubObject=function(){return{}},Ur.stubString=function(){return""},Ur.stubTrue=function(){return!0},Ur.multiply=ws,Ur.nth=function(t,e){return t&&t.length?Hn(t,hu(e)):o},Ur.noConflict=function(){return le._===this&&(le._=Mt),this},Ur.noop=us,Ur.now=Sa,Ur.pad=function(t,e,r){t=gu(t);var n=(e=hu(e))?cr(t):0;if(!e||n>=e)return t;var o=(e-n)/2;return qo(he(o),r)+t+qo(pe(o),r)},Ur.padEnd=function(t,e,r){t=gu(t);var n=(e=hu(e))?cr(t):0;return e&&n<e?t+qo(e-n,r):t},Ur.padStart=function(t,e,r){t=gu(t);var n=(e=hu(e))?cr(t):0;return e&&n<e?qo(e-n,r)+t:t},Ur.parseInt=function(t,e,r){return r||null==e?e=0:e&&(e=+e),mr(gu(t).replace(nt,""),e||0)},Ur.random=function(t,e,r){if(r&&"boolean"!=typeof r&&gi(t,e,r)&&(e=r=o),r===o&&("boolean"==typeof e?(r=e,e=o):"boolean"==typeof t&&(r=t,t=o)),t===o&&e===o?(t=0,e=1):(t=pu(t),e===o?(e=t,t=0):e=pu(e)),t>e){var n=t;t=e,e=n}if(r||t%1||e%1){var i=br();return yr(t+i*(e-t+ue("1e-"+((i+"").length-1))),e)}return Wn(t,e)},Ur.reduce=function(t,e,r){var n=Ga(t)?Le:We,o=arguments.length<3;return n(t,ai(e,4),r,o,fn)},Ur.reduceRight=function(t,e,r){var n=Ga(t)?Ne:We,o=arguments.length<3;return n(t,ai(e,4),r,o,ln)},Ur.repeat=function(t,e,r){return e=(r?gi(t,e,r):e===o)?1:hu(e),Vn(gu(t),e)},Ur.replace=function(){var t=arguments,e=gu(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Ur.result=function(t,e,r){var n=-1,i=(e=go(e,t)).length;for(i||(i=1,t=o);++n<i;){var a=null==t?o:t[Di(e[n])];a===o&&(n=i,a=r),t=Xa(a)?a.call(t):a}return t},Ur.round=Es,Ur.runInContext=t,Ur.sample=function(t){return(Ga(t)?Yr:Yn)(t)},Ur.size=function(t){if(null==t)return 0;if(Wa(t))return au(t)?cr(t):t.length;var e=pi(t);return e==E||e==R?t.size:Nn(t).length},Ur.snakeCase=Vu,Ur.some=function(t,e,r){var n=Ga(t)?ke:eo;return r&&gi(t,e,r)&&(e=o),n(t,ai(e,3))},Ur.sortedIndex=function(t,e){return ro(t,e)},Ur.sortedIndexBy=function(t,e,r){return no(t,e,ai(r,2))},Ur.sortedIndexOf=function(t,e){var r=null==t?0:t.length;if(r){var n=ro(t,e);if(n<r&&Ba(t[n],e))return n}return-1},Ur.sortedLastIndex=function(t,e){return ro(t,e,!0)},Ur.sortedLastIndexBy=function(t,e,r){return no(t,e,ai(r,2),!0)},Ur.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var r=ro(t,e,!0)-1;if(Ba(t[r],e))return r}return-1},Ur.startCase=$u,Ur.startsWith=function(t,e,r){return t=gu(t),r=null==r?0:on(hu(r),0,t.length),e=ao(e),t.slice(r,r+e.length)==e},Ur.subtract=Os,Ur.sum=function(t){return t&&t.length?Ve(t,rs):0},Ur.sumBy=function(t,e){return t&&t.length?Ve(t,ai(e,2)):0},Ur.template=function(t,e,r){var n=Ur.templateSettings;r&&gi(t,e,r)&&(e=o),t=gu(t),e=_u({},e,n,Xo);var i,a,u=_u({},e.imports,n.imports,Xo),s=Iu(u),c=Xe(u,s),f=0,l=e.interpolate||bt,p="__p += '",h=St((e.escape||bt).source+"|"+l.source+"|"+(l===J?lt:bt).source+"|"+(e.evaluate||bt).source+"|$","g"),d="//# sourceURL="+(Lt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ne+"]")+"\n";t.replace(h,(function(e,r,n,o,u,s){return n||(n=o),p+=t.slice(f,s).replace(_t,rr),r&&(i=!0,p+="' +\n__e("+r+") +\n'"),u&&(a=!0,p+="';\n"+u+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),f=s+e.length,e})),p+="';\n";var v=Lt.call(e,"variable")&&e.variable;if(v){if(ct.test(v))throw new wt("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(a?p.replace(q,""):p).replace(G,"$1").replace(z,"$1;"),p="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var y=Ju((function(){return Et(s,d+"return "+p).apply(o,c)}));if(y.source=p,Ka(y))throw y;return y},Ur.times=function(t,e){if((t=hu(t))<1||t>l)return[];var r=h,n=yr(t,h);e=ai(e),t-=h;for(var o=$e(n,e);++r<t;)e(r);return o},Ur.toFinite=pu,Ur.toInteger=hu,Ur.toLength=du,Ur.toLower=function(t){return gu(t).toLowerCase()},Ur.toNumber=vu,Ur.toSafeInteger=function(t){return t?on(hu(t),-9007199254740991,l):0===t?t:0},Ur.toString=gu,Ur.toUpper=function(t){return gu(t).toUpperCase()},Ur.trim=function(t,e,r){if((t=gu(t))&&(r||e===o))return Ye(t);if(!t||!(e=ao(e)))return t;var n=fr(t),i=fr(e);return bo(n,Qe(n,i),Ze(n,i)+1).join("")},Ur.trimEnd=function(t,e,r){if((t=gu(t))&&(r||e===o))return t.slice(0,lr(t)+1);if(!t||!(e=ao(e)))return t;var n=fr(t);return bo(n,0,Ze(n,fr(e))+1).join("")},Ur.trimStart=function(t,e,r){if((t=gu(t))&&(r||e===o))return t.replace(nt,"");if(!t||!(e=ao(e)))return t;var n=fr(t);return bo(n,Qe(n,fr(e))).join("")},Ur.truncate=function(t,e){var r=30,n="...";if(Za(e)){var i="separator"in e?e.separator:i;r="length"in e?hu(e.length):r,n="omission"in e?ao(e.omission):n}var a=(t=gu(t)).length;if(nr(t)){var u=fr(t);a=u.length}if(r>=a)return t;var s=r-cr(n);if(s<1)return n;var c=u?bo(u,0,s).join(""):t.slice(0,s);if(i===o)return c+n;if(u&&(s+=c.length-s),ou(i)){if(t.slice(s).search(i)){var f,l=c;for(i.global||(i=St(i.source,gu(pt.exec(i))+"g")),i.lastIndex=0;f=i.exec(l);)var p=f.index;c=c.slice(0,p===o?s:p)}}else if(t.indexOf(ao(i),s)!=s){var h=c.lastIndexOf(i);h>-1&&(c=c.slice(0,h))}return c+n},Ur.unescape=function(t){return(t=gu(t))&&$.test(t)?t.replace(W,pr):t},Ur.uniqueId=function(t){var e=++Nt;return gu(t)+e},Ur.upperCase=Yu,Ur.upperFirst=Ku,Ur.each=ga,Ur.eachRight=ma,Ur.first=Wi,as(Ur,(ys={},mn(Ur,(function(t,e){Lt.call(Ur.prototype,e)||(ys[e]=t)})),ys),{chain:!1}),Ur.VERSION="4.17.21",Se(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Ur[t].placeholder=Ur})),Se(["drop","take"],(function(t,e){Fr.prototype[t]=function(r){r=r===o?1:vr(hu(r),0);var n=this.__filtered__&&!e?new Fr(this):this.clone();return n.__filtered__?n.__takeCount__=yr(r,n.__takeCount__):n.__views__.push({size:yr(r,h),type:t+(n.__dir__<0?"Right":"")}),n},Fr.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Se(["filter","map","takeWhile"],(function(t,e){var r=e+1,n=1==r||3==r;Fr.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:ai(t,3),type:r}),e.__filtered__=e.__filtered__||n,e}})),Se(["head","last"],(function(t,e){var r="take"+(e?"Right":"");Fr.prototype[t]=function(){return this[r](1).value()[0]}})),Se(["initial","tail"],(function(t,e){var r="drop"+(e?"":"Right");Fr.prototype[t]=function(){return this.__filtered__?new Fr(this):this[r](1)}})),Fr.prototype.compact=function(){return this.filter(rs)},Fr.prototype.find=function(t){return this.filter(t).head()},Fr.prototype.findLast=function(t){return this.reverse().find(t)},Fr.prototype.invokeMap=$n((function(t,e){return"function"==typeof t?new Fr(this):this.map((function(r){return Pn(r,t,e)}))})),Fr.prototype.reject=function(t){return this.filter(Na(ai(t)))},Fr.prototype.slice=function(t,e){t=hu(t);var r=this;return r.__filtered__&&(t>0||e<0)?new Fr(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==o&&(r=(e=hu(e))<0?r.dropRight(-e):r.take(e-t)),r)},Fr.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Fr.prototype.toArray=function(){return this.take(h)},mn(Fr.prototype,(function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),n=/^(?:head|last)$/.test(e),i=Ur[n?"take"+("last"==e?"Right":""):e],a=n||/^find/.test(e);i&&(Ur.prototype[e]=function(){var e=this.__wrapped__,u=n?[1]:arguments,s=e instanceof Fr,c=u[0],f=s||Ga(e),l=function(t){var e=i.apply(Ur,Ce([t],u));return n&&p?e[0]:e};f&&r&&"function"==typeof c&&1!=c.length&&(s=f=!1);var p=this.__chain__,h=!!this.__actions__.length,d=a&&!p,v=s&&!h;if(!a&&f){e=v?e:new Fr(this);var y=t.apply(e,u);return y.__actions__.push({func:pa,args:[l],thisArg:o}),new Hr(y,p)}return d&&v?t.apply(this,u):(y=this.thru(l),d?n?y.value()[0]:y.value():y)})})),Se(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Pt[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);Ur.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var o=this.value();return e.apply(Ga(o)?o:[],t)}return this[r]((function(r){return e.apply(Ga(r)?r:[],t)}))}})),mn(Fr.prototype,(function(t,e){var r=Ur[e];if(r){var n=r.name+"";Lt.call(Pr,n)||(Pr[n]=[]),Pr[n].push({name:e,func:r})}})),Pr[Mo(o,2).name]=[{name:"wrapper",func:o}],Fr.prototype.clone=function(){var t=new Fr(this.__wrapped__);return t.__actions__=Ro(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ro(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ro(this.__views__),t},Fr.prototype.reverse=function(){if(this.__filtered__){var t=new Fr(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Fr.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,r=Ga(t),n=e<0,o=r?t.length:0,i=function(t,e,r){for(var n=-1,o=r.length;++n<o;){var i=r[n],a=i.size;switch(i.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=yr(e,t+a);break;case"takeRight":t=vr(t,e-a)}}return{start:t,end:e}}(0,o,this.__views__),a=i.start,u=i.end,s=u-a,c=n?u:a-1,f=this.__iteratees__,l=f.length,p=0,h=yr(s,this.__takeCount__);if(!r||!n&&o==s&&h==s)return lo(t,this.__actions__);var d=[];t:for(;s--&&p<h;){for(var v=-1,y=t[c+=e];++v<l;){var g=f[v],m=g.iteratee,b=g.type,_=m(y);if(2==b)y=_;else if(!_){if(1==b)continue t;break t}}d[p++]=y}return d},Ur.prototype.at=ha,Ur.prototype.chain=function(){return la(this)},Ur.prototype.commit=function(){return new Hr(this.value(),this.__chain__)},Ur.prototype.next=function(){this.__values__===o&&(this.__values__=lu(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?o:this.__values__[this.__index__++]}},Ur.prototype.plant=function(t){for(var e,r=this;r instanceof Br;){var n=Mi(r);n.__index__=0,n.__values__=o,e?i.__wrapped__=n:e=n;var i=n;r=r.__wrapped__}return i.__wrapped__=t,e},Ur.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Fr){var e=t;return this.__actions__.length&&(e=new Fr(this)),(e=e.reverse()).__actions__.push({func:pa,args:[Zi],thisArg:o}),new Hr(e,this.__chain__)}return this.thru(Zi)},Ur.prototype.toJSON=Ur.prototype.valueOf=Ur.prototype.value=function(){return lo(this.__wrapped__,this.__actions__)},Ur.prototype.first=Ur.prototype.head,Kt&&(Ur.prototype[Kt]=function(){return this}),Ur}();le._=hr,(n=function(){return hr}.call(e,r,e,t))===o||(t.exports=n)}.call(this)},8306:(t,e,r)=>{var n=r(3369);function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(o.Cache||n),r}o.Cache=n,t.exports=o},9601:(t,e,r)=>{var n=r(371),o=r(6374),i=r(5403),a=r(327);t.exports=function(t){return i(t)?n(a(t)):o(t)}},4061:(t,e,r)=>{var n=r(2663),o=r(4140),i=r(7206),a=r(107),u=r(1469);t.exports=function(t,e,r){var s=u(t)?n:a,c=arguments.length<3;return s(t,i(e,4),r,c,o)}},479:t=>{t.exports=function(){return[]}},5062:t=>{t.exports=function(){return!1}},9833:(t,e,r)=>{var n=r(531);t.exports=function(t){return null==t?"":n(t)}},4898:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.createXhrRequestFailedError=e.createStreamingBatchError=e.createRequestFailedError=e.createMultipartError=e.ETIMEDOUT=e.ERR_UNKNOWN=e.ERR_NETWORK=e.ERR_FR_TOO_MANY_REDIRECTS=e.ERR_DEPRECATED=e.ERR_CANCELED=e.ERR_BAD_RESPONSE=e.ERR_BAD_REQUEST=e.ERR_BAD_OPTION_VALUE=e.ERR_BAD_OPTION=e.ERR_BAD_MULTIPART_RESPONSE=e.ECONNABORTED=void 0;var o=r(6486),i=r(467);function a(){a=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",f=u.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),u=new C(n||[]);return i(a,"_invoke",{value:P(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",v="suspendedYield",y="executing",g="completed",m={};function b(){}function _(){}function w(){}var E={};l(E,s,(function(){return this}));var O=Object.getPrototypeOf,T=O&&O(O(L([])));T&&T!==r&&o.call(T,s)&&(E=T);var S=w.prototype=b.prototype=Object.create(E);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){function r(i,a,u,s){var c=h(t[i],t,a);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==n(l)&&o.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(l).then((function(t){f.value=t,u(f)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?g:v,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(o.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return _.prototype=w,i(S,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:_,configurable:!0}),_.displayName=l(w,f,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,f,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(R.prototype),l(R.prototype,c,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),l(S,f,"Generator"),l(S,s,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function u(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function c(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:String(e)}function f(t){var e="function"==typeof Map?new Map:void 0;return f=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(l())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&p(o,r.prototype),o}(t,arguments,h(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),p(r,t)},f(t)}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}e.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE",e.ERR_BAD_OPTION="ERR_BAD_OPTION",e.ECONNABORTED="ECONNABORTED",e.ETIMEDOUT="ETIMEDOUT",e.ERR_NETWORK="ERR_NETWORK",e.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS",e.ERR_DEPRECATED="ERR_DEPRECATED";var d=e.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE",v=(e.ERR_BAD_MULTIPART_RESPONSE="ERR_BAD_MULTIPART_RESPONSE",e.ERR_BAD_REQUEST="ERR_BAD_REQUEST"),y=(e.ERR_CANCELED="ERR_CANCELED",e.ERR_UNKNOWN="ERR_UNKNOWN",function(t){function e(t,r,i,a,u){var s,c,f,p;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(c=this,f=e,p=[t],f=h(f),s=function(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(c,l()?Reflect.construct(f,p||[],h(c).constructor):f.apply(c,p))).name="SnHttpError",(0,o.isUndefined)(r)||(s.code=r),(0,o.isUndefined)(i)||(s.config=i),(0,o.isUndefined)(a)||(s.request=a),(0,o.isUndefined)(u)||(s.response=u),s}var r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(e,t),r=e,(i=[{key:"isSnHttpError",get:function(){return!0}},{key:"toJSON",value:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}}])&&s(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),e}(f(Error)));function g(t,e,r){return new y("Request failed with status code ".concat(e.status),[v,d][Math.floor(e.status/100)-4],r,t,e)}e.createRequestFailedError=function(){var t,e=(t=a().mark((function t(e,r,n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r instanceof Error)){t.next=2;break}return t.abrupt("return",r);case 2:return t.prev=2,t.next=5,(0,i.parseBody)(n,r);case 5:r.data=t.sent,t.next=11;break;case 9:t.prev=9,t.t0=t.catch(2);case 11:return t.abrupt("return",g(e,r,n));case 12:case"end":return t.stop()}}),t,null,[[2,9]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){u(i,n,o,a,s,"next",t)}function s(t){u(i,n,o,a,s,"throw",t)}a(void 0)}))});return function(t,r,n){return e.apply(this,arguments)}}(),e.createXhrRequestFailedError=function(t,e,r){return e instanceof Error?e:g(t,e,r)},e.createMultipartError=function(t,e){return new y(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Malformed Multipart Response",d,e,void 0,t)},e.createStreamingBatchError=function(t,e){return new y(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Streaming Batch Response was invalid",d,e,void 0,t)},e.default=y},5006:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createBatchResponseFailureHandler=function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.config,r=t.response,n=t.message;return e&&!0===e.batch?Promise.reject(s(s(s({},t),{},{config:s(s({},e),{},{data:(0,i.transformData)(e.data)})},r&&s(s({},r),{},{data:(0,i.transformData)(r.data)})),{},{message:n})):Promise.reject(t)}},e.createBatchResponseSuccessHandler=function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.config,r=void 0===e?{}:e,i=t.data,a=void 0===i?{}:i,u=t.headers;if(!0!==r.batch)return t;var c=a.serviced_requests,f=void 0===c?[]:c,l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return(0,n.map)(t,(function(t){return(0,o.mergeHeadersToServicedRequest)(t,e)}))}((0,n.map)(f,o.transformServicedRequest),u);return s(s({},t),{},{data:s(s({},a),{},{serviced_requests:l})})}};var n=r(6486),o=r(8424),i=r(467);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){var n,o,i,u;n=t,o=e,i=r[e],u=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o),(o="symbol"==a(u)?u:String(u))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}},3446:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(6486),o=r(8376),i=r(8424),a=r(467),u=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!=c(t)&&"function"!=typeof t)return{default:t};var r=s(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&Object.prototype.hasOwnProperty.call(t,i)){var a=o?Object.getOwnPropertyDescriptor(t,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=t[i]}return n.default=t,r&&r.set(t,n),n}(r(4898));function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(s=function(t){return t?r:e})(t)}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach((function(e){var n,o,i,a;n=t,o=e,i=r[e],a=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o),(o="symbol"==c(a)?a:String(a))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}e.default=function(t,e,r,s){var c,f,p=[];function h(s){var h=s.headers;try{(0,n.isEmpty)(c)?function(e){var r=e.headers,i=(0,a.getHeader)(o.BATCH_RESPONSE_START_HEADER_NAME,r);!(0,n.isEmpty)(c)||(0,n.isEmpty)(i)||i!==t?d(e):c=i}(s):(0,a.containsHeader)(o.BATCH_ITEM_RESPONSE_START_HEADER_NAME,h)?function(t){var e=t.body,r=t.headers,i=(0,a.getHeader)(o.BATCH_ITEM_RESPONSE_START_HEADER_NAME,r);!(0,n.isEmpty)(i)&&(0,n.isEmpty)(f)||d(t),f={body:e,id:i}}(s):(0,a.containsHeader)(o.BATCH_ITEM_RESPONSE_END_HEADER_NAME,h)?function(t){var r=t.body,u=t.headers,s=t.responseHeaders,c=(0,a.getHeader)(o.BATCH_ITEM_RESPONSE_END_HEADER_NAME,u);((0,n.isEmpty)(c)||(0,n.isEmpty)(f)||c!==f.id)&&d(t);var p=(0,a.transformData)(r,!0,!0);f=(0,i.transformServicedRequest)(l(l({},f),p)),(0,i.mergeHeadersToServicedRequest)(f,s),e(f),f=void 0}(s):(0,a.containsHeader)(o.BATCH_RESPONSE_END_HEADER_NAME,h)?function(t){var e=t.body,o=(0,a.transformData)(e,!0,!0).unserviced_requests;(0,n.isArray)(o)||d(t,"Streaming Batch Response invalid unserviced_requests received: ".concat(e)),r(p=o)}(s):d(s)}catch(t){if(t instanceof u.default)throw t;d(s,t.message)}}function d(t,e){var r=t.body,n=t.headers;throw(0,u.createStreamingBatchError)({body:r,headers:n},s,e)}return{get multipartConfig(){return{multipartConsumer:h,parsePartsAsJson:!1,emitCompletedResponse:!1}},get unserviced_requests(){return p}}}},8376:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BatchRestRequestRequestOptions=e.BatchRestRequestRequestOptionEncodeResponseBodies=e.BatchRestRequestRequestOptionEncodeRequestBodies=e.BatchRestRequestOptions=e.BatchRestRequestOptionShouldEncodeResponse=e.BatchRestRequestOptionIsEncoded=e.BatchRestRequestClientOptions=e.BatchRestRequestClientOptionEncodeResponseBodies=e.BatchRestRequestClientOptionEncodeRequestBodies=e.BatchResponseBodyEncodingNone=e.BatchResponseBodyEncodingBase64=e.BatchResponseBodyEncoding=e.BATCH_RESPONSE_START_HEADER_NAME=e.BATCH_RESPONSE_END_HEADER_NAME=e.BATCH_ITEM_RESPONSE_START_HEADER_NAME=e.BATCH_ITEM_RESPONSE_END_HEADER_NAME=void 0,e.BatchResponseBodyEncoding="body_encoding",e.BatchResponseBodyEncodingBase64="base64",e.BatchResponseBodyEncodingNone="none",e.BatchRestRequestOptions="options",e.BatchRestRequestOptionIsEncoded="is_encoded",e.BatchRestRequestOptionShouldEncodeResponse="should_encode_response",e.BatchRestRequestClientOptions="batchingOptions",e.BatchRestRequestClientOptionEncodeRequestBodies="encodeRequestBodies",e.BatchRestRequestClientOptionEncodeResponseBodies="encodeResponsesBodies",e.BatchRestRequestRequestOptions="batchingOptions",e.BatchRestRequestRequestOptionEncodeRequestBodies="encodeRequestBodies",e.BatchRestRequestRequestOptionEncodeResponseBodies="encodeResponsesBodies",e.BATCH_RESPONSE_START_HEADER_NAME="x-batch-response-start",e.BATCH_ITEM_RESPONSE_START_HEADER_NAME="x-batch-item-response-start",e.BATCH_RESPONSE_END_HEADER_NAME="x-batch-response-end",e.BATCH_ITEM_RESPONSE_END_HEADER_NAME="x-batch-item-response-end"},7655:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(6486),o=r(467),i=r(8424),a=r(8376);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function f(t,e,r){return(e=h(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function h(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:String(e)}e.default=function(t){return function(e){if(!e.data||!e.data.batch_request_id)return e;var r=e.transformRequest[0],u=e.data.rest_requests||[],s=e[a.BatchRestRequestClientOptions],p=(0,n.map)(u,(function(n){var u=n.headers,p=n.body,d=n.url,v=n.params,y=n[a.BatchRestRequestRequestOptions],g=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(n,["headers","body","url","params",a.BatchRestRequestRequestOptions].map(h)),m=y||s,b=(0,o.buildUrl)(d,v,e.paramsSerializer),_=p&&(0,i.shouldEncodeRequestOrDefault)(m)?(0,i.b64EncodeUnicode)(r(p)):p,w=t?[].concat(l(u),[{name:o.HTTP_HEADERS.USER_TOKEN,value:t}]):l(u);return c(c({},g),{},f({url:b,headers:w,body:_},a.BatchRestRequestOptions,(0,i.toGlideBatchingOptionsWithDefaults)(m)))}));return c(c({},e),{},{data:c(c({},e.data),{},{rest_requests:p})})}}},4174:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(1622),o=r(8424),i=r(264),a=r(467),u=d(r(3471)),s=d(r(1143)),c=r(6486),f=r(8376),l=r(4898),p=d(r(3446)),h=["id"];function d(t){return t&&t.__esModule?t:{default:t}}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){var n;return n=function(t,e){if("object"!=v(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==v(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.batchUrl,r=void 0===e?n.DEFAULT_BATCH_URL:e,d=t.batchMethod,v=void 0===d?n.DEFAULT_BATCH_METHOD:d,y=t.batchMax,b=void 0===y?n.DEFAULT_BATCH_MAX:y,_=t.batchInterval,w=void 0===_?n.DEFAULT_BATCH_INTERVAL:_,E=t.useStreaming,O=void 0===E?n.DEFAULT_BATCH_USE_STREAMING:E,T=t[f.BatchRestRequestClientOptionEncodeRequestBodies],S=void 0===T?n.DEFAULT_BATCH_ENCODE_REQUEST_BODIES:T,x=t[f.BatchRestRequestClientOptionEncodeResponseBodies],R=void 0===x?n.DEFAULT_BATCH_ENCODE_RESPONSE_BODIES:x,P=t.sendRequest;(0,s.default)(P,"createHttpRequestBatcher: options must contain 'sendRequest' function.");var A=[],I=new Map;function j(t){var e=t.config,r=e.priority,n=e.operation;(0,u.default)(A,t,r,n),1===A.length&&setTimeout((function(){A.length&&D()}),w),A.length===b&&D()}function C(t){var e=t.response||{},r=t.config||{},n=(0,a.transformData)(r.data||{});(0,c.forEach)(n.rest_requests,(function(r){var n=r.id;void 0!==n&&I.has(n)&&((0,I.get(n).deferredReject)(g(g({},t),{},{response:{headers:e.headers,data:e.data,status:e.status,statusText:e.statusText}})),I.delete(n))}))}function L(t){var e=t.data,r=void 0===e?{}:e,n=t.config,o=void 0===n?{}:n;if((0,a.isMultipartMixedResponse)(t)&&!(0,c.isEmpty)(r))throw(0,l.createStreamingBatchError)(t,o);var i=r.serviced_requests,u=void 0===i?[]:i,s=r.unserviced_requests,f=void 0===s?[]:s;(0,c.forEach)(u,(function(t){return k(o,t)})),N(f)}function N(t){(0,c.forEach)(t,(function(t){j(I.get(t))}))}function k(t,e){var r=e.id,n=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(e,h);if(void 0!==r&&I.has(r)){var o,i=I.get(r),a=i.deferredResolve,u=i.deferredReject;(o=n.status)>=200&&o<300?a(n):u({config:t,response:n}),I.delete(r)}}function D(){for(var t,e=(0,o.createBatchId)(),n=[];A.length&&(!t||t===A[0].config.priority);){var a=A.shift();n.push(a.request),I.set(a.requestId,a),t=a.config.priority}var u={batch_request_id:e,enforce_order:!1,rest_requests:n},s={url:(0,i.attachEmbeddableBaseUrl)(r),method:v,data:u,batch:!0},c=function(t,e){if(O)return(0,p.default)(e,(function(e){return k(t,e)}),(function(t){return N(t)}),t)}(s,e);s.multipartConfig=null==c?void 0:c.multipartConfig,P(s.url,s.method,{batch:s.batch,data:s.data,multipartConfig:s.multipartConfig}).then(c?function(){}:L).catch(C),A.length&&D()}function U(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,c.reduce)(t,(function(t,e,r){return t.push({name:r,value:e}),t}),[])}return{get currentQueueSize(){return A.length},get batchInterval(){return w},enqueueRequest:function(t,e,r){var n,i,a=(0,o.createBatchId)(),u=new Promise((function(t,e){n=t,i=e})),s=r.data,l=r.params,p=r.headers,h=r.priority,d=void 0===h?"high":h,v=r.operation,y=void 0===v?"push":v,b=r.encodeRequestBody,_=void 0===b?S:b,w=r.encodeResponseBody,E=void 0===w?R:w;return j({requestId:a,config:{priority:d,operation:y},request:g(g(m({id:a,headers:U(p),url:t,method:(0,c.toUpper)(r.method||e)},f.BatchRestRequestOptions,(0,o.toGlideBatchingOptionsWithDefaults)({encodeRequestBody:_,encodeResponseBody:E})),s&&{body:s}),l&&{params:l}),deferredReject:i,deferredResolve:n}),u}}}},1622:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_BATCH_USE_STREAMING=e.DEFAULT_BATCH_URL=e.DEFAULT_BATCH_METHOD=e.DEFAULT_BATCH_MAX=e.DEFAULT_BATCH_INTERVAL=e.DEFAULT_BATCH_ENCODE_RESPONSE_BODIES=e.DEFAULT_BATCH_ENCODE_REQUEST_BODIES=void 0,e.DEFAULT_BATCH_URL="/api/now/v1/batch",e.DEFAULT_BATCH_METHOD="post",e.DEFAULT_BATCH_MAX=10,e.DEFAULT_BATCH_INTERVAL=50,e.DEFAULT_BATCH_ENCODE_REQUEST_BODIES=!1,e.DEFAULT_BATCH_ENCODE_RESPONSE_BODIES=!1,e.DEFAULT_BATCH_USE_STREAMING=!1},9881:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"createBatchRequestInterceptor",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"createBatchResponseFailureHandler",{enumerable:!0,get:function(){return i.createBatchResponseFailureHandler}}),Object.defineProperty(e,"createBatchResponseSuccessHandler",{enumerable:!0,get:function(){return i.createBatchResponseSuccessHandler}}),Object.defineProperty(e,"createHttpRequestBatcher",{enumerable:!0,get:function(){return n.default}});var n=a(r(4174)),o=a(r(7655)),i=r(5006);function a(t){return t&&t.__esModule?t:{default:t}}},630:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return decodeURIComponent(atob(t).split("").map((function(t){return"%".concat("00".concat(t.charCodeAt(0).toString(16)).slice(-2))})).join(""))}},5073:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return String.fromCharCode("0x".concat(e))})))}},1256:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toGlideBatchingOptionsWithDefaults=e.toGlideBatchingOptions=e.shouldEncodeResponseOrDefault=e.shouldEncodeRequestOrDefault=void 0;var n=r(8376),o=r(1622);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e,r){var n;return n=function(t,e){if("object"!=i(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==i(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}e.toGlideBatchingOptionsWithDefaults=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(a({},n.BatchRestRequestOptionIsEncoded,u(t)),n.BatchRestRequestOptionShouldEncodeResponse,s(t))},e.toGlideBatchingOptions=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(a({},n.BatchRestRequestOptionIsEncoded,t[n.BatchRestRequestClientOptionEncodeRequestBodies]||t[n.BatchRestRequestOptionIsEncoded]),n.BatchRestRequestOptionShouldEncodeResponse,t[n.BatchRestRequestClientOptionEncodeResponseBodies]||t[n.BatchRestRequestOptionShouldEncodeResponse])};var u=e.shouldEncodeRequestOrDefault=function(){var t=c(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return void 0===t?o.DEFAULT_BATCH_ENCODE_REQUEST_BODIES:t},s=e.shouldEncodeResponseOrDefault=function(){var t=f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return void 0===t?o.DEFAULT_BATCH_ENCODE_RESPONSE_BODIES:t},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===t[n.BatchRestRequestClientOptionEncodeRequestBodies]?t[n.BatchRestRequestOptionIsEncoded]:t[n.BatchRestRequestClientOptionEncodeRequestBodies]},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===t[n.BatchRestRequestClientOptionEncodeResponseBodies]?t[n.BatchRestRequestOptionShouldEncodeResponse]:t[n.BatchRestRequestClientOptionEncodeResponseBodies]}},2666:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return(0,n.v4)()};var n=r(7102)},264:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEmbeddableBaseUrl=e.attachEmbeddableBaseUrl=void 0;var r=e.getEmbeddableBaseUrl=function(){var t,e,r;return(null===(t=window)||void 0===t||null===(e=t.nowUiFramework)||void 0===e||null===(r=e.getEmbeddableBaseUrl)||void 0===r?void 0:r.call(e))||""};e.attachEmbeddableBaseUrl=function(t){return r().concat(t)}},8424:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"b64DecodeUnicode",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"b64EncodeUnicode",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"createBatchId",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"mergeHeadersToServicedRequest",{enumerable:!0,get:function(){return u.mergeHeadersToServicedRequest}}),Object.defineProperty(e,"shouldEncodeRequestOrDefault",{enumerable:!0,get:function(){return a.shouldEncodeRequestOrDefault}}),Object.defineProperty(e,"shouldEncodeResponseOrDefault",{enumerable:!0,get:function(){return a.shouldEncodeResponseOrDefault}}),Object.defineProperty(e,"toGlideBatchingOptions",{enumerable:!0,get:function(){return a.toGlideBatchingOptions}}),Object.defineProperty(e,"toGlideBatchingOptionsWithDefaults",{enumerable:!0,get:function(){return a.toGlideBatchingOptionsWithDefaults}}),Object.defineProperty(e,"transformServicedRequest",{enumerable:!0,get:function(){return u.transformServicedRequest}});var n=s(r(2666)),o=s(r(630)),i=s(r(5073)),a=r(1256),u=r(664);function s(t){return t&&t.__esModule?t:{default:t}}},664:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mergeHeadersToServicedRequest=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e.hasOwnProperty(o.HTTP_HEADERS.IS_LOGGED_IN))return t;var r=t.headers;return(void 0===r?{}:r)[o.HTTP_HEADERS.IS_LOGGED_IN]=e[o.HTTP_HEADERS.IS_LOGGED_IN],t},e.transformServicedRequest=function(t){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({id:t.id,data:f(t),headers:(0,o.transformHeadersToJson)(t.headers),status:t.status_code,statusText:t.status_text},t.error_message&&{error:!0,errorMessage:t.error_message})};var n,o=r(467),i=r(8376),a=(n=r(630))&&n.__esModule?n:{default:n};function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t,e,r){var n;return n=function(t,e){if("object"!=u(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==u(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.body,r=t[i.BatchResponseBodyEncoding]===i.BatchResponseBodyEncodingBase64?(0,a.default)(e):e;return(0,o.transformData)(r)}},6457:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"snHttpFactory",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"snHttpInstance",{enumerable:!0,get:function(){return o.default}});var n=i(r(4374)),o=i(r(709));function i(t){return t&&t.__esModule?t:{default:t}}},709:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(4374)),o=a(r(7361)),i=r(467);function a(t){return t&&t.__esModule?t:{default:t}}var u=["xmlhttp.do"];function s(t,e){return(0,i.isWebWorker)()?e:(0,o.default)(window,["ux_globals","libuxf","sysprops",t],e)}var c=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw new Error("Unable to locate global object")}(),f=c.navigator,l=s("glide.uxf.lib.highPriorityPathNames","/api/now/uxframework/macroponent_drivers,/api/now/uxframework/component_drivers,/api/now/uxframework/scripted_conditions,/api/now/uxframework/scripted_route_conditions,/api/now/uxf/databroker/exec,/api/now/graphql,/api/now/uxf/databroker/exec/macroponent").split(","),p=f&&-1!==f.userAgent.indexOf("Trident/7.0")?1:s("glide.uxf.lib.maxConcurrent",20),h=(0,i.isWebWorker)()?4e3:(0,o.default)(window,["NOW","httpRequestCompressionThreshold"],4e3),d=(0,i.isWebWorker)()?null:(0,o.default)(window,["NOW","httpRequestCompressionLevel"],null),v=(0,i.isWebWorker)()?null:(0,o.default)(window,["NOW","httpRequestCompressionMemoryLevel"],null),y=(0,i.isWebWorker)()?u:(0,o.default)(window,["NOW","httpRequestCompressionExcludeUrls"],u),g=(0,n.default)({xsrfToken:c.g_ck||"default",xTransactionSource:c.transaction_source,maxConcurrent:p,batching:function(t){return!t.nowUiFramework||"boolean"!=typeof t.nowUiFramework.disableRestBatching||!t.nowUiFramework.disableRestBatching}(c),batchingOptions:{useStreaming:"true"===s("glide.uxf.lib.batchingOptions.useStreaming","false"),encodeRequestBodies:"true"===s("glide.uxf.lib.batchingOptions.encodeRequestBodies","false"),encodeResponsesBodies:"true"===s("glide.uxf.lib.batchingOptions.encodeResponsesBodies","false")},enqueueRequestPrioritizer:function(t){return l.length&&l.includes(t)?{priority:"high",operation:"push"}:{priority:"low",operation:"push"}},httpRequestCompressionThreshold:h,httpRequestCompressionLevel:d,httpRequestCompressionMemoryLevel:v,httpRequestCompressionExcludeUrls:y});!function(){if(!(0,i.isWebWorker)()){window.nowUiFramework||(window.nowUiFramework={});var t=(0,o.default)(window,["ux_globals","isNonUxAppConfigAdminPanel"],!1);window.nowUiFramework.batchGQLEffectRequests=t?"true"===s("glide.uxf.lib.classic.batchGQLEffectRequests","false"):"true"===s("glide.uxf.lib.batchGQLEffectRequests","true"),window.nowUiFramework.snHttp=new Proxy(g,{get:function(t,e){switch(e){case"request":case"client":return t[e]}console.error("Operation not allowed")},set:function(){console.error("Operation not allowed")}})}}(),e.default=g},3095:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fetchWithCancelTimeout=function(t,e){return f.apply(this,arguments)};var n=r(6486),o=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!=u(t)&&"function"!=typeof t)return{default:t};var r=a(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&Object.prototype.hasOwnProperty.call(t,i)){var s=o?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,r&&r.set(t,n),n}(r(4898)),i=r(4564);function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(a=function(t){return t?r:e})(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",f=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:P(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",v="suspendedYield",y="executing",g="completed",m={};function b(){}function _(){}function w(){}var E={};l(E,a,(function(){return this}));var O=Object.getPrototypeOf,T=O&&O(O(L([])));T&&T!==r&&n.call(T,a)&&(E=T);var S=w.prototype=b.prototype=Object.create(E);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==u(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){f.value=t,a(f)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?g:v,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return _.prototype=w,o(S,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=l(w,f,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,f,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(R.prototype),l(R.prototype,c,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),l(S,f,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function c(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function f(){var t;return t=s().mark((function t(e,r){var a,u,c,f,l,p,h,d,v,y,g;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=!1,c=new AbortController,f=new Request(e,{signal:c.signal}),(l=r.signal)&&(p=function(){(0,n.isUndefined)(a)||l.removeEventListener("abort",a),u||c.abort("canceled")},l.aborted?p():a=l.addEventListener("abort",p)),r.timeout>0&&(h=setTimeout((function(){c.abort("timeout")}),r.timeout)),t.prev=6,t.next=9,fetch(f);case 9:d=t.sent,t.next=18;break;case 12:return t.prev=12,t.t0=t.catch(6),(v="AbortError"===t.t0.name)&&"timeout"===c.signal.reason?(g=r.timeoutErrorMessage?r.timeoutErrorMessage:"timeout of ".concat(r.timeout,"ms exceeded"),y=new o.default(g,o.ETIMEDOUT,r,e)):y=v?new o.default("Request aborted",o.ECONNABORTED,r,e):new o.default("Network Error",o.ERR_NETWORK,r,e),t.abrupt("return",(0,i.failureHandler)(y));case 18:return t.prev=18,u=!0,(0,n.isUndefined)(h)||clearTimeout(h),l&&l.removeEventListener("abort",a),t.finish(18);case 23:return t.abrupt("return",d);case 24:case"end":return t.stop()}}),t,null,[[6,12,18,23]])})),f=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){c(i,n,o,a,u,"next",t)}function u(t){c(i,n,o,a,u,"throw",t)}a(void 0)}))},f.apply(this,arguments)}},2992:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.xhrWithCancelTimeout=function(t,e){return f.apply(this,arguments)};var n=r(6486),o=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!=u(t)&&"function"!=typeof t)return{default:t};var r=a(e);if(r&&r.has(t))return r.get(t);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if("default"!==i&&Object.prototype.hasOwnProperty.call(t,i)){var s=o?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(n,i,s):n[i]=t[i]}return n.default=t,r&&r.set(t,n),n}(r(4898)),i=r(467);function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(a=function(t){return t?r:e})(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",f=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:P(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",v="suspendedYield",y="executing",g="completed",m={};function b(){}function _(){}function w(){}var E={};l(E,a,(function(){return this}));var O=Object.getPrototypeOf,T=O&&O(O(L([])));T&&T!==r&&n.call(T,a)&&(E=T);var S=w.prototype=b.prototype=Object.create(E);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==u(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){f.value=t,a(f)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?g:v,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return _.prototype=w,o(S,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=l(w,f,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,f,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(R.prototype),l(R.prototype,c,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),l(S,f,"Generator"),l(S,a,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function c(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function f(){var t;return t=s().mark((function t(e,r){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){var u,s,c=!1,f=!1,l=r.signal;if(l){var p=function(){(0,n.isUndefined)(u)||l.removeEventListener("abort",u),c||e.abort()};l.aborted?p():u=l.addEventListener("abort",p)}function h(t,r){function n(t){if("string"==typeof t)try{return JSON.parse(t)}catch(t){}return t}return{ok:r,status:e.status,headers:(0,i.xhrHeadersToHeaders)(e.getAllResponseHeaders()),data:n(e.responseText),text:function(){return Promise.resolve(e.responseText)},json:function(){return"json"===e.responseType?Promise.resolve(e.response):Promise.resolve(n(e.responseText))},blob:function(){if("blob"===e.responseType)return Promise.resolve(e.response);var t=this.headers.get("Content-Type")||"text/plain";return Promise.resolve(new Blob([e.responseText],{type:t}))},arraybuffer:function(){return"arraybuffer"===e.responseType?Promise.resolve(e.response):Promise.reject("Unable to read arraybuffer from xhrRequest")},formData:function(){return Promise.reject("Unable to read formData from xhrRequest")}}}function d(){(0,n.isUndefined)(s)||clearTimeout(s),l&&l.removeEventListener("abort",u)}r.timeout>0&&(s=setTimeout((function(){f=!0,e.abort()}),r.timeout)),e.upload.addEventListener("progress",(function(t){r.onUploadProgress&&r.onUploadProgress(t)})),e.addEventListener("progress",(function(t){r.onDownloadProgress&&r.onDownloadProgress(t)})),e.addEventListener("load",(function(){d(),4===e.readyState&&e.status>=200&&e.status<300?(c=!0,t(h(0,!0))):a((0,o.createXhrRequestFailedError)(e,h(0,!1),r))})),e.addEventListener("abort",(function(){if(c=!0,d(),f){var t=r.timeoutErrorMessage?r.timeoutErrorMessage:"timeout of ".concat(r.timeout,"ms exceeded");a(new o.default(t,o.ETIMEDOUT,r))}else a(new o.default("Request aborted",o.ECONNABORTED,r))})),e.addEventListener("error",(function(){c=!0,d(),a((0,o.createXhrRequestFailedError)(e,h(0,!1),r))})),e.send(r.data)})));case 1:case"end":return t.stop()}}),t)})),f=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){c(i,n,o,a,u,"next",t)}function u(t){c(i,n,o,a,u,"throw",t)}a(void 0)}))},f.apply(this,arguments)}},7261:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(467),o=function(t){var e=Date.now();return setTimeout((function(){t({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-e))}})}),1)},i=!(0,n.isWebWorker)()&&window.requestIdleCallback||o,a=!(0,n.isWebWorker)()&&window&&window.navigator&&window.navigator.userAgentData&&window.navigator.userAgentData.brands&&window.navigator.userAgentData.brands.some((function(t){return"Chromium"===t.brand}))?o:i;e.default=a},2859:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.createHttpClient=void 0;var n=r(6486),o=r(9881),i=r(4898),a=r(467),u=r(2992),s=r(3095),c=r(4564);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:P(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",v="suspendedYield",y="executing",g="completed",m={};function b(){}function _(){}function w(){}var E={};c(E,a,(function(){return this}));var O=Object.getPrototypeOf,T=O&&O(O(L([])));T&&T!==r&&n.call(T,a)&&(E=T);var S=w.prototype=b.prototype=Object.create(E);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){function r(o,i,a,u){var s=h(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==f(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?g:v,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(f(e)+" is not iterable")}return _.prototype=w,o(S,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=c(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(R.prototype),c(R.prototype,u,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),c(S,s,"Generator"),c(S,a,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function p(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){p(i,n,o,a,u,"next",t)}function u(t){p(i,n,o,a,u,"throw",t)}a(void 0)}))}}function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach((function(e){y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function y(t,e,r){var n;return n=function(t,e){if("object"!=f(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==f(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var g=e.createHttpClient=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=v({defaultHeaders:y({},a.HTTP_HEADERS.CONTENT_TYPE,"application/json"),transformRequest:[JSON.stringify]},t),r=function(){var t=h(l().mark((function t(r){var n,o,i,h,d;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=p(v(v({},e),r)),!(0,a.shouldUseXhr)(n)){t.next=7;break}return o=(0,a.createRequestXhr)(n),t.next=5,(0,u.xhrWithCancelTimeout)(o,n);case 5:return i=t.sent,t.abrupt("return",f(o,i,n));case 7:return h=(0,a.createRequest)(n),t.next=10,(0,s.fetchWithCancelTimeout)(h,n);case 10:return d=t.sent,t.abrupt("return",f(h,d,n).then(c.successHandler));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),f=function(){var t=h(l().mark((function t(e,r,n){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.ok){t.next=2;break}return t.abrupt("return",g(e,r,n).catch(c.failureHandler));case 2:if(204!==r.status){t.next=4;break}return t.abrupt("return",(0,a.createExternalResponse)(r,n,e));case 4:if("xml"!==n.dataType){t.next=10;break}return t.next=7,(0,a.parseBody)({responseType:"text"},r);case 7:r.data=t.sent,t.next=13;break;case 10:return t.next=12,(0,a.parseBody)(n,r,e);case 12:r.data=t.sent;case 13:return t.abrupt("return",(0,a.createExternalResponse)(r,n,e));case 14:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),p=function(t){var r=(0,a.resolveUserToken)(t,e),i=(0,a.mergeRequestHeaders)(t,e);if((0,a.isFormData)(t.data)&&delete i[a.HTTP_HEADERS.CONTENT_TYPE],(0,n.isEmpty)(r)||(i[a.HTTP_HEADERS.USER_TOKEN]=r),!(0,n.isEmpty)(t.auth)){var u=t.auth.username||"",s=t.auth.password?decodeURI(encodeURIComponent(t.auth.password)):"";i.set(a.HTTP_HEADERS.AUTHORIZATION,"Basic ".concat(btoa("".concat(u,":").concat(s))))}var c=(0,a.isWebWorker)()?"":(0,n.get)(window,"transaction_source");(0,n.isEmpty)(c)||(i[a.HTTP_HEADERS.TRANSACTION_SOURCE]=c.substring(0,1e3)),(0,a.updateAcceptHeaderForMultipart)(i,t);var f=(0,o.createBatchRequestInterceptor)(r)(v(v({},t),{},{headers:i}));return(0,a.compressDataIfNeeded)(v(v({},f),{},{data:(0,a.shouldStringifyRequestBody)(i,f.data)?JSON.stringify(f.data):f.data}),e)},d=function(t,o){var i=t.headers.get(a.HTTP_HEADERS.USER_TOKEN_RESPONSE);e.currentUserToken=i,globalThis.g_ck=i;var u=(0,n.cloneDeep)(o);return u.headers[a.HTTP_HEADERS.USER_TOKEN]=i,r(u)},g=function(){var t=h(l().mark((function t(r,n,o){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,a.shouldRetryUnauthorizedRequest)(n,o,e)){t.next=2;break}return t.abrupt("return",d(n,o));case 2:return t.t0=Promise,t.next=5,(0,i.createRequestFailedError)(r,n,o);case 5:return t.t1=t.sent,t.abrupt("return",t.t0.reject.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}();return{setXsrfToken:function(t){e.currentUserToken=t},setTransactionSource:function(t){e.transactionSource=t},setDefaultHeaders:function(t){e.defaultHeaders=t},setHttpRequestCompressionThreshold:function(t){!Number.isInteger(t)||t<=0||(e.compressionThreshold=t)},getHttpRequestCompressionThreshold:function(){return e.compressionThreshold},setHttpRequestCompressionLevel:function(t){!Number.isInteger(t)||t<0||t>9||(e.compressionLevel=t)},getHttpRequestCompressionLevel:function(){return e.compressionLevel},setHttpRequestCompressionMemoryLevel:function(t){!Number.isInteger(t)||t<0||t>12||(e.compressionMemoryLevel=t)},getHttpRequestCompressionMemoryLevel:function(){return e.compressionMemoryLevel},setHttpRequestCompressionExcludeUrls:function(t){(0,n.isArray)(t)&&!(0,n.isEmpty)(t)&&(e.httpRequestCompressionExcludeUrls=t.map((function(t){return t.toLowerCase()})))},request:r}};e.default=g()},4564:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.failureHandler=function(t){var e=(t||{}).config;return(0,o.isBatchConfig)(e)?i(t):Promise.reject(t)},e.successHandler=function(t){var e=(t||{}).config;return(0,o.isBatchConfig)(e)?a(t):t};var n=r(9881),o=r(467),i=(0,n.createBatchResponseFailureHandler)(),a=(0,n.createBatchResponseSuccessHandler)()},4374:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=l(r(2859)),o=r(6486),i=r(9881),a=r(467),u=l(r(4845)),s=l(r(3471)),c=l(r(7261)),f=r(8376);function l(t){return t&&t.__esModule?t:{default:t}}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function v(t,e,r){var n;return n=function(t,e){if("object"!=p(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==p(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var y,g=["get","post","put","patch","delete","head"],m=(y=n.default,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.httpClient||y,r=t.methods||g,n=t.maxConcurrent||2,l=t.queue||[],p=t.enqueueRequestPrioritizer||u.default,h=!1!==t.batching,m=t[f.BatchRestRequestClientOptions]||{};t.xsrfToken?e.setXsrfToken(t.xsrfToken):console.warn("No XSRF token supplied in snHttp construction.  Setting an initial XSRF token (typically found on window.g_ck) is highly advised to avoid a 401 on initial request."),t.xTransactionSource&&e.setTransactionSource(t.xTransactionSource),t.headers&&e.setDefaultHeaders(t.headers),t.httpRequestCompressionThreshold&&e.setHttpRequestCompressionThreshold(t.httpRequestCompressionThreshold),t.httpRequestCompressionLevel&&e.setHttpRequestCompressionLevel(t.httpRequestCompressionLevel),t.httpRequestCompressionMemoryLevel&&e.setHttpRequestCompressionMemoryLevel(t.httpRequestCompressionMemoryLevel),t.httpRequestCompressionExcludeUrls&&y.setHttpRequestCompressionExcludeUrls(t.httpRequestCompressionExcludeUrls);var b=(0,i.createHttpRequestBatcher)(d(d({},m),{},{sendRequest:x})),_=[];function w(){return n-_.length}function E(){_.length>0&&_.shift(),O()}function O(){l.splice(0,w()).forEach(T)}function T(t){var r=t.config,n=t.deferredResolve,o=t.deferredReject,i=t.cancel;e.request(r).then((function(t){n(t)})).catch((function(t){o(t)})).then(E),function(t){_.push(t)}({config:r,cancel:i})}function S(){_.slice().forEach((function(t){(0,t.cancel)(),_.shift()}))}function x(t,e,r){var n,o,i=new Promise((function(t,e){n=t,o=e})),a=new AbortController,u=a.signal,f=function(){var i,c,f,p,h,d;p=void 0===(f=(c=(i={config:Object.assign({},{url:t,method:e,signal:u},r),deferredResolve:n,deferredReject:o,cancel:function(){return a.abort("Request cancelled by user")}}).config).priority)?"high":f,d=void 0===(h=c.operation)?"push":h,(0,s.default)(l,i,p,d),0!==w()&&O()};if(h&&!1===r.batch&&"low"===r.priority)var p=setInterval((function(){b.currentQueueSize||((0,c.default)((function(){return f()})),clearInterval(p))}),b.batchInterval);else f();return i}function R(t,e,n){var i=e,u=n,s=t;(0,o.isObject)(t)&&(i=t.method||"get",s=t.url,u=d({},t));if(!i)throw new Error("Must supply method");if(!r.includes(i.toLowerCase()))throw new Error('Method "'.concat(i,'" is not supported (supported methods are ').concat(r,")"));return(0,a.shouldBatch)(d(d({},u),{},{batching:h}))?function(t,e,r){return b.enqueueRequest(t,e,Object.assign({},r,{batch:!0}))}(s,i,d(d({},u),{},{batch:!0},p(s))):x(s,i,d(d({},u),{},{batch:!1},p(s)))}var P={get client(){return e},get queue(){return l},get interceptors(){return e.interceptors},cancelRequests:function(){S(),l.slice().forEach((function(t){t.deferredReject("Request cancelled by user"),l.shift()}))},cancelInFlightRequests:S,request:R};return r.reduce((function(t,e){return d(d({},t),{},v({},e,(function(t){return R(t,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})})))}),P)});e.default=m},9979:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(6486),o=r(264),i=/^([a-z][a-z\d+\-.]*:)?\/\//i;e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.getEmbeddableBaseUrl)(),e=arguments.length>1?arguments[1]:void 0;return(0,n.isEmpty)(t)||function(t){return i.test(t)}(e)?e:e?"".concat(t.replace(/\/+$/,""),"/").concat(e.replace(/^\/+/,"")):e}},5385:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(6486),o=function(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")},i=function(t,e){if((0,n.isEmpty)(e))return t;var r=function(t){var e=t.indexOf("#");return-1===e?t:t.slice(0,e)}(t);return"".concat(r).concat(-1===r.indexOf("?")?"?":"&").concat(e)},a=function(t,e){return function(t,e){return"".concat(o(t),"=").concat(o(e))}(t,function(t){return(0,n.isDate)(t)?t.toISOString():(0,n.isObject)(t)?JSON.stringify(t):t}(e))};e.default=function(t,e,r){if(e instanceof URLSearchParams)return i(t,e.toString());if((0,n.isEmpty)(e))return t;if(r)return i(t,r(e));var o=(0,n.reduce)(e,(function(t,e,r){return null==e?t:Array.isArray(e)?(e.forEach((function(e,n){var o=a("".concat(r,"[").concat(n,"]"),e);t.push(o)})),t):(t.push(a(r,e)),t)}),[]);return i(t,o.join("&"))}},613:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var r=t.headers,a=t.data;if(!(0,o.isString)(a)||!e.compressionThreshold||a.length<e.compressionThreshold||function(t,e){var r=e.httpRequestCompressionExcludeUrls,n=t.url.toLowerCase();return!(!r||!(0,o.isArray)(r)||(0,o.isEmpty)(r))&&r.filter((function(t){return n.includes(t)})).length>0}(t,e))return t;r[i.HTTP_HEADERS.CONTENT_ENCODING]="gzip";var u={};return e.compressionLevel&&(u.level=e.compressionLevel),e.compressionMemoryLevel&&(u.mem=e.compressionMemoryLevel),s(s({},t),{},{data:(0,n.gzipSync)(c.encode(a),u),headers:r})};var n=r(3778),o=r(6486),i=r(3610);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){var n,o,i,u;n=t,o=e,i=r[e],u=function(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o),(o="symbol"==a(u)?u:String(u))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var c=new TextEncoder},9869:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){return{ok:t.ok,status:t.status,statusText:t.statusText,headers:(0,n.headersToJson)(t.headers),config:e,request:r,data:t.data,body:t.data,text:function(){return Promise.resolve(t.data)}}};var n=r(3094)},557:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=new Headers(t.headers),r=t.method.toUpperCase(),u=t.data,s={headers:e,method:r,mode:t.mode,cache:t.cache,integrity:t.integrity,redirect:t.redirect,referrer:t.referrer,signal:t.signal,body:"GET"!==r&&"HEAD"!==r?u:void 0},c=(0,a.getEmbeddableBaseUrl)();(0,i.isUndefined)(t.withCredentials)&&!c||(s.credentials=t.withCredentials||c?"include":"omit");var f=(0,n.default)(t.baseURL,t.url),l=(0,o.default)(f,t.params,t.paramsSerializer);return new Request(l,s)};var n=u(r(9979)),o=u(r(5385)),i=r(6486),a=r(264);function u(t){return t&&t.__esModule?t:{default:t}}},3135:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=(0,o.default)(t.baseURL,t.url),r=(0,i.default)(e,t.params,t.paramsSerializer),u=new XMLHttpRequest,s=(0,n.isUndefined)(t.method)?"POST":t.method;u.open(s,r),(0,n.isEmpty)(t.headers)||Object.keys(t.headers).forEach((function(e){return u.setRequestHeader(e,Array.isArray(t.headers[e])?t.headers[e].join(","):t.headers[e])}));var c=(0,a.getEmbeddableBaseUrl)();return(0,n.isUndefined)(t.withCredentials)&&!c||(u.withCredentials=t.withCredentials||!!c),u};var n=r(6486),o=u(r(9979)),i=u(r(5385)),a=r(264);function u(t){return t&&t.__esModule?t:{default:t}}},4845:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return{priority:"high",operation:"push"}}},3471:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r,n){if((0,o.default)(["push","unshift"].includes(n),"snHttpFactory: options must contain 'enqueueRequest' must return an operation of push or unshit."),(0,o.default)(["high","low"].includes(r),"snHttpFactory: options must contain 'enqueueRequest' must return an priority of low or high."),"high"===r&&"push"===n||"low"===r&&"unshift"===n){var a=(0,i.findIndex)(t,(function(t){return"low"===t.config.priority}));-1===a?t.push(e):t.splice(a,0,e)}"high"===r&&"unshift"===n&&t.unshift(e),"low"===r&&"push"===n&&t.push(e)};var n,o=(n=r(1143))&&n.__esModule?n:{default:n},i=r(6486)},3094:(t,e)=>{"use strict";function r(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object.defineProperty(e,"__esModule",{value:!0}),e.xhrHeadersToHeaders=e.isHeaders=e.headersToJson=e.getHeader=e.containsHeader=void 0,e.headersToJson=function(t){if(!t)return t;if(!o(t))return t;var e,n,i,a={},u=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))){n&&(t=n);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){s=!0,a=t},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw a}}}}(t.entries());try{for(u.s();!(e=u.n()).done;){var s=(n=e.value,i=2,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(n,i)||r(n,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=s[0],f=s[1];a[c]=f}}catch(t){u.e(t)}finally{u.f()}return a},e.getHeader=function(t,e){if("string"==typeof t&&0!==t.length){if(!e)return e;var r=t.toLowerCase();if(!o(e))return e[Object.keys(e).find((function(t){return"string"==typeof t&&t.toLowerCase()===r}))];if(e.has(r))return e.get(r)}},e.containsHeader=function(t,e){if("string"!=typeof t||0===t.length||!e)return!1;var r=t.toLowerCase();return o(e)?e.has(r):void 0!==Object.keys(e).find((function(t){return"string"==typeof t&&t.toLowerCase()===r}))};var o=e.isHeaders=function(t){return t?!(!t.get||!t.entries):t};e.xhrHeadersToHeaders=function(t){return t&&"string"==typeof t&&t.length?t.trim().split("\r\n").reduce((function(t,e){var r=e.split(":"),n=r.shift().trim(),o=r.join().trim();return t.append(n,o),t}),new Headers):t}},3610:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.USER_TOKEN_RESPONSE=e.USER_TOKEN=e.TRANSACTION_SOURCE=e.IS_LOGGED_IN=e.HTTP_HEADERS=e.CONTENT_TYPE=e.CONTENT_ENCODING=e.AUTHORIZATION=e.ACCEPT=void 0;var r=e.TRANSACTION_SOURCE="X-Transaction-Source",n=e.USER_TOKEN="X-UserToken",o=e.IS_LOGGED_IN="x-is-logged-in",i=e.USER_TOKEN_RESPONSE="x-usertoken-response",a=e.CONTENT_ENCODING="Content-Encoding",u=e.AUTHORIZATION="Authorization",s=e.CONTENT_TYPE="Content-Type",c=e.ACCEPT="Accept";e.HTTP_HEADERS={TRANSACTION_SOURCE:r,USER_TOKEN:n,IS_LOGGED_IN:o,USER_TOKEN_RESPONSE:i,CONTENT_ENCODING:a,AUTHORIZATION:u,CONTENT_TYPE:s,ACCEPT:c}},467:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"HTTP_HEADERS",{enumerable:!0,get:function(){return g.HTTP_HEADERS}}),Object.defineProperty(e,"buildFullPath",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"buildUrl",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"compressDataIfNeeded",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"containsHeader",{enumerable:!0,get:function(){return u.containsHeader}}),Object.defineProperty(e,"createExternalResponse",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(e,"createRequest",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"createRequestXhr",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"getHeader",{enumerable:!0,get:function(){return u.getHeader}}),Object.defineProperty(e,"headersToJson",{enumerable:!0,get:function(){return u.headersToJson}}),Object.defineProperty(e,"isBatchConfig",{enumerable:!0,get:function(){return o.isBatchConfig}}),Object.defineProperty(e,"isFile",{enumerable:!0,get:function(){return s.isFile}}),Object.defineProperty(e,"isFileUploadData",{enumerable:!0,get:function(){return s.isFileUploadData}}),Object.defineProperty(e,"isFormData",{enumerable:!0,get:function(){return s.isFormData}}),Object.defineProperty(e,"isMultipartMixedResponse",{enumerable:!0,get:function(){return f.isMultipartMixedResponse}}),Object.defineProperty(e,"isWebWorker",{enumerable:!0,get:function(){return s.isWebWorker}}),Object.defineProperty(e,"mergeRequestHeaders",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"parseBody",{enumerable:!0,get:function(){return c.parseBody}}),Object.defineProperty(e,"resolveUserToken",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(e,"shouldBatch",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"shouldRetryUnauthorizedRequest",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(e,"shouldStringifyRequestBody",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(e,"shouldUseXhr",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(e,"transformData",{enumerable:!0,get:function(){return _.transformData}}),Object.defineProperty(e,"transformHeadersToJson",{enumerable:!0,get:function(){return _.transformHeadersToJson}}),Object.defineProperty(e,"updateAcceptHeaderForMultipart",{enumerable:!0,get:function(){return f.updateAcceptHeaderForMultipart}}),Object.defineProperty(e,"xhrHeadersToHeaders",{enumerable:!0,get:function(){return u.xhrHeadersToHeaders}});var o=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!=n(t)&&"function"!=typeof t)return{default:t};var r=O(e);if(r&&r.has(t))return r.get(t);var o={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var u=i?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(o,a,u):o[a]=t[a]}return o.default=t,r&&r.set(t,o),o}(r(7308)),i=E(r(5385)),a=E(r(9979)),u=r(3094),s=r(5671),c=r(9419),f=r(9940),l=E(r(5061)),p=E(r(613)),h=E(r(557)),d=E(r(3135)),v=E(r(5121)),y=E(r(7270)),g=r(3610),m=E(r(9869)),b=E(r(4377)),_=r(9639),w=E(r(3512));function E(t){return t&&t.__esModule?t:{default:t}}function O(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(O=function(t){return t?r:e})(t)}},5061:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return a(a(a({},e.defaultHeaders),e.transactionSource&&u({},n.HTTP_HEADERS.TRANSACTION_SOURCE,e.transactionSource)),t.headers)};var n=r(3610);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){var n;return n=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==o(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},9940:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.forEvery=e.collectMessageParts=e.SEPARATOR=e.MULTIPART_PAYLOAD_NOT_COMPLETE_ERROR=e.MULTIPART_MIXED_CONTENT_TYPE=e.CRLF=void 0,e.isMultipartMixedResponse=function(t){var e=(0,o.getHeader)(i.CONTENT_TYPE,t.headers);return!(!e||"string"!=typeof e)&&e.includes("multipart/mixed")},e.updateAcceptHeaderForMultipart=e.streamDecorator=e.reduceStream=e.multipartToJSONStream=e.multipartToJSON=e.multipartParser=e.mapStream=e.iteratorToReadableStream=void 0;var n=r(6486),o=r(3094),i=r(3610),a=r(4898);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){c(i,n,o,a,u,"next",t)}function u(t){c(i,n,o,a,u,"throw",t)}a(void 0)}))}}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof b?e:b,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:P(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",v="suspendedYield",y="executing",g="completed",m={};function b(){}function _(){}function w(){}var E={};f(E,a,(function(){return this}));var O=Object.getPrototypeOf,T=O&&O(O(L([])));T&&T!==r&&n.call(T,a)&&(E=T);var S=w.prototype=b.prototype=Object.create(E);function x(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==u(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(l).then((function(t){f.value=t,a(f)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?g:v,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return _.prototype=w,o(S,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:_,configurable:!0}),_.displayName=f(w,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,f(t,c,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(R.prototype),f(R.prototype,s,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),f(S,c,"Generator"),f(S,a,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function p(t){return function(){return new h(t.apply(this,arguments))}}function h(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof y;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function d(t){return new y(t,0)}function v(t){var e={},r=!1;function n(e,n){return r=!0,n=new Promise((function(r){r(t[e](n))})),{done:!1,value:new y(n,1)}}return e["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(t){return r?(r=!1,t):n("next",t)},"function"==typeof t.throw&&(e.throw=function(t){if(r)throw r=!1,t;return n("throw",t)}),"function"==typeof t.return&&(e.return=function(t){return r?(r=!1,t):n("return",t)}),e}function y(t,e){this.v=t,this.k=e}function g(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new m(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function m(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return m=function(t){this.s=t,this.n=t.next},m.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new m(t)}h.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},h.prototype.next=function(t){return this._invoke("next",t)},h.prototype.throw=function(t){return this._invoke("throw",t)},h.prototype.return=function(t){return this._invoke("return",t)};var b=e.MULTIPART_MIXED_CONTENT_TYPE="multipart/mixed",_=e.MULTIPART_PAYLOAD_NOT_COMPLETE_ERROR="Multipart message payload was not complete",w=/(boundary=)(.*)/,E=e.CRLF="\r\n",O=e.SEPARATOR=E+E,T=new TextDecoder;e.updateAcceptHeaderForMultipart=function(t,e){var r;if(null!=e&&null!==(r=e.multipartConfig)&&void 0!==r&&r.multipartConsumer){var n=t[i.HTTP_HEADERS.ACCEPT];null==n?n=b:n.includes(b)||(n+=", ".concat(b)),t[i.HTTP_HEADERS.ACCEPT]=n}};var S=function(t,e){var r=t.headers.get?t.headers.get("content-type"):t.headers["content-type"],o=w.exec(r);if((0,n.isEmpty)(o)||o.length<3)throw(0,a.createMultipartError)(t,e,"Invalid boundary declaration");var i=o[2].replace(/['"]/gm,"");if((0,n.isEmpty)(i))throw(0,a.createMultipartError)(t,e,"Invalid boundary declaration");return"--".concat(i)},x=function(t,e){if((0,n.isEmpty)(t))return new Headers({"Content-Type":"text/plain"});var r=new Headers;return t.forEach((function(t){var n=t.split(":");if(2!==n.length)throw(0,a.createMultipartError)(void 0,e,"Invalid message header: ".concat(t));r.append(n[0].trim(),n[1].trim())})),r},R=function(t){return t.startsWith("--")},P=function(t,e){for(var r=e.isComplete,n=e.boundary,o=e.responseHeaders,i=e.config,u=e.buffer+t,s=e.isPreamble,c=u.indexOf(n),f=[];-1!==c;){var l=u.substring(0,c),p=u.substring(c+n.length);if(!s){var h=l.indexOf(O);if(-1===h)throw(0,a.createMultipartError)(void 0,i,"Message part has malformed encapsulation boundary");var d=u.substring(0,h).trim().split(E),v=x(d,i),y={body:l.substring(h+O.length,l.lastIndexOf(E)),headers:v,responseHeaders:o};if(f.push(y),R(p))return{state:{isPreamble:s,buffer:"",boundary:n,isComplete:!0,responseHeaders:o,config:i},parts:f}}s=s&&!1,c=(u=p).indexOf(n)}return{state:{isPreamble:s,buffer:u,boundary:n,responseHeaders:o,config:i,isComplete:r||R(u)},parts:f}},A=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.boundary,r=void 0===e?"---":e,n=t.isPreamble,i=void 0===n||n,a=t.buffer,u=void 0===a?"":a,s=t.responseHeaders,c=void 0===s?{}:s,f=t.config;return{boundary:r,isPreamble:i,buffer:u,isComplete:!1,responseHeaders:(0,o.headersToJson)(c),config:f}};function I(t,e,r){return j.apply(this,arguments)}function j(){return(j=p(l().mark((function t(e,r,o){var i,u,s,c,f,p,h,y,m,b;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=r.body,u=r.headers,s=i.getReader(),c=A({boundary:e,responseHeaders:u,config:o});case 3:return t.next=6,d(s.read());case 6:if(f=t.sent,p=f.value,!f.done){t.next=13;break}if(!c.isComplete){t.next=12;break}return t.abrupt("return");case 12:throw(0,a.createMultipartError)(r,o,_);case 13:if(h=T.decode(p),y=P(h,c),m=y.state,b=y.parts,(0,n.isEmpty)(b)){t.next=17;break}return t.delegateYield(v(g(b)),"t0",17);case 17:c=m,t.next=3;break;case 20:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.multipartParser=function(){var t=f(l().mark((function t(e){var r,n,o=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=S(e,r=o.length>1&&void 0!==o[1]?o[1]:{}),t.abrupt("return",I(n,e,r));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var C=e.streamDecorator=function(t){return function(){var e=p(l().mark((function e(r){var n,o,i,a,u,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,o=!1,e.prev=2,a=g(r);case 4:return e.next=6,d(a.next());case 6:if(!(n=!(u=e.sent).done)){e.next=13;break}return s=u.value,e.next=10,t(s);case 10:n=!1,e.next=4;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),o=!0,i=e.t0;case 19:if(e.prev=19,e.prev=20,!n||null==a.return){e.next=24;break}return e.next=24,d(a.return());case 24:if(e.prev=24,!o){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(19);case 29:case"end":return e.stop()}}),e,null,[[2,15,19,29],[20,,24,28]])})));return function(t){return e.apply(this,arguments)}}()},L=(e.mapStream=C,e.forEvery=function(t){return function(){var e=f(l().mark((function e(r){var n,o,i,a,u,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,o=!1,e.prev=2,a=g(r);case 4:return e.next=6,a.next();case 6:if(!(n=!(u=e.sent).done)){e.next=12;break}s=u.value,t(s);case 9:n=!1,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),o=!0,i=e.t0;case 18:if(e.prev=18,e.prev=19,!n||null==a.return){e.next=23;break}return e.next=23,a.return();case 23:if(e.prev=23,!o){e.next=26;break}throw i;case 26:return e.finish(23);case 27:return e.finish(18);case 28:case"end":return e.stop()}}),e,null,[[2,14,18,28],[19,,23,27]])})));return function(t){return e.apply(this,arguments)}}()},e.reduceStream=function(t,e){return function(){var r=f(l().mark((function r(n){var o,i,a,u,s,c,f;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:o=e,i=!1,a=!1,r.prev=3,s=g(n);case 5:return r.next=7,s.next();case 7:if(!(i=!(c=r.sent).done)){r.next=13;break}f=c.value,o=t(o,f);case 10:i=!1,r.next=5;break;case 13:r.next=19;break;case 15:r.prev=15,r.t0=r.catch(3),a=!0,u=r.t0;case 19:if(r.prev=19,r.prev=20,!i||null==s.return){r.next=24;break}return r.next=24,s.return();case 24:if(r.prev=24,!a){r.next=27;break}throw u;case 27:return r.finish(24);case 28:return r.finish(19);case 29:return r.abrupt("return",o);case 30:case"end":return r.stop()}}),r,null,[[3,15,19,29],[20,,24,28]])})));return function(t){return r.apply(this,arguments)}}()}),N=(e.multipartToJSONStream=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).useJsonHeaders,e=void 0!==t&&t;return C((function(t){return N(t,e)}))},e.multipartToJSON=function(t){var e=t.headers,r=t.responseHeaders,n=t.body;return{headers:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(0,o.headersToJson)(e):e,body:JSON.parse(n),responseHeaders:r}});e.collectMessageParts=L((function(t,e){return[].concat(function(t){if(Array.isArray(t))return s(t)}(r=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[e]);var r}),[]),e.iteratorToReadableStream=function(t){return new ReadableStream({pull:function(e){return f(l().mark((function r(){var n,o;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.next();case 2:n=r.sent,o=n.value,n.done?e.close():e.enqueue(o);case 6:case"end":return r.stop()}}),r)})))()}})}},9419:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.parseBody=void 0;var o=function(t,e){if(t&&t.__esModule)return t;if(null===t||"object"!=n(t)&&"function"!=typeof t)return{default:t};var r=s(e);if(r&&r.has(t))return r.get(t);var o={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if("default"!==a&&Object.prototype.hasOwnProperty.call(t,a)){var u=i?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(o,a,u):o[a]=t[a]}return o.default=t,r&&r.set(t,o),o}(r(4898)),i=r(3094),a=r(3610),u=r(9940);function s(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(s=function(t){return t?r:e})(t)}function c(){c=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",f=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),u=new C(n||[]);return i(a,"_invoke",{value:P(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",v="suspendedYield",y="executing",g="completed",m={};function b(){}function _(){}function w(){}var E={};l(E,u,(function(){return this}));var O=Object.getPrototypeOf,T=O&&O(O(L([])));T&&T!==r&&o.call(T,u)&&(E=T);var S=w.prototype=b.prototype=Object.create(E);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){function r(i,a,u,s){var c=h(t[i],t,a);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==n(l)&&o.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(l).then((function(t){f.value=t,u(f)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===y)throw new Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?g:v,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=g,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(o.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return _.prototype=w,i(S,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:_,configurable:!0}),_.displayName=l(w,f,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,f,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},x(R.prototype),l(R.prototype,s,(function(){return this})),e.AsyncIterator=R,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new R(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),l(S,f,"Generator"),l(S,u,(function(){return this})),l(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),j(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function f(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){f(i,n,o,a,u,"next",t)}function u(t){f(i,n,o,a,u,"throw",t)}a(void 0)}))}}function p(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new h(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function h(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return h=function(t){this.s=t,this.n=t.next},h.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new h(t)}var d=e.parseBody=function(){var t=l(c().mark((function t(e,r,n){var o,u,s,f;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.responseType,(u=o)||(s=(0,i.getHeader)(a.CONTENT_TYPE,r.headers))&&(u=v(s)),t.t0=u,t.next="multipart/mixed"===t.t0?6:"arraybuffer"===t.t0?9:"blob"===t.t0?10:"json"===t.t0?11:"formData"===t.t0?12:"stream"===t.t0?13:"text"===t.t0?14:15;break;case 6:return t.next=8,y(n,r,e);case 8:return t.abrupt("return",t.sent);case 9:return t.abrupt("return",r.arrayBuffer());case 10:return t.abrupt("return",r.blob());case 11:return t.abrupt("return",r.json());case 12:return t.abrupt("return",r.formData());case 13:return t.abrupt("return",Promise.resolve(r.body));case 14:return t.abrupt("return",r.text());case 15:return t.prev=15,t.next=18,r.text();case 18:return f=t.sent,t.abrupt("return",JSON.parse(f));case 22:return t.prev=22,t.t1=t.catch(15),console.warn("sn-http-request: ".concat(t.t1.message," response body parsing for ").concat(a.HTTP_HEADERS.CONTENT_TYPE,": ").concat(s)),t.abrupt("return",f);case 26:case"end":return t.stop()}}),t,null,[[15,22]])})));return function(e,r,n){return t.apply(this,arguments)}}();function v(t){return t.includes("multipart/mixed")?"multipart/mixed":t.includes("json")?"json":t.includes("text")?"text":t.includes("blob")?"blob":t.includes("x-www-form-urlencoded")?"formData":void 0}var y=function(){var t=l(c().mark((function t(e,r){var n,i,a,s,f,l,h,v,y,g,m,b,_,w,E,O=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(n=O.length>2&&void 0!==O[2]?O[2]:{}).multipartConfig||{},a=i.multipartConsumer,s=i.parsePartsAsJson,f=void 0===s||s,l=i.emitCompletedResponse,(h=void 0===l||l)&&(v=a?r.clone():r),!a){t.next=52;break}return t.prev=5,y=!1,g=!1,t.prev=8,t.t0=p,t.next=12,(0,u.multipartParser)(r,n);case 12:t.t1=t.sent,b=(0,t.t0)(t.t1);case 14:return t.next=16,b.next();case 16:if(!(y=!(_=t.sent).done)){t.next=23;break}w=_.value,E=f?(0,u.multipartToJSON)(w):w,a(E);case 20:y=!1,t.next=14;break;case 23:t.next=29;break;case 25:t.prev=25,t.t2=t.catch(8),g=!0,m=t.t2;case 29:if(t.prev=29,t.prev=30,!y||null==b.return){t.next=34;break}return t.next=34,b.return();case 34:if(t.prev=34,!g){t.next=37;break}throw m;case 37:return t.finish(34);case 38:return t.finish(29);case 39:t.next=52;break;case 41:if(t.prev=41,t.t3=t.catch(5),!(t.t3 instanceof o.default)){t.next=47;break}throw t.t3;case 47:if(t.t3.message!==u.MULTIPART_PAYLOAD_NOT_COMPLETE_ERROR){t.next=51;break}throw new o.default(t.t3.message,o.ERR_BAD_MULTIPART_RESPONSE,i,e);case 51:throw new o.default(t.t3.message,o.ERR_UNKNOWN,i,e);case 52:if(!h){t.next=58;break}return t.next=55,d({responseType:"text"},v);case 55:t.t4=t.sent,t.next=59;break;case 58:t.t4="";case 59:return t.abrupt("return",t.t4);case 60:case"end":return t.stop()}}),t,null,[[5,41],[8,25,29,39],[30,,34,38]])})));return function(e,r){return t.apply(this,arguments)}}()},5121:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return(0,o.get)(t.headers,n.HTTP_HEADERS.USER_TOKEN,e.currentUserToken)};var n=r(3610),o=r(6486)},7308:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.batching,r=void 0===e||e,i=t.batch,a=t.data,u=void 0===a?{}:a,s=t.multipartConfig,c=(!0===i||!1===i?i:r)&&r&&function(t){return!(0,n.overSome)([n.isArrayBuffer,o.isArrayBufferView,o.isBlob,n.isBuffer,o.isFile,o.isFormData,o.isStream,o.isURLSearchParams])(t)}(u);return!(c&&!(0,n.isEmpty)(s))&&c},e.isBatchConfig=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!t&&!0===t.batch};var n=r(6486),o=r(5671)},7270:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){if(401!==t.status)return!1;var i=t.headers.get(n.HTTP_HEADERS.USER_TOKEN_RESPONSE);return!(0,o.isUndefined)(i)&&i!==r.currentUserToken};var n=r(3610),o=r(6486)},3512:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return!((0,i.isString)(e)||(0,o.isFormData)(e)||(0,o.isFile)(e)||t&&"gzip"===t[n.CONTENT_ENCODING])};var n=r(3610),o=r(5671),i=r(6486)},4377:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(t.onUploadProgress||t.onDownloadProgress)&&t.data&&(0,n.isFileUploadData)(t.data)};var n=r(5671)},9639:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.transformData=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof t)try{var o=JSON.parse(t);if(r&&(0,n.isEmpty)(o))throw new Error("Invalid JSON received: ".concat(t));return o}catch(r){if(e)throw new Error("Invalid JSON received: ".concat(t))}return t},e.transformHeadersToJson=function(t){return t instanceof Headers?Object.fromEntries(t.entries()):(0,n.reduce)(t,(function(t,e){var r=e.name,n=e.value;return a(a({},t),{},u({},r,n))}),{})};var n=r(6486);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){var n;return n=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==o(n)?n:String(n))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},5671:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isArrayBufferView=function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},e.isBlob=function(t){return"[object Blob]"===o.call(t)},e.isFile=a,e.isFileUploadData=function(t){return(0,n.overSome)([i,a])(t)},e.isFormData=i,e.isStream=function(t){return(0,n.isObjectLike)(t)&&(0,n.isFunction)(t.pipe)},e.isURLSearchParams=function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},e.isWebWorker=function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope};var n=r(6486),o=Object.prototype.toString;function i(t){return"undefined"!=typeof FormData&&t instanceof FormData}function a(t){return"[object File]"===o.call(t)}},7102:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return s.default}});var n=p(r(3662)),o=p(r(241)),i=p(r(7849)),a=p(r(7953)),u=p(r(9435)),s=p(r(2118)),c=p(r(8895)),f=p(r(962)),l=p(r(7946));function p(t){return t&&t.__esModule?t:{default:t}}},1110:(t,e)=>{"use strict";function r(t){return 14+(t+64>>>9<<4)+1}function n(t,e){const r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function o(t,e,r,o,i,a){return n((u=n(n(e,t),n(o,a)))<<(s=i)|u>>>32-s,r);var u,s}function i(t,e,r,n,i,a,u){return o(e&r|~e&n,t,e,i,a,u)}function a(t,e,r,n,i,a,u){return o(e&n|r&~n,t,e,i,a,u)}function u(t,e,r,n,i,a,u){return o(e^r^n,t,e,i,a,u)}function s(t,e,r,n,i,a,u){return o(r^(e|~n),t,e,i,a,u)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(t){if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return function(t){const e=[],r=32*t.length,n="0123456789abcdef";for(let o=0;o<r;o+=8){const r=t[o>>5]>>>o%32&255,i=parseInt(n.charAt(r>>>4&15)+n.charAt(15&r),16);e.push(i)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[r(e)-1]=e;let o=1732584193,c=-271733879,f=-1732584194,l=271733878;for(let e=0;e<t.length;e+=16){const r=o,p=c,h=f,d=l;o=i(o,c,f,l,t[e],7,-680876936),l=i(l,o,c,f,t[e+1],12,-389564586),f=i(f,l,o,c,t[e+2],17,606105819),c=i(c,f,l,o,t[e+3],22,-1044525330),o=i(o,c,f,l,t[e+4],7,-176418897),l=i(l,o,c,f,t[e+5],12,1200080426),f=i(f,l,o,c,t[e+6],17,-1473231341),c=i(c,f,l,o,t[e+7],22,-45705983),o=i(o,c,f,l,t[e+8],7,1770035416),l=i(l,o,c,f,t[e+9],12,-1958414417),f=i(f,l,o,c,t[e+10],17,-42063),c=i(c,f,l,o,t[e+11],22,-1990404162),o=i(o,c,f,l,t[e+12],7,1804603682),l=i(l,o,c,f,t[e+13],12,-40341101),f=i(f,l,o,c,t[e+14],17,-1502002290),c=i(c,f,l,o,t[e+15],22,1236535329),o=a(o,c,f,l,t[e+1],5,-165796510),l=a(l,o,c,f,t[e+6],9,-1069501632),f=a(f,l,o,c,t[e+11],14,643717713),c=a(c,f,l,o,t[e],20,-373897302),o=a(o,c,f,l,t[e+5],5,-701558691),l=a(l,o,c,f,t[e+10],9,38016083),f=a(f,l,o,c,t[e+15],14,-660478335),c=a(c,f,l,o,t[e+4],20,-405537848),o=a(o,c,f,l,t[e+9],5,568446438),l=a(l,o,c,f,t[e+14],9,-1019803690),f=a(f,l,o,c,t[e+3],14,-187363961),c=a(c,f,l,o,t[e+8],20,1163531501),o=a(o,c,f,l,t[e+13],5,-1444681467),l=a(l,o,c,f,t[e+2],9,-51403784),f=a(f,l,o,c,t[e+7],14,1735328473),c=a(c,f,l,o,t[e+12],20,-1926607734),o=u(o,c,f,l,t[e+5],4,-378558),l=u(l,o,c,f,t[e+8],11,-2022574463),f=u(f,l,o,c,t[e+11],16,1839030562),c=u(c,f,l,o,t[e+14],23,-35309556),o=u(o,c,f,l,t[e+1],4,-1530992060),l=u(l,o,c,f,t[e+4],11,1272893353),f=u(f,l,o,c,t[e+7],16,-155497632),c=u(c,f,l,o,t[e+10],23,-1094730640),o=u(o,c,f,l,t[e+13],4,681279174),l=u(l,o,c,f,t[e],11,-358537222),f=u(f,l,o,c,t[e+3],16,-722521979),c=u(c,f,l,o,t[e+6],23,76029189),o=u(o,c,f,l,t[e+9],4,-640364487),l=u(l,o,c,f,t[e+12],11,-421815835),f=u(f,l,o,c,t[e+15],16,530742520),c=u(c,f,l,o,t[e+2],23,-995338651),o=s(o,c,f,l,t[e],6,-198630844),l=s(l,o,c,f,t[e+7],10,1126891415),f=s(f,l,o,c,t[e+14],15,-1416354905),c=s(c,f,l,o,t[e+5],21,-57434055),o=s(o,c,f,l,t[e+12],6,1700485571),l=s(l,o,c,f,t[e+3],10,-1894986606),f=s(f,l,o,c,t[e+10],15,-1051523),c=s(c,f,l,o,t[e+1],21,-2054922799),o=s(o,c,f,l,t[e+8],6,1873313359),l=s(l,o,c,f,t[e+15],10,-30611744),f=s(f,l,o,c,t[e+6],15,-1560198380),c=s(c,f,l,o,t[e+13],21,1309151649),o=s(o,c,f,l,t[e+4],6,-145523070),l=s(l,o,c,f,t[e+11],10,-1120210379),f=s(f,l,o,c,t[e+2],15,718787259),c=s(c,f,l,o,t[e+9],21,-343485551),o=n(o,r),c=n(c,p),f=n(f,h),l=n(l,d)}return[o,c,f,l]}(function(t){if(0===t.length)return[];const e=8*t.length,n=new Uint32Array(r(e));for(let r=0;r<e;r+=8)n[r>>5]|=(255&t[r/8])<<r%32;return n}(t),8*t.length))}},6149:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};e.default=r},9435:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default="00000000-0000-0000-0000-000000000000"},7946:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o=(n=r(8895))&&n.__esModule?n:{default:n};e.default=function(t){if(!(0,o.default)(t))throw TypeError("Invalid UUID");let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=255&e,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=255&e,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=255&e,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=255&e,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=255&e,r}},3986:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},894:(t,e)=>{"use strict";let r;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if(!r&&(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(n)};const n=new Uint8Array(16)},762:(t,e)=>{"use strict";function r(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:case 3:return e^r^n;case 2:return e&r^e&n^r&n}}function n(t,e){return t<<e|t>>>32-e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(t){const e=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){const e=unescape(encodeURIComponent(t));t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const i=t.length/4+2,a=Math.ceil(i/16),u=new Array(a);for(let e=0;e<a;++e){const r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=t[64*e+4*n]<<24|t[64*e+4*n+1]<<16|t[64*e+4*n+2]<<8|t[64*e+4*n+3];u[e]=r}u[a-1][14]=8*(t.length-1)/Math.pow(2,32),u[a-1][14]=Math.floor(u[a-1][14]),u[a-1][15]=8*(t.length-1)&4294967295;for(let t=0;t<a;++t){const i=new Uint32Array(80);for(let e=0;e<16;++e)i[e]=u[t][e];for(let t=16;t<80;++t)i[t]=n(i[t-3]^i[t-8]^i[t-14]^i[t-16],1);let a=o[0],s=o[1],c=o[2],f=o[3],l=o[4];for(let t=0;t<80;++t){const o=Math.floor(t/20),u=n(a,5)+r(o,s,c,f)+l+e[o]+i[t]>>>0;l=f,f=c,c=n(s,30)>>>0,s=a,a=u}o[0]=o[0]+a>>>0,o[1]=o[1]+s>>>0,o[2]=o[2]+c>>>0,o[3]=o[3]+f>>>0,o[4]=o[4]+l>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,255&o[0],o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,255&o[1],o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,255&o[2],o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,255&o[3],o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,255&o[4]]}},962:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.unsafeStringify=a;var n,o=(n=r(8895))&&n.__esModule?n:{default:n};const i=[];for(let t=0;t<256;++t)i.push((t+256).toString(16).slice(1));function a(t,e=0){return i[t[e+0]]+i[t[e+1]]+i[t[e+2]]+i[t[e+3]]+"-"+i[t[e+4]]+i[t[e+5]]+"-"+i[t[e+6]]+i[t[e+7]]+"-"+i[t[e+8]]+i[t[e+9]]+"-"+i[t[e+10]]+i[t[e+11]]+i[t[e+12]]+i[t[e+13]]+i[t[e+14]]+i[t[e+15]]}e.default=function(t,e=0){const r=a(t,e);if(!(0,o.default)(r))throw TypeError("Stringified UUID is invalid");return r}},3662:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o=(n=r(894))&&n.__esModule?n:{default:n},i=r(962);let a,u,s=0,c=0;e.default=function(t,e,r){let n=e&&r||0;const f=e||new Array(16);let l=(t=t||{}).node||a,p=void 0!==t.clockseq?t.clockseq:u;if(null==l||null==p){const e=t.random||(t.rng||o.default)();null==l&&(l=a=[1|e[0],e[1],e[2],e[3],e[4],e[5]]),null==p&&(p=u=16383&(e[6]<<8|e[7]))}let h=void 0!==t.msecs?t.msecs:Date.now(),d=void 0!==t.nsecs?t.nsecs:c+1;const v=h-s+(d-c)/1e4;if(v<0&&void 0===t.clockseq&&(p=p+1&16383),(v<0||h>s)&&void 0===t.nsecs&&(d=0),d>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=d,u=p,h+=122192928e5;const y=(1e4*(268435455&h)+d)%4294967296;f[n++]=y>>>24&255,f[n++]=y>>>16&255,f[n++]=y>>>8&255,f[n++]=255&y;const g=h/4294967296*1e4&268435455;f[n++]=g>>>8&255,f[n++]=255&g,f[n++]=g>>>24&15|16,f[n++]=g>>>16&255,f[n++]=p>>>8|128,f[n++]=255&p;for(let t=0;t<6;++t)f[n+t]=l[t];return e||(0,i.unsafeStringify)(f)}},241:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(r(3447)),o=i(r(1110));function i(t){return t&&t.__esModule?t:{default:t}}var a=(0,n.default)("v3",48,o.default);e.default=a},3447:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0,e.default=function(t,e,r){function n(t,n,a,u){var s;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));const e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}(t)),"string"==typeof n&&(n=(0,i.default)(n)),16!==(null===(s=n)||void 0===s?void 0:s.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+t.length);if(c.set(n),c.set(t,n.length),c=r(c),c[6]=15&c[6]|e,c[8]=63&c[8]|128,a){u=u||0;for(let t=0;t<16;++t)a[u+t]=c[t];return a}return(0,o.unsafeStringify)(c)}try{n.name=t}catch(t){}return n.DNS=a,n.URL=u,n};var n,o=r(962),i=(n=r(7946))&&n.__esModule?n:{default:n};const a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";e.DNS=a;const u="6ba7b811-9dad-11d1-80b4-00c04fd430c8";e.URL=u},7849:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(6149)),o=a(r(894)),i=r(962);function a(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,r){if(n.default.randomUUID&&!e&&!t)return n.default.randomUUID();const a=(t=t||{}).random||(t.rng||o.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e){r=r||0;for(let t=0;t<16;++t)e[r+t]=a[t];return e}return(0,i.unsafeStringify)(a)}},7953:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(r(3447)),o=i(r(762));function i(t){return t&&t.__esModule?t:{default:t}}var a=(0,n.default)("v5",80,o.default);e.default=a},8895:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o=(n=r(3986))&&n.__esModule?n:{default:n};e.default=function(t){return"string"==typeof t&&o.default.test(t)}},2118:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o=(n=r(8895))&&n.__esModule?n:{default:n};e.default=function(t){if(!(0,o.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}},2857:e=>{"use strict";e.exports=t},509:(t,e,r)=>{"use strict";var n=r(9985),o=r(3691),i=TypeError;t.exports=function(t){if(n(t))return t;throw new i(o(t)+" is not a function")}},2655:(t,e,r)=>{"use strict";var n=r(9429),o=r(3691),i=TypeError;t.exports=function(t){if(n(t))return t;throw new i(o(t)+" is not a constructor")}},3550:(t,e,r)=>{"use strict";var n=r(598),o=String,i=TypeError;t.exports=function(t){if(n(t))return t;throw new i("Can't set "+o(t)+" as a prototype")}},7370:(t,e,r)=>{"use strict";var n=r(4201),o=r(5391),i=r(2560).f,a=n("unscopables"),u=Array.prototype;void 0===u[a]&&i(u,a,{configurable:!0,value:o(null)}),t.exports=function(t){u[a][t]=!0}},1514:(t,e,r)=>{"use strict";var n=r(730).charAt;t.exports=function(t,e,r){return e+(r?n(t,e).length:1)}},767:(t,e,r)=>{"use strict";var n=r(3622),o=TypeError;t.exports=function(t,e){if(n(e,t))return t;throw new o("Incorrect invocation")}},5027:(t,e,r)=>{"use strict";var n=r(8999),o=String,i=TypeError;t.exports=function(t){if(n(t))return t;throw new i(o(t)+" is not an object")}},7075:t=>{"use strict";t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},4872:(t,e,r)=>{"use strict";var n,o,i,a=r(7075),u=r(7697),s=r(9037),c=r(9985),f=r(8999),l=r(6812),p=r(926),h=r(3691),d=r(5773),v=r(1880),y=r(2148),g=r(3622),m=r(1868),b=r(9385),_=r(4201),w=r(4630),E=r(618),O=E.enforce,T=E.get,S=s.Int8Array,x=S&&S.prototype,R=s.Uint8ClampedArray,P=R&&R.prototype,A=S&&m(S),I=x&&m(x),j=Object.prototype,C=s.TypeError,L=_("toStringTag"),N=w("TYPED_ARRAY_TAG"),k="TypedArrayConstructor",D=a&&!!b&&"Opera"!==p(s.opera),U=!1,M={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},B={BigInt64Array:8,BigUint64Array:8},H=function(t){var e=m(t);if(f(e)){var r=T(e);return r&&l(r,k)?r[k]:H(e)}},F=function(t){if(!f(t))return!1;var e=p(t);return l(M,e)||l(B,e)};for(n in M)(i=(o=s[n])&&o.prototype)?O(i)[k]=o:D=!1;for(n in B)(i=(o=s[n])&&o.prototype)&&(O(i)[k]=o);if((!D||!c(A)||A===Function.prototype)&&(A=function(){throw new C("Incorrect invocation")},D))for(n in M)s[n]&&b(s[n],A);if((!D||!I||I===j)&&(I=A.prototype,D))for(n in M)s[n]&&b(s[n].prototype,I);if(D&&m(P)!==I&&b(P,I),u&&!l(I,L))for(n in U=!0,y(I,L,{configurable:!0,get:function(){return f(this)?this[N]:void 0}}),M)s[n]&&d(s[n],N,n);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:D,TYPED_ARRAY_TAG:U&&N,aTypedArray:function(t){if(F(t))return t;throw new C("Target is not a typed array")},aTypedArrayConstructor:function(t){if(c(t)&&(!b||g(A,t)))return t;throw new C(h(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(u){if(r)for(var o in M){var i=s[o];if(i&&l(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}I[t]&&!r||v(I,t,r?e:D&&x[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(u){if(b){if(r)for(n in M)if((o=s[n])&&l(o,t))try{delete o[t]}catch(t){}if(A[t]&&!r)return;try{return v(A,t,r?e:D&&A[t]||e)}catch(t){}}for(n in M)!(o=s[n])||o[t]&&!r||v(o,t,e)}},getTypedArrayConstructor:H,isView:function(t){if(!f(t))return!1;var e=p(t);return"DataView"===e||l(M,e)||l(B,e)},isTypedArray:F,TypedArray:A,TypedArrayPrototype:I}},3999:(t,e,r)=>{"use strict";var n=r(9037),o=r(8844),i=r(7697),a=r(7075),u=r(1236),s=r(5773),c=r(2148),f=r(6045),l=r(3689),p=r(767),h=r(8700),d=r(3126),v=r(9842),y=r(7788),g=r(5477),m=r(1868),b=r(9385),_=r(2872),w=r(6004),E=r(3457),O=r(8758),T=r(5997),S=r(618),x=u.PROPER,R=u.CONFIGURABLE,P="ArrayBuffer",A="DataView",I="prototype",j="Wrong index",C=S.getterFor(P),L=S.getterFor(A),N=S.set,k=n[P],D=k,U=D&&D[I],M=n[A],B=M&&M[I],H=Object.prototype,F=n.Array,q=n.RangeError,G=o(_),z=o([].reverse),W=g.pack,V=g.unpack,$=function(t){return[255&t]},Y=function(t){return[255&t,t>>8&255]},K=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},X=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},J=function(t){return W(y(t),23,4)},Q=function(t){return W(t,52,8)},Z=function(t,e,r){c(t[I],e,{configurable:!0,get:function(){return r(this)[e]}})},tt=function(t,e,r,n){var o=L(t),i=v(r),a=!!n;if(i+e>o.byteLength)throw new q(j);var u=o.bytes,s=i+o.byteOffset,c=w(u,s,s+e);return a?c:z(c)},et=function(t,e,r,n,o,i){var a=L(t),u=v(r),s=n(+o),c=!!i;if(u+e>a.byteLength)throw new q(j);for(var f=a.bytes,l=u+a.byteOffset,p=0;p<e;p++)f[l+p]=s[c?p:e-p-1]};if(a){var rt=x&&k.name!==P;l((function(){k(1)}))&&l((function(){new k(-1)}))&&!l((function(){return new k,new k(1.5),new k(NaN),1!==k.length||rt&&!R}))?rt&&R&&s(k,"name",P):((D=function(t){return p(this,U),E(new k(v(t)),this,D)})[I]=U,U.constructor=D,O(D,k)),b&&m(B)!==H&&b(B,H);var nt=new M(new D(2)),ot=o(B.setInt8);nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(B,{setInt8:function(t,e){ot(this,t,e<<24>>24)},setUint8:function(t,e){ot(this,t,e<<24>>24)}},{unsafe:!0})}else U=(D=function(t){p(this,U);var e=v(t);N(this,{type:P,bytes:G(F(e),0),byteLength:e}),i||(this.byteLength=e,this.detached=!1)})[I],B=(M=function(t,e,r){p(this,B),p(t,U);var n=C(t),o=n.byteLength,a=h(e);if(a<0||a>o)throw new q("Wrong offset");if(a+(r=void 0===r?o-a:d(r))>o)throw new q("Wrong length");N(this,{type:A,buffer:t,byteLength:r,byteOffset:a,bytes:n.bytes}),i||(this.buffer=t,this.byteLength=r,this.byteOffset=a)})[I],i&&(Z(D,"byteLength",C),Z(M,"buffer",L),Z(M,"byteLength",L),Z(M,"byteOffset",L)),f(B,{getInt8:function(t){return tt(this,1,t)[0]<<24>>24},getUint8:function(t){return tt(this,1,t)[0]},getInt16:function(t){var e=tt(this,2,t,arguments.length>1&&arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=tt(this,2,t,arguments.length>1&&arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return X(tt(this,4,t,arguments.length>1&&arguments[1]))},getUint32:function(t){return X(tt(this,4,t,arguments.length>1&&arguments[1]))>>>0},getFloat32:function(t){return V(tt(this,4,t,arguments.length>1&&arguments[1]),23)},getFloat64:function(t){return V(tt(this,8,t,arguments.length>1&&arguments[1]),52)},setInt8:function(t,e){et(this,1,t,$,e)},setUint8:function(t,e){et(this,1,t,$,e)},setInt16:function(t,e){et(this,2,t,Y,e,arguments.length>2&&arguments[2])},setUint16:function(t,e){et(this,2,t,Y,e,arguments.length>2&&arguments[2])},setInt32:function(t,e){et(this,4,t,K,e,arguments.length>2&&arguments[2])},setUint32:function(t,e){et(this,4,t,K,e,arguments.length>2&&arguments[2])},setFloat32:function(t,e){et(this,4,t,J,e,arguments.length>2&&arguments[2])},setFloat64:function(t,e){et(this,8,t,Q,e,arguments.length>2&&arguments[2])}});T(D,P),T(M,A),t.exports={ArrayBuffer:D,DataView:M}},2872:(t,e,r)=>{"use strict";var n=r(690),o=r(7578),i=r(6310);t.exports=function(t){for(var e=n(this),r=i(e),a=arguments.length,u=o(a>1?arguments[1]:void 0,r),s=a>2?arguments[2]:void 0,c=void 0===s?r:o(s,r);c>u;)e[u++]=t;return e}},9976:(t,e,r)=>{"use strict";var n=r(6310);t.exports=function(t,e,r){for(var o=0,i=arguments.length>2?r:n(e),a=new t(i);i>o;)a[o]=e[o++];return a}},4328:(t,e,r)=>{"use strict";var n=r(5290),o=r(7578),i=r(6310),a=function(t){return function(e,r,a){var u=n(e),s=i(u);if(0===s)return!t&&-1;var c,f=o(a,s);if(t&&r!=r){for(;s>f;)if((c=u[f++])!=c)return!0}else for(;s>f;f++)if((t||f in u)&&u[f]===r)return t||f||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},2960:(t,e,r)=>{"use strict";var n=r(4071),o=r(8844),i=r(4413),a=r(690),u=r(6310),s=r(7120),c=o([].push),f=function(t){var e=1===t,r=2===t,o=3===t,f=4===t,l=6===t,p=7===t,h=5===t||l;return function(d,v,y,g){for(var m,b,_=a(d),w=i(_),E=u(w),O=n(v,y),T=0,S=g||s,x=e?S(d,E):r||p?S(d,0):void 0;E>T;T++)if((h||T in w)&&(b=O(m=w[T],T,_),t))if(e)x[T]=b;else if(b)switch(t){case 3:return!0;case 5:return m;case 6:return T;case 2:c(x,m)}else switch(t){case 4:return!1;case 7:c(x,m)}return l?-1:o||f?f:x}};t.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6),filterReject:f(7)}},6004:(t,e,r)=>{"use strict";var n=r(8844);t.exports=n([].slice)},382:(t,e,r)=>{"use strict";var n=r(6004),o=Math.floor,i=function(t,e){var r=t.length;if(r<8)for(var a,u,s=1;s<r;){for(u=s,a=t[s];u&&e(t[u-1],a)>0;)t[u]=t[--u];u!==s++&&(t[u]=a)}else for(var c=o(r/2),f=i(n(t,0,c),e),l=i(n(t,c),e),p=f.length,h=l.length,d=0,v=0;d<p||v<h;)t[d+v]=d<p&&v<h?e(f[d],l[v])<=0?f[d++]:l[v++]:d<p?f[d++]:l[v++];return t};t.exports=i},5271:(t,e,r)=>{"use strict";var n=r(2297),o=r(9429),i=r(8999),a=r(4201)("species"),u=Array;t.exports=function(t){var e;return n(t)&&(e=t.constructor,(o(e)&&(e===u||n(e.prototype))||i(e)&&null===(e=e[a]))&&(e=void 0)),void 0===e?u:e}},7120:(t,e,r)=>{"use strict";var n=r(5271);t.exports=function(t,e){return new(n(t))(0===e?0:e)}},6431:(t,e,r)=>{"use strict";var n=r(4201)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[n]=function(){return this},Array.from(a,(function(){throw 2}))}catch(t){}t.exports=function(t,e){try{if(!e&&!o)return!1}catch(t){return!1}var r=!1;try{var i={};i[n]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(t){}return r}},6648:(t,e,r)=>{"use strict";var n=r(8844),o=n({}.toString),i=n("".slice);t.exports=function(t){return i(o(t),8,-1)}},926:(t,e,r)=>{"use strict";var n=r(3043),o=r(9985),i=r(6648),a=r(4201)("toStringTag"),u=Object,s="Arguments"===i(function(){return arguments}());t.exports=n?i:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=u(t),a))?r:s?i(e):"Object"===(n=i(e))&&o(e.callee)?"Arguments":n}},8758:(t,e,r)=>{"use strict";var n=r(6812),o=r(9152),i=r(2474),a=r(2560);t.exports=function(t,e,r){for(var u=o(e),s=a.f,c=i.f,f=0;f<u.length;f++){var l=u[f];n(t,l)||r&&n(r,l)||s(t,l,c(e,l))}}},1748:(t,e,r)=>{"use strict";var n=r(3689);t.exports=!n((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},7807:t=>{"use strict";t.exports=function(t,e){return{value:t,done:e}}},5773:(t,e,r)=>{"use strict";var n=r(7697),o=r(2560),i=r(5684);t.exports=n?function(t,e,r){return o.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},5684:t=>{"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},6522:(t,e,r)=>{"use strict";var n=r(7697),o=r(2560),i=r(5684);t.exports=function(t,e,r){n?o.f(t,e,i(0,r)):t[e]=r}},2148:(t,e,r)=>{"use strict";var n=r(8702),o=r(2560);t.exports=function(t,e,r){return r.get&&n(r.get,e,{getter:!0}),r.set&&n(r.set,e,{setter:!0}),o.f(t,e,r)}},1880:(t,e,r)=>{"use strict";var n=r(9985),o=r(2560),i=r(8702),a=r(5014);t.exports=function(t,e,r,u){u||(u={});var s=u.enumerable,c=void 0!==u.name?u.name:e;if(n(r)&&i(r,c,u),u.global)s?t[e]=r:a(e,r);else{try{u.unsafe?t[e]&&(s=!0):delete t[e]}catch(t){}s?t[e]=r:o.f(t,e,{value:r,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return t}},6045:(t,e,r)=>{"use strict";var n=r(1880);t.exports=function(t,e,r){for(var o in e)n(t,o,e[o],r);return t}},5014:(t,e,r)=>{"use strict";var n=r(9037),o=Object.defineProperty;t.exports=function(t,e){try{o(n,t,{value:e,configurable:!0,writable:!0})}catch(r){n[t]=e}return e}},7697:(t,e,r)=>{"use strict";var n=r(3689);t.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},6420:(t,e,r)=>{"use strict";var n=r(9037),o=r(8999),i=n.document,a=o(i)&&o(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},6338:t=>{"use strict";t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3265:(t,e,r)=>{"use strict";var n=r(6420)("span").classList,o=n&&n.constructor&&n.constructor.prototype;t.exports=o===Object.prototype?void 0:o},7365:(t,e,r)=>{"use strict";var n=r(71).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},2532:(t,e,r)=>{"use strict";var n=r(8563),o=r(806);t.exports=!n&&!o&&"object"==typeof window&&"object"==typeof document},8563:t=>{"use strict";t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},7298:(t,e,r)=>{"use strict";var n=r(71);t.exports=/MSIE|Trident/.test(n)},806:(t,e,r)=>{"use strict";var n=r(9037),o=r(6648);t.exports="process"===o(n.process)},71:t=>{"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},3615:(t,e,r)=>{"use strict";var n,o,i=r(9037),a=r(71),u=i.process,s=i.Deno,c=u&&u.versions||s&&s.version,f=c&&c.v8;f&&(o=(n=f.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!o&&a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(o=+n[1]),t.exports=o},7922:(t,e,r)=>{"use strict";var n=r(71).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},2739:t=>{"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},9989:(t,e,r)=>{"use strict";var n=r(9037),o=r(2474).f,i=r(5773),a=r(1880),u=r(5014),s=r(8758),c=r(5266);t.exports=function(t,e){var r,f,l,p,h,d=t.target,v=t.global,y=t.stat;if(r=v?n:y?n[d]||u(d,{}):n[d]&&n[d].prototype)for(f in e){if(p=e[f],l=t.dontCallGetSet?(h=o(r,f))&&h.value:r[f],!c(v?f:d+(y?".":"#")+f,t.forced)&&void 0!==l){if(typeof p==typeof l)continue;s(p,l)}(t.sham||l&&l.sham)&&i(p,"sham",!0),a(r,f,p,t)}}},3689:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},8678:(t,e,r)=>{"use strict";r(4043);var n=r(2615),o=r(1880),i=r(6308),a=r(3689),u=r(4201),s=r(5773),c=u("species"),f=RegExp.prototype;t.exports=function(t,e,r,l){var p=u(t),h=!a((function(){var e={};return e[p]=function(){return 7},7!==""[t](e)})),d=h&&!a((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[c]=function(){return r},r.flags="",r[p]=/./[p]),r.exec=function(){return e=!0,null},r[p](""),!e}));if(!h||!d||r){var v=/./[p],y=e(p,""[t],(function(t,e,r,o,a){var u=e.exec;return u===i||u===f.exec?h&&!a?{done:!0,value:n(v,e,r,o)}:{done:!0,value:n(t,r,e,o)}:{done:!1}}));o(String.prototype,t,y[0]),o(f,p,y[1])}l&&s(f[p],"sham",!0)}},1735:(t,e,r)=>{"use strict";var n=r(7215),o=Function.prototype,i=o.apply,a=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(n?a.bind(i):function(){return a.apply(i,arguments)})},4071:(t,e,r)=>{"use strict";var n=r(6576),o=r(509),i=r(7215),a=n(n.bind);t.exports=function(t,e){return o(t),void 0===e?t:i?a(t,e):function(){return t.apply(e,arguments)}}},7215:(t,e,r)=>{"use strict";var n=r(3689);t.exports=!n((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},2615:(t,e,r)=>{"use strict";var n=r(7215),o=Function.prototype.call;t.exports=n?o.bind(o):function(){return o.apply(o,arguments)}},1236:(t,e,r)=>{"use strict";var n=r(7697),o=r(6812),i=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,u=o(i,"name"),s=u&&"something"===function(){}.name,c=u&&(!n||n&&a(i,"name").configurable);t.exports={EXISTS:u,PROPER:s,CONFIGURABLE:c}},2743:(t,e,r)=>{"use strict";var n=r(8844),o=r(509);t.exports=function(t,e,r){try{return n(o(Object.getOwnPropertyDescriptor(t,e)[r]))}catch(t){}}},6576:(t,e,r)=>{"use strict";var n=r(6648),o=r(8844);t.exports=function(t){if("Function"===n(t))return o(t)}},8844:(t,e,r)=>{"use strict";var n=r(7215),o=Function.prototype,i=o.call,a=n&&o.bind.bind(i,i);t.exports=n?a:function(t){return function(){return i.apply(t,arguments)}}},6058:(t,e,r)=>{"use strict";var n=r(9037),o=r(9985);t.exports=function(t,e){return arguments.length<2?(r=n[t],o(r)?r:void 0):n[t]&&n[t][e];var r}},1664:(t,e,r)=>{"use strict";var n=r(926),o=r(4849),i=r(981),a=r(9478),u=r(4201)("iterator");t.exports=function(t){if(!i(t))return o(t,u)||o(t,"@@iterator")||a[n(t)]}},5185:(t,e,r)=>{"use strict";var n=r(2615),o=r(509),i=r(5027),a=r(3691),u=r(1664),s=TypeError;t.exports=function(t,e){var r=arguments.length<2?u(t):e;if(o(r))return i(n(r,t));throw new s(a(t)+" is not iterable")}},4849:(t,e,r)=>{"use strict";var n=r(509),o=r(981);t.exports=function(t,e){var r=t[e];return o(r)?void 0:n(r)}},7017:(t,e,r)=>{"use strict";var n=r(8844),o=r(690),i=Math.floor,a=n("".charAt),u=n("".replace),s=n("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,f=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,r,n,l,p){var h=r+t.length,d=n.length,v=f;return void 0!==l&&(l=o(l),v=c),u(p,v,(function(o,u){var c;switch(a(u,0)){case"$":return"$";case"&":return t;case"`":return s(e,0,r);case"'":return s(e,h);case"<":c=l[s(u,1,-1)];break;default:var f=+u;if(0===f)return o;if(f>d){var p=i(f/10);return 0===p?o:p<=d?void 0===n[p-1]?a(u,1):n[p-1]+a(u,1):o}c=n[f-1]}return void 0===c?"":c}))}},9037:function(t,e,r){"use strict";var n=function(t){return t&&t.Math===Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||n("object"==typeof this&&this)||function(){return this}()||Function("return this")()},6812:(t,e,r)=>{"use strict";var n=r(8844),o=r(690),i=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return i(o(t),e)}},7248:t=>{"use strict";t.exports={}},2688:(t,e,r)=>{"use strict";var n=r(6058);t.exports=n("document","documentElement")},8506:(t,e,r)=>{"use strict";var n=r(7697),o=r(3689),i=r(6420);t.exports=!n&&!o((function(){return 7!==Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},5477:t=>{"use strict";var e=Array,r=Math.abs,n=Math.pow,o=Math.floor,i=Math.log,a=Math.LN2;t.exports={pack:function(t,u,s){var c,f,l,p=e(s),h=8*s-u-1,d=(1<<h)-1,v=d>>1,y=23===u?n(2,-24)-n(2,-77):0,g=t<0||0===t&&1/t<0?1:0,m=0;for((t=r(t))!=t||t===1/0?(f=t!=t?1:0,c=d):(c=o(i(t)/a),t*(l=n(2,-c))<1&&(c--,l*=2),(t+=c+v>=1?y/l:y*n(2,1-v))*l>=2&&(c++,l/=2),c+v>=d?(f=0,c=d):c+v>=1?(f=(t*l-1)*n(2,u),c+=v):(f=t*n(2,v-1)*n(2,u),c=0));u>=8;)p[m++]=255&f,f/=256,u-=8;for(c=c<<u|f,h+=u;h>0;)p[m++]=255&c,c/=256,h-=8;return p[--m]|=128*g,p},unpack:function(t,e){var r,o=t.length,i=8*o-e-1,a=(1<<i)-1,u=a>>1,s=i-7,c=o-1,f=t[c--],l=127&f;for(f>>=7;s>0;)l=256*l+t[c--],s-=8;for(r=l&(1<<-s)-1,l>>=-s,s+=e;s>0;)r=256*r+t[c--],s-=8;if(0===l)l=1-u;else{if(l===a)return r?NaN:f?-1/0:1/0;r+=n(2,e),l-=u}return(f?-1:1)*r*n(2,l-e)}}},4413:(t,e,r)=>{"use strict";var n=r(8844),o=r(3689),i=r(6648),a=Object,u=n("".split);t.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(t){return"String"===i(t)?u(t,""):a(t)}:a},3457:(t,e,r)=>{"use strict";var n=r(9985),o=r(8999),i=r(9385);t.exports=function(t,e,r){var a,u;return i&&n(a=e.constructor)&&a!==r&&o(u=a.prototype)&&u!==r.prototype&&i(t,u),t}},6738:(t,e,r)=>{"use strict";var n=r(8844),o=r(9985),i=r(4091),a=n(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return a(t)}),t.exports=i.inspectSource},618:(t,e,r)=>{"use strict";var n,o,i,a=r(9834),u=r(9037),s=r(8999),c=r(5773),f=r(6812),l=r(4091),p=r(2713),h=r(7248),d="Object already initialized",v=u.TypeError,y=u.WeakMap;if(a||l.state){var g=l.state||(l.state=new y);g.get=g.get,g.has=g.has,g.set=g.set,n=function(t,e){if(g.has(t))throw new v(d);return e.facade=t,g.set(t,e),e},o=function(t){return g.get(t)||{}},i=function(t){return g.has(t)}}else{var m=p("state");h[m]=!0,n=function(t,e){if(f(t,m))throw new v(d);return e.facade=t,c(t,m,e),e},o=function(t){return f(t,m)?t[m]:{}},i=function(t){return f(t,m)}}t.exports={set:n,get:o,has:i,enforce:function(t){return i(t)?o(t):n(t,{})},getterFor:function(t){return function(e){var r;if(!s(e)||(r=o(e)).type!==t)throw new v("Incompatible receiver, "+t+" required");return r}}}},3292:(t,e,r)=>{"use strict";var n=r(4201),o=r(9478),i=n("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||a[i]===t)}},2297:(t,e,r)=>{"use strict";var n=r(6648);t.exports=Array.isArray||function(t){return"Array"===n(t)}},9401:(t,e,r)=>{"use strict";var n=r(926);t.exports=function(t){var e=n(t);return"BigInt64Array"===e||"BigUint64Array"===e}},9985:t=>{"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},9429:(t,e,r)=>{"use strict";var n=r(8844),o=r(3689),i=r(9985),a=r(926),u=r(6058),s=r(6738),c=function(){},f=u("Reflect","construct"),l=/^\s*(?:class|function)\b/,p=n(l.exec),h=!l.test(c),d=function(t){if(!i(t))return!1;try{return f(c,[],t),!0}catch(t){return!1}},v=function(t){if(!i(t))return!1;switch(a(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return h||!!p(l,s(t))}catch(t){return!0}};v.sham=!0,t.exports=!f||o((function(){var t;return d(d.call)||!d(Object)||!d((function(){t=!0}))||t}))?v:d},5266:(t,e,r)=>{"use strict";var n=r(3689),o=r(9985),i=/#|\.prototype\./,a=function(t,e){var r=s[u(t)];return r===f||r!==c&&(o(e)?n(e):!!e)},u=a.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=a.data={},c=a.NATIVE="N",f=a.POLYFILL="P";t.exports=a},1973:(t,e,r)=>{"use strict";var n=r(8999),o=Math.floor;t.exports=Number.isInteger||function(t){return!n(t)&&isFinite(t)&&o(t)===t}},981:t=>{"use strict";t.exports=function(t){return null==t}},8999:(t,e,r)=>{"use strict";var n=r(9985);t.exports=function(t){return"object"==typeof t?null!==t:n(t)}},598:(t,e,r)=>{"use strict";var n=r(8999);t.exports=function(t){return n(t)||null===t}},3931:t=>{"use strict";t.exports=!1},734:(t,e,r)=>{"use strict";var n=r(6058),o=r(9985),i=r(3622),a=r(9525),u=Object;t.exports=a?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return o(e)&&i(e.prototype,u(t))}},8734:(t,e,r)=>{"use strict";var n=r(4071),o=r(2615),i=r(5027),a=r(3691),u=r(3292),s=r(6310),c=r(3622),f=r(5185),l=r(1664),p=r(2125),h=TypeError,d=function(t,e){this.stopped=t,this.result=e},v=d.prototype;t.exports=function(t,e,r){var y,g,m,b,_,w,E,O=r&&r.that,T=!(!r||!r.AS_ENTRIES),S=!(!r||!r.IS_RECORD),x=!(!r||!r.IS_ITERATOR),R=!(!r||!r.INTERRUPTED),P=n(e,O),A=function(t){return y&&p(y,"normal",t),new d(!0,t)},I=function(t){return T?(i(t),R?P(t[0],t[1],A):P(t[0],t[1])):R?P(t,A):P(t)};if(S)y=t.iterator;else if(x)y=t;else{if(!(g=l(t)))throw new h(a(t)+" is not iterable");if(u(g)){for(m=0,b=s(t);b>m;m++)if((_=I(t[m]))&&c(v,_))return _;return new d(!1)}y=f(t,g)}for(w=S?t.next:y.next;!(E=o(w,y)).done;){try{_=I(E.value)}catch(t){p(y,"throw",t)}if("object"==typeof _&&_&&c(v,_))return _}return new d(!1)}},2125:(t,e,r)=>{"use strict";var n=r(2615),o=r(5027),i=r(4849);t.exports=function(t,e,r){var a,u;o(t);try{if(!(a=i(t,"return"))){if("throw"===e)throw r;return r}a=n(a,t)}catch(t){u=!0,a=t}if("throw"===e)throw r;if(u)throw a;return o(a),r}},974:(t,e,r)=>{"use strict";var n=r(2013).IteratorPrototype,o=r(5391),i=r(5684),a=r(5997),u=r(9478),s=function(){return this};t.exports=function(t,e,r,c){var f=e+" Iterator";return t.prototype=o(n,{next:i(+!c,r)}),a(t,f,!1,!0),u[f]=s,t}},1934:(t,e,r)=>{"use strict";var n=r(9989),o=r(2615),i=r(3931),a=r(1236),u=r(9985),s=r(974),c=r(1868),f=r(9385),l=r(5997),p=r(5773),h=r(1880),d=r(4201),v=r(9478),y=r(2013),g=a.PROPER,m=a.CONFIGURABLE,b=y.IteratorPrototype,_=y.BUGGY_SAFARI_ITERATORS,w=d("iterator"),E="keys",O="values",T="entries",S=function(){return this};t.exports=function(t,e,r,a,d,y,x){s(r,e,a);var R,P,A,I=function(t){if(t===d&&k)return k;if(!_&&t&&t in L)return L[t];switch(t){case E:case O:case T:return function(){return new r(this,t)}}return function(){return new r(this)}},j=e+" Iterator",C=!1,L=t.prototype,N=L[w]||L["@@iterator"]||d&&L[d],k=!_&&N||I(d),D="Array"===e&&L.entries||N;if(D&&(R=c(D.call(new t)))!==Object.prototype&&R.next&&(i||c(R)===b||(f?f(R,b):u(R[w])||h(R,w,S)),l(R,j,!0,!0),i&&(v[j]=S)),g&&d===O&&N&&N.name!==O&&(!i&&m?p(L,"name",O):(C=!0,k=function(){return o(N,this)})),d)if(P={values:I(O),keys:y?k:I(E),entries:I(T)},x)for(A in P)(_||C||!(A in L))&&h(L,A,P[A]);else n({target:e,proto:!0,forced:_||C},P);return i&&!x||L[w]===k||h(L,w,k,{name:d}),v[e]=k,P}},2013:(t,e,r)=>{"use strict";var n,o,i,a=r(3689),u=r(9985),s=r(8999),c=r(5391),f=r(1868),l=r(1880),p=r(4201),h=r(3931),d=p("iterator"),v=!1;[].keys&&("next"in(i=[].keys())?(o=f(f(i)))!==Object.prototype&&(n=o):v=!0),!s(n)||a((function(){var t={};return n[d].call(t)!==t}))?n={}:h&&(n=c(n)),u(n[d])||l(n,d,(function(){return this})),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:v}},9478:t=>{"use strict";t.exports={}},6310:(t,e,r)=>{"use strict";var n=r(3126);t.exports=function(t){return n(t.length)}},8702:(t,e,r)=>{"use strict";var n=r(8844),o=r(3689),i=r(9985),a=r(6812),u=r(7697),s=r(1236).CONFIGURABLE,c=r(6738),f=r(618),l=f.enforce,p=f.get,h=String,d=Object.defineProperty,v=n("".slice),y=n("".replace),g=n([].join),m=u&&!o((function(){return 8!==d((function(){}),"length",{value:8}).length})),b=String(String).split("String"),_=t.exports=function(t,e,r){"Symbol("===v(h(e),0,7)&&(e="["+y(h(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!a(t,"name")||s&&t.name!==e)&&(u?d(t,"name",{value:e,configurable:!0}):t.name=e),m&&r&&a(r,"arity")&&t.length!==r.arity&&d(t,"length",{value:r.arity});try{r&&a(r,"constructor")&&r.constructor?u&&d(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=l(t);return a(n,"source")||(n.source=g(b,"string"==typeof e?e:"")),t};Function.prototype.toString=_((function(){return i(this)&&p(this).source||c(this)}),"toString")},134:(t,e,r)=>{"use strict";var n=r(5680),o=Math.abs,i=2220446049250313e-31,a=1/i;t.exports=function(t,e,r,u){var s=+t,c=o(s),f=n(s);if(c<u)return f*function(t){return t+a-a}(c/u/e)*u*e;var l=(1+e/i)*c,p=l-(l-c);return p>r||p!=p?f*(1/0):f*p}},7788:(t,e,r)=>{"use strict";var n=r(134);t.exports=Math.fround||function(t){return n(t,1.1920928955078125e-7,34028234663852886e22,11754943508222875e-54)}},5680:t=>{"use strict";t.exports=Math.sign||function(t){var e=+t;return 0===e||e!=e?e:e<0?-1:1}},8828:t=>{"use strict";var e=Math.ceil,r=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?r:e)(n)}},8742:(t,e,r)=>{"use strict";var n=r(509),o=TypeError,i=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw new o("Bad Promise constructor");e=t,r=n})),this.resolve=n(e),this.reject=n(r)};t.exports.f=function(t){return new i(t)}},5391:(t,e,r)=>{"use strict";var n,o=r(5027),i=r(8920),a=r(2739),u=r(7248),s=r(2688),c=r(6420),f=r(2713),l="prototype",p="script",h=f("IE_PROTO"),d=function(){},v=function(t){return"<"+p+">"+t+"</"+p+">"},y=function(t){t.write(v("")),t.close();var e=t.parentWindow.Object;return t=null,e},g=function(){try{n=new ActiveXObject("htmlfile")}catch(t){}var t,e,r;g="undefined"!=typeof document?document.domain&&n?y(n):(e=c("iframe"),r="java"+p+":",e.style.display="none",s.appendChild(e),e.src=String(r),(t=e.contentWindow.document).open(),t.write(v("document.F=Object")),t.close(),t.F):y(n);for(var o=a.length;o--;)delete g[l][a[o]];return g()};u[h]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(d[l]=o(t),r=new d,d[l]=null,r[h]=t):r=g(),void 0===e?r:i.f(r,e)}},8920:(t,e,r)=>{"use strict";var n=r(7697),o=r(5648),i=r(2560),a=r(5027),u=r(5290),s=r(300);e.f=n&&!o?Object.defineProperties:function(t,e){a(t);for(var r,n=u(e),o=s(e),c=o.length,f=0;c>f;)i.f(t,r=o[f++],n[r]);return t}},2560:(t,e,r)=>{"use strict";var n=r(7697),o=r(8506),i=r(5648),a=r(5027),u=r(8360),s=TypeError,c=Object.defineProperty,f=Object.getOwnPropertyDescriptor,l="enumerable",p="configurable",h="writable";e.f=n?i?function(t,e,r){if(a(t),e=u(e),a(r),"function"==typeof t&&"prototype"===e&&"value"in r&&h in r&&!r[h]){var n=f(t,e);n&&n[h]&&(t[e]=r.value,r={configurable:p in r?r[p]:n[p],enumerable:l in r?r[l]:n[l],writable:!1})}return c(t,e,r)}:c:function(t,e,r){if(a(t),e=u(e),a(r),o)try{return c(t,e,r)}catch(t){}if("get"in r||"set"in r)throw new s("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},2474:(t,e,r)=>{"use strict";var n=r(7697),o=r(2615),i=r(9556),a=r(5684),u=r(5290),s=r(8360),c=r(6812),f=r(8506),l=Object.getOwnPropertyDescriptor;e.f=n?l:function(t,e){if(t=u(t),e=s(e),f)try{return l(t,e)}catch(t){}if(c(t,e))return a(!o(i.f,t,e),t[e])}},2741:(t,e,r)=>{"use strict";var n=r(4948),o=r(2739).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,o)}},7518:(t,e)=>{"use strict";e.f=Object.getOwnPropertySymbols},1868:(t,e,r)=>{"use strict";var n=r(6812),o=r(9985),i=r(690),a=r(2713),u=r(1748),s=a("IE_PROTO"),c=Object,f=c.prototype;t.exports=u?c.getPrototypeOf:function(t){var e=i(t);if(n(e,s))return e[s];var r=e.constructor;return o(r)&&e instanceof r?r.prototype:e instanceof c?f:null}},3622:(t,e,r)=>{"use strict";var n=r(8844);t.exports=n({}.isPrototypeOf)},4948:(t,e,r)=>{"use strict";var n=r(8844),o=r(6812),i=r(5290),a=r(4328).indexOf,u=r(7248),s=n([].push);t.exports=function(t,e){var r,n=i(t),c=0,f=[];for(r in n)!o(u,r)&&o(n,r)&&s(f,r);for(;e.length>c;)o(n,r=e[c++])&&(~a(f,r)||s(f,r));return f}},300:(t,e,r)=>{"use strict";var n=r(4948),o=r(2739);t.exports=Object.keys||function(t){return n(t,o)}},9556:(t,e)=>{"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,o=n&&!r.call({1:2},1);e.f=o?function(t){var e=n(this,t);return!!e&&e.enumerable}:r},9385:(t,e,r)=>{"use strict";var n=r(2743),o=r(8999),i=r(4684),a=r(3550);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=n(Object.prototype,"__proto__","set"))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return i(r),a(n),o(r)?(e?t(r,n):r.__proto__=n,r):r}}():void 0)},5899:(t,e,r)=>{"use strict";var n=r(2615),o=r(9985),i=r(8999),a=TypeError;t.exports=function(t,e){var r,u;if("string"===e&&o(r=t.toString)&&!i(u=n(r,t)))return u;if(o(r=t.valueOf)&&!i(u=n(r,t)))return u;if("string"!==e&&o(r=t.toString)&&!i(u=n(r,t)))return u;throw new a("Can't convert object to primitive value")}},9152:(t,e,r)=>{"use strict";var n=r(6058),o=r(8844),i=r(2741),a=r(7518),u=r(5027),s=o([].concat);t.exports=n("Reflect","ownKeys")||function(t){var e=i.f(u(t)),r=a.f;return r?s(e,r(t)):e}},9302:t=>{"use strict";t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},7073:(t,e,r)=>{"use strict";var n=r(9037),o=r(7919),i=r(9985),a=r(5266),u=r(6738),s=r(4201),c=r(2532),f=r(8563),l=r(3931),p=r(3615),h=o&&o.prototype,d=s("species"),v=!1,y=i(n.PromiseRejectionEvent),g=a("Promise",(function(){var t=u(o),e=t!==String(o);if(!e&&66===p)return!0;if(l&&(!h.catch||!h.finally))return!0;if(!p||p<51||!/native code/.test(t)){var r=new o((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[d]=n,!(v=r.then((function(){}))instanceof n))return!0}return!e&&(c||f)&&!y}));t.exports={CONSTRUCTOR:g,REJECTION_EVENT:y,SUBCLASSING:v}},7919:(t,e,r)=>{"use strict";var n=r(9037);t.exports=n.Promise},2945:(t,e,r)=>{"use strict";var n=r(5027),o=r(8999),i=r(8742);t.exports=function(t,e){if(n(t),o(e)&&e.constructor===t)return e;var r=i.f(t);return(0,r.resolve)(e),r.promise}},562:(t,e,r)=>{"use strict";var n=r(7919),o=r(6431),i=r(7073).CONSTRUCTOR;t.exports=i||!o((function(t){n.all(t).then(void 0,(function(){}))}))},6100:(t,e,r)=>{"use strict";var n=r(2615),o=r(5027),i=r(9985),a=r(6648),u=r(6308),s=TypeError;t.exports=function(t,e){var r=t.exec;if(i(r)){var c=n(r,t,e);return null!==c&&o(c),c}if("RegExp"===a(t))return n(u,t,e);throw new s("RegExp#exec called on incompatible receiver")}},6308:(t,e,r)=>{"use strict";var n,o,i=r(2615),a=r(8844),u=r(4327),s=r(9633),c=r(7901),f=r(3430),l=r(5391),p=r(618).get,h=r(2100),d=r(6422),v=f("native-string-replace",String.prototype.replace),y=RegExp.prototype.exec,g=y,m=a("".charAt),b=a("".indexOf),_=a("".replace),w=a("".slice),E=(o=/b*/g,i(y,n=/a/,"a"),i(y,o,"a"),0!==n.lastIndex||0!==o.lastIndex),O=c.BROKEN_CARET,T=void 0!==/()??/.exec("")[1];(E||T||O||h||d)&&(g=function(t){var e,r,n,o,a,c,f,h=this,d=p(h),S=u(t),x=d.raw;if(x)return x.lastIndex=h.lastIndex,e=i(g,x,S),h.lastIndex=x.lastIndex,e;var R=d.groups,P=O&&h.sticky,A=i(s,h),I=h.source,j=0,C=S;if(P&&(A=_(A,"y",""),-1===b(A,"g")&&(A+="g"),C=w(S,h.lastIndex),h.lastIndex>0&&(!h.multiline||h.multiline&&"\n"!==m(S,h.lastIndex-1))&&(I="(?: "+I+")",C=" "+C,j++),r=new RegExp("^(?:"+I+")",A)),T&&(r=new RegExp("^"+I+"$(?!\\s)",A)),E&&(n=h.lastIndex),o=i(y,P?r:h,C),P?o?(o.input=w(o.input,j),o[0]=w(o[0],j),o.index=h.lastIndex,h.lastIndex+=o[0].length):h.lastIndex=0:E&&o&&(h.lastIndex=h.global?o.index+o[0].length:n),T&&o&&o.length>1&&i(v,o[0],r,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(o[a]=void 0)})),o&&R)for(o.groups=c=l(null),a=0;a<R.length;a++)c[(f=R[a])[0]]=o[f[1]];return o}),t.exports=g},9633:(t,e,r)=>{"use strict";var n=r(5027);t.exports=function(){var t=n(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},7901:(t,e,r)=>{"use strict";var n=r(3689),o=r(9037).RegExp,i=n((function(){var t=o("a","y");return t.lastIndex=2,null!==t.exec("abcd")})),a=i||n((function(){return!o("a","y").sticky})),u=i||n((function(){var t=o("^r","gy");return t.lastIndex=2,null!==t.exec("str")}));t.exports={BROKEN_CARET:u,MISSED_STICKY:a,UNSUPPORTED_Y:i}},2100:(t,e,r)=>{"use strict";var n=r(3689),o=r(9037).RegExp;t.exports=n((function(){var t=o(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)}))},6422:(t,e,r)=>{"use strict";var n=r(3689),o=r(9037).RegExp;t.exports=n((function(){var t=o("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},4684:(t,e,r)=>{"use strict";var n=r(981),o=TypeError;t.exports=function(t){if(n(t))throw new o("Can't call method on "+t);return t}},517:(t,e,r)=>{"use strict";var n=r(9037),o=r(7697),i=Object.getOwnPropertyDescriptor;t.exports=function(t){if(!o)return n[t];var e=i(n,t);return e&&e.value}},4241:(t,e,r)=>{"use strict";var n=r(6058),o=r(2148),i=r(4201),a=r(7697),u=i("species");t.exports=function(t){var e=n(t);a&&e&&!e[u]&&o(e,u,{configurable:!0,get:function(){return this}})}},5997:(t,e,r)=>{"use strict";var n=r(2560).f,o=r(6812),i=r(4201)("toStringTag");t.exports=function(t,e,r){t&&!r&&(t=t.prototype),t&&!o(t,i)&&n(t,i,{configurable:!0,value:e})}},2713:(t,e,r)=>{"use strict";var n=r(3430),o=r(4630),i=n("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},4091:(t,e,r)=>{"use strict";var n=r(3931),o=r(9037),i=r(5014),a="__core-js_shared__",u=t.exports=o[a]||i(a,{});(u.versions||(u.versions=[])).push({version:"3.37.1",mode:n?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"})},3430:(t,e,r)=>{"use strict";var n=r(4091);t.exports=function(t,e){return n[t]||(n[t]=e||{})}},6373:(t,e,r)=>{"use strict";var n=r(5027),o=r(2655),i=r(981),a=r(4201)("species");t.exports=function(t,e){var r,u=n(t).constructor;return void 0===u||i(r=n(u)[a])?e:o(r)}},730:(t,e,r)=>{"use strict";var n=r(8844),o=r(8700),i=r(4327),a=r(4684),u=n("".charAt),s=n("".charCodeAt),c=n("".slice),f=function(t){return function(e,r){var n,f,l=i(a(e)),p=o(r),h=l.length;return p<0||p>=h?t?"":void 0:(n=s(l,p))<55296||n>56319||p+1===h||(f=s(l,p+1))<56320||f>57343?t?u(l,p):n:t?c(l,p,p+2):f-56320+(n-55296<<10)+65536}};t.exports={codeAt:f(!1),charAt:f(!0)}},5984:(t,e,r)=>{"use strict";var n=r(1236).PROPER,o=r(3689),i=r(6350);t.exports=function(t){return o((function(){return!!i[t]()||"​᠎"!=="​᠎"[t]()||n&&i[t].name!==t}))}},1435:(t,e,r)=>{"use strict";var n=r(8844),o=r(4684),i=r(4327),a=r(6350),u=n("".replace),s=RegExp("^["+a+"]+"),c=RegExp("(^|[^"+a+"])["+a+"]+$"),f=function(t){return function(e){var r=i(o(e));return 1&t&&(r=u(r,s,"")),2&t&&(r=u(r,c,"$1")),r}};t.exports={start:f(1),end:f(2),trim:f(3)}},146:(t,e,r)=>{"use strict";var n=r(3615),o=r(3689),i=r(9037).String;t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol("symbol detection");return!i(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},7578:(t,e,r)=>{"use strict";var n=r(8700),o=Math.max,i=Math.min;t.exports=function(t,e){var r=n(t);return r<0?o(r+e,0):i(r,e)}},1530:(t,e,r)=>{"use strict";var n=r(8732),o=TypeError;t.exports=function(t){var e=n(t,"number");if("number"==typeof e)throw new o("Can't convert number to bigint");return BigInt(e)}},9842:(t,e,r)=>{"use strict";var n=r(8700),o=r(3126),i=RangeError;t.exports=function(t){if(void 0===t)return 0;var e=n(t),r=o(e);if(e!==r)throw new i("Wrong length or index");return r}},5290:(t,e,r)=>{"use strict";var n=r(4413),o=r(4684);t.exports=function(t){return n(o(t))}},8700:(t,e,r)=>{"use strict";var n=r(8828);t.exports=function(t){var e=+t;return e!=e||0===e?0:n(e)}},3126:(t,e,r)=>{"use strict";var n=r(8700),o=Math.min;t.exports=function(t){var e=n(t);return e>0?o(e,9007199254740991):0}},690:(t,e,r)=>{"use strict";var n=r(4684),o=Object;t.exports=function(t){return o(n(t))}},3250:(t,e,r)=>{"use strict";var n=r(5904),o=RangeError;t.exports=function(t,e){var r=n(t);if(r%e)throw new o("Wrong offset");return r}},5904:(t,e,r)=>{"use strict";var n=r(8700),o=RangeError;t.exports=function(t){var e=n(t);if(e<0)throw new o("The argument can't be less than 0");return e}},8732:(t,e,r)=>{"use strict";var n=r(2615),o=r(8999),i=r(734),a=r(4849),u=r(5899),s=r(4201),c=TypeError,f=s("toPrimitive");t.exports=function(t,e){if(!o(t)||i(t))return t;var r,s=a(t,f);if(s){if(void 0===e&&(e="default"),r=n(s,t,e),!o(r)||i(r))return r;throw new c("Can't convert object to primitive value")}return void 0===e&&(e="number"),u(t,e)}},8360:(t,e,r)=>{"use strict";var n=r(8732),o=r(734);t.exports=function(t){var e=n(t,"string");return o(e)?e:e+""}},3043:(t,e,r)=>{"use strict";var n={};n[r(4201)("toStringTag")]="z",t.exports="[object z]"===String(n)},4327:(t,e,r)=>{"use strict";var n=r(926),o=String;t.exports=function(t){if("Symbol"===n(t))throw new TypeError("Cannot convert a Symbol value to a string");return o(t)}},7191:t=>{"use strict";var e=Math.round;t.exports=function(t){var r=e(t);return r<0?0:r>255?255:255&r}},3691:t=>{"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},1158:(t,e,r)=>{"use strict";var n=r(9989),o=r(9037),i=r(2615),a=r(7697),u=r(9800),s=r(4872),c=r(3999),f=r(767),l=r(5684),p=r(5773),h=r(1973),d=r(3126),v=r(9842),y=r(3250),g=r(7191),m=r(8360),b=r(6812),_=r(926),w=r(8999),E=r(734),O=r(5391),T=r(3622),S=r(9385),x=r(2741).f,R=r(1304),P=r(2960).forEach,A=r(4241),I=r(2148),j=r(2560),C=r(2474),L=r(9976),N=r(618),k=r(3457),D=N.get,U=N.set,M=N.enforce,B=j.f,H=C.f,F=o.RangeError,q=c.ArrayBuffer,G=q.prototype,z=c.DataView,W=s.NATIVE_ARRAY_BUFFER_VIEWS,V=s.TYPED_ARRAY_TAG,$=s.TypedArray,Y=s.TypedArrayPrototype,K=s.isTypedArray,X="BYTES_PER_ELEMENT",J="Wrong length",Q=function(t,e){I(t,e,{configurable:!0,get:function(){return D(this)[e]}})},Z=function(t){var e;return T(G,t)||"ArrayBuffer"===(e=_(t))||"SharedArrayBuffer"===e},tt=function(t,e){return K(t)&&!E(e)&&e in t&&h(+e)&&e>=0},et=function(t,e){return e=m(e),tt(t,e)?l(2,t[e]):H(t,e)},rt=function(t,e,r){return e=m(e),!(tt(t,e)&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?B(t,e,r):(t[e]=r.value,t)};a?(W||(C.f=et,j.f=rt,Q(Y,"buffer"),Q(Y,"byteOffset"),Q(Y,"byteLength"),Q(Y,"length")),n({target:"Object",stat:!0,forced:!W},{getOwnPropertyDescriptor:et,defineProperty:rt}),t.exports=function(t,e,r){var a=t.match(/\d+/)[0]/8,s=t+(r?"Clamped":"")+"Array",c="get"+t,l="set"+t,h=o[s],m=h,b=m&&m.prototype,_={},E=function(t,e){B(t,e,{get:function(){return function(t,e){var r=D(t);return r.view[c](e*a+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,n){var o=D(t);o.view[l](e*a+o.byteOffset,r?g(n):n,!0)}(this,e,t)},enumerable:!0})};W?u&&(m=e((function(t,e,r,n){return f(t,b),k(w(e)?Z(e)?void 0!==n?new h(e,y(r,a),n):void 0!==r?new h(e,y(r,a)):new h(e):K(e)?L(m,e):i(R,m,e):new h(v(e)),t,m)})),S&&S(m,$),P(x(h),(function(t){t in m||p(m,t,h[t])})),m.prototype=b):(m=e((function(t,e,r,n){f(t,b);var o,u,s,c=0,l=0;if(w(e)){if(!Z(e))return K(e)?L(m,e):i(R,m,e);o=e,l=y(r,a);var p=e.byteLength;if(void 0===n){if(p%a)throw new F(J);if((u=p-l)<0)throw new F(J)}else if((u=d(n)*a)+l>p)throw new F(J);s=u/a}else s=v(e),o=new q(u=s*a);for(U(t,{buffer:o,byteOffset:l,byteLength:u,length:s,view:new z(o)});c<s;)E(t,c++)})),S&&S(m,$),b=m.prototype=O(Y)),b.constructor!==m&&p(b,"constructor",m),M(b).TypedArrayConstructor=m,V&&p(b,V,s);var T=m!==h;_[s]=m,n({global:!0,constructor:!0,forced:T,sham:!W},_),X in m||p(m,X,a),X in b||p(b,X,a),A(s)}):t.exports=function(){}},9800:(t,e,r)=>{"use strict";var n=r(9037),o=r(3689),i=r(6431),a=r(4872).NATIVE_ARRAY_BUFFER_VIEWS,u=n.ArrayBuffer,s=n.Int8Array;t.exports=!a||!o((function(){s(1)}))||!o((function(){new s(-1)}))||!i((function(t){new s,new s(null),new s(1.5),new s(t)}),!0)||o((function(){return 1!==new s(new u(2),1,void 0).length}))},1304:(t,e,r)=>{"use strict";var n=r(4071),o=r(2615),i=r(2655),a=r(690),u=r(6310),s=r(5185),c=r(1664),f=r(3292),l=r(9401),p=r(4872).aTypedArrayConstructor,h=r(1530);t.exports=function(t){var e,r,d,v,y,g,m,b,_=i(this),w=a(t),E=arguments.length,O=E>1?arguments[1]:void 0,T=void 0!==O,S=c(w);if(S&&!f(S))for(b=(m=s(w,S)).next,w=[];!(g=o(b,m)).done;)w.push(g.value);for(T&&E>2&&(O=n(O,arguments[2])),r=u(w),d=new(p(_))(r),v=l(d),e=0;r>e;e++)y=T?O(w[e],e):w[e],d[e]=v?h(y):+y;return d}},4630:(t,e,r)=>{"use strict";var n=r(8844),o=0,i=Math.random(),a=n(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+a(++o+i,36)}},6837:(t,e,r)=>{"use strict";var n=r(3689),o=r(4201),i=r(7697),a=r(3931),u=o("iterator");t.exports=!n((function(){var t=new URL("b?a=1&b=2&c=3","http://a"),e=t.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),n="";return t.pathname="c%20d",e.forEach((function(t,r){e.delete("b"),n+=r+t})),r.delete("a",2),r.delete("b",void 0),a&&(!t.toJSON||!r.has("a",1)||r.has("a",2)||!r.has("a",void 0)||r.has("b"))||!e.size&&(a||!i)||!e.sort||"http://a/c%20d?a=1&c=3"!==t.href||"3"!==e.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!e[u]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},9525:(t,e,r)=>{"use strict";var n=r(146);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5648:(t,e,r)=>{"use strict";var n=r(7697),o=r(3689);t.exports=n&&o((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},1500:t=>{"use strict";var e=TypeError;t.exports=function(t,r){if(t<r)throw new e("Not enough arguments");return t}},9834:(t,e,r)=>{"use strict";var n=r(9037),o=r(9985),i=n.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},4201:(t,e,r)=>{"use strict";var n=r(9037),o=r(3430),i=r(6812),a=r(4630),u=r(146),s=r(9525),c=n.Symbol,f=o("wks"),l=s?c.for||c:c&&c.withoutSetter||a;t.exports=function(t){return i(f,t)||(f[t]=u&&i(c,t)?c[t]:l("Symbol."+t)),f[t]}},6350:t=>{"use strict";t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},9211:(t,e,r)=>{"use strict";var n=r(9989),o=r(6576),i=r(3689),a=r(3999),u=r(5027),s=r(7578),c=r(3126),f=r(6373),l=a.ArrayBuffer,p=a.DataView,h=p.prototype,d=o(l.prototype.slice),v=o(h.getUint8),y=o(h.setUint8);n({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:i((function(){return!new l(2).slice(1,void 0).byteLength}))},{slice:function(t,e){if(d&&void 0===e)return d(u(this),t);for(var r=u(this).byteLength,n=s(t,r),o=s(void 0===e?r:e,r),i=new(f(this,l))(c(o-n)),a=new p(this),h=new p(i),g=0;n<o;)y(h,g++,v(a,n++));return i}})},752:(t,e,r)=>{"use strict";var n=r(5290),o=r(7370),i=r(9478),a=r(618),u=r(2560).f,s=r(1934),c=r(7807),f=r(3931),l=r(7697),p="Array Iterator",h=a.set,d=a.getterFor(p);t.exports=s(Array,"Array",(function(t,e){h(this,{type:p,target:n(t),index:0,kind:e})}),(function(){var t=d(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=void 0,c(void 0,!0);switch(t.kind){case"keys":return c(r,!1);case"values":return c(e[r],!1)}return c([r,e[r]],!1)}),"values");var v=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!f&&l&&"values"!==v.name)try{u(v,"name",{value:"values"})}catch(t){}},5415:(t,e,r)=>{"use strict";var n=r(9989),o=r(8734),i=r(6522);n({target:"Object",stat:!0},{fromEntries:function(t){var e={};return o(t,(function(t,r){i(e,t,r)}),{AS_ENTRIES:!0}),e}})},1195:(t,e,r)=>{"use strict";var n=r(9989),o=r(2615),i=r(509),a=r(8742),u=r(9302),s=r(8734);n({target:"Promise",stat:!0,forced:r(562)},{allSettled:function(t){var e=this,r=a.f(e),n=r.resolve,c=r.reject,f=u((function(){var r=i(e.resolve),a=[],u=0,c=1;s(t,(function(t){var i=u++,s=!1;c++,o(r,e,t).then((function(t){s||(s=!0,a[i]={status:"fulfilled",value:t},--c||n(a))}),(function(t){s||(s=!0,a[i]={status:"rejected",reason:t},--c||n(a))}))})),--c||n(a)}));return f.error&&c(f.value),r.promise}})},6409:(t,e,r)=>{"use strict";var n=r(9989),o=r(3931),i=r(7919),a=r(3689),u=r(6058),s=r(9985),c=r(6373),f=r(2945),l=r(1880),p=i&&i.prototype;if(n({target:"Promise",proto:!0,real:!0,forced:!!i&&a((function(){p.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=c(this,u("Promise")),r=s(t);return this.then(r?function(r){return f(e,t()).then((function(){return r}))}:t,r?function(r){return f(e,t()).then((function(){throw r}))}:t)}}),!o&&s(i)){var h=u("Promise").prototype.finally;p.finally!==h&&l(p,"finally",h,{unsafe:!0})}},4043:(t,e,r)=>{"use strict";var n=r(9989),o=r(6308);n({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},7267:(t,e,r)=>{"use strict";var n=r(1735),o=r(2615),i=r(8844),a=r(8678),u=r(3689),s=r(5027),c=r(9985),f=r(981),l=r(8700),p=r(3126),h=r(4327),d=r(4684),v=r(1514),y=r(4849),g=r(7017),m=r(6100),b=r(4201)("replace"),_=Math.max,w=Math.min,E=i([].concat),O=i([].push),T=i("".indexOf),S=i("".slice),x="$0"==="a".replace(/./,"$0"),R=!!/./[b]&&""===/./[b]("a","$0");a("replace",(function(t,e,r){var i=R?"$":"$0";return[function(t,r){var n=d(this),i=f(t)?void 0:y(t,b);return i?o(i,t,n,r):o(e,h(n),t,r)},function(t,o){var a=s(this),u=h(t);if("string"==typeof o&&-1===T(o,i)&&-1===T(o,"$<")){var f=r(e,a,u,o);if(f.done)return f.value}var d=c(o);d||(o=h(o));var y,b=a.global;b&&(y=a.unicode,a.lastIndex=0);for(var x,R=[];null!==(x=m(a,u))&&(O(R,x),b);)""===h(x[0])&&(a.lastIndex=v(u,p(a.lastIndex),y));for(var P,A="",I=0,j=0;j<R.length;j++){for(var C,L=h((x=R[j])[0]),N=_(w(l(x.index),u.length),0),k=[],D=1;D<x.length;D++)O(k,void 0===(P=x[D])?P:String(P));var U=x.groups;if(d){var M=E([L],k,N,u);void 0!==U&&O(M,U),C=h(n(o,void 0,M))}else C=g(L,u,N,k,U,o);N>=I&&(A+=S(u,I,N)+C,I=N+L.length)}return A+S(u,I)}]}),!!u((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!x||R)},8436:(t,e,r)=>{"use strict";var n=r(9989),o=r(1435).trim;n({target:"String",proto:!0,forced:r(5984)("trim")},{trim:function(){return o(this)}})},9943:(t,e,r)=>{"use strict";var n=r(4872),o=r(2872),i=r(1530),a=r(926),u=r(2615),s=r(8844),c=r(3689),f=n.aTypedArray,l=n.exportTypedArrayMethod,p=s("".slice);l("fill",(function(t){var e=arguments.length;f(this);var r="Big"===p(a(this),0,3)?i(t):+t;return u(o,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),c((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})))},1638:(t,e,r)=>{"use strict";var n=r(9037),o=r(2615),i=r(4872),a=r(6310),u=r(3250),s=r(690),c=r(3689),f=n.RangeError,l=n.Int8Array,p=l&&l.prototype,h=p&&p.set,d=i.aTypedArray,v=i.exportTypedArrayMethod,y=!c((function(){var t=new Uint8ClampedArray(2);return o(h,t,{length:1,0:3},1),3!==t[1]})),g=y&&i.NATIVE_ARRAY_BUFFER_VIEWS&&c((function(){var t=new l(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));v("set",(function(t){d(this);var e=u(arguments.length>1?arguments[1]:void 0,1),r=s(t);if(y)return o(h,this,r,e);var n=this.length,i=a(r),c=0;if(i+e>n)throw new f("Wrong length");for(;c<i;)this[e+c]=r[c++]}),!y||g)},3356:(t,e,r)=>{"use strict";var n=r(9037),o=r(6576),i=r(3689),a=r(509),u=r(382),s=r(4872),c=r(7365),f=r(7298),l=r(3615),p=r(7922),h=s.aTypedArray,d=s.exportTypedArrayMethod,v=n.Uint16Array,y=v&&o(v.prototype.sort),g=!(!y||i((function(){y(new v(2),null)}))&&i((function(){y(new v(2),{})}))),m=!!y&&!i((function(){if(l)return l<74;if(c)return c<67;if(f)return!0;if(p)return p<602;var t,e,r=new v(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(y(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));d("sort",(function(t){return void 0!==t&&a(t),m?y(this,t):u(h(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!m||g)},8607:(t,e,r)=>{"use strict";r(1158)("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},218:(t,e,r)=>{"use strict";r(1195)},6265:(t,e,r)=>{"use strict";var n=r(9037),o=r(6338),i=r(3265),a=r(752),u=r(5773),s=r(5997),c=r(4201)("iterator"),f=a.values,l=function(t,e){if(t){if(t[c]!==f)try{u(t,c,f)}catch(e){t[c]=f}if(s(t,e,!0),o[e])for(var r in a)if(t[r]!==a[r])try{u(t,r,a[r])}catch(e){t[r]=a[r]}}};for(var p in o)l(n[p]&&n[p].prototype,p);l(i,"DOMTokenList")},2625:(t,e,r)=>{"use strict";r(752);var n=r(9989),o=r(9037),i=r(517),a=r(2615),u=r(8844),s=r(7697),c=r(6837),f=r(1880),l=r(2148),p=r(6045),h=r(5997),d=r(974),v=r(618),y=r(767),g=r(9985),m=r(6812),b=r(4071),_=r(926),w=r(5027),E=r(8999),O=r(4327),T=r(5391),S=r(5684),x=r(5185),R=r(1664),P=r(7807),A=r(1500),I=r(4201),j=r(382),C=I("iterator"),L="URLSearchParams",N=L+"Iterator",k=v.set,D=v.getterFor(L),U=v.getterFor(N),M=i("fetch"),B=i("Request"),H=i("Headers"),F=B&&B.prototype,q=H&&H.prototype,G=o.RegExp,z=o.TypeError,W=o.decodeURIComponent,V=o.encodeURIComponent,$=u("".charAt),Y=u([].join),K=u([].push),X=u("".replace),J=u([].shift),Q=u([].splice),Z=u("".split),tt=u("".slice),et=/\+/g,rt=Array(4),nt=function(t){return rt[t-1]||(rt[t-1]=G("((?:%[\\da-f]{2}){"+t+"})","gi"))},ot=function(t){try{return W(t)}catch(e){return t}},it=function(t){var e=X(t,et," "),r=4;try{return W(e)}catch(t){for(;r;)e=X(e,nt(r--),ot);return e}},at=/[!'()~]|%20/g,ut={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},st=function(t){return ut[t]},ct=function(t){return X(V(t),at,st)},ft=d((function(t,e){k(this,{type:N,target:D(t).entries,index:0,kind:e})}),L,(function(){var t=U(this),e=t.target,r=t.index++;if(!e||r>=e.length)return t.target=void 0,P(void 0,!0);var n=e[r];switch(t.kind){case"keys":return P(n.key,!1);case"values":return P(n.value,!1)}return P([n.key,n.value],!1)}),!0),lt=function(t){this.entries=[],this.url=null,void 0!==t&&(E(t)?this.parseObject(t):this.parseQuery("string"==typeof t?"?"===$(t,0)?tt(t,1):t:O(t)))};lt.prototype={type:L,bindURL:function(t){this.url=t,this.update()},parseObject:function(t){var e,r,n,o,i,u,s,c=this.entries,f=R(t);if(f)for(r=(e=x(t,f)).next;!(n=a(r,e)).done;){if(i=(o=x(w(n.value))).next,(u=a(i,o)).done||(s=a(i,o)).done||!a(i,o).done)throw new z("Expected sequence with length 2");K(c,{key:O(u.value),value:O(s.value)})}else for(var l in t)m(t,l)&&K(c,{key:l,value:O(t[l])})},parseQuery:function(t){if(t)for(var e,r,n=this.entries,o=Z(t,"&"),i=0;i<o.length;)(e=o[i++]).length&&(r=Z(e,"="),K(n,{key:it(J(r)),value:it(Y(r,"="))}))},serialize:function(){for(var t,e=this.entries,r=[],n=0;n<e.length;)t=e[n++],K(r,ct(t.key)+"="+ct(t.value));return Y(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var pt=function(){y(this,ht);var t=k(this,new lt(arguments.length>0?arguments[0]:void 0));s||(this.size=t.entries.length)},ht=pt.prototype;if(p(ht,{append:function(t,e){var r=D(this);A(arguments.length,2),K(r.entries,{key:O(t),value:O(e)}),s||this.length++,r.updateURL()},delete:function(t){for(var e=D(this),r=A(arguments.length,1),n=e.entries,o=O(t),i=r<2?void 0:arguments[1],a=void 0===i?i:O(i),u=0;u<n.length;){var c=n[u];if(c.key!==o||void 0!==a&&c.value!==a)u++;else if(Q(n,u,1),void 0!==a)break}s||(this.size=n.length),e.updateURL()},get:function(t){var e=D(this).entries;A(arguments.length,1);for(var r=O(t),n=0;n<e.length;n++)if(e[n].key===r)return e[n].value;return null},getAll:function(t){var e=D(this).entries;A(arguments.length,1);for(var r=O(t),n=[],o=0;o<e.length;o++)e[o].key===r&&K(n,e[o].value);return n},has:function(t){for(var e=D(this).entries,r=A(arguments.length,1),n=O(t),o=r<2?void 0:arguments[1],i=void 0===o?o:O(o),a=0;a<e.length;){var u=e[a++];if(u.key===n&&(void 0===i||u.value===i))return!0}return!1},set:function(t,e){var r=D(this);A(arguments.length,1);for(var n,o=r.entries,i=!1,a=O(t),u=O(e),c=0;c<o.length;c++)(n=o[c]).key===a&&(i?Q(o,c--,1):(i=!0,n.value=u));i||K(o,{key:a,value:u}),s||(this.size=o.length),r.updateURL()},sort:function(){var t=D(this);j(t.entries,(function(t,e){return t.key>e.key?1:-1})),t.updateURL()},forEach:function(t){for(var e,r=D(this).entries,n=b(t,arguments.length>1?arguments[1]:void 0),o=0;o<r.length;)n((e=r[o++]).value,e.key,this)},keys:function(){return new ft(this,"keys")},values:function(){return new ft(this,"values")},entries:function(){return new ft(this,"entries")}},{enumerable:!0}),f(ht,C,ht.entries,{name:"entries"}),f(ht,"toString",(function(){return D(this).serialize()}),{enumerable:!0}),s&&l(ht,"size",{get:function(){return D(this).entries.length},configurable:!0,enumerable:!0}),h(pt,L),n({global:!0,constructor:!0,forced:!c},{URLSearchParams:pt}),!c&&g(H)){var dt=u(q.has),vt=u(q.set),yt=function(t){if(E(t)){var e,r=t.body;if(_(r)===L)return e=t.headers?new H(t.headers):new H,dt(e,"content-type")||vt(e,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),T(t,{body:S(0,O(r)),headers:S(0,e)})}return t};if(g(M)&&n({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return M(t,arguments.length>1?yt(arguments[1]):{})}}),g(B)){var gt=function(t){return y(this,F),new B(t,arguments.length>1?yt(arguments[1]):{})};F.constructor=gt,gt.prototype=F,n({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:gt})}}t.exports={URLSearchParams:pt,getState:D}},9307:(t,e,r)=>{"use strict";r(2625)}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var r=o[t]={id:t,loaded:!1,exports:{}};return n[t].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},r=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(t,n){if(1&n&&(t=this(t)),8&n)return t;if("object"==typeof t&&t){if(4&n&&t.__esModule)return t;if(16&n&&"function"==typeof t.then)return t}var o=Object.create(null);i.r(o);var a={};e=e||[null,r({}),r([]),r(r)];for(var u=2&n&&t;"object"==typeof u&&!~e.indexOf(u);u=r(u))Object.getOwnPropertyNames(u).forEach((e=>a[e]=()=>t[e]));return a.default=()=>t,i.d(o,a),o},i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var a={};return(()=>{"use strict";i.r(a),i.d(a,{init:()=>Vn});var t={};i.r(t),i.d(t,{AMB_GC:()=>M,ARIA_LIVE_ASSERTIVE_TIMEOUT:()=>Et,ARIA_LIVE_POLITE_TIMEOUT:()=>Ot,CHECK_FOR_POSSIBLE_PRESENTATIONAL_COMPONENTS:()=>Y,DEFAULT:()=>j,DEV:()=>L,DISABLE_GQL_BATCHING:()=>K,DISABLE_REST_BATCHING:()=>X,EMBEDDABLE_BASE_URL:()=>jt,ENABLE_ACTION_DISPATCHED_HANDLING:()=>J,ENABLE_DECLARATIVE_STATE_UPDATE_DEEP_COMPARE:()=>vt,ENABLE_PROPERTY_DEEP_COMPARE:()=>dt,ENABLE_SCHEDULER_QUEUE_COUNTS:()=>bt,ENABLE_SCHEDULER_STATS:()=>pt,GARBAGE_COLLECTOR_INTERVAL:()=>Q,GQL_CACHE_CAPACITY:()=>B,GQL_CACHE_MAX_PERSIST:()=>q,GQL_CACHING_ENABLED:()=>H,GQL_CACHING_REFRESH_DELAY:()=>F,HTTP_CACHE_CAPACITY:()=>G,HTTP_CACHE_MAX_PERSIST:()=>V,HTTP_CACHING_ENABLED:()=>z,HTTP_CACHING_REFRESH_DELAY:()=>W,INTERSECT_ROOT_MARGIN:()=>Z,LOGGING_ENABLED:()=>tt,LOGGING_LEVELS:()=>et,LOGS_CLEANUP_INTERVAL:()=>nt,LOGS_OBSERVER_INTERVAL:()=>rt,MEMOIZE:()=>ot,MEMOIZE_SNABBDOM_PROP_PARTS:()=>mt,METRICS_COMPONENT_INTERACTIVE_ENABLED:()=>wt,METRICS_ELEMENT_CONFIG_ENABLED:()=>_t,METRICS_LEVEL:()=>it,METRICS_MARK_EXPIRATION:()=>At,METRICS_MARK_PRUNING_INTERVAL:()=>Pt,METRICS_OBSERVER_INTERVAL:()=>at,METRICS_PRUNE_MARKS:()=>It,METRICS_TYPES:()=>ut,METRICS_USE_WINDOW_PERFORMANCE:()=>ht,NOW_UI_CONFIG:()=>D,NOW_UI_EVENT:()=>U,NOW_UI_FRAMEWORK:()=>k,NOW_UI_FRAMEWORK_CONFIG_KEYS:()=>Ct,NXUI_SYS_PROPS:()=>Lt,PAGE_OPT_OUT_PROPERTY_DEEP_COMPARE:()=>yt,PAGE_OPT_OUT_STATE_DEEP_COMPARE:()=>gt,POSSIBLE_PRESENTATIONAL_COMPONENTS:()=>st,PROD:()=>N,QUEUE_FLUSH_ENABLED:()=>ct,SCHEDULER_RAF_TIMEOUT:()=>Rt,TELEMETRY_MARKING_ENABLED:()=>$,TEST:()=>C,TIME_TO_WAIT_AFTER_DISCONNECT:()=>ft,VALIDATE_SCHEMAS:()=>lt,WHEN_COMPONENT_IS_IDLE_MIN_INTERVAL:()=>xt,WHEN_COMPONENT_IS_IDLE_THROTTLE:()=>St,WHEN_COMPONENT_IS_IDLE_TIMEOUT:()=>Tt});var e={};i.r(e),i.d(e,{createCounter:()=>mr,createGauge:()=>br,createHistogram:()=>_r,createTraceId:()=>He,createTraceParentHeader:()=>Fe,getConfigValue:()=>Ne,isSpanContextValid:()=>vr,isValidSpanId:()=>dr,isValidTraceId:()=>hr,onEvent:()=>fr,setConfigValue:()=>Le,trace:()=>yr,track:()=>gr}),i(6409);let r=!1,n={};function o(t,e){let r=n[t];r||(r={calls:0,hits:0,size:0},n[t]=r),r.calls+=1,e?r.hits+=1:r.size+=1}function u(t,e,n){let i,a=e,c=!1;void 0===n&&"object"==typeof e?(a=e.createCacheKey,i=e.profileName,c=e.snabbdom):"object"==typeof n&&(a=e||n.createCacheKey,i=n.profileName,c=n.snabbdom);const f=function e(...n){const u=a?a.apply(this,n):n[0],{cache:f}=e;if(f.has(u)){r&&o(i,!0);const t=f.get(u);return c?s(t):t}r&&o(i,!1);const l=t.apply(this,n),p=c?s(l):l;return e.cache=f.set(u,p)||f,p};return f.cache=new(u.Cache||Map),f}function s(t){return t?{children:void 0!==t.children?t.children.map((t=>s(t))):void 0,data:t.data,elm:void 0,key:t.key,sel:t.sel,text:t.text}:t}u.Cache=Map,u.collectStats=function(t=!0){r=t},u.clearStats=function(){n={}},u.getStats=function(){return Object.keys(n).reduce(((t,e)=>{const{hits:r,calls:o}=n[e],i={...n[e],usage:o?`%`:"0.0000%"};return{...t,[e]:i}}),{})};const c=u((function(t){if("symbol"==typeof t)return[t];if("string"!=typeof t&&!Array.isArray(t))return[];if(Array.isArray(t))return t;const e=t.split(".");for(let t=0;t<e.length;t++){const r=e[t],{length:n}=r;if("]"===r.charAt(n-1)){const o=[];let i="[",a=r.indexOf(i);const u=r.substring(0,a);for(u&&o.push(u);a<n;){if("["!==i&&"]"!==i){const t=r.indexOf("]",a);let e=r.substring(a,t);e.charAt(0)===e.charAt(e.length-1)&&["'",'"'].includes(e.charAt(0))&&(e=e.slice(1,-1)),o.push(e),a=t}else a+=1;i=r.charAt(a)}const{length:s}=o;s&&(e.splice(t,1,...o),t+=s-1)}}return e}),null,{profileName:"splitPath"});function f(t,e,r){if(!t||!e)return r;const n=c(e);let o=t;const{length:i}=n;for(let t=0;t<i;t++){if(!o||!Object.prototype.hasOwnProperty.call(o,n[t]))return r;o=o[n[t]]}return void 0!==o?o:r}const l=t=>!0===t||"true"===t,p=()=>{var t,e,r,n,o,i,a;return document.hidden&&!l(null===(t=window)||void 0===t||null===(e=t.ux_globals)||void 0===e||null===(r=e.sysprops)||void 0===r?void 0:r["sn_nxui_framework.scheduler.unchained.defer.off"])&&!l(null===(n=window)||void 0===n||null===(o=n.ux_globals)||void 0===o||null===(i=o.nxui)||void 0===i||null===(a=i.sysprops)||void 0===a?void 0:a["sn_nxui_framework.scheduler.unchained.defer.off"])},h=t=>{const e=new MessageChannel;e.port1.onmessage=()=>t(),e.port2.postMessage(null)};let d={};const v="UNKNOWN";function y(t,e=0,r){const n=r||v;t[n]||(t[n]=[]),t[n].push(e)}function g(){return d}function m(t,e=0){return function(t){y(d,t)}(e),p()?h(t):setTimeout(t,e)}var b,_,w,E,O,T,S;function x(t){m((function(){const e=Date.now();t({didTimeout:!1,timeRemaining:()=>Math.max(0,100-(Date.now()-e))})}))}const R=window.requestIdleCallback||x,P=null===(b=window)||void 0===b||null===(_=b.navigator)||void 0===_||null===(w=_.userAgentData)||void 0===w||null===(E=w.brands)||void 0===E?void 0:E.some((t=>"Chromium"===t.brand)),A=(null===(O=window)||void 0===O?void 0:O.location)!==(null===(T=window)||void 0===T||null===(S=T.parent)||void 0===S?void 0:S.location),I="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope||P&&A?x:R,j="DEFAULT",C="test",L="development",N="production",k="nowUiFramework",D="NOW_UI_CONFIG",U="NOW_UI_EVENT",M="ambGC",B="graphQLCacheCapacity",H="graphQLCachingEnabled",F="graphQLCacheDelay",q="gqlCacheMaxPersist",G="httpCacheCapacity",z="httpCachingEnabled",W="httpCacheDelay",V="httpCacheMaxPersist",$="telemetryMarkingEnabled",Y="checkForPossiblePresentationalComponents",K="disableGraphQLBatching",X="disableRestBatching",J="enableActionDispatchedHandling",Q="GARBAGE_COLLECTOR_INTERVAL",Z="intersectRootMargin",tt="loggingEnabled",et="loggingLevels",rt="logsObserverInterval",nt="logsCleanupInterval",ot="memoize",it="metricsLevel",at="metricsObserverInterval",ut="metricTypes",st="possiblePresentationalComponents",ct="queueFlushEnabled",ft="TIME_TO_WAIT_AFTER_DISCONNECT",lt="validateSchemas",pt="enableSchedulerStats",ht="metricsUseWindowPerformance",dt="enablePropertyDeepCompare",vt="enableDeclarativeStateUpdateDeepCompare",yt="pageOptOutOfPropertyDeepCompare",gt="pageOptOutOfStateDeepCompare",mt="memoizeSnabbdomPropParts",bt="enableSchedulerQueueCounts",_t="metricsElementConfigEnabled",wt="metricsComponentInteractiveEnabled",Et="ariaLiveAssertiveTimeout",Ot="ariaLivePoliteTimeout",Tt="whenComponentIsIdleTimeout",St="whenComponentIsIdleThrottle",xt="whenComponentIsIdleMinInterval",Rt="schedulerRafTimeout",Pt="metricsMarkPruningInterval",At="metricsMarkExpiration",It="metricsPruneMarks",jt=Symbol("EMBEDDABLE_BASE_URL"),Ct=[M,B,H,q,F,G,z,$,Y,K,X,J,Z,tt,et,rt,nt,it,at,ut,st,ct,lt,pt,ht,yt,gt,mt,bt,dt,vt,_t,wt,Et,Ot,Tt,St,xt,Rt,Pt,At,It,jt],Lt={"sn_nxui_framework.performance.cache.graphql.capacity":B,"sn_nxui_framework.performance.cache.graphql.enabled":H,"sn_nxui_framework.performance.cache.graphql.max_persist":q,"sn_nxui_framework.performance.cache.graphql.delay":F,"sn_nxui_framework.performance.cache.http.capacity":G,"sn_nxui_framework.performance.cache.http.enabled":z,"sn_nxui_framework.performance.cache.http.max_persist":V,"sn_nxui_framework.performance.cache.http.delay":W,"sn_nxui_framework.performance.telemetry.marking.enabled":$,"sn_nxui_framework.performance.telemetry.window.top.enabled":ht,"sn_nxui_framework.performance.property.deep.compare.enabled":dt,"sn_nxui_framework.performance.declarative.state.update.deep.compare.enabled":vt,"sn_nxui_framework.performance.page.opt.out.property.deep.compare":yt,"sn_nxui_framework.performance.page.opt.out.state.deep.compare":gt,"sn_nxui_framework.performance.memoize.snabbdom.prop.parts":mt,"sn_nxui_framework.performance.scheduler.queue.counts.enabled":bt,"sn_nxui_framework.performance.scheduler.stats.enabled":pt,"sn_nxui_framework.performance.metrics.element.config.enabled":_t,"sn_nxui_framework.interactive_mark":wt,"sn_nxui_framework.disableGraphQLBatching":K,"sn_nxui_framework.whenComponentIsIdleTimeout":Tt,"sn_nxui_framework.whenComponentIsIdleThrottle":St,"sn_nxui_framework.whenComponentIsIdleMinInterval":xt,"sn_nxui_framework.metricsObserverInterval":at,"sn_nxui_framework.schedulerRafTimeout":Rt,"sn_nxui_framework.metricsMarkPruningInterval":Pt,"sn_nxui_framework.metricsMarkExpiration":At,"sn_nxui_framework.metricsPruneMarks":It,"sn_nxui_framework.metricsLevel":it,"sn_nxui_framework.logging.enabled":tt,"sn_nxui_framework.logging.level":et},Nt={};Nt[M]={},Nt[M][Q]=2e4,Nt[M][ft]=5e3,Nt[H]=!0,Nt[F]=500,Nt[B]=3,Nt[z]=!0,Nt[G]=3,Nt[W]=500,Nt[tt]=!0,Nt[et]=!0,Nt[rt]=1e3,Nt[nt]=6e4,Nt[lt]=!0,Nt[Y]=!0,Nt[pt]=!0,Nt[wt]=!0,Nt[Et]=500,Nt[Ot]=5e3,Nt[Tt]=5e3,Nt[St]=50,Nt[xt]=25,Nt[at]=3e3,Nt[Rt]=0,Nt[Pt]=3e5,Nt[At]=3e5,Nt[It]=!0;const kt={};kt[M]={},kt[M][Q]=5e3,kt[M][ft]=1e3,kt[H]=!1,kt[B]=200,kt[z]=!1,kt[G]=200,kt[K]=!1,kt[X]=!1,kt[ot]=u,kt[lt]=!1,kt[Y]=!1,kt[st]=[],kt[ut]=null,kt[it]=null,kt[at]=3e3,kt[pt]=!1,kt[$]=!0,kt[J]=!1,kt[Z]="500px",kt[ct]=!1,kt[tt]=!1,kt[et]=null,kt[rt]=1e3,kt[nt]=6e4,kt[wt]=!1,kt[Et]=500,kt[Ot]=5e3,kt[Tt]=5e3,kt[St]=50,kt[xt]=25,kt[Rt]=0,kt[Pt]=3e5,kt[At]=3e5,kt[It]=!0;const Dt={};Dt[F]=500,Dt[W]=500,Dt[ut]=["TEST"],Dt[pt]=!1,Dt[Z]="400px",Dt[tt]=!0,Dt[lt]=!0,Dt[wt]=!0,Dt[Et]=500,Dt[Ot]=5e3,Dt[Tt]=600,Dt[St]=50,Dt[xt]=25,Dt[at]=3e3,Dt[Rt]=0,Dt[Pt]=3e5,Dt[At]=3e5,Dt[It]=!0;const Ut=()=>{const t="production";return t===N?kt:t===L?{...kt,...Nt}:t===C?{...kt,...Dt}:{}},Mt={},Bt=()=>{const t={};return globalThis[k]?(Ct.forEach((e=>{void 0!==globalThis[k][e]&&(t[e]=globalThis[k][e])})),t):t},Ht=()=>{var t,e;const r={};if(!(null===(t=globalThis.ux_globals)||void 0===t||null===(e=t.nxui)||void 0===e?void 0:e.sysprops))return r;const n=Object.keys(Lt);for(const t in globalThis.ux_globals.nxui.sysprops)if(n.indexOf(t)>-1){const e=Lt[t],n=globalThis.ux_globals.nxui.sysprops[t];r[e]="true"===n||"false"!==n&&n}return r},Ft={},qt=(t,e)=>{const r=Ft[t]||(Ft[t]=new Set);return r.add(e),()=>r.delete(e)},Gt=t=>{const e=f(Mt,t);if(void 0!==e)return e;const r=f(Bt(),t);if(void 0!==r)return r;const n=f(Ht(),t);return void 0!==n?n:f(Ut(),t,void 0)},zt=(t,e)=>{if(Gt(t)===e)return;((t,e)=>{if(!window.__ENABLE_NOW_UI_EVENT__)return;const r=new CustomEvent(U,{composed:!0,bubbles:!0,detail:{type:t,...e}});document.dispatchEvent(r)})(D,{path:t,value:e,previousValue:Gt(t)});const r=function(t,e,r){if(!t||!e)return;const n=c(e);let o,i=t;const{length:a}=n;for(let t=0;t<a;t++){const e=t+1===a,u=n[t];if(o=i[u],!o){const e=n[t+1],r=Number.parseInt(e);o=i[u]=r!=e||Number.isNaN(r)?{}:[]}e&&(i[u]=r),i=o}}(Mt,t,e),n=Ft[t];return n&&n.forEach((r=>r(t,e))),r};globalThis.nowUiFramework=globalThis.nowUiFramework||{},globalThis.nowUiFramework.getConfig=()=>{const t=Bt(),e=Ht();return{...Ut(),...e,...t,...Mt}},globalThis.nowUiFramework.getConfigItem=Gt,globalThis.nowUiFramework.setConfigItem=zt,globalThis.nowUiFramework.observeConfigItem=qt,globalThis.nowUiFramework.getEmbeddableBaseUrl=()=>Gt(jt)||"",globalThis.nowUiFramework.setEmbeddableBaseUrl=t=>zt(jt,t);var Wt=i(7510);const Vt="UXR_UCM_DIALOG_CLOSED";function $t(t){return"function"==typeof t}i(6265),i(218);const Yt="DISPATCH",Kt="ERROR",Xt="GQL",Jt="HTTP",Qt="CONNECTION",Zt="UPDATE_PROPERTIES",te="UPDATE_STATE",ee="RENDER_START",re="RENDER_END",ne="RENDER_TREE",oe="INTERSECTION",ie="SCHEDULE",ae="EXECUTE",ue="DEFER",se="PROPERTY_REFLECTION",ce="EFFECT_START",fe="EFFECT_END",le="PATCH_START",pe="PATCH_END",he="HOOK_START",de="HOOK_END",ve="INTERACTIVE",ye="HERO_INTERACTIVE",ge="UPDATE_CONTEXT",me={DISPATCH:Yt,ERROR:Kt,GQL:"GQL",HTTP:Jt,CONNECTION:Qt,UPDATE_PROPERTIES:Zt,UPDATE_STATE:te,RENDER_START:ee,RENDER_END:re,RENDER_TREE:ne,INTERSECTION:oe,SCHEDULE:ie,EXECUTE:ae,DEFER:ue,PROPERTY_REFLECTION:se,EFFECT_START:ce,EFFECT_END:fe,PATCH_START:le,PATCH_END:pe,HOOK_START:he,HOOK_END:de,INTERACTIVE:ve,HERO_INTERACTIVE:ye,UPDATE_CONTEXT:ge},be={[ye]:5,[ve]:5,[Kt]:5,[Xt]:4,[Jt]:4,[Yt]:3,[ee]:2,[re]:2,[ne]:2,[oe]:1,[Qt]:1,[Zt]:1,[te]:1,[ie]:1,[ae]:1,[ue]:1,[se]:1,[ce]:0,[fe]:0,[le]:0,[pe]:0,[he]:0,[de]:0,[ge]:1},_e="0-50ms",we="51-100ms",Ee="100+ms",Oe="defer",Te="debounce",Se=Symbol("__INTERACTION_ID__"),xe=t=>crypto.getRandomValues(new Uint8Array(t));let Re=256,Pe=[];for(;Re--;)Pe[Re]=(Re+256).toString(16).substring(1);const Ae=t=>{let e=0,r="";for(;e<t.length;e++)r+=Pe[t[e]];return r},Ie=(t,e,r,n)=>({version:t,trace_id:e,parent_id:r,flags:n,child(t){return Ie(this.version,this.trace_id,Ae(xe(8)),void 0===t?this.flags:t?1|this.flags:-2&this.flags)},toString(){const t=this.flags.toString(16).padStart(2,"0");return`---`}});function je(t){const e=xe(24);return Ie("00",Ae(e.slice(0,16)),Ae(e.slice(16,24)),t?1:0)}const Ce={debug:!1,enableTrace:!1,enableCounter:!1,enableGauge:!1,enableHistogram:!1,enableInteractions:!1,enableTrack:!1,enableMousemoveInteractions:!1,enableScrollInteractions:!1,enableKeypressInteractions:!1,enableClickInteractions:!1},Le=(t,e)=>Ce[t]=e,Ne=t=>Ce[t],ke="exception.type",De="exception.message",Ue=Array.from(document.getElementsByTagName("meta")).find((t=>"traceparent"===t.getAttribute("name"))),Me=Ue&&Ue.content?function(t){if(t.length>55)return null;const e=t.split("-");return Ie(e[0],e[1],e[2],parseInt(e[3],16))}(Ue.content):je(),Be=(Me.parent_id,Me.trace_id,Me.flags,Me.toString()),He=()=>je().trace_id,Fe=(t,e)=>`---`;let qe={};const Ge=()=>({...qe});let ze={};const We=()=>({...ze});let Ve={};const $e=()=>({...Ve});function Ye(){return{application:$e(),user:Ge(),page:We()}}const Ke={UNSPECIFIED:0,INTERNAL:1,SERVER:2,CLIENT:3,PRODUCER:4,CONSUMER:5},Xe="00000000000000000000000000000000",Je="0000000000000000",Qe=()=>null,Ze=()=>performance.timeOrigin+performance.now();function tr(t){return function(e,r={}){if(Ne("enableTrace")){const{attributes:n={},links:o=[],parentSpan:i,events:a=[],kind:u=Ke.INTERNAL}=r,s=i?i.id:void 0,c=i?i.traceId:r.traceId||He(),{page:f,user:l,application:p}=Ye();return{type:"trace",id:je().parent_id,traceId:c,links:o,events:a,status:0,attributes:n,application:p,user:l,page:f,name:e,documentTraceParent:Be,startTime:Ze(),parentSpanId:s,endTime:null,duration:null,kind:u,setStatus(t){this.status=t},addEvent(t,e,r=Date.now()){this.events.push({name:t,attributes:e,time:r})},end(){this.endTime=Ze(),this.duration=this.endTime-this.startTime,t(this)},recordException(t,e=Date.now()){const r={};"string"==typeof t?r[De]=t:t&&(t.code?r[ke]=t.code.toString():t.name&&(r[ke]=t.name),t.message&&(r[De]=t.message),t.stack&&(r["exception.stacktrace"]=t.stack)),r[ke]||r[De]?this.addEvent("exception",r,e):console.warn(`Failed to record an exception `)},setAttribute(t,e){this.attributes[t]=e}}}return{id:Je,traceId:Xe,links:[],events:[],attributes:{},status:0,name:e,startTime:null,endTime:null,parentSpanId:null,setStatus:Qe,addEvent:Qe,end:Qe,recordException:Qe,setAttribute:Qe}}}function er(t){return function(e,r={}){if(!Ne("enableTrack"))return;const{attributes:n,time:o=Date.now(),traceId:i}=r,{page:a,user:u,application:s}=Ye(),c={name:e,type:"usage",attributes:n,application:s,user:u,page:a,timestamp:o,traceId:i||He(),documentTraceParent:Be};t(c)}}const rr=(t,e,r,n)=>{const o=je().parent_id;return function(i,a){(t=>{switch(t){case"counter":return Ne("enableCounter");case"gauge":return Ne("enableGauge");case"histogram":return Ne("enableHistogram")}})(r)&&(a&&(e.attributes={...e.attributes,...a}),n({...e,id:o,name:t,type:r,value:i,traceId:e.traceId||He()}))}};function nr(t){const e=e=>t((t=>{t.attributes||(t.attributes={});const{page:e,application:r,user:n}=Ye();return t.timestamp=Date.now(),t.application=r,t.user=n,t.page=e,t.documentTraceParent=Be,t})(e));return{createCounter:(t,r={})=>rr(t,r,"counter",e),createGauge:(t,r={})=>rr(t,r,"gauge",e),createHistogram:(t,r={})=>rr(t,r,"histogram",e)}}const or=new Set;or.add(window);const ir=t=>{if(!Ne("enableInteractions"))return!1;switch(t){case"move":return Ne("enableMousemoveInteractions");case"scroll":return Ne("enableScrollInteractions");case"keypress":return Ne("enableKeypressInteractions");case"click":return Ne("enableClickInteractions")}},ar=new Set,ur={events:[],flushed:!1},sr=t=>ur[t];function cr(t){const e=Ne("debug"),r=sr("flushed"),n=sr("events");e&&console.dir(t),"trace"!==t.type?(ar.forEach((e=>e(t))),r||n.push(t)):(({type:t,id:e,traceId:r,links:n,events:o,status:i,attributes:a,application:u,user:s,page:c,name:f,documentTraceParent:l,startTime:p,parentSpanId:h,endTime:d,duration:v,kind:y})=>{ar.forEach((g=>g({type:t,id:e,traceId:r,links:n,events:o,status:i,attributes:a,application:u,user:s,page:c,name:f,documentTraceParent:l,startTime:p,parentSpanId:h,endTime:d,duration:v,kind:y})))})(t)}function fr(t){return ar.add(t),()=>ar.delete(t)}const lr=/^([0-9a-f]{32})$/i,pr=/^[0-9a-f]{16}$/i;function hr(t){return lr.test(t)&&t!==Xe}function dr(t){return pr.test(t)&&t!==Je}function vr(t){return hr(t.traceId)&&dr(t.spanId)}const{trace:yr,track:gr,metrics:{createCounter:mr,createGauge:br,createHistogram:_r}}=function(t){for(const e in t)Le(e,t[e]);return((t,e={})=>{ze={...e,id:void 0||location.href.replace(location.origin,"")}})(),function(t){if(!Ne("enableInteractions"))return!1;let e=0,r=window.innerWidth,n=window.innerHeight,o=document.documentElement.scrollWidth,i=document.documentElement.scrollHeight;window.addEventListener("resize",(t=>{const a=Date.now();a>e+100&&(r=window.innerWidth,n=window.innerHeight,o=document.documentElement.scrollWidth,i=document.documentElement.scrollHeight,e=a)}));const a=(t,e)=>{const{clientX:a,clientY:u,pageX:s,pageY:c,screenX:f,screenY:l,target:p}=e,{page:h,user:d,application:v}=Ye();return{attributes:{clientX:a,clientX:a,pageX:s,pageY:c,screenX:f,screenY:l,target:p.tagName.toLowerCase(),windowWidth:r,windowHeight:n,pageWidth:o,pageHeight:i,scrollTop:"scroll"===t?p.scrollTop:void 0},name:t,application:v,user:d,page:h,type:"interaction",timestamp:Date.now(),traceId:He(),documentTraceParent:Be}};or.forEach((e=>{let r=0;e.addEventListener("scroll",(e=>{if(!ir("scroll"))return;const n=Date.now();if(n>r+100){const o=a("scroll",e);r=n,t(o)}}))}));let u=0;document.addEventListener("mousemove",(e=>{if(!ir("move"))return;const r=Date.now();if(r>u+100){const{clientX:n,clientY:o,pageX:i,pageY:s,screenX:c,screenY:f,target:l}=e,p=a("mousemove",e);u=r,t(p)}})),document.addEventListener("click",(e=>{if(!ir("click"))return;const r=a("click",e);t(r)})),document.addEventListener("keypress",(e=>{if(!ir("keypress"))return;const r=a("keypress",e);t(r)}))}(cr),{trace:tr(cr),track:er(cr),metrics:nr(cr)}}(),{createTraceId:wr,getConfigValue:Er}=e,Or=2147483648,Tr=Math.floor(Math.random()*Or).toString(36)+Math.abs(Math.floor(Math.random()*Or)^Date.now()).toString(36);let Sr=0;function xr(){return!0===Er("enableTrace")?wr():(Sr+=1,`-`)}const Rr={...be};function Pr(t,e=0){if(Rr[t])throw new Error(`@servicenow/ui-metrics  is already a defined metric.`);if(!Number.isInteger(e)||e>5||e<0)throw new Error(`@servicenow/ui-metrics  is not valid metric level.`);Rr[t]=e}const Ar=new Set,Ir=[],{GQL:jr,HTTP:Cr,RENDER_START:Lr,UPDATE_PROPERTIES:Nr,DISPATCH:kr,UPDATE_STATE:Dr}=me;let Ur=0,Mr=0,Br=0,Hr=0,Fr=0,qr=0;const{METRICS_LEVEL:Gr,METRICS_TYPES:zr,TELEMETRY_MARKING_ENABLED:Wr,METRICS_ELEMENT_CONFIG_ENABLED:Vr}=t;let $r=parseInt(Gt(Gr)),Yr=Number.isInteger($r),Kr=Gt(zr),Xr=Gt(Wr),Jr=Gt(Vr),Qr={};const Zr=(t,e)=>{switch(Qr={},t){case Gr:$r=e,Yr=Number.isInteger($r);break;case zr:Kr=e;break;case Wr:Xr=e;break;case Vr:Jr=e}};qt(Gr,Zr),qt(zr,Zr),qt(Wr,Zr),qt(Vr,Zr);const tn=new Set,{METRICS_OBSERVER_INTERVAL:en,METRICS_USE_WINDOW_PERFORMANCE:rn,METRICS_MARK_PRUNING_INTERVAL:nn,METRICS_MARK_EXPIRATION:on,METRICS_PRUNE_MARKS:an}=t;let un;const sn=[],cn=Gt(nn),fn=Gt(on),ln=Gt(an);let{performance:pn}=window;if(!Gt(rn))try{pn=window.top.performance}catch(t){}const hn=()=>{tn.size&&(clearTimeout(un),un=m((()=>{var t;t=()=>{const t=sn.splice(0);t.length&&tn.forEach((e=>e([...t])))},p()?x(t):I(t)}),Gt(en)))},dn=[],vn=(t,e)=>{var r;return!(!gn(t)||!yn(e))||!!e.name.includes(null==t||null===(r=t.options)||void 0===r?void 0:r.path)},yn=t=>t.name.includes("/api/now/v1/batch"),gn=t=>{var e;return null==t||null===(e=t.options)||void 0===e?void 0:e.batch};if(window.PerformanceObserver){const t=new PerformanceObserver((t=>{const e=t.getEntries().sort(((t,e)=>t.startTime<e.startTime?-1:t.startTime>e.startTime?1:0));for(let t=0;t<dn.length;t++){const r=dn[t];for(let n=0;n<e.length;n++){const o=e[n];if(o.startTime>r.markTime&&vn(r,o)){r.options.resource=o.toJSON(),dn.splice(t,1),t-=1,sn.push(r),hn(),gn(r)||e.splice(n,1);break}}}}));t.observe({entryTypes:["resource"]})}function mn(t={},e,r,n={},o="performance"){var i,a;(t=>{switch(t){case jr:Ur++;break;case Cr:Mr++;break;case Lr:Br++;break;case Nr:Hr++;break;case kr:Fr++;break;case Dr:qr++}})(r);const u=function(t){if(!t.nowId)return t;const e="SEISMIC-HOIST"===t.tagName?t.sourceElement:t;return{componentName:e.tagName,componentId:e.nowId,parentComponentId:e.__DO_NOT_USE_OR_YOU_WILL_BE_FIRED_BY_YOUR_PARENT__,metricTypes:e.metricTypes,metricsLevel:e.metricsLevel,ready:e.__DO_NOT_USE_BOOTSTRAPPED__}}(t);if(!function(t,e){if(!1===Xr)return!1;if(!t.ready)return!1;if(Jr&&Array.isArray(t.nowMetricTypes))return t.nowMetricTypes.includes(e);if(Array.isArray(Kr))return Kr.includes(e);const r=Rr[e];return!!(t=>{if(Qr[t])return!0;const e=Number.isInteger(t)&&t>=0&&t<=5;return e&&(Qr[t]=!0),e})(r)&&(Jr&&Number.isInteger(t.nowMetricsLevel)?r>=t.nowMetricsLevel:Yr&&r>=$r)}(u,r))return;const{componentName:s,componentId:c,parentComponentId:f}=u,l=(p={componentName:s,componentId:c,parentComponentId:f,markTime:pn.now(),interactionId:e,event:r,options:n,type:o},Ar.size?[...Ar].reduceRight(((t,e)=>e(t)),p):p);var p;r!==me.HTTP&&r!==me.GQL||(dn.push(l),l.options.resource={unresolved:!0}),Ir.push(l),tn.size&&!(null==l||null===(i=l.options)||void 0===i||null===(a=i.resource)||void 0===a?void 0:a.unresolved)&&(sn.push(l),hn())}function bn(){return[...Ir]}function _n(){Ir.length=0}function wn(t){return tn.add(t),()=>tn.delete(t)}ln&&cn>0&&setInterval((()=>{const t=pn.now();for(let e=0;e<dn.length;e++)if(t-dn[e].markTime>=fn){dn.splice(e);break}for(let e=0;e<Ir.length;e++)if(t-Ir[e].markTime>=fn){Ir.splice(e);break}}),cn);const En=()=>({...Rr});let On={},Tn=g();function Sn(t){const e={[_e]:{},[we]:{},[Ee]:{}};return Object.keys(t).forEach((r=>{(t[r]||[]).forEach((t=>{t<=50?e[_e][r]=(e[_e][r]?e[_e][r]:0)+1:t>100?e[Ee][r]=(e[Ee][r]?e[Ee][r]:0)+1:e[we][r]=(e[we][r]?e[we][r]:0)+1}))})),e}let xn=!1;const Rn=()=>xn,Pn=()=>{On={},d={},Tn=g()};globalThis.nowUiFrameworkMetrics={applyInteractionId:function(t){return t[Se]||(t[Se]=xr()),t},getInteractionId:function(t){return t[Se]},setInteractionId:function(t,e){return t[Se]=e,t},createInteractionId:xr,defineMetric:Pr,mark:mn,clearMarks:_n,getMarks:bn,observe:wn,types:me,getMetricTypes:En,addMarkAugmenter:function(t){return"function"!=typeof t?()=>{}:(Ar.add(t),()=>Ar.delete(t))},getPerformanceCounters:()=>({totalGQL:Ur,totalHTTP:Mr,totalRenders:Br,totalPropChange:Hr,totalDispatch:Fr,totalStateUpdates:qr}),clearPerfomanceCounters:()=>{Ur=0,Mr=0,Br=0,Hr=0,Fr=0,qr=0},collectMetrics:(t={})=>{const{shouldClear:e=!1,shouldDisable:r=!1}=t;r&&(xn=!1);const n={[Oe]:Sn(Tn),[Te]:Sn(On)};return e&&Pn(),{counters:n}},logTimingMetrics:(t,e=0,r)=>{if(Rn())switch(t){case Oe:y(Tn,e,r);break;case Te:y(On,e,r)}},isPerfMetricsEnabled:Rn,enableMetrics:()=>{xn=!0}};const An=window.requestIdleCallback||function(t){setTimeout((function(){const e=Date.now();t({didTimeout:!1,timeRemaining:()=>Math.max(0,100-(Date.now()-e))})}))};var In,jn,Cn,Ln;const Nn={},kn=(null===(In=window)||void 0===In||null===(jn=In.ux_globals)||void 0===jn||null===(Cn=jn.libuxf)||void 0===Cn||null===(Ln=Cn.sysprops)||void 0===Ln?void 0:Ln["glide.uxf.lib.ux.metrics.clear_interval"])||15e3;let Dn,Un=0;function Mn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(t.length>0||e)&&function(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;const{all:n,usage:o,performance:i}=Wt.markTypes,a={[o]:[],[i]:[]};e.forEach((t=>{const{type:e}=t;e===n?(a[o].push(t),a[i].push(t)):a[e]&&a[e].push(t)})),Object.keys(Nn).forEach((t=>{Nn[t].forEach((e=>e({marks:a[t],immediate:r})))})),Un=(null===(t=e[e.length-1])||void 0===t?void 0:t.markTime)||Un}(t,e)}function Bn(){var t;Dn&&clearInterval(Dn);const e=(null!==(t=bn())&&void 0!==t?t:[]).filter((t=>"usage"==t.type&&t.markTime>Un));Mn(e,!0)}let Hn=!1;function Fn(t){const{path:e,config:r}=t;return new Promise(((t,n)=>{(function(t){return t.includes("@devsnc/ux-metrics-appsee-subscriber")?Promise.resolve().then(i.bind(i,622)):Promise.resolve().then(i.t.bind(i,2857,23))})(e).then((o=>{if(function(t){let{handleMarks:e,init:r}=t;return $t(e)&&"function"==typeof r}(o)){const{init:i,name:a,type:u=Wt.markTypes.usage,handleMarks:s}=o;Promise.resolve(i(r||{})).then((()=>{(function(t,e,r){$t(r)&&function(t){return Object.values(Wt.markTypes).includes(t)}(e)?Nn[e]?Nn[e].push(r):Nn[e]=[r]:console.error("".concat(t," subscriber handleMarks should be of type function, type should be one of markType(all, usage, performance)"))})(a,u,s),t()})).catch((t=>{n(),console.error("UX Metrics Subscriber is not initialized from path ".concat(e),t.message)}))}else n(),console.error("UX Metrics Subscriber is not valid from path ".concat(e,". Ignoring the subscriber."))})).catch((t=>{n(),console.error("Failed to load UX Metrics Subscriber from path ".concat(e),t.message)}))}))}const qn=function(t){return function(t){return Array.isArray(t)&&t.length>0}(t)?function(t){return Promise.allSettled(t.map(Fn))}(t):Promise.reject("No valid subscriber")},Gn={subscribers:{},async updateUserConsent(t){try{if(!t)return;const e={YES:"Y",AGREE:"Y",NO:"N"}[t];if(!e)return void console.log("Unsupported user consent - ".concat(t));const r={user_consent:e},n=await fetch("/api/now/consent/update",{keepalive:!0,credentials:"same-origin",method:"POST",headers:{"Content-Type":"application/json","X-Transaction-Source":window.transaction_source,"X-UserToken":window.g_ck},body:JSON.stringify(r)});return this.notifyChange(e),n}catch(t){throw console.error("Error updating the user consent - ".concat(t)),t}},notifyChange(t){for(const e in this.subscribers)this.subscribers[e].call(null,t)},subscribe(t,e){this.subscribers[t]=e},unsubscribe(t){delete this.subscribers[t]}},zn=()=>{window.addEventListener("GLIDE_UX_METRICS",(t=>{var e=t.detail;const{level:r=Wt.DEFAULT_LEVEL,type:n=Wt.markTypes.usage}=e.config||{};En()[e.eventName]||Pr(e.eventName,r),mn({ready:!0,__DO_NOT_USE_BOOTSTRAPPED__:!0},"",e.eventName,e.data,n)}))};function Wn(t){let{detail:{payload:{result:e}}={}}=t;e||document.removeEventListener(Vt,Wn)}function Vn(t){const{globalMetricsLevel:e,subscribers:r,userConsentRequired:n}=t;return n&&(window.userConsent=Gn,document.addEventListener(Vt,Wn)),function(t){let{globalMetricsLevel:e}=t;var r;r=e,Number.isInteger(r)&&r>=0&&zt("metricsLevel",e)}({globalMetricsLevel:e}),zn(),function(){if(!Hn){const t=window.top!==window.self?"unload":"beforeunload";window.addEventListener(t,Bn),Hn=!0}}(),qn(r).then((()=>{Mn(bn(),!1),wn((async t=>Mn(t,!1)))})).finally((()=>function(){if(_n&&kn>0)return Dn=setInterval((()=>An((()=>_n()))),kn),Dn}()))}})(),a})()));
;
;
/*! RESOURCE: /scripts/js_includes_ux_metrics.js */
/*! RESOURCE: /scripts/now_ux_metrics_initializer.js */
(function() {
	var isInitialized = false;
	if (window.self === window.top) {
		if (isInitialized)
			return;
		function init() {
			if (window.nowUiClassic && window.NOW.UXMetrics && window.NOW.UXMetrics.config) {
				window.nowUiClassic.ux_metrics_runtime.init(window.NOW.UXMetrics.config);
				var consentDialog = document.getElementById('user_consent_dialog');
				if (consentDialog)
					consentDialog.classList.remove("hidden");
				isInitialized = true;
			}
		}
		if (window.addLateLoadEvent) {
			addLateLoadEvent(init);
		} else if (window.g_load_functions) {
			window.g_load_functions.push(init);
		} else {
			window.addEventListener("load", init)
		}
	}
})();
;
;
/*! RESOURCE: /scripts/js_includes_now_ux_metrics.js */
/*! RESOURCE: /scripts/nowuxmetrics/form_ux_metrics.js */
(function() {
	function onloadActions() {
		function startUXMetricsSession() {
			if (window.self === window.top) {
				if (!window.GlideUXMetrics)
					return;
                                var isPolaris = (NOW.isPolarisEnabled == 'true' || NOW.isPolarisWrapper == 'true' ||  NOW.isPolarisEnabled == true 
                                                || NOW.isPolarisWrapper == true);
				window.GlideUXMetrics.track('EXPERIENCE_START', {
					meta: {
						applicationContextId: isPolaris ? 'a84adaf4c700201072b211d4d8c260b7' : '4a3bbe6da35b9110c1c3de5e26fcdad0',
						applicationContextName: isPolaris ? 'Unified Navigation App' : 'CoreUI App',
						url: location.pathname + location.search,
pageTitle: (document.title || '').split(/\s\|\s/)[0]
					}
				});
			}
		}
		startUXMetricsSession();
		function getFileType(fileName) {
			return (fileName || '').split('.').pop();
		}
            CustomEvent.observe("body_clicked", debounceBodyClicked(captureClickMetrics, 50));
            function debounceBodyClicked(fn, ms) {
                var timeout;
                return function (evt) {
                    if (timeout)
                        clearTimeout(timeout);
                    timeout = setTimeout(function () {
                        fn(evt);
                        timeout = null;
                    }, ms);
                }
            }
            function captureClickMetrics(evt) {
                if (!evt || !evt.target || !window.GlideUXMetrics)
                    return;
                var target = evt.target;
                var parent = target.parentElement;
                var dataset = evt.target.dataset;
                var parentDataset = parent ? parent.dataset : {};
                var eventName = dataset['nowUxMetricsEvent'] || parentDataset['nowUxMetricsEvent'];
                try {
                    switch (eventName) {
                        case 'Click Next Record':
                        case 'Click Previous Record':
                            GlideUXMetrics.track(eventName, {'table': g_form.getTableName()});
                            break;
                        case 'Click Form Action':
                            GlideUXMetrics.track(eventName, {
                                'table': g_form.getTableName(),
                                'label': target.innerText,
                                'sysid': g_form.getUniqueValue(),
                                'name': dataset['actionName']
                            });
                            break;
                        case 'Personalize Form Field':
                            GlideUXMetrics.track(eventName, {
                                'name': target.attributes['name'].value,
                                'action': target.checked ? 'Check' : 'Uncheck',
                                'table': g_form.getTableName(),
                                'viewName': window.NOW.UXMetrics && window.NOW.UXMetrics.viewInfo && window.NOW.UXMetrics.viewInfo.viewName,
                                'viewId': window.NOW.UXMetrics && window.NOW.UXMetrics.viewInfo && window.NOW.UXMetrics.viewInfo.viewId,
                            });
                            break;
                        case 'Follow Record':
                        case 'Unfollow Record':
                        case 'Open Connect Mini':
                        case 'Open Connect Full':
                            GlideUXMetrics.track(eventName, {
                                'table': g_form.getTableName(),
                                'sysid': g_form.getUniqueValue()
                            });
                            break;
                        case 'Manage Attachments':
							var count = gel('attachmentNumber_' + g_form.getUniqueValue());
                            GlideUXMetrics.track(eventName, {
                                count:  count && count.textContent || 0
                            });
                            break;
                        case 'Click More Options':
                        case 'Click Suggestion':
                        case 'Personalize Form':
                            GlideUXMetrics.track(eventName);
                            break;
                        case 'Apply Attachment Action':
var attachmentAction = (dataset.nowUxMetricsAction || '').replace(/[\[\]']+/g, '')
                            if (attachmentAction == 'Remove') {
                                var deletedSysIds = gel("deleted_sys_ids").value;
                                var deleteIds = deletedSysIds.split(";") || [];
                                for (var i = 0; i < deleteIds.length; i++) {
                                    var id = deleteIds[i];
                                    var element = gel('sys_id_' + id);
                                    if (element) {
                                        var fileName = element.dataset.nowUxMetricsFilename || '';
                                        GlideUXMetrics.track(eventName, {
                                            'action': 'Remove',
                                            'fileType': getFileType(fileName),
                                            'attachmentId': id
                                        });
                                    }
                                }
                            } else {
                                GlideUXMetrics.track(eventName, {
                                    'fileType': getFileType(dataset.nowUxMetricsFilename || ''),
                                    'action': attachmentAction,
                                    'attachmentId': dataset.nowUxMetricsAttachmentid
                                });
                            }
                            break;
                        case 'Toggle Form Section':
                            GlideUXMetrics.track(eventName, {
                                'sectionName': dataset.sectionTitle,
                                'action': target.attributes['aria-expanded'].value === "true" ? "Expand" : "Collapse"
                            });
                                break;
                            case 'Click Related Link':
                                GlideUXMetrics.track(eventName, {
                                    'name': dataset.nowUxMetricsLinkName
                                });
                                break;
                            case 'Select Date and Time':
                                var ref = dataset.ref || parent.dataset.ref;
                                var requestedBy = ref.split('.');
                                requestedBy.shift();
                                var fieldName = requestedBy.join('.');
                                GlideUXMetrics.track(eventName, {
                                    'name': fieldName
                                });
                                break;
                            case 'Show Related Records':
                                var ref = dataset['requestedBy'];
                                var relatedRecordTableName = g_form.getTableName();
                                if (ref) {
                                    captureRecordMetrics(eventName, ref, relatedRecordTableName)
                                }
                                break;
                            case 'Look Up Record List':
                                var ref = dataset['requestedBy'] || parent.dataset['requestedBy'];
                                var relatedRecordTableName = dataset['form'] || parent.dataset['form'];
                                if (ref) {
                                    captureRecordMetrics(eventName, ref, relatedRecordTableName)
                                }
                                break;
                        default:
                            break;
                    }
                } catch (err) {
                }
            }
            function captureRecordMetrics(eventName, ref, relatedRecordTableName) {
                var requestedBy = ref.split('.');
                var data = {};
                requestedBy.shift();
                var fieldName = requestedBy.join('.');
                data['name'] =  fieldName;
                data['table'] = relatedRecordTableName;
                GlideUXMetrics.track(eventName, data);
            }
		Event.observe(document.body, 'drop', function(event) {
			if (!event.dataTransfer || !event.dataTransfer.files)
				return;
			try {
				var files = event.dataTransfer.files;
				for (var i = 0; i < files.length; i++) {
					var fileName = files[i].name || '';
					GlideUXMetrics.track('Add Attachment', {
						action: 'Drag and Drop',
						fileType: getFileType(fileName),
						fileSize: getDisplaySize(files[i].size)
					});
				}
			} catch (err) {
			}
		});
	}
	if (window.addLateLoadEvent) {
		window.addLateLoadEvent(onloadActions);
	} else {
		window.addEventListener("load", onloadActions)
	}
})();
;
/*! RESOURCE: /scripts/now_ux_metrics.js */
var GlideUXMetrics = (function () {
	function setMetaData(eventName, data) {
		var data = data || {};
		if (eventName == 'USER_NAVIGATE'  || eventName == 'EXPERIENCE_START') {
			var meta = data.meta || {};
			meta.url =  meta.url || (meta.pageTitle ? meta.url : window.location.pathname + window.location.search);
meta.pageTitle = meta.pageTitle || (window.document.title || '').split(/\s\|\s/)[0];
			meta.selectedContent = meta.selectedContent || {};
			if (!meta.selectedContent.isSeismicApp)
				meta.selectedContent.isSeismicApp = false;
		}
		return data;
	}
	function track(eventName, data, config) {
		if (!eventName) return;
		var payload = {
			"eventName": eventName, "data": setMetaData(eventName, data), "config": config
		}
		window.top.dispatchEvent(new CustomEvent('GLIDE_UX_METRICS', {detail: payload}));
	}
	function trackPerformance(key, metrics) {
		if (!isPerformanceMonitoringEnabled()) return;
		if (!key || !metrics) return;
		metrics = metrics instanceof Array? metrics: [metrics];
		var payload = {
			eventName: '$PERF-DATA',
			data: {key, metrics},
			config: {level: 5, type: 'usage'}
		};
		window.top.dispatchEvent(new CustomEvent('GLIDE_UX_METRICS', {detail: payload}));
	}
	function isPerformanceMonitoringEnabled() {
		var isGlobalPerfEnabled = !!('true' === 'true');
		var isUi16PerfEnabled = !!('true' === 'true');
		return isGlobalPerfEnabled && isUi16PerfEnabled;
	}
	return {
		track: track,
		trackPerformance: trackPerformance
	};
})();
;
/*! RESOURCE: /scripts/doctype/telemetry_for_form_controls.js */
function telemetryForRecordUpdate(fieldName) {
	var elem = window.g_form && g_form.getGlideUIElement(fieldName);
	var type = elem && elem.type;
	var options = {
		name: fieldName,
		type: type
	};
	window.GlideUXMetrics && GlideUXMetrics.track('Update Field', options);
}
function telemetryForRecordUpdateElement(ref) {
	if (!ref) return;
	var field = ref.split('.');
	field.shift();
	var fieldName = field.join('.');
	telemetryForRecordUpdate(fieldName);
}
function telemetryForPreviewRecord(ref, dependentTable) {
	if (!ref) return;
	var requestedBy = ref.split('.');
	requestedBy.shift();
	var fieldName = requestedBy.join('.');
	var options = {
		name: fieldName,
		table: dependentTable
	};
	window.GlideUXMetrics && GlideUXMetrics.track('Preview Record', options);
}
function telemetryForWatchlist(evt) {
	var target = evt.target;
	var parent = target.parentElement;
	var eventName = target.dataset['nowUxMetricsEvent'] || parent.dataset['nowUxMetricsEvent'];
	window.GlideUXMetrics && GlideUXMetrics.track(eventName);
}
;
;
